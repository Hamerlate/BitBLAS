# Reproduce the results of Table1

The Table1 is about the performance of the matrix multiplication of vendor libraries. The performance is measured by the throughput of the matrix multiplication. The throughput is calculated by the number of elements in the matrix divided by the time of the matrix multiplication. The throughput is measured in GFLOPS. The throughput is calculated by the following formula:

\[
\text{{Throughput}} = \frac{{\text{{Number of elements in the matrix}}}}{{\text{{Time of the matrix multiplication}}}}
\]

The Table1 is generated by the following command:

```bash
# reproduce the results of Table1 on A100
cd nvidia
python run_all.py --device A100 --reproduce
cd ..

# reproduce the results of Table1 on V100
cd nvidia
python run_all.py --device V100 --reproduce
cd ..

# reproduce the results of Table1 on MI250
cd amd
python run_all.py --device MI250 --reproduce
cd ..
```

The `run_all.sh` scripts share the following common options:

- `device`: str, the device to measure, default is `A100`.
- `reproduce`: bool, whether to use the paper's result as the input, if not set, the script will run the benchmark to get the result, default is `False`.
- `FORCE_TUNE`: bool, whether to force tune the op with AMOS/TensorIR, otherwise use the checkpoints if available, default is `False`.

The example output of the Table1 is shown below:

```bash
+---------------------------------------------------------------------------------------------------+
|                                    Performance Overview - A100                                    |
+----------+----------------------+----------------------+--------------------+---------------------+
| Library  | W$_{FP16}$A$_{FP16}$ | W$_{INT8}$A$_{INT8}$ | W$_{FP8}$A$_{FP8}$ | W$_{NF4}$A$_{FP16}$ |
+----------+----------------------+----------------------+--------------------+---------------------+
|  cuBLAS  |         87%          |         52%          |         x          |          x          |
| rocBLAS  |          x           |          x           |         x          |          x          |
|   AMOS   |         38%          |         45%          |         x          |          x          |
| TensorIR |         56%          |          x           |         x          |          x          |
|  Roller  |         70%          |          x           |         x          |          x          |
+----------+----------------------+----------------------+--------------------+---------------------+
```
