fc_model/latest.pth.tar does not exist. Failed to load checkpoint.
Batch 128
Dtype float16
Trials 200
Logging to devnull...
Totally 1 different mappings for this matching
Logging to devnull...
Totally 1 different mappings for this matching
Query subgraph task id: 0, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph1.log...
Query subgraph task id: 1, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 2, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 3, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 4, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph5.log...
Query subgraph task id: 5, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph9.log...
Query subgraph task id: 6, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 7, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 8, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 9, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph14.log...
Query subgraph task id: 10, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 11, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 12, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 13, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph34.log...
Query subgraph task id: 14, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 15, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 16, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 17, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph39.log...
Query subgraph task id: 18, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 19, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 20, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 21, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph51.log...
Query subgraph task id: 22, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 23, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 24, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 25, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph56.log...
Query subgraph task id: 26, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 27, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 28, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 29, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph64.log...
Query subgraph task id: 30, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 31, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 32, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph69.log...
Query subgraph task id: 33, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 34, perf=10000000000.000000 ms after 0 tuning
#############################################
operations:inputs:[128, 2048],[1000, 2048],body:R[128, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[128, 2048] [1000, 2048] [128, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 700.2786003546378/700.2786003546378
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=2: 2818.8308204421332/2818.8308204421332
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=3: 445.6261438036614/2818.8308204421332
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=4: 960.3909168798774/2818.8308204421332
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=5: 7183.307320620916/7183.307320620916
.Y.Y.E.Y.E
*E*E*E
iteration=6: 1e-10/7183.307320620916
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=7: 12171.738389670056/12171.738389670056
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=8: 2274.3102193473683/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=9: 1364.9755421763791/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=10: 1564.9385209804811/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=11: 1e-10/12171.738389670056
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=12: 948.9702761492315/12171.738389670056
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=13: 1358.8620830502791/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=14: 261.28551005133545/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=15: 7239.9293177033205/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=16: 1759.232232350693/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=17: 1e-10/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=18: 2930.4529620185153/12171.738389670056
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=19: 5072.768681279555/12171.738389670056
.Y.Y.E.E.Y
*Y*E*E
iteration=20: 1522.7716501573138/12171.738389670056
Best record value:12171.738389670056 (larger is better)
Round 1, Match 1, Mapping 1: 12171.738389670056/12171.738389670056(0.0821575331300813 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 2, 1, 1], [16, 1, 2, 1]], "reduce_factors": [[8, 4, 4]], "last_factors": [[125, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 36 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 1808.5894810637185/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 3090.4979419188217/12171.738389670056
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=3: 2201.116027401164/12171.738389670056
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=4: 15668.632007767355/15668.632007767355
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=5: 14899.607565222412/15668.632007767355
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=6: 1366.9346193592792/15668.632007767355
.E.Y.Y.Y.Y
*E*E*E*E
iteration=7: 1e-10/15668.632007767355
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=8: 5636.752163532029/15668.632007767355
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=9: 14259.050721771047/15668.632007767355
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=10: 13649.613884691997/15668.632007767355
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=11: 6081.207735868996/15668.632007767355
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=12: 4904.026162088271/15668.632007767355
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=13: 16243.36604546209/16243.36604546209
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=14: 827.891884254259/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=15: 6964.652721708068/16243.36604546209
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=16: 430.89216287691204/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=17: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=18: 1943.5961362716519/16243.36604546209
.Y.E.Y.Y.Y
*E*E*E*E
iteration=19: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=20: 1e-10/16243.36604546209
Best record value:16243.36604546209 (larger is better)
Round 2, Match 1, Mapping 1: 16243.36604546209/16243.36604546209(0.06156359446688515 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 1, 2], [16, 1, 2, 1]], "reduce_factors": [[8, 4, 4]], "last_factors": [[125, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 68 schedules
Tensorize use time 515.7344660758972 s.
#############################################
operations:inputs:[128, 2048, 7, 7],[2048],[2048],body:S[128, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 2048, 7, 7],[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 2048, 7, 7],body:R[128, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[128, 2048, 7, 7] [2048] [2048] [128, 2048, 7, 7] [128, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.B.B.N.N.N.N.N.N.N.E.Y.Y.Y.E.Y.Y.E.E.Y.N.N.N.N

Currently best performance: 1.408197580239373
.N.N.E.E.E.E.Y.Y.Y.Y.Y.E.N.N.N.N.N.E.Y.E.E.Y.Y.Y.Y.Y.Y.N

Currently best performance: 1.408197580239373
.N.N.N.N.B.N.Y.E.E.Y.Y.Y.E.Y.E.Y.N.N.N.N.N

Currently best performance: 1.3089946554524805
.N.E.Y.Y.E.Y.Y.Y.E.Y.E.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 1.3089946554524805
.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.E.Y.E.E.N.N.N.N.B.N

Currently best performance: 1.0818812798858097
.T.Y.E.Y.Y.Y.E.Y.Y.E.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N

Currently best performance: 1.0818812798858097
.N.N.N.E.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.E.N

Currently best performance: 1.0818812798858097
.N.B.N.N.N.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.6879050825175824
.N.N.Y.Y.Y.E.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.E.N.N.N.N

Currently best performance: 0.6879050825175824
.N.N.N.N.Y.E.Y.Y.Y.Y.T.Y.E.Y.N.N.N.B.N.N.N

Currently best performance: 0.3997347524961662
.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.3997347524961662
.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N.N.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.08633629431204665
.B.N.N.N.N.N.NSchedule cost 1454.575813 seconds
#############################################
operations:inputs:[128, 512, 7, 7],[512],[512],body:S[128, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 7, 7],body:S[128, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 512, 7, 7],body:S[128, 512, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[128, 512, 7, 7],[2048, 512, 1, 1],body:R[128, 2048, 7, 7] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 7, 7] [512] [512] [2048, 512, 1, 1] [128, 2048, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph2/at:resnet50:subgraph2:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 132.54223072981347/132.54223072981347
Best record value:132.54223072981347 (larger is better)
Round 1, Match 1, Mapping 3: 132.54223072981347/132.54223072981347(7.5447651250000005 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 32, 1, 1], [4, 2, 16, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[448, 448, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:132.54223072981347 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/132.54223072981347(7.5447651250000005 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:132.54223072981347 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/132.54223072981347(7.5447651250000005 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 1815.836465767893/1815.836465767893
Best record value:1815.836465767893 (larger is better)
Round 1, Match 1, Mapping 6: 1815.836465767893/1815.836465767893(0.550710385462555 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 4, 4, 1], [8, 2, 1, 4], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[3584, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 472.87226188422466/472.87226188422466
Best record value:1815.836465767893 (larger is better)
Round 1, Match 1, Mapping 7: 472.87226188422466/1815.836465767893(0.550710385462555 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[392, 1, 2, 1], [2, 32, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[1024, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 1354.0075321398726/1354.0075321398726
Best record value:1815.836465767893 (larger is better)
Round 1, Match 1, Mapping 8: 1354.0075321398726/1815.836465767893(0.550710385462555 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 2, 1, 4], [32, 1, 1, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[196, 64, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1815.836465767893 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1815.836465767893(0.550710385462555 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1815.836465767893 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/1815.836465767893(0.550710385462555 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 2519.2247539280243/2519.2247539280243
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 11: 2519.2247539280243/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 1, 1, 4], [8, 1, 8, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[784, 32, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 687.0154670731139/687.0154670731139
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 12: 687.0154670731139/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 56, 1, 2], [8, 4, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[28672, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 982.5078162540641/982.5078162540641
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 13: 982.5078162540641/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 2, 14], [2, 4, 8, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[28, 3584, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 1186.751698611292/1186.751698611292
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 14: 1186.751698611292/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[16, 1, 1, 1], [16, 2, 2, 1], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 1197.0179544999487/1197.0179544999487
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 15: 1197.0179544999487/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 7, 2, 1], [8, 2, 4, 1], [7, 1, 1, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 224, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 2117.130846903677/2117.130846903677
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 17: 2117.130846903677/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 1, 1, 7], [1, 2, 32, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 16, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 261.084385904173/261.084385904173
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 18: 261.084385904173/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 8], [32, 2, 1, 1], [1, 1, 7, 1], [1, 7, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[8, 1568, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 664.0289729418247/664.0289729418247
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 19: 664.0289729418247/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 8, 2, 2], [7, 1, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[3584, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2519.2247539280243 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 95.29654192325663/95.29654192325663
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 2: 95.29654192325663/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 7, 1, 1], [4, 2, 2, 4], [8, 8, 1, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[32, 1792, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=1: 132.6605708077518/132.6605708077518
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 3: 132.6605708077518/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 32, 1, 1], [4, 2, 16, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[448, 448, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 11.184656798058738/11.184656798058738
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 4: 11.184656798058738/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 32, 1, 2], [2, 8, 4, 2]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 41.29380322945832/41.29380322945832
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 5: 41.29380322945832/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[16, 7, 1, 1], [1, 4, 1, 16], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[196, 2048, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1947.6261369958515/1947.6261369958515
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 6: 1947.6261369958515/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 7, 4], [8, 8, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[1024, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 1296.018651869097/1296.018651869097
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 7: 1296.018651869097/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[392, 1, 2, 1], [2, 32, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[1024, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1354.0075321398726
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 8: 1354.0075321398726/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 2, 1, 4], [32, 1, 1, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[196, 64, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 611.915259011974/611.915259011974
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 9: 611.915259011974/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 8, 1], [16, 2, 2, 1], [1, 7, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[256, 392, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1853.890872567677/2519.2247539280243
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 11: 2519.2247539280243/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 1, 1, 4], [8, 1, 8, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[784, 32, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 231.79544761042447/687.0154670731139
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 12: 687.0154670731139/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 56, 1, 2], [8, 4, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[28672, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 1435.0882511217676/1435.0882511217676
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 13: 1435.0882511217676/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 2, 1, 1], [64, 1, 1, 1], [1, 1, 1, 7]], "reduce_factors": [[2, 4, 4]], "last_factors": [[98, 512, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 141.28453726916095/1186.751698611292
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 14: 1186.751698611292/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[16, 1, 1, 1], [16, 2, 2, 1], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 775.3097030059288/1197.0179544999487
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 15: 1197.0179544999487/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 7, 2, 1], [8, 2, 4, 1], [7, 1, 1, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 224, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 244.7995682421055/244.7995682421055
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 16: 244.7995682421055/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 1, 1], [2, 8, 2, 2], [7, 1, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 896, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 2117.1875335183877/2117.1875335183877
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 17: 2117.1875335183877/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 1, 1, 7], [1, 2, 32, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 16, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 2410.606596794276/2410.606596794276
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 18: 2410.606596794276/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 4], [8, 2, 2, 2], [7, 1, 1, 1], [1, 1, 1, 7]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[3136, 4, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/664.0289729418247
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 19: 664.0289729418247/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 8, 2, 2], [7, 1, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[3584, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2519.2247539280243 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/2519.2247539280243(0.39694751269841266 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 5 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 8 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
mapping (1,0,1,0,0,0,0): explored 3 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 568.2526454925537 s.
#############################################
operations:inputs:[128, 512, 7, 7],[512],[512],body:S[128, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 7, 7],body:S[128, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 512, 7, 7],body:S[128, 512, 9, 9] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 8)) && (v3 >= 1)) && (v3 < 8)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 512, 9, 9],[512, 512, 3, 3],body:R[128, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 7, 7] [512] [512] [512, 512, 3, 3] [128, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph3/at:resnet50:subgraph3:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 150.72075493976348/150.72075493976348
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 4: 150.72075493976348/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 2, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[1, 3584, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*T
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 33.40792789662602/33.40792789662602
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 7: 33.40792789662602/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 2, 1, 4], [2, 8, 1, 1]], "reduce_factors": [[12, 8, 1], [1, 1, 3]], "last_factors": [[1792, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 11.414266231344802/11.414266231344802
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 8: 11.414266231344802/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 392, 1, 2], [2, 4, 2, 1]], "reduce_factors": [[24, 12, 1]], "last_factors": [[7168, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 13.096548523566373/13.096548523566373
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 9: 13.096548523566373/150.72075493976348(6.6347863 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 14, 2, 1], [1, 8, 1, 2], [7, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [1, 3, 1]], "last_factors": [[1792, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*T*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 143.68809150082956/143.68809150082956
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 15: 143.68809150082956/150.72075493976348(6.6347863 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 1, 1], [2, 8, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[64, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.E
*T*E
iteration=1: 1e-10/1e-10
Best record value:150.72075493976348 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/150.72075493976348(6.6347863 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 434.7963016479652/434.7963016479652
Best record value:434.7963016479652 (larger is better)
Round 1, Match 1, Mapping 17: 434.7963016479652/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[196, 4, 1, 1], [8, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[112, 56, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*Y*E
iteration=1: 10.923332503538921/10.923332503538921
Best record value:434.7963016479652 (larger is better)
Round 1, Match 1, Mapping 19: 10.923332503538921/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 4], [1, 4, 2, 2], [1, 7, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[12, 8, 1], [3, 1, 1]], "last_factors": [[224, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 22.602777287508466/22.602777287508466
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 3: 22.602777287508466/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 8, 1, 2], [2, 64, 1, 1]], "reduce_factors": [[8, 6, 2], [3, 1, 1]], "last_factors": [[392, 32, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/150.72075493976348
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 4: 150.72075493976348/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 2, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[1, 3584, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 6: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/33.40792789662602
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 7: 33.40792789662602/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 2, 1, 4], [2, 8, 1, 1]], "reduce_factors": [[12, 8, 1], [1, 1, 3]], "last_factors": [[1792, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/11.414266231344802
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 8: 11.414266231344802/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 392, 1, 2], [2, 4, 2, 1]], "reduce_factors": [[24, 12, 1]], "last_factors": [[7168, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 58.11676954831867/58.11676954831867
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 9: 58.11676954831867/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 14, 2, 1], [2, 2, 4, 1], [7, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [1, 3, 1]], "last_factors": [[1792, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 14: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/143.68809150082956
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 15: 143.68809150082956/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 1, 1], [2, 8, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[64, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/434.7963016479652
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 17: 434.7963016479652/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[196, 4, 1, 1], [8, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[112, 56, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 86.36811738496736/86.36811738496736
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 19: 86.36811738496736/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 2, 1, 2], [8, 1, 1, 2], [1, 7, 1, 1], [1, 1, 1, 7]], "reduce_factors": [[12, 1, 8], [3, 1, 1]], "last_factors": [[1, 3136, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.T.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:434.7963016479652 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/434.7963016479652(2.2999275665634675 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 2 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 1579.5573253631592 s.
#############################################
operations:inputs:[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[128, 2048, 7, 7],[512, 2048, 1, 1],body:R[128, 512, 7, 7] [2048, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 2048, 7, 7] [512, 2048, 1, 1] [128, 512, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph4/at:resnet50:subgraph4:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.E
*Y*E
iteration=1: 79.69552795342918/79.69552795342918
Best record value:79.69552795342918 (larger is better)
Round 1, Match 1, Mapping 1: 79.69552795342918/79.69552795342918(12.54775551 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [4, 1, 4, 1], [1, 32, 1, 4]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[2, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 57.82066203421823/57.82066203421823
Best record value:79.69552795342918 (larger is better)
Round 1, Match 1, Mapping 2: 57.82066203421823/79.69552795342918(12.54775551 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [8, 1, 1, 2], [2, 16, 1, 4]], "reduce_factors": [[32, 2, 2]], "last_factors": [[16, 392, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*Y*E*Y
iteration=1: 156.6058839348817/156.6058839348817
Best record value:156.6058839348817 (larger is better)
Round 1, Match 1, Mapping 3: 156.6058839348817/156.6058839348817(6.38545612 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 4], [1, 16, 1, 8]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[8, 896, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 577.7421127058169/577.7421127058169
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 4: 577.7421127058169/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 8, 1, 1], [8, 2, 4, 2]], "reduce_factors": [[8, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 896, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 387.1137992086867/387.1137992086867
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 7: 387.1137992086867/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 1, 14], [2, 2, 4, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[32, 3136, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 43.09997668420561/43.09997668420561
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 10: 43.09997668420561/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 56, 1, 1], [1, 2, 2, 4], [1, 1, 1, 7]], "reduce_factors": [[64, 1, 2], [1, 1, 1]], "last_factors": [[392, 32, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 197.1201133847508/197.1201133847508
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 14: 197.1201133847508/577.7421127058169(1.7308760743034055 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 4, 4, 1], [1, 4, 2, 2], [7, 1, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 7168, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/577.7421127058169(1.7308760743034055 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 177.3786559355134/177.3786559355134
Best record value:577.7421127058169 (larger is better)
Round 1, Match 1, Mapping 16: 177.3786559355134/577.7421127058169(1.7308760743034055 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 1, 2], [2, 8, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[16, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 49, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 745.3367561248682/745.3367561248682
Best record value:745.3367561248682 (larger is better)
Round 1, Match 1, Mapping 17: 745.3367561248682/745.3367561248682(1.3416754128686328 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 4, 7, 1], [2, 2, 1, 4]], "reduce_factors": [[32, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 512, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:745.3367561248682 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/745.3367561248682(1.3416754128686328 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 47.3319528753128/47.3319528753128
Best record value:745.3367561248682 (larger is better)
Round 1, Match 1, Mapping 19: 47.3319528753128/745.3367561248682(1.3416754128686328 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [4, 2, 2, 1], [1, 7, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 4], [1, 1, 1]], "last_factors": [[112, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 102.26649955086624/102.26649955086624
Best record value:745.3367561248682 (larger is better)
Round 1, Match 1, Mapping 20: 102.26649955086624/745.3367561248682(1.3416754128686328 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[8, 2, 1, 1], [1, 8, 2, 1], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[64, 2, 1]], "last_factors": [[224, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 140.85471976438677/140.85471976438677
Best record value:745.3367561248682 (larger is better)
Round 2, Match 1, Mapping 1: 140.85471976438677/745.3367561248682(1.3416754128686328 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1], [1, 32, 1, 4]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[2, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 284.71542306963005/284.71542306963005
Best record value:745.3367561248682 (larger is better)
Round 2, Match 1, Mapping 2: 284.71542306963005/745.3367561248682(1.3416754128686328 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 8], [1, 8, 4, 4]], "reduce_factors": [[32, 1, 4]], "last_factors": [[3584, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 506.1675322826208/506.1675322826208
Best record value:745.3367561248682 (larger is better)
Round 2, Match 1, Mapping 3: 506.1675322826208/745.3367561248682(1.3416754128686328 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [4, 2, 1, 2], [8, 4, 2, 2]], "reduce_factors": [[16, 4, 2], [1, 1, 1]], "last_factors": [[32, 224, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 57.04754679586874/577.7421127058169
Best record value:745.3367561248682 (larger is better)
Round 2, Match 1, Mapping 4: 577.7421127058169/745.3367561248682(1.3416754128686328 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 8, 1, 1], [8, 2, 4, 2]], "reduce_factors": [[8, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 896, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 1038.1644961022853/1038.1644961022853
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 5: 1038.1644961022853/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 7, 4], [2, 2, 2, 2], [7, 1, 1, 1]], "reduce_factors": [[64, 1, 2], [1, 1, 1]], "last_factors": [[112, 32, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 936.6951443227624/936.6951443227624
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 6: 936.6951443227624/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 4, 2, 7], [2, 4, 1, 2], [7, 1, 1, 1]], "reduce_factors": [[32, 4, 1]], "last_factors": [[3584, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/387.1137992086867
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 7: 387.1137992086867/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 1, 14], [2, 2, 4, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[32, 3136, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 8: 1e-10/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 701.4785292790762/701.4785292790762
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 9: 701.4785292790762/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 2, 2, 1], [2, 2, 2, 2], [1, 1, 1, 7]], "reduce_factors": [[64, 2, 1], [1, 1, 1]], "last_factors": [[7168, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 801.7768141988925/801.7768141988925
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 10: 801.7768141988925/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 2, 1, 1], [2, 2, 2, 2], [1, 1, 1, 7]], "reduce_factors": [[16, 1, 8], [1, 1, 1]], "last_factors": [[49, 1024, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 309.98211889845885/309.98211889845885
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 11: 309.98211889845885/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[8, 2, 7, 1], [2, 2, 1, 4], [1, 1, 1, 7]], "reduce_factors": [[128, 1, 1], [1, 1, 1]], "last_factors": [[1, 3136, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 232.77737440885795/232.77737440885795
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 14: 232.77737440885795/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 4, 4, 1], [2, 2, 2, 2], [7, 1, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 7168, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 71.03383796389818/71.03383796389818
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 15: 71.03383796389818/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 7, 1, 8], [2, 2, 4, 1], [1, 7, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 407.4792757995724/407.4792757995724
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 16: 407.4792757995724/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 2, 1, 2], [2, 8, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[16, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 49, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/745.3367561248682
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 17: 745.3367561248682/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 4, 7, 1], [2, 2, 1, 4]], "reduce_factors": [[32, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 512, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.T
*Y*E*Y
iteration=1: 176.22329890017306/176.22329890017306
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 18: 176.22329890017306/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 4], [8, 1, 1, 2], [1, 7, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[3136, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/47.3319528753128
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 19: 47.3319528753128/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [4, 2, 2, 1], [1, 7, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 4], [1, 1, 1]], "last_factors": [[112, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 139.26947571105492/139.26947571105492
Best record value:1038.1644961022853 (larger is better)
Round 2, Match 1, Mapping 20: 139.26947571105492/1038.1644961022853(0.9632384884615384 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 2, 4], [1, 8, 2, 1], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[64, 2, 1]], "last_factors": [[224, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 5 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 6 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 5 schedules
Tensorize use time 748.9313986301422 s.
#############################################
operations:inputs:[128, 2048, 7, 7],[2048],[2048],body:S[128, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 2048, 7, 7],[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 2048, 7, 7] [2048] [2048] [128, 2048, 7, 7] [128, 2048, 7, 7] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph5.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.B.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 1.3254987090947092
.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 1.2123143511895884
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 1.2123143511895884
.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N

Currently best performance: 0.6758988714450292
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.6758988714450292
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.6682990201267022
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.6682990201267022
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.6682990201267022
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.6682990201267022
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.B.N.N

Currently best performance: 0.620518777707362
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.620518777707362
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.620518777707362
.N.N.N.N.N.N.N.NSchedule cost 816.111442 seconds
#############################################
operations:inputs:[128, 2048, 7, 7],[2048],[2048],body:S[128, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 2048, 7, 7],[2048],[2048],body:S[128, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 2048, 7, 7],[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 2048, 7, 7] [2048] [2048] [128, 2048, 7, 7] [2048] [2048] [128, 2048, 7, 7] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph9.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.B.B.N.N.N.N.B.N.B.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.B.N.B

Currently best performance: 0.8638162729842834
.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.8638162729842834
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.8638162729842834
.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.783492510272144
.N.N.N.N.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.N

Currently best performance: 0.6451684684870969
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.6451684684870969
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N

Currently best performance: 0.6451684684870969
.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.E.Y.B.N.N.N.N.N.N

Currently best performance: 0.6434112176298805
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.6434112176298805
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.6434112176298805
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.6434112176298805
.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.6434112176298805
.N.N.N.N.N.N.N.BSchedule cost 825.526522 seconds
#############################################
operations:inputs:[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[128, 1024, 14, 14],[2048, 1024, 1, 1],body:R[128, 2048, 7, 7] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 1024, 14, 14] [2048, 1024, 1, 1] [128, 2048, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph10/at:resnet50:subgraph10:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 419.52190504403524/419.52190504403524
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 2: 419.52190504403524/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 4]], "last_factors": [[896, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 100.25914346757938/100.25914346757938
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 9: 100.25914346757938/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 14, 2, 2], [2, 8, 2, 2], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[128, 784, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 394.81111438769244/394.81111438769244
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 10: 394.81111438769244/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 16, 7, 1], [16, 2, 1, 2], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[224, 448, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 117.14470998893862/117.14470998893862
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 13: 117.14470998893862/419.52190504403524(2.383665758513932 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 4, 7, 2], [16, 2, 1, 2], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 2]], "last_factors": [[4096, 49, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 230.9061774042163/230.9061774042163
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 17: 230.9061774042163/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[196, 1, 2, 2], [16, 1, 2, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 3136, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 74.51898767521632/74.51898767521632
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 18: 74.51898767521632/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 4, 2, 1], [8, 8, 1, 1], [1, 1, 1, 7], [1, 1, 7, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[112, 512, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 21.238776420370176/21.238776420370176
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 19: 21.238776420370176/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 1, 1, 1], [1, 32, 1, 2], [1, 7, 1, 1], [1, 7, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[2, 6272, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:419.52190504403524 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/419.52190504403524(2.383665758513932 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.04604415800015517, 0.1251609979961978, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800100908, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.04604415800015517, 0.1251609979961978, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800100908, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517, 0.04604415800015517]
Original trials for each mapping [5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 1531.9219577677834/1531.9219577677834
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 1: 1531.9219577677834/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 8, 2, 1], [16, 1, 2, 4]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[14336, 2, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/419.52190504403524
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 2: 419.52190504403524/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 4]], "last_factors": [[896, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 193.4511006630579/193.4511006630579
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 3: 193.4511006630579/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 8, 2, 2], [64, 1, 1, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[28672, 7, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 288.54411368305676/288.54411368305676
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 4: 288.54411368305676/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [4, 2, 4, 2], [2, 1, 2, 32]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 256, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 253.7863350892366/253.7863350892366
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 6: 253.7863350892366/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 4, 1], [4, 2, 4, 2], [7, 1, 1, 1]], "reduce_factors": [[16, 1, 4]], "last_factors": [[7, 8192, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 322.2577475761541/322.2577475761541
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 8: 322.2577475761541/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 2, 4], [4, 16, 1, 1]], "reduce_factors": [[4, 2, 8]], "last_factors": [[8, 1568, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 520.996226984036/520.996226984036
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 9: 520.996226984036/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 4, 7, 1], [32, 1, 1, 2], [1, 7, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[448, 112, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/394.81111438769244
Best record value:1531.9219577677834 (larger is better)
Round 2, Match 1, Mapping 10: 394.81111438769244/1531.9219577677834(0.652774767624021 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 16, 7, 1], [16, 2, 1, 2], [7, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[224, 448, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 2002.6639165757554/2002.6639165757554
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 11: 2002.6639165757554/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 2, 4], [8, 1, 4, 2], [7, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[25088, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 55.35218518480725/117.14470998893862
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 13: 117.14470998893862/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 4, 7, 2], [16, 2, 1, 2], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 2]], "last_factors": [[4096, 49, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 116.61697293837663/116.61697293837663
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 14: 116.61697293837663/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[8, 2, 1, 1], [4, 4, 2, 2], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2048, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 346.0707211645596/346.0707211645596
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 15: 346.0707211645596/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 7, 4], [8, 2, 1, 4], [1, 7, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 1792, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 446.4394874515874/446.4394874515874
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 17: 446.4394874515874/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 1, 2, 2], [1, 4, 2, 8]], "reduce_factors": [[64, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 1568, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 282.38649321004783/282.38649321004783
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 18: 282.38649321004783/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[8, 1, 1, 2], [8, 8, 1, 1], [1, 1, 1, 7], [1, 1, 7, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[112, 512, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 309.8536748400277/309.8536748400277
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 19: 309.8536748400277/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 2, 1, 1], [32, 1, 2, 1], [7, 1, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1]], "last_factors": [[56, 3584, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 1366.1714096239891/1366.1714096239891
Best record value:2002.6639165757554 (larger is better)
Round 2, Match 1, Mapping 20: 1366.1714096239891/2002.6639165757554(0.49933490673255093 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 1, 4], [4, 8, 2, 1], [7, 1, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[32, 2, 1]], "last_factors": [[1792, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.043584716051635865, 0.09699956942819912, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.04358471605228251, 0.11847554164170904, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865, 0.043584716051635865]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 4 schedules
mapping (1,1,0,0,0,0,0): explored 4 schedules
mapping (1,1,1,0,0,0,0): explored 3 schedules
Tensorize use time 887.2704434394836 s.
#############################################
operations:inputs:[128, 512, 14, 14],[512],[512],body:S[128, 512, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 14, 14],body:S[128, 512, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 512, 14, 14],body:S[128, 512, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 512, 16, 16],[512, 512, 3, 3],body:R[128, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 14, 14] [512] [512] [512, 512, 3, 3] [128, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph12/at:resnet50:subgraph12:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 108.67375081035367/108.67375081035367
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 4: 108.67375081035367/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1], [2, 16, 2, 2]], "reduce_factors": [[32, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[7, 14336, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 16.096766074978255/16.096766074978255
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 6: 16.096766074978255/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 8, 1, 1], [4, 2, 1, 2], [1, 7, 1, 1]], "reduce_factors": [[18, 4, 4]], "last_factors": [[32, 224, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/108.67375081035367(9.201854105 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 106.57266707340267/106.57266707340267
Best record value:108.67375081035367 (larger is better)
Round 1, Match 1, Mapping 10: 106.57266707340267/108.67375081035367(9.201854105 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 1, 2, 2], [1, 16, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 2, 3], [3, 1, 1]], "last_factors": [[56, 56, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*T*E*E
iteration=1: 283.2363022881015/283.2363022881015
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 11: 283.2363022881015/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 8, 1, 1], [4, 2, 2, 1], [1, 1, 1, 7]], "reduce_factors": [[8, 3, 4], [3, 1, 1]], "last_factors": [[1792, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 6.920152513415632/6.920152513415632
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 16: 6.920152513415632/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 16, 1, 7], [1, 16, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 3584, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 30.694128898802454/30.694128898802454
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 19: 30.694128898802454/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 4, 1], [1, 8, 1, 2], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[96, 1, 1], [1, 3, 1]], "last_factors": [[14, 3584, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/108.67375081035367
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 4: 108.67375081035367/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1], [2, 16, 2, 2]], "reduce_factors": [[32, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[7, 14336, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/16.096766074978255
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 6: 16.096766074978255/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 8, 1, 1], [4, 2, 1, 2], [1, 7, 1, 1]], "reduce_factors": [[18, 4, 4]], "last_factors": [[32, 224, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 8: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 117.57854663437178/117.57854663437178
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 10: 117.57854663437178/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 1, 2, 2], [1, 16, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 2, 3], [3, 1, 1]], "last_factors": [[56, 56, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/283.2363022881015
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 11: 283.2363022881015/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 8, 1, 1], [4, 2, 2, 1], [1, 1, 1, 7]], "reduce_factors": [[8, 3, 4], [3, 1, 1]], "last_factors": [[1792, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 14: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/6.920152513415632
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 16: 6.920152513415632/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 16, 1, 7], [1, 16, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 3584, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/30.694128898802454
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 19: 30.694128898802454/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 4, 1], [1, 8, 1, 2], [1, 7, 1, 1], [7, 1, 1, 1]], "reduce_factors": [[96, 1, 1], [1, 3, 1]], "last_factors": [[14, 3584, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:283.2363022881015 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/283.2363022881015(3.5306208700000004 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 739.6612343788147 s.
#############################################
operations:inputs:[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[128, 1024, 14, 14],[512, 1024, 1, 1],body:R[128, 512, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 1024, 14, 14] [512, 1024, 1, 1] [128, 512, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph13/at:resnet50:subgraph13:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 390.96726664288377/390.96726664288377
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 8: 390.96726664288377/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 2], [64, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[512, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 20.286843484374256/20.286843484374256
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 10: 20.286843484374256/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 56, 1, 2], [2, 2, 2, 2], [1, 2, 7, 1]], "reduce_factors": [[64, 1, 1]], "last_factors": [[128, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 317.4105348927901/317.4105348927901
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 11: 317.4105348927901/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 8, 7, 4], [2, 4, 1, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28672, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 366.6672827288128/366.6672827288128
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 12: 366.6672827288128/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[8, 28, 1, 14], [2, 1, 4, 2]], "reduce_factors": [[16, 1, 4]], "last_factors": [[128, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 331.2524139502085/331.2524139502085
Best record value:390.96726664288377 (larger is better)
Round 1, Match 1, Mapping 13: 331.2524139502085/390.96726664288377(2.5577588849999997 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 1, 28], [2, 8, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[56, 7168, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 901.3920525246064/901.3920525246064
Best record value:901.3920525246064 (larger is better)
Round 1, Match 1, Mapping 14: 901.3920525246064/901.3920525246064(1.109395181818182 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 1, 2, 1], [2, 4, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[56, 896, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:901.3920525246064 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/901.3920525246064(1.109395181818182 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:901.3920525246064 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/901.3920525246064(1.109395181818182 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 1952.7267830828944/1952.7267830828944
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 17: 1952.7267830828944/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 1, 1, 16], [8, 1, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[64, 1, 1]], "last_factors": [[7168, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 96.08946311836742/96.08946311836742
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 18: 96.08946311836742/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 4, 2, 1], [2, 7, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[2048, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 185.34144982216688/185.34144982216688
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 19: 185.34144982216688/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 8, 1, 7], [2, 4, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 32, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 423.7857217529462/423.7857217529462
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 21: 423.7857217529462/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[112, 7, 1, 4], [2, 4, 2, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 147.53133330391313/147.53133330391313
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 22: 147.53133330391313/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 1, 2], [2, 2, 2, 2], [2, 7, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[6272, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 503.2921123952631/503.2921123952631
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 1: 503.2921123952631/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [16, 1, 1, 1], [2, 8, 8, 1], [7, 2, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*Y*Y*E
iteration=1: 78.43889410071546/78.43889410071546
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 2: 78.43889410071546/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 4, 1, 1], [4, 32, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[16, 1792, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 4: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*Y*E
iteration=1: 456.36789029038/456.36789029038
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 5: 456.36789029038/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [1, 8, 1, 2], [64, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 256, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 220.04738874549807/220.04738874549807
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 6: 220.04738874549807/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [4, 1, 2, 2], [1, 8, 2, 8]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[4, 3136, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/390.96726664288377
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 8: 390.96726664288377/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 2], [64, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[512, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 21.932817116335386/21.932817116335386
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 10: 21.932817116335386/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 56, 1, 2], [2, 2, 2, 2], [1, 2, 7, 1]], "reduce_factors": [[64, 1, 1]], "last_factors": [[128, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/317.4105348927901
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 11: 317.4105348927901/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 8, 7, 4], [2, 4, 1, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28672, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/366.6672827288128
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 12: 366.6672827288128/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[8, 28, 1, 14], [2, 1, 4, 2]], "reduce_factors": [[16, 1, 4]], "last_factors": [[128, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/331.2524139502085
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 13: 331.2524139502085/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 1, 28], [2, 8, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[56, 7168, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 736.9421195873324/901.3920525246064
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 14: 901.3920525246064/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 1, 2, 1], [2, 4, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[56, 896, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 247.9700791169119/247.9700791169119
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 15: 247.9700791169119/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 4, 2], [2, 8, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[128, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1952.7267830828944
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 17: 1952.7267830828944/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 1, 1, 16], [8, 1, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[64, 1, 1]], "last_factors": [[7168, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/96.08946311836742
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 18: 96.08946311836742/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 4, 2, 1], [2, 7, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[2048, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/185.34144982216688
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 19: 185.34144982216688/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 8, 1, 7], [2, 4, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 32, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 5.452391244009591/423.7857217529462
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 21: 423.7857217529462/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[112, 7, 1, 4], [2, 4, 2, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/147.53133330391313
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 22: 147.53133330391313/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 1, 2], [2, 2, 2, 2], [2, 7, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[6272, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 145.66224784919004/145.66224784919004
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 23: 145.66224784919004/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 4, 2, 1], [1, 2, 2, 4], [7, 1, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[224, 112, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1952.7267830828944 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/1952.7267830828944(0.5121044114636643 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 1131.2808122634888 s.
#############################################
operations:inputs:[128, 1024, 14, 14],[1024],[1024],body:S[128, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 1024, 14, 14],[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 1024, 14, 14] [1024] [1024] [128, 1024, 14, 14] [128, 1024, 14, 14] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph14.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.B.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.B.N

Currently best performance: 1.747210479976161
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.747210479976161
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N

Currently best performance: 1.6497233344653253
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 1.6497233344653253
.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 1.5120513596166163
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 1.5120513596166163
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.5120513596166163
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 1.5120513596166163
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 1.5120513596166163
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 1.5120513596166163
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 1.5120513596166163
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.5120513596166163
.N.N.N.N.N.N.N.NSchedule cost 679.654650 seconds
#############################################
operations:inputs:[128, 256, 14, 14],[256],[256],body:S[128, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 14, 14],body:S[128, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 256, 14, 14],body:S[128, 256, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[128, 256, 14, 14],[1024, 256, 1, 1],body:R[128, 1024, 14, 14] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 14, 14] [256] [256] [1024, 256, 1, 1] [128, 1024, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph15/at:resnet50:subgraph15:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 1368.9327280257874/1368.9327280257874
Best record value:1368.9327280257874 (larger is better)
Round 1, Match 1, Mapping 2: 1368.9327280257874/1368.9327280257874(0.730496086131387 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 8], [8, 1, 4, 4], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1024, 196, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1368.9327280257874 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1368.9327280257874(0.730496086131387 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 303.1731021549499/303.1731021549499
Best record value:1368.9327280257874 (larger is better)
Round 1, Match 1, Mapping 4: 303.1731021549499/1368.9327280257874(0.730496086131387 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 8, 2, 1], [2, 8, 1, 8]], "reduce_factors": [[8, 1, 2]], "last_factors": [[16, 1568, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 19.743108819987036/19.743108819987036
Best record value:1368.9327280257874 (larger is better)
Round 1, Match 1, Mapping 5: 19.743108819987036/1368.9327280257874(0.730496086131387 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 4], [4, 8, 1, 4], [1, 14, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 28672, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 2612.4665909198075/2612.4665909198075
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 6: 2612.4665909198075/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 1, 5], [4, 2, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[12544, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 1745.0708933938145/1745.0708933938145
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 10: 1745.0708933938145/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 7, 4], [16, 2, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 1, 2]], "last_factors": [[14336, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 1089.3633564459526/1089.3633564459526
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 11: 1089.3633564459526/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 4, 8, 2], [1, 16, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[14336, 56, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 734.8821208340152/734.8821208340152
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 12: 734.8821208340152/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 7, 14, 1], [4, 2, 2, 2]], "reduce_factors": [[8, 1, 2]], "last_factors": [[1024, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 1849.2531088603687/1849.2531088603687
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 13: 1849.2531088603687/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 14, 4, 2], [16, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[784, 64, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 93.55437220906639/93.55437220906639
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 14: 93.55437220906639/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 56, 2, 2], [1, 4, 4, 2], [7, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[4, 6272, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 2148.28098422548/2148.28098422548
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 15: 2148.28098422548/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 16, 1, 7], [32, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[896, 32, 28]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 165.19912164618216/165.19912164618216
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 19: 165.19912164618216/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[112, 1, 2, 1], [16, 2, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 7168, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 471.824898061683/471.824898061683
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 20: 471.824898061683/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 7, 4, 2], [8, 4, 1, 1], [1, 1, 1, 14]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3584, 28, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 35.076926115772096/35.076926115772096
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 21: 35.076926115772096/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 16, 4, 1], [2, 16, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 401408, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 401.83873892672864/401.83873892672864
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 22: 401.83873892672864/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [2, 8, 2, 1], [7, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[50176, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 561.1588092720843/561.1588092720843
Best record value:2612.4665909198075 (larger is better)
Round 1, Match 1, Mapping 24: 561.1588092720843/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 1, 2, 1], [2, 8, 2, 1], [14, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[14336, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2612.4665909198075 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 454.8275910256315/1368.9327280257874
Best record value:2612.4665909198075 (larger is better)
Round 2, Match 1, Mapping 2: 1368.9327280257874/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 8], [8, 1, 4, 4], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1024, 196, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 140.24773330158368/140.24773330158368
Best record value:2612.4665909198075 (larger is better)
Round 2, Match 1, Mapping 3: 140.24773330158368/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 25, 1, 1], [8, 1, 2, 2], [1, 32, 1, 4]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[224, 3584, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/303.1731021549499
Best record value:2612.4665909198075 (larger is better)
Round 2, Match 1, Mapping 4: 303.1731021549499/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 8, 2, 1], [2, 8, 1, 8]], "reduce_factors": [[8, 1, 2]], "last_factors": [[16, 1568, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 165.1849271730587/165.1849271730587
Best record value:2612.4665909198075 (larger is better)
Round 2, Match 1, Mapping 5: 165.1849271730587/2612.4665909198075(0.38278001467108375 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [1, 1, 8, 4], [8, 8, 2, 1], [1, 7, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 3568.0825793666986/3568.0825793666986
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 6: 3568.0825793666986/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [4, 2, 1, 4], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[12544, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 8: 1e-10/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 423.47729155860344/423.47729155860344
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 9: 423.47729155860344/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 8, 1, 2], [8, 1, 4, 1], [1, 2, 1, 7]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[49, 16384, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1820.3827974081419/1820.3827974081419
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 10: 1820.3827974081419/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 7, 4], [16, 2, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14336, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 175.37505287908593/1089.3633564459526
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 11: 1089.3633564459526/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 4, 8, 2], [1, 16, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[14336, 56, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 734.8356881242802/734.8821208340152
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 12: 734.8821208340152/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 7, 14, 1], [4, 2, 2, 2]], "reduce_factors": [[8, 1, 2]], "last_factors": [[1024, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1849.2531088603687
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 13: 1849.2531088603687/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 14, 4, 2], [16, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[784, 64, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 280.50867504845195/280.50867504845195
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 14: 280.50867504845195/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 7, 1, 4], [1, 4, 4, 2], [7, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[4, 6272, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/2148.28098422548
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 15: 2148.28098422548/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 16, 1, 7], [32, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[896, 32, 28]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 478.6574844867813/478.6574844867813
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 16: 478.6574844867813/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 112, 1, 2], [8, 4, 1, 1]], "reduce_factors": [[1, 16, 1], [1, 1, 1]], "last_factors": [[112, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 765.9056480832126/765.9056480832126
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 17: 765.9056480832126/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 4, 2, 1], [2, 8, 2, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[392, 512, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 165.58921078989897/165.58921078989897
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 19: 165.58921078989897/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[112, 1, 2, 1], [16, 2, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 7168, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/471.824898061683
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 20: 471.824898061683/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 7, 4, 2], [8, 4, 1, 1], [1, 1, 1, 14]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3584, 28, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 31.979904718195634/35.076926115772096
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 21: 35.076926115772096/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 16, 4, 1], [2, 16, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 401408, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/401.83873892672864
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 22: 401.83873892672864/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [2, 8, 2, 1], [7, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[50176, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 23: 1e-10/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 1004.6341255633712/1004.6341255633712
Best record value:3568.0825793666986 (larger is better)
Round 2, Match 1, Mapping 24: 1004.6341255633712/3568.0825793666986(0.2802625717753121 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 1, 2, 1], [2, 8, 2, 1], [14, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[14336, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 7 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 5 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 4 schedules
Tensorize use time 904.6945650577545 s.
#############################################
operations:inputs:[128, 256, 14, 14],[256],[256],body:S[128, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 14, 14],body:S[128, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 256, 14, 14],body:S[128, 256, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 256, 16, 16],[256, 256, 3, 3],body:R[128, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 14, 14] [256] [256] [256, 256, 3, 3] [128, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph16/at:resnet50:subgraph16:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 29.43717731456541/29.43717731456541
Best record value:29.43717731456541 (larger is better)
Round 1, Match 1, Mapping 1: 29.43717731456541/29.43717731456541(33.970648385 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 8, 1, 1], [32, 2, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[1568, 128, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:29.43717731456541 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/29.43717731456541(33.970648385 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 8.369894383038899/8.369894383038899
Best record value:29.43717731456541 (larger is better)
Round 1, Match 1, Mapping 3: 8.369894383038899/29.43717731456541(33.970648385 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 25, 1, 1], [2, 2, 2, 1], [1, 32, 1, 4]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[49, 4096, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 8.20105575631914/8.20105575631914
Best record value:29.43717731456541 (larger is better)
Round 1, Match 1, Mapping 4: 8.20105575631914/29.43717731456541(33.970648385 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 5, 1, 5], [4, 1, 2, 1], [2, 32, 1, 2]], "reduce_factors": [[18, 1, 8]], "last_factors": [[32, 224, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 407.90848319846805/407.90848319846805
Best record value:407.90848319846805 (larger is better)
Round 1, Match 1, Mapping 5: 407.90848319846805/407.90848319846805(2.4515302848297216 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 2], [32, 2, 2, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[448, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 72.88534651981242/72.88534651981242
Best record value:407.90848319846805 (larger is better)
Round 1, Match 1, Mapping 6: 72.88534651981242/407.90848319846805(2.4515302848297216 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 5, 1, 1], [1, 4, 2, 1], [16, 2, 1, 4]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[448, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:407.90848319846805 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/407.90848319846805(2.4515302848297216 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.E.E.E

iteration=1: 1e-10/1e-10
Best record value:407.90848319846805 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/407.90848319846805(2.4515302848297216 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:407.90848319846805 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/407.90848319846805(2.4515302848297216 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 729.1219738201983/729.1219738201983
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 10: 729.1219738201983/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 16], [4, 1, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[12544, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 42.597183041342134/42.597183041342134
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 12: 42.597183041342134/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 392, 1, 2], [2, 1, 4, 1]], "reduce_factors": [[72, 2, 1]], "last_factors": [[1792, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 326.28303240885504/326.28303240885504
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 14: 326.28303240885504/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 2, 1], [1, 1, 2, 4], [1, 2, 1, 7]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[256, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*E*T*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 233.63774068552533/233.63774068552533
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 17: 233.63774068552533/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 1, 1], [2, 2, 2, 1], [2, 1, 7, 1]], "reduce_factors": [[16, 9, 1]], "last_factors": [[896, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 21.69868695737009/21.69868695737009
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 18: 21.69868695737009/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 8, 1, 2], [2, 4, 1, 1], [2, 1, 7, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[14, 3584, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.T.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 43.65119250836863/43.65119250836863
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 23: 43.65119250836863/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [1, 2, 4, 1], [2, 7, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[3584, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 55.12071842057981/55.12071842057981
Best record value:729.1219738201983 (larger is better)
Round 1, Match 1, Mapping 24: 55.12071842057981/729.1219738201983(1.3715126356164384 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 2, 1], [2, 4, 1, 1], [1, 7, 2, 1], [1, 14, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[14, 7168, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/29.43717731456541
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 1: 29.43717731456541/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 8, 1, 1], [32, 2, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[1568, 128, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/8.369894383038899
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 3: 8.369894383038899/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 25, 1, 1], [2, 2, 2, 1], [1, 32, 1, 4]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[49, 4096, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/8.20105575631914
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 4: 8.20105575631914/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 5, 1, 5], [4, 1, 2, 1], [2, 32, 1, 2]], "reduce_factors": [[18, 1, 8]], "last_factors": [[32, 224, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/407.90848319846805
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 5: 407.90848319846805/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 2], [32, 2, 2, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[448, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 271.7953219018631/271.7953219018631
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 6: 271.7953219018631/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 5, 1, 1], [1, 4, 2, 1], [16, 2, 1, 4]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[448, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 168.07760758978773/168.07760758978773
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 8: 168.07760758978773/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 1, 2], [16, 8, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[6, 1, 8], [3, 1, 1]], "last_factors": [[128, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 711.0859842975037/729.1219738201983
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 10: 729.1219738201983/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 16], [4, 1, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[12544, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 117.76667915020944/117.76667915020944
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 11: 117.76667915020944/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 49, 2, 8], [2, 1, 1, 4]], "reduce_factors": [[8, 2, 3], [3, 1, 1]], "last_factors": [[1568, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/42.597183041342134
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 12: 42.597183041342134/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 392, 1, 2], [2, 1, 4, 1]], "reduce_factors": [[72, 2, 1]], "last_factors": [[1792, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:729.1219738201983 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/729.1219738201983(1.3715126356164384 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 805.8292850659589/805.8292850659589
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 14: 805.8292850659589/805.8292850659589(1.2409576302729528 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[56, 2, 2, 1], [1, 1, 2, 4], [1, 2, 1, 7]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[256, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/805.8292850659589(1.2409576302729528 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/805.8292850659589(1.2409576302729528 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/233.63774068552533
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 17: 233.63774068552533/805.8292850659589(1.2409576302729528 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 1, 1], [2, 2, 2, 1], [2, 1, 7, 1]], "reduce_factors": [[16, 9, 1]], "last_factors": [[896, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/21.69868695737009
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 18: 21.69868695737009/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 8, 1, 2], [2, 4, 1, 1], [2, 1, 7, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[14, 3584, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 96.77153963573751/96.77153963573751
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 21: 96.77153963573751/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 112, 1, 2], [1, 2, 2, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[1024, 196, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/43.65119250836863
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 23: 43.65119250836863/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 4, 1], [1, 2, 4, 1], [2, 7, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[3584, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 53.48764420268543/55.12071842057981
Best record value:805.8292850659589 (larger is better)
Round 2, Match 1, Mapping 24: 55.12071842057981/805.8292850659589(1.2409576302729528 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 2, 1], [2, 4, 1, 1], [1, 7, 2, 1], [1, 14, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[14, 7168, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.08259930109279977, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.10088701417684796, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 5 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 4 schedules
Tensorize use time 1132.9433133602142 s.
#############################################
operations:inputs:[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[128, 1024, 14, 14],[256, 1024, 1, 1],body:R[128, 256, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 1024, 14, 14] [256, 1024, 1, 1] [128, 256, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph17/at:resnet50:subgraph17:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 1666.176534100347/1666.176534100347
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 1: 1666.176534100347/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [1, 2, 4, 1], [8, 2, 2, 4], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 95.61127263692791/95.61127263692791
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 2: 95.61127263692791/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [2, 1, 1, 4], [1, 8, 2, 8], [2, 7, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[14336, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 227.1953551200115/227.1953551200115
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 4: 227.1953551200115/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 1, 1, 4], [1, 32, 1, 4]], "reduce_factors": [[32, 1, 2]], "last_factors": [[14, 896, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1666.176534100347 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/1666.176534100347(0.6001764996288047 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 2058.193301454437/2058.193301454437
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 11: 2058.193301454437/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[392, 2, 2, 2], [4, 1, 2, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[1792, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*Y*E
iteration=1: 153.5864710223836/153.5864710223836
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 12: 153.5864710223836/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 4, 2, 14], [2, 4, 1, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[50176, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 713.5756907684524/713.5756907684524
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 14: 713.5756907684524/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 4, 7, 1], [1, 4, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[25088, 1, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 583.4186182677224/583.4186182677224
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 15: 583.4186182677224/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 28, 1, 2], [4, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[64, 112, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 918.4866627979343/918.4866627979343
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 16: 918.4866627979343/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[224, 1, 1, 14], [1, 2, 2, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[14, 1792, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 118.71244209886704/118.71244209886704
Best record value:2058.193301454437 (larger is better)
Round 1, Match 1, Mapping 24: 118.71244209886704/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 4, 1, 1], [14, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[16, 2, 2]], "last_factors": [[2, 25088, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 758.9299209543332/1666.176534100347
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 1: 1666.176534100347/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [1, 2, 4, 1], [8, 2, 2, 4], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 79.23577350013595/95.61127263692791
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 2: 95.61127263692791/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [2, 1, 1, 4], [1, 8, 2, 8], [2, 7, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[14336, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 768.7025285257721/768.7025285257721
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 3: 768.7025285257721/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1], [2, 16, 4, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[112, 112, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 597.216873592483/597.216873592483
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 4: 597.216873592483/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [1, 2, 4, 1], [8, 8, 1, 2]], "reduce_factors": [[16, 4, 1]], "last_factors": [[256, 49, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*E*E
iteration=1: 254.00514809505995/254.00514809505995
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 6: 254.00514809505995/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 5, 1, 1], [1, 2, 1, 4], [8, 4, 1, 4]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[56, 112, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 561.9932833451037/561.9932833451037
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 7: 561.9932833451037/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [1, 2, 2, 2], [32, 1, 2, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 53.719288096447784/53.719288096447784
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 8: 53.719288096447784/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [2, 32, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[1, 6272, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 477.0820766879425/2058.193301454437
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 11: 2058.193301454437/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[392, 2, 2, 2], [4, 1, 2, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[1792, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/153.5864710223836
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 12: 153.5864710223836/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 4, 2, 14], [2, 4, 1, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[50176, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/713.5756907684524
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 14: 713.5756907684524/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 4, 7, 1], [1, 4, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[25088, 1, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/583.4186182677224
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 15: 583.4186182677224/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 28, 1, 2], [4, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[64, 112, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 551.5148686846256/918.4866627979343
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 16: 918.4866627979343/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[224, 1, 1, 14], [1, 2, 2, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[14, 1792, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 37.848843493860734/37.848843493860734
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 18: 37.848843493860734/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 4, 1, 2], [8, 1, 1, 1], [1, 14, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 12544, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 280.81274813720125/280.81274813720125
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 19: 280.81274813720125/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 32, 1, 7], [1, 1, 2, 4], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3584, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 138.94446088388992/138.94446088388992
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 22: 138.94446088388992/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 2, 2], [2, 2, 2, 1], [2, 7, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[14, 1024, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 319.4046532345532/319.4046532345532
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 23: 319.4046532345532/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 8], [1, 2, 1, 4], [1, 7, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[28, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 204.98581777434177/204.98581777434177
Best record value:2058.193301454437 (larger is better)
Round 2, Match 1, Mapping 24: 204.98581777434177/2058.193301454437(0.485863013592233 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [2, 4, 1, 1], [14, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[16, 2, 2]], "last_factors": [[2, 25088, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 7 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 4 schedules
Tensorize use time 820.9110949039459 s.
#############################################
operations:inputs:[128, 1024, 14, 14],[1024],[1024],body:S[128, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 1024, 14, 14],[1024],[1024],body:S[128, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 1024, 14, 14],[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 1024, 14, 14],body:S[128, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 1024, 14, 14] [1024] [1024] [128, 1024, 14, 14] [1024] [1024] [128, 1024, 14, 14] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph34.log by 200 trials...
.Y.Y.Y.Y.E.Y.Y.E.Y.Y.B.N.B.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N

Currently best performance: 3.0482731900999998
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.9211878514931893
.N.N.N.N.N.N.N.B.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 1.7448404459204334
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 1.5186442031303031
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 1.5186442031303031
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B

Currently best performance: 1.5088594037144578
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.5088594037144578
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 1.5088594037144578
.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 1.5088594037144578
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 1.5088594037144578
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 1.5088594037144578
.N.N.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 1.4879925995065284
.N.N.N.N.N.N.N.NSchedule cost 676.518563 seconds
#############################################
operations:inputs:[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[128, 512, 28, 28],[1024, 512, 1, 1],body:R[128, 1024, 14, 14] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 28, 28] [1024, 512, 1, 1] [128, 1024, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph35/at:resnet50:subgraph35:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 46.511304685858924/46.511304685858924
Best record value:46.511304685858924 (larger is better)
Round 1, Match 1, Mapping 2: 46.511304685858924/46.511304685858924(21.50014941 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 4, 1], [2, 8, 1, 8], [1, 7, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[14, 28672, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 34.22461414011943/34.22461414011943
Best record value:46.511304685858924 (larger is better)
Round 1, Match 1, Mapping 3: 34.22461414011943/46.511304685858924(21.50014941 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 4, 2, 2], [8, 4, 4, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[8, 50176, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 532.1927470646955/532.1927470646955
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 4: 532.1927470646955/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [1, 16, 1, 2], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[2048, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 92.03148032129003/92.03148032129003
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 6: 92.03148032129003/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [16, 2, 1, 1], [2, 8, 4, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[12544, 64, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 103.87371158378603/103.87371158378603
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 10: 103.87371158378603/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 2, 1, 56], [4, 1, 1, 8], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[512, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 337.90227043546975/337.90227043546975
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 14: 337.90227043546975/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 8, 2], [2, 8, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[49, 2048, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 266.2014863131055/266.2014863131055
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 15: 266.2014863131055/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 28, 2, 4], [8, 4, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[224, 256, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 2.9534081628558178/2.9534081628558178
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 16: 2.9534081628558178/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 392, 1, 4], [1, 16, 1, 2]], "reduce_factors": [[2, 2, 8], [1, 1, 1]], "last_factors": [[4, 7168, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*E
iteration=1: 148.56206417818927/148.56206417818927
Best record value:532.1927470646955 (larger is better)
Round 1, Match 1, Mapping 17: 148.56206417818927/532.1927470646955(1.8790184674922599 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[8, 28, 1, 1], [16, 2, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[448, 112, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 1208.9484469692386/1208.9484469692386
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 18: 1208.9484469692386/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 1, 1, 2], [4, 2, 4, 1], [1, 7, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 123.89904086654988/123.89904086654988
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 19: 123.89904086654988/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[16, 7, 1, 2], [8, 2, 1, 2], [1, 7, 1, 2]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 4096, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 644.778180166606/644.778180166606
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 20: 644.778180166606/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 4, 2, 4], [2, 2, 4, 2], [2, 7, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 128, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 239.82025376052545/239.82025376052545
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 21: 239.82025376052545/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 7, 1, 14], [2, 1, 1, 16]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 3136, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 583.0157487408904/583.0157487408904
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 22: 583.0157487408904/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 8], [2, 1, 4, 4], [14, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[256, 3136, 1]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 200.65055847059907/200.65055847059907
Best record value:1208.9484469692386 (larger is better)
Round 1, Match 1, Mapping 24: 200.65055847059907/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 4, 1], [2, 4, 2, 2], [1, 7, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[12544, 64, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 192.2275258512118/192.2275258512118
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 1: 192.2275258512118/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 4, 1, 4], [8, 2, 2, 4], [1, 7, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 256, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 46.71743116348744/46.71743116348744
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 2: 46.71743116348744/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 4, 4, 1], [2, 8, 1, 8], [1, 7, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[14, 28672, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 182.02814251012038/182.02814251012038
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 3: 182.02814251012038/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 25, 1, 1], [16, 1, 1, 2], [8, 8, 2, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1]], "last_factors": [[896, 224, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/532.1927470646955
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 4: 532.1927470646955/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [1, 16, 1, 2], [32, 1, 2, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[2048, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/92.03148032129003
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 6: 92.03148032129003/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [16, 2, 1, 1], [2, 8, 4, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[12544, 64, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 52.29614247532815/52.29614247532815
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 7: 52.29614247532815/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [4, 4, 2, 1], [1, 64, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 12544, 32]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 616.039236076788/616.039236076788
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 8: 616.039236076788/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [4, 2, 4, 1], [8, 1, 2, 8], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[49, 1024, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 79.40016093983861/79.40016093983861
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 9: 79.40016093983861/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 14, 4, 1], [16, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[7, 14336, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 71.00413014126049/103.87371158378603
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 10: 103.87371158378603/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 2, 1, 56], [4, 1, 1, 8], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[512, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 99.68272240476728/99.68272240476728
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 13: 99.68272240476728/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 112, 2, 1], [8, 4, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[1, 4, 8], [1, 1, 1]], "last_factors": [[28, 3584, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 349.5086648257148/349.5086648257148
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 14: 349.5086648257148/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 8, 2], [2, 8, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[49, 2048, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 861.4725737543897/861.4725737543897
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 15: 861.4725737543897/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 4, 4, 1], [4, 4, 1, 2], [1, 2, 1, 7]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[6272, 8, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 215.07397206879062/215.07397206879062
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 16: 215.07397206879062/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[32, 14, 1, 7], [2, 2, 1, 8]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[56, 3584, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 19.19119039919439/148.56206417818927
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 17: 148.56206417818927/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[8, 28, 1, 1], [16, 2, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[448, 112, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1208.9484469692386
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 18: 1208.9484469692386/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 1, 1, 2], [4, 2, 4, 1], [1, 7, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 198.12359284947073/198.12359284947073
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 19: 198.12359284947073/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[16, 7, 1, 2], [8, 2, 1, 2], [1, 7, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 4096, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 695.0464504835597/695.0464504835597
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 20: 695.0464504835597/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 2, 8], [4, 4, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1792, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/239.82025376052545
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 21: 239.82025376052545/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 7, 1, 14], [2, 1, 1, 16]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 3136, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 761.3997246394898/761.3997246394898
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 22: 761.3997246394898/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 8], [2, 1, 4, 4], [14, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[256, 3136, 1]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 64.10313120981657/64.10313120981657
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 23: 64.10313120981657/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 2, 2], [8, 2, 1, 2], [7, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[14, 57344, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 302.59864926650397/302.59864926650397
Best record value:1208.9484469692386 (larger is better)
Round 2, Match 1, Mapping 24: 302.59864926650397/1208.9484469692386(0.8271651305785124 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 2, 4], [8, 1, 2, 2], [7, 1, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[16, 1568, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118515, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 4 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Tensorize use time 1153.022995710373 s.
#############################################
operations:inputs:[128, 256, 28, 28],[256],[256],body:S[128, 256, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 28, 28],body:S[128, 256, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 256, 28, 28],body:S[128, 256, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 256, 30, 30],[256, 256, 3, 3],body:R[128, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 28, 28] [256] [256] [256, 256, 3, 3] [128, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph37/at:resnet50:subgraph37:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 71.80906942744696/71.80906942744696
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 4: 71.80906942744696/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [32, 4, 1, 1]], "reduce_factors": [[12, 12, 1]], "last_factors": [[1568, 32, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*T
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:71.80906942744696 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/71.80906942744696(13.925817559999999 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 170.66714318753495/170.66714318753495
Best record value:170.66714318753495 (larger is better)
Round 1, Match 1, Mapping 18: 170.66714318753495/170.66714318753495(5.859358639999999 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 4, 1, 4], [4, 1, 2, 1], [14, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [1, 3, 1]], "last_factors": [[56, 224, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*E
iteration=1: 76.37570021098749/76.37570021098749
Best record value:170.66714318753495 (larger is better)
Round 1, Match 1, Mapping 19: 76.37570021098749/170.66714318753495(5.859358639999999 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 2, 4], [1, 2, 1, 4], [1, 14, 1, 1]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[112, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:170.66714318753495 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/170.66714318753495(5.859358639999999 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 10.572147191007886/10.572147191007886
Best record value:170.66714318753495 (larger is better)
Round 1, Match 1, Mapping 21: 10.572147191007886/170.66714318753495(5.859358639999999 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 448, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 8, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[112, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:170.66714318753495 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/170.66714318753495(5.859358639999999 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 361.3054305555688/361.3054305555688
Best record value:361.3054305555688 (larger is better)
Round 1, Match 1, Mapping 23: 361.3054305555688/361.3054305555688(2.7677414049999998 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 2, 1], [8, 1, 1, 1], [1, 2, 7, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 1, 3], [1, 1, 3]], "last_factors": [[128, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:361.3054305555688 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/361.3054305555688(2.7677414049999998 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 2 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:361.3054305555688 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/361.3054305555688(2.7677414049999998 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 78.11570410915523/78.11570410915523
Best record value:361.3054305555688 (larger is better)
Round 2, Match 1, Mapping 2: 78.11570410915523/361.3054305555688(2.7677414049999998 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [2, 16, 2, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 2, 3], [3, 1, 1]], "last_factors": [[784, 8, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 54.93286571943796/54.93286571943796
Best record value:361.3054305555688 (larger is better)
Round 2, Match 1, Mapping 3: 54.93286571943796/361.3054305555688(2.7677414049999998 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 25, 1, 1], [2, 1, 4, 1], [2, 8, 4, 2]], "reduce_factors": [[8, 2, 3], [3, 1, 1]], "last_factors": [[2048, 49, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 514.3470886098836/514.3470886098836
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 4: 514.3470886098836/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [32, 4, 1, 1]], "reduce_factors": [[12, 12, 1]], "last_factors": [[1568, 32, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 163.89049860543238/163.89049860543238
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 5: 163.89049860543238/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 1], [8, 16, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[7, 3584, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 6: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 8: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 14: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.E.E.E

iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 71.57088855568044/71.57088855568044
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 16: 71.57088855568044/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[392, 4, 1, 2], [4, 2, 1, 1]], "reduce_factors": [[3, 2, 8], [3, 1, 1]], "last_factors": [[512, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/514.3470886098836(1.9442124241486067 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 133.428403116456/170.66714318753495
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 18: 170.66714318753495/514.3470886098836(1.9442124241486067 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 4, 1, 4], [4, 1, 2, 1], [14, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [1, 3, 1]], "last_factors": [[56, 224, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 169.6518521749444/169.6518521749444
Best record value:514.3470886098836 (larger is better)
Round 2, Match 1, Mapping 19: 169.6518521749444/514.3470886098836(1.9442124241486067 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 2, 4], [2, 2, 2, 1], [1, 14, 1, 1]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[112, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 514.5826813394187/514.5826813394187
Best record value:514.5826813394187 (larger is better)
Round 2, Match 1, Mapping 20: 514.5826813394187/514.5826813394187(1.9433223003095978 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 4, 2], [1, 2, 2, 2], [1, 7, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[64, 224, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 5.445044724688046/10.572147191007886
Best record value:514.5826813394187 (larger is better)
Round 2, Match 1, Mapping 21: 10.572147191007886/514.5826813394187(1.9433223003095978 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 448, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 8, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[112, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:514.5826813394187 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/514.5826813394187(1.9433223003095978 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.T.Y.Y
*Y*Y*Y
iteration=1: 221.95396126617058/361.3054305555688
Best record value:514.5826813394187 (larger is better)
Round 2, Match 1, Mapping 23: 361.3054305555688/514.5826813394187(1.9433223003095978 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 2, 1], [8, 1, 1, 1], [1, 2, 7, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 1, 3], [1, 1, 3]], "last_factors": [[128, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:514.5826813394187 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/514.5826813394187(1.9433223003095978 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.05860984346726228, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.03769509283017005, 0.0659012352023005, 0.03769509283017005, 0.03769509283017005, 0.08389197189686642, 0.03769509283017005]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 5 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 1238.62881731987 s.
#############################################
operations:inputs:[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[128, 512, 28, 28],[256, 512, 1, 1],body:R[128, 256, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 28, 28] [256, 512, 1, 1] [128, 256, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph38/at:resnet50:subgraph38:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 519.9056685730325/519.9056685730325
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 6: 519.9056685730325/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [4, 1, 2, 1], [2, 4, 4, 4]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[112, 3584, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 376.3409965856576/376.3409965856576
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 9: 376.3409965856576/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 2, 2], [2, 2, 2, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[16, 12544, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:519.9056685730325 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/519.9056685730325(1.9234258452012385 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 1189.3738810357854/1189.3738810357854
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 12: 1189.3738810357854/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[448, 7, 1, 4], [4, 1, 2, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[7168, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 444.68086169387294/444.68086169387294
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 16: 444.68086169387294/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[6272, 1, 2, 1], [1, 2, 2, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[392, 64, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 620.416998360866/620.416998360866
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 17: 620.416998360866/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 4, 2, 1], [1, 4, 2, 1], [7, 2, 2, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[98, 256, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 436.909033020673/436.909033020673
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 20: 436.909033020673/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 32, 7, 1], [4, 2, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[512, 784, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 64.91845289313733/64.91845289313733
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 21: 64.91845289313733/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 98, 4, 8], [1, 4, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 7168, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 923.9637638777873/923.9637638777873
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 22: 923.9637638777873/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 1, 2], [4, 1, 2, 1], [14, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[224, 256, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 420.14813705288424/420.14813705288424
Best record value:1189.3738810357854 (larger is better)
Round 1, Match 1, Mapping 24: 420.14813705288424/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 2, 1], [4, 1, 1, 2], [14, 2, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[2, 4, 4]], "last_factors": [[98, 8192, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 3 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 17.297653411287637/17.297653411287637
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 4: 17.297653411287637/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 49, 1, 1], [1, 4, 1, 2], [1, 32, 4, 1]], "reduce_factors": [[2, 4, 4]], "last_factors": [[224, 3584, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 433.46334151471007/519.9056685730325
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 6: 519.9056685730325/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [4, 1, 2, 1], [2, 4, 4, 4]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[112, 3584, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 119.33311685271715/119.33311685271715
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 7: 119.33311685271715/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 2, 1, 1], [8, 1, 1, 1], [2, 4, 8, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28672, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 84.11304499861514/84.11304499861514
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 8: 84.11304499861514/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [4, 2, 1, 1], [1, 64, 2, 1], [7, 1, 4, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[224, 112, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 431.0023485358003/431.0023485358003
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 9: 431.0023485358003/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 16, 2, 2], [2, 2, 1, 2], [4, 1, 1, 7]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[3584, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 54.95528583776043/54.95528583776043
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 10: 54.95528583776043/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 112, 1, 2], [1, 1, 2, 4], [1, 7, 2, 2]], "reduce_factors": [[8, 4, 1]], "last_factors": [[256, 1568, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1189.3738810357854
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 12: 1189.3738810357854/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[448, 7, 1, 4], [4, 1, 2, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[7168, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 44.232113765389386/44.232113765389386
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 13: 44.232113765389386/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 8, 1, 8], [1, 8, 1, 1], [1, 2, 14, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[8, 50176, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 14: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 259.74874846429395/444.68086169387294
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 16: 444.68086169387294/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[6272, 1, 2, 1], [1, 2, 2, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[392, 64, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/620.416998360866
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 17: 620.416998360866/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 4, 2, 1], [1, 4, 2, 1], [7, 2, 2, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[98, 256, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 351.4237815023482/436.909033020673
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 20: 436.909033020673/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 32, 7, 1], [4, 2, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[512, 784, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 461.79137782455933/461.79137782455933
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 21: 461.79137782455933/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 49, 2, 4], [1, 2, 2, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[512, 392, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/923.9637638777873
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 22: 923.9637638777873/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 1, 2], [4, 1, 2, 1], [14, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[224, 256, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 23: 1e-10/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/420.14813705288424
Best record value:1189.3738810357854 (larger is better)
Round 2, Match 1, Mapping 24: 420.14813705288424/1189.3738810357854(0.8407785103950105 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 2, 1], [4, 1, 1, 2], [14, 2, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[2, 4, 4]], "last_factors": [[98, 8192, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 3 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Tensorize use time 952.6518404483795 s.
#############################################
operations:inputs:[128, 512, 28, 28],[512],[512],body:S[128, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 28, 28],[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 512, 28, 28] [512] [512] [128, 512, 28, 28] [128, 512, 28, 28] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph39.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.B.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.B

Currently best performance: 4.2348603550999995
.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 3.2976002001
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 3.2976002001
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 3.2687396701
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.B.N.N.N.N.N

Currently best performance: 3.233598680099999
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 2.9958766350999997
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 2.9958766350999997
.N.N.N.N.N.B.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 2.7447459101000002
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 2.7447459101000002
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 2.7447459101000002
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 2.7447459101000002
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N

Currently best performance: 2.6912198251
.N.N.N.N.N.N.N.NSchedule cost 770.449461 seconds
#############################################
operations:inputs:[128, 128, 28, 28],[128],[128],body:S[128, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 128, 28, 28],body:S[128, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 128, 28, 28],body:S[128, 128, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[128, 128, 28, 28],[512, 128, 1, 1],body:R[128, 512, 28, 28] [128, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 128, 28, 28] [128] [128] [512, 128, 1, 1] [128, 512, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph40/at:resnet50:subgraph40:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 664.8369103748614/664.8369103748614
Best record value:664.8369103748614 (larger is better)
Round 1, Match 1, Mapping 1: 664.8369103748614/664.8369103748614(1.5041282822822823 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 4, 1], [1, 2, 2, 4], [2, 4, 1, 16], [14, 2, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*E*Y
iteration=1: 326.84688957309675/326.84688957309675
Best record value:664.8369103748614 (larger is better)
Round 1, Match 1, Mapping 2: 326.84688957309675/664.8369103748614(1.5041282822822823 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 2, 4], [16, 4, 2, 1], [1, 28, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[56, 1024, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 993.5995336823476/993.5995336823476
Best record value:993.5995336823476 (larger is better)
Round 1, Match 1, Mapping 3: 993.5995336823476/993.5995336823476(1.0064416961770621 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 7, 1, 7], [16, 1, 1, 1], [8, 2, 8, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[25088, 4, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1499.9158007266105/1499.9158007266105
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 4: 1499.9158007266105/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 8, 1], [1, 64, 1, 2]], "reduce_factors": [[4, 2, 1]], "last_factors": [[448, 128, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 112.24829478157324/112.24829478157324
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 6: 112.24829478157324/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 1, 1, 1], [2, 4, 1, 2], [1, 4, 32, 1]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[14, 14336, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 333.85196066941467/333.85196066941467
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 7: 333.85196066941467/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 1, 2], [2, 2, 2, 2], [1, 16, 1, 8]], "reduce_factors": [[2, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 16, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 924.0730767083354/924.0730767083354
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 8: 924.0730767083354/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 4, 1, 1], [4, 1, 2, 2], [32, 4, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[448, 224, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 472.83615019101893/472.83615019101893
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 10: 472.83615019101893/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 1, 4], [4, 4, 1, 1], [1, 4, 1, 7]], "reduce_factors": [[2, 4, 1]], "last_factors": [[4096, 14, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 154.60057348680772/154.60057348680772
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 12: 154.60057348680772/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 112, 7, 2], [1, 2, 4, 2]], "reduce_factors": [[2, 2, 2]], "last_factors": [[3584, 224, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 227.25206902668882/227.25206902668882
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 13: 227.25206902668882/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 16, 4, 1], [1, 4, 2, 2], [2, 14, 1, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[8192, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 272.9954182578364/272.9954182578364
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 14: 272.9954182578364/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[16, 1, 28, 1], [4, 4, 1, 1], [1, 28, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[896, 896, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 32.58206378508325/32.58206378508325
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 15: 32.58206378508325/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 7, 1, 32], [1, 8, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[2, 114688, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 436.04399669886885/436.04399669886885
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 16: 436.04399669886885/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[32, 98, 1, 4], [2, 4, 1, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[14336, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 682.8119413626262/682.8119413626262
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 17: 682.8119413626262/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[56, 2, 4, 1], [4, 4, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 4]], "last_factors": [[56, 1024, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 1438.8537895236389/1438.8537895236389
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 19: 1438.8537895236389/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 4, 2, 2], [8, 2, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[2, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2048, 56, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 201.10552392258955/201.10552392258955
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 20: 201.10552392258955/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 7, 4, 2], [2, 4, 1, 2], [1, 14, 1, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14336, 16, 7]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1189.1428705754606/1189.1428705754606
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 21: 1189.1428705754606/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 28, 1, 4], [2, 4, 1, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 196, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 660.8188418290134/660.8188418290134
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 22: 660.8188418290134/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 2, 1, 1], [2, 2, 4, 1], [2, 7, 2, 1], [2, 7, 1, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 1]], "last_factors": [[224, 512, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 717.052168892862/717.052168892862
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 23: 717.052168892862/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 2, 1, 2], [2, 1, 1, 8], [7, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[256, 896, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 682.6589206463437/682.6589206463437
Best record value:1499.9158007266105 (larger is better)
Round 1, Match 1, Mapping 24: 682.6589206463437/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 1, 4], [8, 1, 2, 1], [7, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[2, 2, 2]], "last_factors": [[896, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/664.8369103748614
Best record value:1499.9158007266105 (larger is better)
Round 2, Match 1, Mapping 1: 664.8369103748614/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 4, 1], [1, 2, 2, 4], [2, 4, 1, 16], [14, 2, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 1263.5199129738662/1263.5199129738662
Best record value:1499.9158007266105 (larger is better)
Round 2, Match 1, Mapping 2: 1263.5199129738662/1499.9158007266105(0.6667040906666666 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [2, 1, 2, 4], [16, 8, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[4, 2, 1], [1, 1, 1]], "last_factors": [[25088, 64, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 1726.9081367001395/1726.9081367001395
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 3: 1726.9081367001395/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 7, 1, 7], [16, 1, 1, 1], [8, 2, 8, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[25088, 4, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1499.9158007266105
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 4: 1499.9158007266105/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 8, 1], [1, 64, 1, 2]], "reduce_factors": [[4, 2, 1]], "last_factors": [[448, 128, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1565.7847484390625/1565.7847484390625
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 6: 1565.7847484390625/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [1, 4, 2, 2], [2, 16, 2, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[28672, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*Y*E
iteration=1: 941.0250265545873/941.0250265545873
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 7: 941.0250265545873/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [4, 2, 1, 2], [1, 32, 4, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 256, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 319.45463777606454/924.0730767083354
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 8: 924.0730767083354/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 4, 1, 1], [4, 1, 2, 2], [32, 4, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[448, 224, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.E.Y
*Y*Y
iteration=1: 114.79231309805432/472.83615019101893
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 10: 472.83615019101893/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[56, 2, 1, 4], [4, 4, 1, 1], [1, 4, 1, 7]], "reduce_factors": [[2, 4, 1]], "last_factors": [[4096, 14, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 799.3675547792747/799.3675547792747
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 11: 799.3675547792747/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[3136, 1, 1, 4], [1, 8, 2, 1]], "reduce_factors": [[2, 2, 2], [1, 1, 1]], "last_factors": [[224, 512, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 71.72489882635499/154.60057348680772
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 12: 154.60057348680772/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 112, 7, 2], [1, 2, 4, 2]], "reduce_factors": [[2, 2, 2]], "last_factors": [[3584, 224, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 382.08109581469614/382.08109581469614
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 13: 382.08109581469614/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 28, 4, 2], [4, 4, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[2048, 112, 7]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 331.6384112177409/331.6384112177409
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 14: 331.6384112177409/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[32, 1, 2, 7], [4, 4, 1, 1], [1, 28, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[896, 896, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/32.58206378508325
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 15: 32.58206378508325/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 7, 1, 32], [1, 8, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[2, 114688, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 740.5270400290901/740.5270400290901
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 16: 740.5270400290901/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1568, 4, 1, 2], [4, 1, 1, 4]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[128, 6272, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 722.711323321427/722.711323321427
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 17: 722.711323321427/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 2, 4, 1], [4, 4, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 4]], "last_factors": [[56, 1024, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1726.9081367001395 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/1726.9081367001395(0.5790695977093772 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 2099.53858171318/2099.53858171318
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 19: 2099.53858171318/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[112, 1, 1, 4], [2, 1, 2, 4], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 14, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 92.06489125547994/201.10552392258955
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 20: 201.10552392258955/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 7, 4, 2], [2, 4, 1, 2], [1, 14, 1, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14336, 16, 7]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 172.4667121352158/1189.1428705754606
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 21: 1189.1428705754606/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 28, 1, 4], [2, 4, 1, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 196, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 659.781728369494/660.8188418290134
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 22: 660.8188418290134/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 2, 1, 1], [2, 2, 4, 1], [2, 7, 2, 1], [2, 7, 1, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 1]], "last_factors": [[224, 512, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/717.052168892862
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 23: 717.052168892862/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 2, 1, 2], [2, 1, 1, 8], [7, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[256, 896, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 720.8194663858151/720.8194663858151
Best record value:2099.53858171318 (larger is better)
Round 2, Match 1, Mapping 24: 720.8194663858151/2099.53858171318(0.4762951291821561 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 2, 1, 2], [1, 2, 2, 4], [4, 1, 1, 7], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1]], "last_factors": [[7168, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.08259930109279977, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.10088701417684796, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 5 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 5 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
mapping (1,0,1,0,0,0,0): explored 6 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Tensorize use time 877.1221985816956 s.
#############################################
operations:inputs:[128, 128, 28, 28],[128],[128],body:S[128, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 128, 28, 28],body:S[128, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 128, 28, 28],body:S[128, 128, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 128, 30, 30],[128, 128, 3, 3],body:R[128, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 128, 28, 28] [128] [128] [128, 128, 3, 3] [128, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph41/at:resnet50:subgraph41:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 30.514072792020333/30.514072792020333
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 4: 30.514072792020333/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 98, 1, 1], [1, 1, 2, 2], [4, 1, 16, 2]], "reduce_factors": [[72, 1, 1]], "last_factors": [[12544, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 28.530724727973087/28.530724727973087
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 5: 28.530724727973087/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [1, 1, 2, 2], [1, 16, 1, 8], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[1, 25088, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*T*E
iteration=1: 1e-10/1e-10
Best record value:30.514072792020333 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/30.514072792020333(32.771764255 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 99.49093027994473/99.49093027994473
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 13: 99.49093027994473/99.49093027994473(10.051167450000001 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 64, 1, 1], [2, 1, 2, 1], [1, 2, 14, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[784, 512, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 29.44704999296365/29.44704999296365
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 14: 29.44704999296365/99.49093027994473(10.051167450000001 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 28, 4, 1], [2, 2, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[28, 3584, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 4.058145596845587/4.058145596845587
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 15: 4.058145596845587/99.49093027994473(10.051167450000001 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 112, 1, 2], [1, 4, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[3, 2, 4], [1, 3, 1]], "last_factors": [[2048, 98, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/99.49093027994473(10.051167450000001 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/99.49093027994473(10.051167450000001 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/99.49093027994473(10.051167450000001 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:99.49093027994473 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/99.49093027994473(10.051167450000001 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 127.38935957367642/127.38935957367642
Best record value:127.38935957367642 (larger is better)
Round 1, Match 1, Mapping 20: 127.38935957367642/127.38935957367642(7.84994919 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 16, 1, 1], [1, 1, 1, 4], [2, 7, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[112, 448, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632195949, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.10569453459558631, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632195949, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.10569453459558631, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973, 0.03888284632192973]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 51.461604183845914/51.461604183845914
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 1: 51.461604183845914/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 4], [2, 2, 1, 1], [4, 8, 2, 2], [7, 1, 2, 2]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 3136, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 41.08917903110069/41.08917903110069
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 4: 41.08917903110069/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 32, 2, 2]], "reduce_factors": [[36, 2, 1]], "last_factors": [[4, 12544, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/28.530724727973087
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 5: 28.530724727973087/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [1, 1, 2, 2], [1, 16, 1, 8], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[1, 25088, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 6: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 10.802736662075018/10.802736662075018
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 8: 10.802736662075018/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [1, 32, 1, 4], [2, 7, 2, 1]], "reduce_factors": [[8, 1, 3], [3, 1, 1]], "last_factors": [[1, 200704, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:127.38935957367642 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/127.38935957367642(7.84994919 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 181.7522183203575/181.7522183203575
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 12: 181.7522183203575/181.7522183203575(5.50199612 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 112, 1, 7], [2, 1, 1, 2]], "reduce_factors": [[18, 4, 1]], "last_factors": [[57344, 7, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/99.49093027994473
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 13: 99.49093027994473/181.7522183203575(5.50199612 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 64, 1, 1], [2, 1, 2, 1], [1, 2, 14, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[784, 512, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 26.707632407222672/29.44704999296365
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 14: 29.44704999296365/181.7522183203575(5.50199612 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 28, 4, 1], [2, 2, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[28, 3584, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*T*E
iteration=1: 1e-10/4.058145596845587
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 15: 4.058145596845587/181.7522183203575(5.50199612 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 112, 1, 2], [1, 4, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[3, 2, 4], [1, 3, 1]], "last_factors": [[2048, 98, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/181.7522183203575(5.50199612 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/181.7522183203575(5.50199612 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/181.7522183203575(5.50199612 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*Y*Y
iteration=1: 134.64586309179424/134.64586309179424
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 19: 134.64586309179424/181.7522183203575(5.50199612 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 4, 7, 2], [1, 2, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[2, 4, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[14336, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/127.38935957367642
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 20: 127.38935957367642/181.7522183203575(5.50199612 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 16, 1, 1], [1, 1, 1, 4], [2, 7, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[112, 448, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/181.7522183203575(5.50199612 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 145.71550815290837/145.71550815290837
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 22: 145.71550815290837/181.7522183203575(5.50199612 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 8], [1, 2, 2, 1], [1, 28, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[3, 8, 1], [3, 1, 1]], "last_factors": [[1792, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:181.7522183203575 (larger is better)
Round 2, Match 1, Mapping 23: 1e-10/181.7522183203575(5.50199612 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 359.4732916808275/359.4732916808275
Best record value:359.4732916808275 (larger is better)
Round 2, Match 1, Mapping 24: 359.4732916808275/359.4732916808275(2.78184784 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 4, 2, 1], [2, 1, 1, 2], [4, 7, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[6, 1, 12]], "last_factors": [[32, 1568, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.03711425839685796, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.08259930109275147, 0.037114258396835235, 0.037114258396835235, 0.037114258396835235, 0.10088701417685075]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Tensorize use time 1238.7966799736023 s.
#############################################
operations:inputs:[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[128, 512, 28, 28],[128, 512, 1, 1],body:R[128, 128, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 512, 28, 28] [128, 512, 1, 1] [128, 128, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph42/at:resnet50:subgraph42:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 144.43833499977498/144.43833499977498
Best record value:144.43833499977498 (larger is better)
Round 1, Match 1, Mapping 1: 144.43833499977498/144.43833499977498(6.9233697549999995 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 1], [4, 2, 2, 8], [4, 7, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 28672, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 548.9167035386876/548.9167035386876
Best record value:548.9167035386876 (larger is better)
Round 1, Match 1, Mapping 2: 548.9167035386876/548.9167035386876(1.8217700309597522 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 1, 2], [1, 32, 4, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[896, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 1078.2687087120617/1078.2687087120617
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 3: 1078.2687087120617/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [1, 1, 2, 2], [4, 1, 4, 8]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[128, 448, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 262.135303194506/262.135303194506
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 4: 262.135303194506/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 7, 1, 2], [1, 1, 1, 4], [64, 1, 2, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[2, 6272, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 125.51586739086945/125.51586739086945
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 5: 125.51586739086945/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 1], [1, 64, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 28672, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 465.2208604780343/465.2208604780343
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 6: 465.2208604780343/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [64, 2, 1, 1]], "reduce_factors": [[1, 16, 2], [1, 1, 1]], "last_factors": [[25088, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.E
*E*Y*Y
iteration=1: 611.4280923025932/611.4280923025932
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 8: 611.4280923025932/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [4, 1, 1, 1], [64, 1, 2, 1], [2, 1, 7, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[16, 784, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 614.2552131863715/614.2552131863715
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 10: 614.2552131863715/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 7, 8, 1], [2, 2, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 4]], "last_factors": [[896, 14, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 244.12753681971483/244.12753681971483
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 11: 244.12753681971483/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 224, 4, 2], [2, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[64, 784, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.E.E
*E*Y
iteration=1: 952.9822016668692/952.9822016668692
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 13: 952.9822016668692/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 32, 1, 2], [1, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[14336, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 696.0585784710374/696.0585784710374
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 16: 696.0585784710374/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[196, 8, 1, 8], [2, 2, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[256, 98, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*E
iteration=1: 529.6411062497363/529.6411062497363
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 17: 529.6411062497363/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 2, 2], [2, 1, 2, 1], [1, 28, 1, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[12544, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 193.79014311339085/193.79014311339085
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 19: 193.79014311339085/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 8, 7, 2], [2, 2, 1, 1], [1, 7, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 4096, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 55.668953352707405/55.668953352707405
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 20: 55.668953352707405/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 56, 4, 1], [2, 1, 1, 2], [1, 14, 1, 2]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 25088, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 826.0669185384273/826.0669185384273
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 23: 826.0669185384273/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 8], [1, 2, 2, 1], [14, 1, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[3584, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 3 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.E
*Y*Y
iteration=1: 373.3103901745004/373.3103901745004
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 1: 373.3103901745004/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [1, 1, 2, 2], [4, 16, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.E
*Y*Y*E
iteration=1: 143.75662394583986/548.9167035386876
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 2: 548.9167035386876/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 1, 2], [1, 32, 4, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[896, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 98.28918928146682/1078.2687087120617
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 3: 1078.2687087120617/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [1, 1, 2, 2], [4, 1, 4, 8]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[128, 448, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 237.5508755583657/262.135303194506
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 4: 262.135303194506/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 7, 1, 2], [1, 1, 1, 4], [64, 1, 2, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[2, 6272, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 81.10414209036281/125.51586739086945
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 5: 125.51586739086945/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 1], [1, 64, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 28672, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 623.6151929589358/623.6151929589358
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 6: 623.6151929589358/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [64, 2, 1, 1]], "reduce_factors": [[1, 16, 2], [1, 1, 1]], "last_factors": [[25088, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*Y*E
iteration=1: 424.7690927266603/611.4280923025932
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 8: 611.4280923025932/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [4, 1, 1, 1], [64, 1, 2, 1], [2, 1, 7, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[16, 784, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 774.0870975696771/774.0870975696771
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 9: 774.0870975696771/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 2, 8, 1], [1, 4, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[112, 128, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 91.6415344569599/614.2552131863715
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 10: 614.2552131863715/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 7, 8, 1], [2, 2, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 4]], "last_factors": [[896, 14, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 703.8352645409931/703.8352645409931
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 11: 703.8352645409931/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[224, 8, 1, 7], [1, 2, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[8, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.E.Y.E
*Y*Y
iteration=1: 776.4146258074726/952.9822016668692
Best record value:1078.2687087120617 (larger is better)
Round 2, Match 1, Mapping 13: 952.9822016668692/1078.2687087120617(0.9274126123853211 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 32, 1, 2], [1, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[14336, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 1419.0082551304895/1419.0082551304895
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 14: 1419.0082551304895/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[16, 7, 2, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1]], "last_factors": [[12544, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*Y*E*Y
iteration=1: 460.1339444783949/696.0585784710374
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 16: 696.0585784710374/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[196, 8, 1, 8], [2, 2, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[256, 98, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/529.6411062497363
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 17: 529.6411062497363/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 2, 2], [2, 1, 2, 1], [1, 28, 1, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[12544, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 121.29169378246084/193.79014311339085
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 19: 193.79014311339085/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 8, 7, 2], [2, 2, 1, 1], [1, 7, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 4096, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 1387.736158050687/1387.736158050687
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 20: 1387.736158050687/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 8, 1, 7], [1, 1, 4, 1], [7, 2, 2, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1024, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*E
iteration=1: 562.6185266751841/562.6185266751841
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 21: 562.6185266751841/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 112, 2, 8], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 98, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.E
*Y*E
iteration=1: 373.0942499613353/826.0669185384273
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 23: 826.0669185384273/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 8], [1, 2, 2, 1], [14, 1, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[3584, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1419.0082551304895 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/1419.0082551304895(0.7047175352112676 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03711425839683427, 0.03711425839683427, 0.08259930109279992, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.1008870141768455, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683524, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427, 0.03711425839683427]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 6 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 4 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 966.4269859790802 s.
#############################################
operations:inputs:[128, 512, 28, 28],[512],[512],body:S[128, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 28, 28],[512],[512],body:S[128, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 512, 28, 28],[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 512, 28, 28],body:S[128, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 512, 28, 28] [512] [512] [128, 512, 28, 28] [512] [512] [128, 512, 28, 28] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph51.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B

Currently best performance: 3.2847682100999998
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.B.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 3.1189106451
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 3.1189106451
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 3.1189106451
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 3.1189106451
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 3.1189106451
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 3.1189106451
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 3.1189106451
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 3.1157409301
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.N

Currently best performance: 2.8868497000999995
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B

Currently best performance: 2.6402544551
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 2.6402544551
.N.N.N.N.N.N.N.NSchedule cost 840.534969 seconds
#############################################
operations:inputs:[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 256, 56, 56],[512, 256, 1, 1],body:R[128, 512, 28, 28] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 56, 56] [512, 256, 1, 1] [128, 512, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph52/at:resnet50:subgraph52:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 316.8005917936431/316.8005917936431
Best record value:316.8005917936431 (larger is better)
Round 1, Match 1, Mapping 4: 316.8005917936431/316.8005917936431(3.15655976 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [4, 4, 1, 1], [64, 1, 1, 2]], "reduce_factors": [[1, 1, 16]], "last_factors": [[896, 896, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 427.7238643176265/427.7238643176265
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 5: 427.7238643176265/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 16, 1, 1], [16, 2, 4, 1], [2, 7, 1, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*E*Y
iteration=1: 16.275537159451897/16.275537159451897
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 6: 16.275537159451897/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 98, 1, 1], [1, 16, 1, 1], [8, 4, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[3136, 32, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:427.7238643176265 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/427.7238643176265(2.3379569938080493 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 1408.9682125779293/1408.9682125779293
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 12: 1408.9682125779293/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[392, 4, 1, 8], [2, 1, 2, 4]], "reduce_factors": [[16, 1, 1]], "last_factors": [[2048, 56, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 300.143975313158/300.143975313158
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 13: 300.143975313158/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 2, 2, 4], [1, 4, 2, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[512, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*Y*E
iteration=1: 371.7484211147527/371.7484211147527
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 15: 371.7484211147527/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 4, 4], [8, 1, 2, 1], [1, 7, 4, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[49, 2048, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 516.8359262989089/516.8359262989089
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 16: 516.8359262989089/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[392, 1, 8, 4], [2, 4, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[3584, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 26.93094581191376/26.93094581191376
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 17: 26.93094581191376/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 112, 4, 1], [1, 8, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[2, 8, 1]], "last_factors": [[448, 896, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 39.05934424147741/39.05934424147741
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 18: 39.05934424147741/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 2, 1, 2], [1, 8, 2, 1], [14, 1, 2, 1], [1, 4, 1, 7]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 114688, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 275.7020001869949/316.8005917936431
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 4: 316.8005917936431/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [4, 4, 1, 1], [64, 1, 1, 2]], "reduce_factors": [[1, 1, 16]], "last_factors": [[896, 896, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 419.4403240240133/427.7238643176265
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 5: 427.7238643176265/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 16, 1, 1], [16, 2, 4, 1], [2, 7, 1, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/16.275537159451897
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 6: 16.275537159451897/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 98, 1, 1], [1, 16, 1, 1], [8, 4, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[3136, 32, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 177.2694136924138/177.2694136924138
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 8: 177.2694136924138/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 2, 1], [2, 1, 4, 2], [4, 4, 1, 8], [14, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[32, 25088, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 463.95806283357325/463.95806283357325
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 9: 463.95806283357325/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 64, 1, 1], [1, 8, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[25088, 64, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 141.20196584906904/141.20196584906904
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 11: 141.20196584906904/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[64, 14, 1, 14], [2, 4, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[32, 50176, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 1401.3704735531294/1408.9682125779293
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 12: 1408.9682125779293/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[392, 4, 1, 8], [2, 1, 2, 4]], "reduce_factors": [[16, 1, 1]], "last_factors": [[2048, 56, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/300.143975313158
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 13: 300.143975313158/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 2, 2, 4], [1, 4, 2, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[512, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 659.8015422529149/659.8015422529149
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 14: 659.8015422529149/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 16, 1, 4], [4, 1, 4, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[64, 1568, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 141.79002123204896/371.7484211147527
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 15: 371.7484211147527/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 4, 4], [8, 1, 2, 1], [1, 7, 4, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[49, 2048, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/516.8359262989089
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 16: 516.8359262989089/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[392, 1, 8, 4], [2, 4, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[3584, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 230.35259009039697/230.35259009039697
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 17: 230.35259009039697/1408.9682125779293(0.709739219858156 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 2, 2], [1, 8, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[2, 8, 1]], "last_factors": [[448, 896, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 79.55360910679438/79.55360910679438
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 18: 79.55360910679438/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 4], [1, 2, 1, 8], [28, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 7168, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 12.921258514763716/12.921258514763716
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 23: 12.921258514763716/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 16, 1, 1], [1, 4, 1, 4], [7, 1, 1, 4], [1, 28, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[2, 114688, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 242.13353279583507/242.13353279583507
Best record value:1408.9682125779293 (larger is better)
Round 2, Match 1, Mapping 24: 242.13353279583507/1408.9682125779293(0.709739219858156 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 8, 1], [4, 1, 1, 4], [1, 14, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[16, 1, 1]], "last_factors": [[896, 448, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Tensorize use time 1252.8349525928497 s.
#############################################
operations:inputs:[128, 128, 56, 56],[128],[128],body:S[128, 128, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 128, 56, 56],body:S[128, 128, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 128, 56, 56],body:S[128, 128, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 128, 58, 58],[128, 128, 3, 3],body:R[128, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 128, 56, 56] [128] [128] [128, 128, 3, 3] [128, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph54/at:resnet50:subgraph54:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 110.32924197529718/110.32924197529718
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 6: 110.32924197529718/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 2, 1], [1, 32, 1, 4]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[25088, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:110.32924197529718 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/110.32924197529718(9.063780210000001 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 240.49593060262896/240.49593060262896
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 14: 240.49593060262896/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 56, 1, 4], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[12, 1, 2], [1, 1, 3]], "last_factors": [[64, 896, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 152.92046825963146/152.92046825963146
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 17: 152.92046825963146/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[224, 2, 1, 1], [1, 2, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 1, 18]], "last_factors": [[2048, 49, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 14.250471719952088/14.250471719952088
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 18: 14.250471719952088/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 16, 1, 1], [1, 2, 1, 2], [1, 7, 2, 2], [1, 14, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[448, 56, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 161.21086590512093/161.21086590512093
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 19: 161.21086590512093/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 28, 16, 1], [1, 2, 1, 2], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[8, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 121.9129349107639/121.9129349107639
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 3: 121.9129349107639/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 2, 1, 1], [8, 2, 4, 2]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[4, 6272, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 14.719520437788622/14.719520437788622
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 4: 14.719520437788622/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 49, 1, 1], [1, 1, 4, 1], [4, 16, 2, 1]], "reduce_factors": [[18, 4, 1]], "last_factors": [[128, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 219.49760672211247/219.49760672211247
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 5: 219.49760672211247/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [4, 1, 1, 1], [2, 8, 2, 4], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[16, 6272, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 46.243173198665055/110.32924197529718
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 6: 110.32924197529718/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 2, 1], [1, 32, 1, 4]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[25088, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.E
*Y*E
iteration=1: 49.28559813328905/49.28559813328905
Best record value:240.49593060262896 (larger is better)
Round 2, Match 1, Mapping 7: 49.28559813328905/240.49593060262896(4.158074514999999 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 2, 1, 2], [1, 32, 1, 4]], "reduce_factors": [[2, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 1024, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 590.0817190288407/590.0817190288407
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 8: 590.0817190288407/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [1, 1, 1, 4], [8, 4, 4, 1], [7, 2, 1, 2]], "reduce_factors": [[4, 1, 6], [3, 1, 1]], "last_factors": [[3136, 64, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 6.152528003685574/6.152528003685574
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 9: 6.152528003685574/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[8, 28, 1, 2], [1, 4, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[6, 2, 2], [1, 3, 1]], "last_factors": [[6272, 8, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 3.4819496584784266/3.4819496584784266
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 10: 3.4819496584784266/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 32, 1, 7], [2, 2, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[18, 2, 2]], "last_factors": [[1792, 224, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*T*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 65.64195110770666/65.64195110770666
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 13: 65.64195110770666/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[16, 7, 2, 2], [1, 2, 2, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 1, 2], [3, 1, 1]], "last_factors": [[2, 28672, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/240.49593060262896
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 14: 240.49593060262896/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 56, 1, 4], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[12, 1, 2], [1, 1, 3]], "last_factors": [[64, 896, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 383.7674931441185/383.7674931441185
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 16: 383.7674931441185/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 32, 2, 4], [1, 2, 2, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[64, 1568, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 67.87513304722376/152.92046825963146
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 17: 152.92046825963146/590.0817190288407(1.6946805294117648 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[224, 2, 1, 1], [1, 2, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 1, 18]], "last_factors": [[2048, 49, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*Y
iteration=1: 10.15850147983262/14.250471719952088
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 18: 14.250471719952088/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 16, 1, 1], [1, 2, 1, 2], [1, 7, 2, 2], [1, 14, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[448, 56, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/161.21086590512093
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 19: 161.21086590512093/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 28, 16, 1], [1, 2, 1, 2], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[8, 1792, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 35.86211932186856/35.86211932186856
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 23: 35.86211932186856/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 4, 1, 4], [1, 1, 1, 4], [7, 2, 2, 1], [2, 14, 1, 1]], "reduce_factors": [[12, 1, 2], [3, 1, 1]], "last_factors": [[512, 784, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:590.0817190288407 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/590.0817190288407(1.6946805294117648 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.10088701417684796, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.08259930109279977, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421, 0.03711425839683421]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 1365.7729663848877 s.
#############################################
operations:inputs:[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 256, 56, 56],[128, 256, 1, 1],body:R[128, 128, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 56, 56] [128, 256, 1, 1] [128, 128, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph55/at:resnet50:subgraph55:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 328.82034101306505/328.82034101306505
Best record value:328.82034101306505 (larger is better)
Round 1, Match 1, Mapping 1: 328.82034101306505/328.82034101306505(3.04117439 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [128, 1, 1, 1], [14, 4, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 256, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 193.75574693471606/193.75574693471606
Best record value:328.82034101306505 (larger is better)
Round 1, Match 1, Mapping 2: 193.75574693471606/328.82034101306505(3.04117439 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 2, 1], [2, 32, 1, 2], [1, 8, 7, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[49, 2048, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 261.8459342879351/261.8459342879351
Best record value:328.82034101306505 (larger is better)
Round 1, Match 1, Mapping 3: 261.8459342879351/328.82034101306505(3.04117439 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 1, 7, 2], [4, 1, 1, 1], [128, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 896, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 568.9094694854381/568.9094694854381
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 4: 568.9094694854381/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 1, 1, 2], [2, 2, 1, 1], [4, 1, 8, 4]], "reduce_factors": [[16, 1, 1]], "last_factors": [[2048, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 24.551152994503006/24.551152994503006
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 6: 24.551152994503006/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 2], [4, 16, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[4, 401408, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 242.58782159768958/242.58782159768958
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 7: 242.58782159768958/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 8, 1, 1], [2, 1, 1, 2], [8, 4, 1, 4]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[512, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 193.23526001702288/193.23526001702288
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 8: 193.23526001702288/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 4], [8, 4, 1, 4], [7, 8, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[112, 448, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 40.96286558957382/40.96286558957382
Best record value:568.9094694854381 (larger is better)
Round 1, Match 1, Mapping 9: 40.96286558957382/568.9094694854381(1.757748910216718 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 8, 2, 14], [2, 1, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[3584, 56, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 780.2589893907567/780.2589893907567
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 10: 780.2589893907567/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[224, 1, 2, 2], [1, 1, 2, 2], [1, 7, 2, 4]], "reduce_factors": [[8, 1, 2]], "last_factors": [[112, 512, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 25.941504884828888/25.941504884828888
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 11: 25.941504884828888/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[128, 28, 2, 7], [2, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[8, 200704, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 354.7810920836099/354.7810920836099
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 12: 354.7810920836099/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 8, 4, 28], [4, 1, 1, 1]], "reduce_factors": [[16, 1, 1]], "last_factors": [[1568, 256, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 128.1971943601734/128.1971943601734
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 13: 128.1971943601734/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 1, 8], [2, 1, 2, 1], [14, 1, 4, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[7, 28672, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 23.83932095424043/23.83932095424043
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 15: 23.83932095424043/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 16, 1, 14], [4, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[2, 100352, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 174.96480943723088/174.96480943723088
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 17: 174.96480943723088/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[112, 4, 1, 2], [1, 4, 1, 1], [2, 4, 7, 1]], "reduce_factors": [[16, 1, 1]], "last_factors": [[32, 12544, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 5.300761495390204/5.300761495390204
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 18: 5.300761495390204/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 8, 1, 1], [1, 2, 1, 2], [8, 7, 1, 1], [1, 14, 1, 4]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 802816, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 227.6986671269155/227.6986671269155
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 19: 227.6986671269155/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 8, 2, 1], [1, 2, 2, 1], [7, 1, 4, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 3136, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 396.47907785754217/396.47907785754217
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 21: 396.47907785754217/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[448, 16, 7, 1], [1, 4, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 64, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 37.260994631681065/37.260994631681065
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 22: 37.260994631681065/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 2, 2], [2, 2, 1, 1], [2, 28, 1, 1], [1, 28, 1, 2]], "reduce_factors": [[1, 4, 4], [1, 1, 1]], "last_factors": [[64, 3584, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.E.E.Y.Y
*Y*E
iteration=1: 46.32055270778509/46.32055270778509
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 23: 46.32055270778509/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 1, 1, 2], [1, 1, 4, 1], [1, 7, 1, 8], [1, 28, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[16, 7168, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 295.96722809341287/295.96722809341287
Best record value:780.2589893907567 (larger is better)
Round 1, Match 1, Mapping 24: 295.96722809341287/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 4, 2], [2, 1, 1, 2], [2, 7, 2, 2], [14, 4, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[1568, 256, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 360.15395710093486/360.15395710093486
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 1: 360.15395710093486/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [128, 1, 1, 1], [14, 4, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 256, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/193.75574693471606
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 2: 193.75574693471606/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 2, 1], [2, 32, 1, 2], [1, 8, 7, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[49, 2048, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/261.8459342879351
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 3: 261.8459342879351/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 1, 7, 2], [4, 1, 1, 1], [128, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 896, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 714.963256091093/714.963256091093
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 4: 714.963256091093/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 1, 1, 2], [2, 2, 1, 1], [4, 1, 8, 4]], "reduce_factors": [[16, 1, 1]], "last_factors": [[7168, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 25.323099496641028/25.323099496641028
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 6: 25.323099496641028/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 2], [4, 16, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[4, 401408, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 433.78046080259304/433.78046080259304
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 7: 433.78046080259304/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 8, 1], [1, 1, 1, 4], [16, 2, 1, 4]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 896, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 437.8192034084813/437.8192034084813
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 8: 437.8192034084813/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 2, 1, 1], [128, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[50176, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/40.96286558957382
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 9: 40.96286558957382/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 8, 2, 14], [2, 1, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[3584, 56, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 219.49484078913187/780.2589893907567
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 10: 780.2589893907567/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[224, 1, 2, 2], [1, 1, 2, 2], [1, 7, 2, 4]], "reduce_factors": [[8, 1, 2]], "last_factors": [[112, 512, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 317.49722323675377/317.49722323675377
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 11: 317.49722323675377/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[448, 8, 14, 1], [4, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[1792, 56, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 315.09345049432096/354.7810920836099
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 12: 354.7810920836099/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 8, 4, 28], [4, 1, 1, 1]], "reduce_factors": [[16, 1, 1]], "last_factors": [[1568, 256, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 80.76642699999427/128.1971943601734
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 13: 128.1971943601734/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 1, 8], [2, 1, 2, 1], [14, 1, 4, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[7, 28672, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 361.01332548740663/361.01332548740663
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 14: 361.01332548740663/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[112, 1, 1, 8], [2, 1, 1, 2], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[1024, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 281.49925976532404/281.49925976532404
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 15: 281.49925976532404/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[16, 14, 1, 4], [2, 1, 2, 1], [14, 1, 1, 4]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[1568, 256, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 652.5882948969471/652.5882948969471
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 16: 652.5882948969471/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[64, 98, 4, 2], [1, 1, 4, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[64, 1792, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 246.68702805772742/246.68702805772742
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 17: 246.68702805772742/780.2589893907567(1.2816257340153452 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 28, 1, 4], [2, 1, 2, 1], [28, 2, 1, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[3136, 64, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 8.283542248622535/8.283542248622535
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 18: 8.283542248622535/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 8, 1, 1], [1, 2, 1, 2], [8, 7, 1, 1], [1, 14, 1, 4]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 802816, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 26.88492935962698/227.6986671269155
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 19: 227.6986671269155/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 8, 2, 1], [1, 2, 2, 1], [7, 1, 4, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 3136, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 622.9273766983578/622.9273766983578
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 21: 622.9273766983578/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[64, 98, 2, 4], [2, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1792, 28, 32]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/37.260994631681065
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 22: 37.260994631681065/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 2, 2], [2, 2, 1, 1], [2, 28, 1, 1], [1, 28, 1, 2]], "reduce_factors": [[1, 4, 4], [1, 1, 1]], "last_factors": [[64, 3584, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 483.7739745145384/483.7739745145384
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 23: 483.7739745145384/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 1, 1, 1], [1, 2, 2, 1], [2, 14, 2, 1], [14, 2, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[14336, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/295.96722809341287
Best record value:780.2589893907567 (larger is better)
Round 2, Match 1, Mapping 24: 295.96722809341287/780.2589893907567(1.2816257340153452 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 4, 2], [2, 1, 1, 2], [2, 7, 2, 2], [14, 4, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[1568, 256, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 6 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 2 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Tensorize use time 1516.473563194275 s.
#############################################
operations:inputs:[128, 256, 56, 56],[256],[256],body:S[128, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 56, 56],[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 256, 56, 56] [256] [256] [128, 256, 56, 56] [128, 256, 56, 56] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph56.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 6.7956594551
.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 4.9799848301
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 4.9799848301
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 4.9799848301
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 4.9799848301
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 4.9799848301
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 4.9799848301
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 4.9799848301
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 4.9762881101000005
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 4.9762881101000005
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 4.9762881101000005
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 4.9762881101000005
.N.N.N.N.N.N.N.NSchedule cost 1381.710303 seconds
#############################################
operations:inputs:[128, 64, 56, 56],[64],[64],body:S[128, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 64, 56, 56],body:S[128, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 64, 56, 56],body:S[128, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 64, 56, 56],[256, 64, 1, 1],body:R[128, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 64, 56, 56] [64] [64] [256, 64, 1, 1] [128, 256, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph57/at:resnet50:subgraph57:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 702.2513730136549/702.2513730136549
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 1: 702.2513730136549/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 1], [16, 2, 2, 2], [8, 1, 7, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 140.0006337268686/140.0006337268686
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 2: 140.0006337268686/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 4], [16, 8, 1, 1], [4, 2, 7, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[196, 8192, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=1: 681.8222012245867/681.8222012245867
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 3: 681.8222012245867/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 4], [1, 4, 2, 1], [4, 16, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[50176, 2, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 58.59871902831033/58.59871902831033
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 4: 58.59871902831033/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 98, 1, 2], [2, 2, 1, 2], [16, 2, 1, 4]], "reduce_factors": [[1, 1, 4]], "last_factors": [[28, 57344, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*E
iteration=1: 190.69335352008088/190.69335352008088
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 5: 190.69335352008088/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [2, 16, 1, 4], [4, 7, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 16.532055617529352/16.532055617529352
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 6: 16.532055617529352/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 196, 1, 2], [2, 2, 2, 1], [4, 2, 1, 16]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[1, 200704, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 27.858860631803022/27.858860631803022
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 7: 27.858860631803022/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 1, 7, 1], [2, 1, 2, 2], [64, 1, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 229376, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.E.E
*Y
iteration=1: 442.49832251351876/442.49832251351876
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 8: 442.49832251351876/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 4], [16, 1, 4, 2], [1, 14, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 224, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 642.8292677785361/642.8292677785361
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 10: 642.8292677785361/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[128, 7, 1, 1], [1, 1, 4, 2], [7, 2, 4, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[28672, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 493.4764280121568/493.4764280121568
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 11: 493.4764280121568/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[784, 8, 2, 4], [2, 2, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[128, 3136, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*E*Y*Y
iteration=1: 200.31153030095842/200.31153030095842
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 12: 200.31153030095842/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 448, 2, 8], [1, 4, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[32768, 14, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 356.0722521589177/356.0722521589177
Best record value:702.2513730136549 (larger is better)
Round 1, Match 1, Mapping 13: 356.0722521589177/702.2513730136549(1.4239915198863635 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[112, 2, 4, 1], [8, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[50176, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 884.7665837166915/884.7665837166915
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 14: 884.7665837166915/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[16, 14, 2, 2], [2, 2, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[28672, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 21.21726861407143/21.21726861407143
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 17: 21.21726861407143/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 8, 2, 28], [2, 2, 2, 1], [56, 1, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[7, 114688, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 272.26467227784553/272.26467227784553
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 18: 272.26467227784553/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 2, 2], [2, 2, 2, 1], [14, 1, 4, 1], [56, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7168, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 781.4959899427207/781.4959899427207
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 19: 781.4959899427207/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[32, 2, 2, 7], [2, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[50176, 4, 16]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 562.7112272914094/562.7112272914094
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 20: 562.7112272914094/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 16, 1, 1], [1, 1, 4, 2], [1, 2, 1, 28]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 8, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 263.04126743046737/263.04126743046737
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 21: 263.04126743046737/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[8, 784, 4, 2], [2, 1, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 1024, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 500.1675266998252/500.1675266998252
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 22: 500.1675266998252/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 2, 1], [4, 2, 1, 1], [1, 56, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[1792, 64, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 182.95072246531367/182.95072246531367
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 23: 182.95072246531367/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 2, 1], [1, 1, 2, 4], [14, 4, 1, 1], [1, 2, 2, 14]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[256, 3136, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 538.3722235481885/538.3722235481885
Best record value:884.7665837166915 (larger is better)
Round 1, Match 1, Mapping 24: 538.3722235481885/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 1, 2], [1, 1, 4, 2], [14, 1, 2, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2]], "last_factors": [[28672, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 3 schedules
mapping (1,1,0,0,0,0,0): explored 2 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*Y*Y
iteration=1: 257.0279714044096/702.2513730136549
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 1: 702.2513730136549/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 1], [16, 2, 2, 2], [8, 1, 7, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 548.3841909897112/548.3841909897112
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 2: 548.3841909897112/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 2], [64, 1, 1, 2], [2, 4, 1, 7]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[3584, 56, 16]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 501.02440333666925/681.8222012245867
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 3: 681.8222012245867/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 4], [1, 4, 2, 1], [4, 16, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[50176, 2, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 406.6519010060461/406.6519010060461
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 4: 406.6519010060461/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[196, 1, 1, 2], [2, 2, 1, 2], [8, 8, 1, 2]], "reduce_factors": [[1, 1, 4]], "last_factors": [[392, 512, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 132.9830754168697/190.69335352008088
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 5: 190.69335352008088/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [2, 16, 1, 4], [4, 7, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 17.425529140165438/17.425529140165438
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 6: 17.425529140165438/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 196, 1, 2], [2, 2, 2, 1], [64, 2, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[1, 200704, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/27.858860631803022
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 7: 27.858860631803022/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 1, 7, 1], [2, 1, 2, 2], [64, 1, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 229376, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 345.3404381925362/442.49832251351876
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 8: 442.49832251351876/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 4], [16, 1, 4, 2], [1, 14, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 224, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 260.3537824141533/260.3537824141533
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 9: 260.3537824141533/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 4, 28, 2], [4, 2, 1, 1], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3584, 224, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 95.44925284770757/642.8292677785361
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 10: 642.8292677785361/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[128, 7, 1, 1], [1, 1, 4, 2], [7, 2, 4, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[28672, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 492.487113655371/493.4764280121568
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 11: 493.4764280121568/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[784, 8, 2, 4], [2, 2, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[128, 3136, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 829.9335751716894/829.9335751716894
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 12: 829.9335751716894/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1568, 8, 4, 1], [1, 8, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[6272, 16, 32]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 616.8287061355037/616.8287061355037
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 13: 616.8287061355037/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[112, 2, 4, 1], [8, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[50176, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 130.7092621138648/884.7665837166915
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 14: 884.7665837166915/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[16, 14, 2, 2], [2, 2, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[28672, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 118.51827312423924/118.51827312423924
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 15: 118.51827312423924/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 224, 2, 1], [4, 2, 1, 1], [1, 14, 2, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[128, 784, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 540.8407947497748/540.8407947497748
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 17: 540.8407947497748/884.7665837166915(1.130241600896861 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 8, 2, 28], [2, 2, 2, 1], [56, 1, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[512, 196, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 253.338348672622/272.26467227784553
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 18: 272.26467227784553/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 2, 2], [2, 2, 2, 1], [14, 1, 4, 1], [56, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7168, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 390.09153078421457/781.4959899427207
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 19: 781.4959899427207/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[32, 2, 2, 7], [2, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[50176, 4, 16]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/562.7112272914094
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 20: 562.7112272914094/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 16, 1, 1], [1, 1, 4, 2], [1, 2, 1, 28]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 8, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 283.9077277115538/283.9077277115538
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 21: 283.9077277115538/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 784, 4, 2], [2, 1, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 1024, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 583.3012812590073/583.3012812590073
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 22: 583.3012812590073/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 16, 1, 1], [4, 1, 2, 1], [4, 7, 2, 1], [4, 1, 2, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[28672, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 282.05733778616315/282.05733778616315
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 23: 282.05733778616315/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 4], [8, 1, 1, 1], [1, 14, 1, 4], [56, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[16384, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 28.614123877350707/538.3722235481885
Best record value:884.7665837166915 (larger is better)
Round 2, Match 1, Mapping 24: 538.3722235481885/884.7665837166915(1.130241600896861 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 1, 2], [1, 1, 4, 2], [14, 1, 2, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2]], "last_factors": [[28672, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 5 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 6 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
mapping (1,0,1,0,0,0,0): explored 4 schedules
mapping (1,1,0,0,0,0,0): explored 5 schedules
mapping (1,1,1,0,0,0,0): explored 5 schedules
Tensorize use time 1687.1232719421387 s.
#############################################
operations:inputs:[128, 64, 56, 56],[64],[64],body:S[128, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 64, 56, 56],body:S[128, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 64, 56, 56],body:S[128, 64, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 64, 58, 58],[64, 64, 3, 3],body:R[128, 64, 56, 56] [64, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 64, 56, 56] [64] [64] [64, 64, 3, 3] [128, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph58/at:resnet50:subgraph58:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 203.2134678083825/203.2134678083825
Best record value:203.2134678083825 (larger is better)
Round 1, Match 1, Mapping 12: 203.2134678083825/203.2134678083825(4.92093369 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 56, 1, 2], [2, 2, 2, 1]], "reduce_factors": [[3, 1, 12]], "last_factors": [[98, 8192, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:203.2134678083825 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/203.2134678083825(4.92093369 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:203.2134678083825 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/203.2134678083825(4.92093369 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 137.30923859191765/137.30923859191765
Best record value:203.2134678083825 (larger is better)
Round 1, Match 1, Mapping 15: 137.30923859191765/203.2134678083825(4.92093369 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 8, 1], [4, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 3], [3, 1, 1]], "last_factors": [[448, 1792, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*E*T*Y
iteration=1: 489.24101895944665/489.24101895944665
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 16: 489.24101895944665/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[128, 7, 7, 2], [4, 1, 1, 2]], "reduce_factors": [[12, 1, 1], [3, 1, 1]], "last_factors": [[4096, 49, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 4: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 6: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 142.3708849638174/142.3708849638174
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 8: 142.3708849638174/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 4, 1, 2], [128, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 3, 1], [3, 1, 1]], "last_factors": [[3584, 224, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 10.292398688806642/10.292398688806642
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 11: 10.292398688806642/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[112, 56, 2, 1], [2, 4, 1, 1]], "reduce_factors": [[2, 1, 6], [1, 1, 3]], "last_factors": [[392, 1024, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/203.2134678083825
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 12: 203.2134678083825/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 56, 1, 2], [2, 2, 2, 1]], "reduce_factors": [[3, 1, 12]], "last_factors": [[98, 8192, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 14: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 25.783730713263257/137.30923859191765
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 15: 137.30923859191765/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 8, 1], [4, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 3], [3, 1, 1]], "last_factors": [[448, 1792, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/489.24101895944665
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 16: 489.24101895944665/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[128, 7, 7, 2], [4, 1, 1, 2]], "reduce_factors": [[12, 1, 1], [3, 1, 1]], "last_factors": [[4096, 49, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 293.45054421049014/293.45054421049014
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 19: 293.45054421049014/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 2, 2, 1], [1, 2, 2, 2], [1, 14, 1, 4]], "reduce_factors": [[4, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[112, 448, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 73.09505763319979/73.09505763319979
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 23: 73.09505763319979/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 8, 1, 1], [28, 1, 2, 1], [2, 7, 1, 4]], "reduce_factors": [[6, 1, 2], [3, 1, 1]], "last_factors": [[128, 6272, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:489.24101895944665 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/489.24101895944665(2.043982334365325 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 847.7040841579437 s.
#############################################
operations:inputs:[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 256, 56, 56],[64, 256, 1, 1],body:R[128, 64, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 256, 56, 56] [64, 256, 1, 1] [128, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph59/at:resnet50:subgraph59:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 2.296544505776875/2.296544505776875
Best record value:2.296544505776875 (larger is better)
Round 1, Match 1, Mapping 1: 2.296544505776875/2.296544505776875(435.43680406999994 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 1], [1, 64, 2, 1], [1, 7, 1, 8]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 3584, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:2.296544505776875 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/2.296544505776875(435.43680406999994 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:2.296544505776875 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/2.296544505776875(435.43680406999994 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2.296544505776875 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/2.296544505776875(435.43680406999994 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 336.90854050650876/336.90854050650876
Best record value:336.90854050650876 (larger is better)
Round 1, Match 1, Mapping 5: 336.90854050650876/336.90854050650876(2.9681645899999998 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [8, 4, 2, 2], [28, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 392, 32]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.E.E.E

iteration=1: 1e-10/1e-10
Best record value:336.90854050650876 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/336.90854050650876(2.9681645899999998 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 1122.0461178743888/1122.0461178743888
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 7: 1122.0461178743888/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [4, 1, 2, 1], [2, 16, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 399.98317670758775/399.98317670758775
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 11: 399.98317670758775/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[32, 56, 1, 7], [2, 1, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[98, 256, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 455.9712888290344/455.9712888290344
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 12: 455.9712888290344/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[32, 392, 1, 1], [1, 2, 4, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[1568, 16, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*Y*E
iteration=1: 569.9778600482292/569.9778600482292
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 14: 569.9778600482292/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 56, 1, 1], [1, 2, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[2048, 56, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1122.0461178743888 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/1122.0461178743888(0.8912289647188534 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1264.6753173924708/1264.6753173924708
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 16: 1264.6753173924708/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[784, 16, 1, 1], [1, 1, 4, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[3584, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 833.7777031914413/833.7777031914413
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 19: 833.7777031914413/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 4, 1], [4, 2, 1, 1], [14, 4, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 32, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 22: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 5.30599116454029/5.30599116454029
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 23: 5.30599116454029/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 2, 2, 2], [1, 14, 1, 4], [1, 28, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[56, 3584, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/2.296544505776875
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 1: 2.296544505776875/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 1], [1, 64, 2, 1], [1, 7, 1, 8]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 3584, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 3: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 4: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 285.4117553695602/336.90854050650876
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 5: 336.90854050650876/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [8, 4, 2, 2], [28, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 392, 32]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 6: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 1082.9039580915448/1122.0461178743888
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 7: 1122.0461178743888/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [4, 1, 2, 1], [2, 16, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 548.8158757161151/548.8158757161151
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 8: 548.8158757161151/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [64, 2, 1, 1], [7, 4, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[4096, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 242.41387357482336/242.41387357482336
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 10: 242.41387357482336/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 1, 2], [2, 1, 1, 4], [1, 7, 2, 4]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 256, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 13.567460270279744/399.98317670758775
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 11: 399.98317670758775/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[32, 56, 1, 7], [2, 1, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[98, 256, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 974.7423896604992/974.7423896604992
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 12: 974.7423896604992/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[6272, 1, 2, 1], [4, 1, 1, 2]], "reduce_factors": [[2, 2, 4]], "last_factors": [[1024, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 676.3954547023551/676.3954547023551
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 13: 676.3954547023551/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[112, 2, 1, 1], [2, 1, 1, 4], [4, 14, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[4096, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 598.5760369027056/598.5760369027056
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 14: 598.5760369027056/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 56, 1, 1], [1, 2, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[2048, 56, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1264.6753173924708 (larger is better)
Round 2, Match 1, Mapping 15: 1e-10/1264.6753173924708(0.7907167841796875 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1372.5969310284684/1372.5969310284684
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 16: 1372.5969310284684/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[784, 16, 1, 1], [1, 1, 4, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[3584, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 17: 1e-10/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/833.7777031914413
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 19: 833.7777031914413/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 4, 1], [4, 2, 1, 1], [14, 4, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 32, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.Y
*E*Y
iteration=1: 372.52314298163157/372.52314298163157
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 20: 372.52314298163157/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 7, 1, 2], [1, 4, 2, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 224, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 21: 1e-10/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 22: 1e-10/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*Y
iteration=1: 223.45033780322677/223.45033780322677
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 23: 223.45033780322677/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [2, 2, 1, 2], [8, 7, 1, 1], [1, 4, 14, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[32, 784, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:1372.5969310284684 (larger is better)
Round 2, Match 1, Mapping 24: 1e-10/1372.5969310284684(0.7285459972948602 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 2 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Tensorize use time 996.9687895774841 s.
#############################################
operations:inputs:[128, 256, 56, 56],[256],[256],body:S[128, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 56, 56],[256],[256],body:S[128, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 256, 56, 56],[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 256, 56, 56],body:S[128, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[128, 256, 56, 56] [256] [256] [128, 256, 56, 56] [256] [256] [128, 256, 56, 56] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph64.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 12.596633370100003
.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 5.076305560099999
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 5.076305560099999
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N

Currently best performance: 5.024250830100001
.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 4.9864575151
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 4.9848622801
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 4.9848622801
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 4.9848622801
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 4.9848622801
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 4.9848622801
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 4.9746298251
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 4.9746298251
.N.N.N.N.N.N.N.NSchedule cost 1445.176917 seconds
#############################################
operations:inputs:[128, 64, 56, 56],body:S[128, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 64, 56, 56],[256, 64, 1, 1],body:R[128, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 64, 56, 56] [256, 64, 1, 1] [128, 256, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph65/at:resnet50:subgraph65:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 98.14477857436279/98.14477857436279
Best record value:98.14477857436279 (larger is better)
Round 1, Match 1, Mapping 1: 98.14477857436279/98.14477857436279(10.18902905 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 2, 1, 1], [2, 64, 1, 1], [2, 7, 1, 4]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 256, 32]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:98.14477857436279 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/98.14477857436279(10.18902905 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:98.14477857436279 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/98.14477857436279(10.18902905 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:98.14477857436279 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/98.14477857436279(10.18902905 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*Y*Y
iteration=1: 213.4070369534206/213.4070369534206
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 5: 213.4070369534206/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 4, 1, 2], [32, 1, 2, 2], [8, 7, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 50.730654092271834/50.730654092271834
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 6: 50.730654092271834/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 4], [1, 4, 1, 2], [8, 2, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[49, 65536, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 189.4435115225047/189.4435115225047
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 7: 189.4435115225047/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 4, 2, 7], [4, 2, 1, 1], [4, 16, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 14336, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 175.95764917571827/175.95764917571827
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 8: 175.95764917571827/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 7, 1, 1], [4, 1, 2, 1], [16, 2, 1, 4], [1, 14, 4, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 3584, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*Y*E
iteration=1: 91.14447553580492/91.14447553580492
Best record value:213.4070369534206 (larger is better)
Round 1, Match 1, Mapping 10: 91.14447553580492/213.4070369534206(4.685881095 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 14, 4, 4], [1, 1, 1, 8], [1, 14, 1, 4]], "reduce_factors": [[2, 2, 1]], "last_factors": [[57344, 2, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 687.4899562948286/687.4899562948286
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 11: 687.4899562948286/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[128, 7, 7, 8], [1, 4, 2, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[14336, 56, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 184.8445872967367/184.8445872967367
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 12: 184.8445872967367/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 896, 2, 7], [2, 1, 1, 4]], "reduce_factors": [[4, 1, 1]], "last_factors": [[8192, 98, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*Y
iteration=1: 440.70036811988274/440.70036811988274
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 14: 440.70036811988274/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[224, 4, 1, 1], [2, 1, 4, 1], [1, 7, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[392, 512, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 187.74805072980118/187.74805072980118
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 16: 187.74805072980118/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 784, 1, 8], [2, 2, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[98, 4096, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/687.4899562948286(1.454566704347826 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 171.94881637755526/171.94881637755526
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 18: 171.94881637755526/687.4899562948286(1.454566704347826 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 4, 2], [1, 2, 1, 4], [14, 1, 2, 2], [2, 28, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 170.26531273108858/170.26531273108858
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 19: 170.26531273108858/687.4899562948286(1.454566704347826 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 28, 8, 4], [4, 1, 1, 2], [4, 14, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4096, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 523.4053520948776/523.4053520948776
Best record value:687.4899562948286 (larger is better)
Round 1, Match 1, Mapping 20: 523.4053520948776/687.4899562948286(1.454566704347826 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[224, 4, 1, 1], [8, 1, 1, 1], [2, 1, 14, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 1024, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 698.5495303580655/698.5495303580655
Best record value:698.5495303580655 (larger is better)
Round 1, Match 1, Mapping 21: 698.5495303580655/698.5495303580655(1.4315377171428572 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[896, 7, 8, 1], [1, 1, 1, 8]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 170.33924175717976/170.33924175717976
Best record value:698.5495303580655 (larger is better)
Round 1, Match 1, Mapping 22: 170.33924175717976/698.5495303580655(1.4315377171428572 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 16, 1, 1], [1, 2, 1, 4], [7, 4, 2, 1], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3584, 56, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 133.1637776707422/133.1637776707422
Best record value:698.5495303580655 (larger is better)
Round 1, Match 1, Mapping 23: 133.1637776707422/698.5495303580655(1.4315377171428572 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 8, 2, 1], [2, 2, 1, 2], [2, 28, 1, 1], [56, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[16384, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 20.719106834079334/20.719106834079334
Best record value:698.5495303580655 (larger is better)
Round 1, Match 1, Mapping 24: 20.719106834079334/698.5495303580655(1.4315377171428572 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 2, 1, 1], [8, 1, 1, 1], [14, 1, 1, 4], [2, 2, 1, 14]], "reduce_factors": [[2, 2, 1]], "last_factors": [[4, 200704, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888349904684045, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.10569298256490325, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 2 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888349904684045, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619, 0.10569298256490325, 0.03888288719946619, 0.03888288719946619, 0.03888288719946619]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 460.3250827705828/460.3250827705828
Best record value:698.5495303580655 (larger is better)
Round 2, Match 1, Mapping 1: 460.3250827705828/698.5495303580655(1.4315377171428572 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 1], [1, 8, 8, 2], [14, 2, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 512, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 92.10494513527398/92.10494513527398
Best record value:698.5495303580655 (larger is better)
Round 2, Match 1, Mapping 2: 92.10494513527398/698.5495303580655(1.4315377171428572 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 2], [2, 64, 1, 1], [1, 28, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[65536, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.E.Y.E
*Y
iteration=1: 695.1589090586299/695.1589090586299
Best record value:698.5495303580655 (larger is better)
Round 2, Match 1, Mapping 3: 695.1589090586299/698.5495303580655(1.4315377171428572 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 4], [4, 2, 1, 1], [2, 8, 4, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[4096, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.E.Y
*Y*Y
iteration=1: 726.198572938805/726.198572938805
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 4: 726.198572938805/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 14, 4, 1], [2, 1, 2, 2], [16, 2, 2, 2]], "reduce_factors": [[2, 1, 2]], "last_factors": [[6272, 64, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 197.19711241823038/213.4070369534206
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 5: 213.4070369534206/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 4, 1, 2], [32, 1, 2, 2], [8, 7, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[57344, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/50.730654092271834
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 6: 50.730654092271834/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 4], [1, 4, 1, 2], [8, 2, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[49, 65536, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 165.4696939252301/189.4435115225047
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 7: 189.4435115225047/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 4, 2, 7], [4, 2, 1, 1], [4, 16, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 14336, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 252.32592619432594/252.32592619432594
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 8: 252.32592619432594/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 4, 1, 1], [32, 2, 1, 2], [2, 2, 1, 14]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[128, 784, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 723.5794975636269/723.5794975636269
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 9: 723.5794975636269/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 224, 2, 1], [2, 1, 2, 2], [28, 1, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[25088, 32, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.E.Y
*Y*E
iteration=1: 42.55200376334687/91.14447553580492
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 10: 91.14447553580492/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 14, 4, 4], [1, 1, 1, 8], [1, 14, 1, 4]], "reduce_factors": [[2, 2, 1]], "last_factors": [[57344, 2, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 709.8639918189974/709.8639918189974
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 11: 709.8639918189974/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[128, 7, 7, 8], [2, 4, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[14336, 56, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 379.1581899533999/379.1581899533999
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 12: 379.1581899533999/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[256, 7, 4, 7], [2, 2, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[14336, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=1: 437.146797314569/437.146797314569
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 13: 437.146797314569/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[112, 4, 2, 1], [2, 1, 1, 4], [28, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[28672, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 439.00019567448345/440.70036811988274
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 14: 440.70036811988274/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[224, 4, 1, 1], [2, 1, 4, 1], [1, 7, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[392, 512, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 133.70656540551468/133.70656540551468
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 15: 133.70656540551468/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[8, 56, 1, 2], [2, 2, 2, 1], [2, 1, 1, 28]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[32, 12544, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*E*Y
iteration=1: 38.233562587630715/187.74805072980118
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 16: 187.74805072980118/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 784, 1, 8], [2, 2, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[98, 4096, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 357.51014263424855/357.51014263424855
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 17: 357.51014263424855/726.198572938805(1.377033826923077 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 32, 1, 4], [1, 1, 1, 8], [14, 2, 1, 2]], "reduce_factors": [[1, 2, 2]], "last_factors": [[98, 4096, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 45.13876653383619/171.94881637755526
Best record value:726.198572938805 (larger is better)
Round 2, Match 1, Mapping 18: 171.94881637755526/726.198572938805(1.377033826923077 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 4, 2], [1, 2, 1, 4], [14, 1, 2, 2], [2, 28, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 780.1789001697924/780.1789001697924
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 19: 780.1789001697924/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 4, 7, 4], [2, 1, 1, 4], [14, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 4, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 554.4404731534576/554.4404731534576
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 20: 554.4404731534576/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[224, 2, 2, 1], [1, 1, 1, 8], [4, 2, 7, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4096, 56, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*Y
iteration=1: 349.4453864909655/698.5495303580655
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 21: 698.5495303580655/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[896, 7, 8, 1], [1, 1, 1, 8]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 177.57981952955393/177.57981952955393
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 22: 177.57981952955393/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 2, 1, 2], [4, 1, 2, 1], [2, 4, 7, 1], [4, 7, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[896, 512, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 382.07545427042623/382.07545427042623
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 23: 382.07545427042623/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 8, 2, 1], [4, 1, 1, 2], [2, 28, 1, 1], [56, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[16384, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 20.315045910756414/20.719106834079334
Best record value:780.1789001697924 (larger is better)
Round 2, Match 1, Mapping 24: 20.719106834079334/780.1789001697924(1.2817572992327366 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 2, 1, 1], [8, 1, 1, 1], [14, 1, 1, 4], [2, 2, 1, 14]], "reduce_factors": [[2, 2, 1]], "last_factors": [[4, 200704, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711474686056984, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245, 0.1008870719422892, 0.03711427964755245, 0.08259830859853981, 0.03711427964755245, 0.03711427964755245, 0.03711427964755245]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 5 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 5 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 5 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 4 schedules
mapping (1,0,1,0,0,0,0): explored 5 schedules
mapping (1,1,0,0,0,0,0): explored 6 schedules
mapping (1,1,1,0,0,0,0): explored 2 schedules
Tensorize use time 1091.3861215114594 s.
#############################################
operations:inputs:[128, 64, 56, 56],body:S[128, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[128, 64, 56, 56],[64, 64, 1, 1],body:R[128, 64, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 64, 56, 56] [64, 64, 1, 1] [128, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph68/at:resnet50:subgraph68:transform.log...
[Warning] Too few trials, expect at least 240 trials.
Increase trials to 240.
Num rounds: 2
Num matching: 1
Num mapping: 24
Initial trials per matching: 120
Original weights [0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664, 0.041666666666666664]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 944.0515681922019/944.0515681922019
Best record value:944.0515681922019 (larger is better)
Round 1, Match 1, Mapping 2: 944.0515681922019/944.0515681922019(1.0592641691331923 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [32, 2, 1, 2], [7, 8, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[112, 1792, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 1204.8740380192999/1204.8740380192999
Best record value:1204.8740380192999 (larger is better)
Round 1, Match 1, Mapping 3: 1204.8740380192999/1204.8740380192999(0.8299622769230769 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 2, 1, 7], [4, 1, 1, 2], [64, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[448, 256, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:1204.8740380192999 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/1204.8740380192999(0.8299622769230769 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1080.732758704729/1080.732758704729
Best record value:1204.8740380192999 (larger is better)
Round 1, Match 1, Mapping 5: 1080.732758704729/1204.8740380192999(0.8299622769230769 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [64, 1, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 896, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 2719.1818009830913/2719.1818009830913
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 6: 2719.1818009830913/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 2], [4, 8, 4, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[7168, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 2427.8697932737605/2427.8697932737605
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 7: 2427.8697932737605/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 2, 2], [8, 8, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 896, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 1543.948659921973/1543.948659921973
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 8: 1543.948659921973/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [4, 8, 2, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[16384, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*E
iteration=1: 1079.2876873949224/1079.2876873949224
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 9: 1079.2876873949224/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 2, 2], [1, 1, 4, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[28, 2048, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:2719.1818009830913 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/2719.1818009830913(0.367757683446712 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 3663.6943965956025/3663.6943965956025
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 12: 3663.6943965956025/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 8, 2, 4], [2, 1, 4, 1]], "reduce_factors": [[1, 1, 4]], "last_factors": [[98, 512, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 44.37509389395452/44.37509389395452
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 13: 44.37509389395452/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 28, 2, 1], [1, 2, 4, 1], [1, 14, 1, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[8, 100352, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 156.66316200467946/156.66316200467946
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 14: 156.66316200467946/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 14, 4, 2], [2, 2, 1, 2], [1, 28, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[14336, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 2147.7989874927603/2147.7989874927603
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 15: 2147.7989874927603/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 8, 1], [1, 1, 4, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[196, 128, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.E
*Y*E
iteration=1: 270.6927737701886/270.6927737701886
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 16: 270.6927737701886/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[256, 7, 7, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[8, 12544, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 1443.3306986884045/1443.3306986884045
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 17: 1443.3306986884045/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 8, 1, 1], [2, 2, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[7168, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 1415.409225174323/1415.409225174323
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 18: 1415.409225174323/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 2, 2, 1], [8, 7, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*E
iteration=1: 1801.400396672366/1801.400396672366
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 19: 1801.400396672366/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 4, 1, 1], [1, 2, 1, 4], [1, 7, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 512, 7]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 545.283030076821/545.283030076821
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 20: 545.283030076821/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 14, 2, 2], [2, 2, 1, 2], [1, 28, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 196, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 42.72300762727875/42.72300762727875
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 21: 42.72300762727875/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 3136, 1, 4], [1, 4, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 384.619428296951/384.619428296951
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 22: 384.619428296951/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [2, 1, 4, 1], [2, 14, 1, 2], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[112, 512, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 23: 1e-10/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3663.6943965956025 (larger is better)
Round 1, Match 1, Mapping 24: 1e-10/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, None
New weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 0 schedules
Original weights [0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.10569453459566182, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775, 0.03888284632192775]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 2361.41135591984/2361.41135591984
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 1: 2361.41135591984/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [4, 4, 4, 2], [4, 14, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8192, 98, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/944.0515681922019
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 2: 944.0515681922019/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [32, 2, 1, 2], [7, 8, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[112, 1792, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2094.925709576101/2094.925709576101
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 3: 2094.925709576101/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 1, 7], [4, 1, 1, 2], [64, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[448, 256, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1280.206744062829/1280.206744062829
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 4: 1280.206744062829/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 7, 1, 2], [4, 1, 2, 1], [4, 4, 2, 4]], "reduce_factors": [[2, 1, 2]], "last_factors": [[896, 448, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 78.67302287837153/1080.732758704729
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 5: 1080.732758704729/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [64, 1, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 896, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.E.E.Y
*Y
iteration=1: 3262.065375034203/3262.065375034203
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 6: 3262.065375034203/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 2, 2, 2], [8, 8, 2, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[512, 49, 32]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.E.Y
*Y*E
iteration=1: 1823.4533370380757/2427.8697932737605
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 7: 2427.8697932737605/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 2, 2], [8, 8, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 896, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1605.881790915274/1605.881790915274
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 8: 1605.881790915274/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [4, 8, 2, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[16384, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1079.2876873949224
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 9: 1079.2876873949224/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 2, 2], [1, 1, 4, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[28, 2048, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 1809.2595569078162/1809.2595569078162
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 11: 1809.2595569078162/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 224, 4, 1], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[256, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/3663.6943965956025
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 12: 3663.6943965956025/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 8, 2, 4], [2, 1, 4, 1]], "reduce_factors": [[1, 1, 4]], "last_factors": [[98, 512, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 298.08873343852906/298.08873343852906
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 13: 298.08873343852906/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 4, 1, 14], [2, 2, 1, 2], [7, 4, 2, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[14, 3584, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 1903.0274349930178/1903.0274349930178
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 14: 1903.0274349930178/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 4, 1, 2], [1, 8, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[224, 448, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/2147.7989874927603
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 15: 2147.7989874927603/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 8, 1], [1, 1, 4, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[196, 128, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/270.6927737701886
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 16: 270.6927737701886/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[256, 7, 7, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[8, 12544, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1443.3306986884045
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 17: 1443.3306986884045/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 8, 1, 1], [2, 2, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[7168, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1415.409225174323
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 18: 1415.409225174323/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 2, 2, 1], [8, 7, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28672, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 323.85252948232386/1801.400396672366
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 19: 1801.400396672366/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 4, 1, 1], [1, 2, 1, 4], [1, 7, 2, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 512, 7]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 1044.609401340404/1044.609401340404
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 20: 1044.609401340404/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 4, 2, 1], [4, 1, 1, 2], [7, 2, 4, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[25088, 16, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 59.81539517329879/59.81539517329879
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 21: 59.81539517329879/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 3136, 1, 4], [1, 1, 1, 8]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7168, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/384.619428296951
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 22: 384.619428296951/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [2, 1, 4, 1], [2, 14, 1, 2], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[112, 512, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 23: 1e-10/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 140.62351411482155/140.62351411482155
Best record value:3663.6943965956025 (larger is better)
Round 2, Match 1, Mapping 24: 140.62351411482155/3663.6943965956025(0.27294853002183406 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [4, 2, 1, 1], [4, 7, 1, 2], [7, 4, 2, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[196, 256, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.20825200966118518, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905, 0.034423825666905]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 6 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 5 schedules
mapping (1,0,1,0,0,0,0): explored 1 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Tensorize use time 690.9391345977783 s.
#############################################
operations:inputs:[128, 64, 112, 112],[64],[64],body:S[128, 64, 112, 112] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 64, 112, 112],body:S[128, 64, 112, 112] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 64, 112, 112],body:S[128, 64, 114, 114] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 113)) && (v3 >= 1)) && (v3 < 113)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[128, 64, 114, 114],body:R[128, 64, 56, 56] [3, 3] { comm_reducer(result=[(v6 + v7)], lhs=[v6], rhs=[v7], identity_element=[0h]) } { (T0[n, c, ((i*2) + r), ((j*2) + s)]/9h) }$tensors:[128, 64, 112, 112] [64] [64] [128, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph69.log by 200 trials...
.Y.Y.Y.T.Y.Y.Y.Y.Y.Y.B.B.B.N.N.N.N.N.N.Y.Y.Y.E.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 8.9857986951
.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 7.0460682101000005
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.E.Y.Y.Y.N.N.N.B.N.N

Currently best performance: 5.9685640451
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 5.6315169701
.N.N.N.N.N.B.Y.Y.Y.Y.E.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 5.5909493001
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 5.5909493001
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 5.1540027650999996
.N.N.N.N.N.N.N.N.Y.Y.T.T.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N

Currently best performance: 3.0647936251
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.E.E.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 2.25879839638483
.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 2.25879839638483
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 2.25879839638483
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 2.25879839638483
.N.N.N.N.N.N.N.NSchedule cost 2214.449454 seconds
#############################################
operations:inputs:[128, 3, 224, 224],body:S[128, 3, 230, 230] [ ] { } { tir.if_then_else(((((v2 >= 3) && (v2 < 227)) && (v3 >= 3)) && (v3 < 227)), T0[b, c, (h - 3), (w - 3)], 0h) }$inputs:[128, 3, 230, 230],[64, 3, 7, 7],body:R[128, 64, 112, 112] [3, 7, 7] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[128, 3, 224, 224] [64, 3, 7, 7] [128, 64, 112, 112] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph70/at:resnet50:subgraph70:transform.log...
[Warning] Too few trials, expect at least 220 trials.
Increase trials to 220.
Num rounds: 2
Num matching: 1
Num mapping: 22
Initial trials per matching: 110
Original weights [0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.E.E
*E*Y
iteration=1: 190.42861469789727/190.42861469789727
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 1: 190.42861469789727/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 2], [64, 2, 1, 1], [1, 56, 2, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[784, 4096, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 6.668564119006255/6.668564119006255
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 3: 6.668564119006255/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 98, 2, 1], [1, 2, 4, 1], [2, 4, 1, 16]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[32768, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 56.27310210259117/56.27310210259117
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 5: 56.27310210259117/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 98, 1, 1], [1, 1, 2, 4], [1, 8, 4, 4]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[56, 14336, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 41.017691729672734/41.017691729672734
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 8: 41.017691729672734/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 112, 2, 1], [4, 1, 2, 1], [14, 8, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 7, 1]], "last_factors": [[196, 8192, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 41.91177567197519/41.91177567197519
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 11: 41.91177567197519/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[12544, 1, 2, 2], [1, 4, 1, 2]], "reduce_factors": [[2, 1, 1], [1, 1, 7]], "last_factors": [[4, 28672, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 11.645800264737746/11.645800264737746
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 14: 11.645800264737746/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 14, 1, 8], [4, 1, 1, 2], [8, 14, 1, 1]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[448, 256, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 28.119530586098758/28.119530586098758
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 15: 28.119530586098758/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[16, 7, 1, 4], [4, 2, 1, 1], [28, 2, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 3, 1]], "last_factors": [[112, 4096, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*T*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 1, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 21: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 145.61715056665568/145.61715056665568
Best record value:190.42861469789727 (larger is better)
Round 1, Match 1, Mapping 22: 145.61715056665568/190.42861469789727(5.251311635 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 1, 2, 4], [2, 56, 1, 1], [28, 2, 2, 1]], "reduce_factors": [[2, 5, 1]], "last_factors": [[3136, 64, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.11460702963725806, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,0,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,0,1): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,0,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,0,1,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (0,1,1,0,0,0,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 0 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Original weights [0.11460702963725806, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343, 0.04216157001727343]
Original trials for each mapping [13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:32x8x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/190.42861469789727
Best record value:190.42861469789727 (larger is better)
Round 2, Match 1, Mapping 1: 190.42861469789727/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 2], [64, 2, 1, 1], [1, 56, 2, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[784, 4096, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:190.42861469789727 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*T*E
iteration=1: 9.537825395471106/9.537825395471106
Best record value:190.42861469789727 (larger is better)
Round 2, Match 1, Mapping 3: 9.537825395471106/190.42861469789727(5.251311635 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 98, 2, 1], [1, 2, 4, 1], [2, 4, 1, 16]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[32768, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 335.15345904360885/335.15345904360885
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 4: 335.15345904360885/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 98, 1, 4], [2, 1, 2, 2], [64, 2, 1, 1]], "reduce_factors": [[5, 1, 2]], "last_factors": [[32768, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/56.27310210259117
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 5: 56.27310210259117/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 98, 1, 1], [1, 1, 2, 4], [1, 8, 4, 4]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[56, 14336, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 30.660777556481793/30.660777556481793
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 6: 30.660777556481793/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 2], [2, 8, 1, 8], [14, 8, 1, 1]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[896, 3584, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 7: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 114.67616441112287/114.67616441112287
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 8: 114.67616441112287/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 112, 2, 1], [4, 1, 2, 1], [14, 8, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 7, 1]], "last_factors": [[196, 8192, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 34.89673459412196/34.89673459412196
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 9: 34.89673459412196/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 2, 2, 2], [4, 1, 1, 2], [1, 16, 1, 7]], "reduce_factors": [[10, 1, 1]], "last_factors": [[64, 50176, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 267.6452039399312/267.6452039399312
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 10: 267.6452039399312/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[896, 28, 1, 2], [1, 1, 2, 4]], "reduce_factors": [[1, 4, 1], [3, 1, 1]], "last_factors": [[1792, 1792, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 106.73692085104446/106.73692085104446
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 11: 106.73692085104446/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[64, 49, 2, 8], [2, 1, 4, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[784, 2048, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/11.645800264737746
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 14: 11.645800264737746/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 14, 1, 8], [4, 1, 1, 2], [8, 14, 1, 1]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[448, 256, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/28.119530586098758
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 15: 28.119530586098758/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[16, 7, 1, 4], [4, 2, 1, 1], [28, 2, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 3, 1]], "last_factors": [[112, 4096, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 2.6678083368543315/2.6678083368543315
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 17: 2.6678083368543315/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 784, 4, 8], [4, 1, 1, 2]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[1, 458752, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 18: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[0, 1, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 20: 1e-10/335.15345904360885(2.98370783 ms), {"vmap": [[1, 0, 1, 0, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 44.27140361299789/44.27140361299789
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 21: 44.27140361299789/335.15345904360885(2.98370783 ms), {"vmap": [[1, 1, 0, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [4, 1, 2, 1], [4, 14, 2, 1], [7, 4, 1, 4]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[64, 25088, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}
.E.E.E.E.E

iteration=1: 1e-10/145.61715056665568
Best record value:335.15345904360885 (larger is better)
Round 2, Match 1, Mapping 22: 145.61715056665568/335.15345904360885(2.98370783 ms), {"vmap": [[1, 1, 1, 0, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 1, 2, 4], [2, 56, 1, 1], [28, 2, 2, 1]], "reduce_factors": [[2, 5, 1]], "last_factors": [[3136, 64, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.08922212726484514, 0.04009008602024778, 0.04009008602024778, 0.10897615233019954, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778, 0.04009008602024778]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,0,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,0,1): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 4 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,0,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,0,1,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (0,1,1,0,0,0,0): explored 0 schedules
mapping (1,0,1,0,0,0,0): explored 0 schedules
mapping (1,1,0,0,0,0,0): explored 1 schedules
mapping (1,1,1,0,0,0,0): explored 1 schedules
Tensorize use time 1470.6957070827484 s.
Query subgraph task id: 0, perf=0.000062 ms after 200 tuning
Query subgraph task id: 1, perf=0.085696 ms after 200 tuning
Query subgraph task id: 2, perf=0.000397 ms after 200 tuning
Query subgraph task id: 3, perf=0.002300 ms after 200 tuning
Query subgraph task id: 4, perf=0.000963 ms after 200 tuning
Query subgraph task id: 5, perf=0.620519 ms after 200 tuning
Query subgraph task id: 6, perf=0.590459 ms after 200 tuning
Query subgraph task id: 7, perf=0.000499 ms after 200 tuning
Query subgraph task id: 8, perf=0.003531 ms after 200 tuning
Query subgraph task id: 9, perf=0.000512 ms after 200 tuning
Query subgraph task id: 10, perf=1.512051 ms after 200 tuning
Query subgraph task id: 11, perf=0.000280 ms after 200 tuning
Query subgraph task id: 12, perf=0.001241 ms after 200 tuning
Query subgraph task id: 13, perf=0.000486 ms after 200 tuning
Query subgraph task id: 14, perf=1.487993 ms after 200 tuning
Query subgraph task id: 15, perf=0.000827 ms after 200 tuning
Query subgraph task id: 16, perf=0.001943 ms after 200 tuning
Query subgraph task id: 17, perf=0.000841 ms after 200 tuning
Query subgraph task id: 18, perf=2.691220 ms after 200 tuning
Query subgraph task id: 19, perf=0.000476 ms after 200 tuning
Query subgraph task id: 20, perf=0.002782 ms after 200 tuning
Query subgraph task id: 21, perf=0.000705 ms after 200 tuning
Query subgraph task id: 22, perf=2.640254 ms after 200 tuning
Query subgraph task id: 23, perf=0.000710 ms after 200 tuning
Query subgraph task id: 24, perf=0.001695 ms after 200 tuning
Query subgraph task id: 25, perf=0.001282 ms after 200 tuning
Query subgraph task id: 26, perf=4.976288 ms after 200 tuning
Query subgraph task id: 27, perf=0.001130 ms after 200 tuning
Query subgraph task id: 28, perf=0.002044 ms after 200 tuning
Query subgraph task id: 29, perf=0.000729 ms after 200 tuning
Query subgraph task id: 30, perf=4.974630 ms after 200 tuning
Query subgraph task id: 31, perf=0.001282 ms after 200 tuning
Query subgraph task id: 32, perf=0.000273 ms after 200 tuning
Query subgraph task id: 33, perf=2.258798 ms after 200 tuning
Query subgraph task id: 34, perf=0.002984 ms after 200 tuning
[NOTICE] totally 71 subgraphs, mapped 54 subgraphs, ratio= 76.05633802816901 %
.GYWhole graph cost is 96.208380 ms
#############################################
operations:inputs:[128, 2048],[1000, 2048],body:R[128, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[128, 2048] [1000, 2048] [128, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 3213.6815627213127/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 1733.383023113519/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=3: 8094.8916889209095/16243.36604546209
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=4: 12532.6488838003/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=5: 1e-10/16243.36604546209
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=6: 6063.535195624359/16243.36604546209
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=7: 11599.12960507725/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=8: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=9: 2183.9017113195805/16243.36604546209
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=10: 3143.2030429243514/16243.36604546209
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=11: 10387.152383903569/16243.36604546209
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=12: 1253.357250827916/16243.36604546209
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=13: 14836.701202578355/16243.36604546209
.Y.Y.Y.E.E
*E*E*E
iteration=14: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=15: 11735.50803854141/16243.36604546209
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=16: 12324.701659037712/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=17: 8769.300564186247/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=18: 50.97065364081438/16243.36604546209
.E.Y.Y.E.Y
*E*Y*E
iteration=19: 13890.330455612264/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=20: 1281.2544687747272/16243.36604546209
Best record value:16243.36604546209 (larger is better)
Round 1, Match 1, Mapping 1: 16243.36604546209/16243.36604546209(0.06156359446688515 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 1, 2], [16, 1, 2, 1]], "reduce_factors": [[8, 4, 4]], "last_factors": [[125, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 105 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/16243.36604546209
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=3: 16658.693661046414/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=4: 13146.390107004525/16658.693661046414
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=5: 481.6651915458919/16658.693661046414
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=6: 2575.8176939268947/16658.693661046414
.Y.E.Y.Y.E
*E*Y*Y
iteration=7: 608.3771056265952/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=8: 7263.563240752153/16658.693661046414
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=9: 16524.376221585917/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=10: 1e-10/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=11: 1161.3420602372455/16658.693661046414
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=12: 11526.208437984687/16658.693661046414
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=13: 5327.505474348863/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=14: 594.6977514408054/16658.693661046414
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=15: 4062.3470983269717/16658.693661046414
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=16: 11750.147881990593/16658.693661046414
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=17: 1314.840768007205/16658.693661046414
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=18: 1e-10/16658.693661046414
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=19: 498.6363969529377/16658.693661046414
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=20: 865.1181487360312/16658.693661046414
Best record value:16658.693661046414 (larger is better)
Round 2, Match 1, Mapping 1: 16658.693661046414/16658.693661046414(0.06002871655766945 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 1, 1, 2], [16, 1, 2, 1]], "reduce_factors": [[32, 1, 4]], "last_factors": [[125, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 134 schedules
Tensorize use time 546.9318771362305 s.
#############################################
operations:inputs:[128, 2048, 7, 7],[2048],[2048],body:S[128, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[128, 2048, 7, 7],[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[128, 2048, 7, 7],body:S[128, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[128, 2048, 7, 7],body:R[128, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[128, 2048, 7, 7] [2048] [2048] [128, 2048, 7, 7] [128, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.08569573099983022
.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N

Currently best performance: 0.08569573099983022
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y
Time taken:  131460.5184
