fc_model/latest.pth.tar does not exist. Failed to load checkpoint.
Batch 1
Dtype float16
Trials 200
Logging to devnull...
Totally 1 different mappings for this matching
Logging to devnull...
Totally 1 different mappings for this matching
Query subgraph task id: 0, perf=0.000091 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph1.log...
Query subgraph task id: 1, perf=0.120348 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 2, perf=0.000743 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 3, perf=0.001101 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 4, perf=0.000773 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph5.log...
Query subgraph task id: 5, perf=0.719794 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph9.log...
Query subgraph task id: 6, perf=0.713952 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 7, perf=0.001196 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 8, perf=0.001372 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 9, perf=0.000694 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph14.log...
Query subgraph task id: 10, perf=1.945372 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 11, perf=0.000879 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 12, perf=0.001260 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 13, perf=0.000592 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph34.log...
Query subgraph task id: 14, perf=1.978764 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 15, perf=0.001308 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 16, perf=0.005256 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 17, perf=0.001655 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph39.log...
Query subgraph task id: 18, perf=3.904154 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 19, perf=0.001191 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 20, perf=0.002666 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 21, perf=0.000980 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph51.log...
Query subgraph task id: 22, perf=4.012507 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 23, perf=0.002400 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 24, perf=0.002347 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 25, perf=0.002043 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph56.log...
Query subgraph task id: 26, perf=7.943377 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 27, perf=0.002311 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 28, perf=0.002997 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 29, perf=0.002208 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph64.log...
Query subgraph task id: 30, perf=7.915796 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 31, perf=0.001924 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 32, perf=0.000554 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph69.log...
Query subgraph task id: 33, perf=4.070046 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 34, perf=0.006411 ms after 0 tuning
#############################################
operations:inputs:[1, 2048],[1000, 2048],body:R[1, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[1, 2048] [1000, 2048] [1, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 29313.204507817783/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=3: 18333.049648616154/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=4: 15542.503812945024/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=5: 21334.093505716817/29313.204507817783
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=6: 16681.95761430463/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=7: 5768.405327452244/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=8: 21275.518488879967/29313.204507817783
.Y.E.Y.Y.Y
*E*E*E*E
iteration=9: 1e-10/29313.204507817783
.Y.Y.Y.Y.E
*E*E*E*E
iteration=10: 1e-10/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=11: 9588.439529990184/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=12: 18782.331479673776/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=13: 28073.70260090068/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=14: 3728.8763698794146/29313.204507817783
.E.E.Y.Y.Y
*Y*Y*Y
iteration=15: 17990.72757331349/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=16: 1e-10/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=17: 730.563937068375/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=18: 23590.82375530341/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=19: 7851.6406144089015/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=20: 5814.7161437450395/29313.204507817783
Best record value:29313.204507817783 (larger is better)
Round 1, Match 1, Mapping 1: 29313.204507817783/29313.204507817783(0.034114318676189144 ms), {"vmap": [[1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[2, 1, 4, 2], [0, 0, -1]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[8, 16, 1], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 609 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 6918.625974718671/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 2587.25732261103/29313.204507817783
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=3: 24175.569006100573/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=4: 20797.77614028268/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=5: 5380.300172225595/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=6: 13951.278249429699/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=7: 28198.004515600758/29313.204507817783
.E.Y.E.Y.Y
*E*E*Y
iteration=8: 1306.4535894279331/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=9: 19704.168534865905/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=10: 1310.3685178576814/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=11: 10785.985867964924/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=12: 1843.003844731778/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=13: 4318.810072811119/29313.204507817783
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=14: 10345.2091531204/29313.204507817783
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=15: 1510.6660859256097/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=16: 27960.591539871686/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=17: 7018.1933687962955/29313.204507817783
.Y.Y.E.E.Y
*E*Y*Y
iteration=18: 662.4773561559235/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=19: 2428.5012553072897/29313.204507817783
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=20: 13487.657137937107/29313.204507817783
Best record value:29313.204507817783 (larger is better)
Round 2, Match 1, Mapping 1: 29313.204507817783/29313.204507817783(0.034114318676189144 ms), {"vmap": [[1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[2, 1, 4, 2], [0, 0, -1]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[8, 16, 1], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 656 schedules
Tensorize use time 718.3923165798187 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 2048, 7, 7],body:R[1, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.Y.T.E.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.B.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.01714934481969827
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.B.N.B.N.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006635298026563738
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006635298026563738
.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006207547292391024
.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006207547292391024
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.006207547292391024
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006207547292391024
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006207547292391024
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.Y.N.N.N

Currently best performance: 0.006207547292391024
.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006207547292391024
.Y.Y.Y.Y.Y.Y.T.Y.E.E.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.006207547292391024
.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004153150587521339
.N.N.N.N.N.N.N.NSchedule cost 1382.741623 seconds
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 7, 7],[2048, 512, 1, 1],body:R[1, 2048, 7, 7] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [2048, 512, 1, 1] [1, 2048, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph2/at:resnet50:subgraph2:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 12892.262359502693/12892.262359502693
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/12892.262359502693
.Y.Y.Y
*Y*Y*Y
iteration=3: 5656.756260314557/12892.262359502693
Best record value:12892.262359502693 (larger is better)
Round 1, Match 1, Mapping 1: 12892.262359502693/12892.262359502693(0.07756590520072026 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [8, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[784, 1, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 1166.2254590401674/1166.2254590401674
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 4755.424610249449/4755.424610249449
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/4755.424610249449
Best record value:12892.262359502693 (larger is better)
Round 1, Match 1, Mapping 2: 4755.424610249449/12892.262359502693(0.07756590520072026 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 4, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 7494.1877098418645/7494.1877098418645
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 12524.584988293986/12524.584988293986
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/12524.584988293986
Best record value:12892.262359502693 (larger is better)
Round 1, Match 1, Mapping 3: 12524.584988293986/12892.262359502693(0.07756590520072026 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 13398.344033266312/13398.344033266312
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=2: 1031.1250718163126/13398.344033266312
.Y.Y.Y
*E*Y*Y
iteration=3: 24211.11742069991/24211.11742069991
Best record value:24211.11742069991 (larger is better)
Round 1, Match 1, Mapping 4: 24211.11742069991/24211.11742069991(0.041303339396678344 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 25295.5390611969/25295.5390611969
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=2: 9855.034252591337/25295.5390611969
.Y.Y.Y
*Y*Y*Y
iteration=3: 4900.138576957855/25295.5390611969
Best record value:25295.5390611969 (larger is better)
Round 1, Match 1, Mapping 5: 25295.5390611969/25295.5390611969(0.039532662165479994 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [32, 1, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[16, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 26647.658053540385/26647.658053540385
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 12149.313912467696/26647.658053540385
.Y.Y.Y
*E*Y*Y
iteration=3: 800.2762689388072/26647.658053540385
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 6: 26647.658053540385/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 17967.723544397068/17967.723544397068
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=2: 15640.307350506782/17967.723544397068
.Y.Y.Y
*Y*Y*Y
iteration=3: 8199.76852083157/17967.723544397068
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 7: 17967.723544397068/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [16, 2, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[32, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 21231.599231001903/21231.599231001903
.E.Y.Y.E.Y
*E*E*E
iteration=2: 1e-10/21231.599231001903
.Y.Y.Y
*E*Y*E
iteration=3: 5677.262101489834/21231.599231001903
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 8: 21231.599231001903/26647.658053540385(0.0375267499301741 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 7, 1], [[16, 1, 2, 2], [0, -1, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 2, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 21 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,1): explored 13 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 37 schedules
mapping (0,0,1,0,1,1,1): explored 21 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 30 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 11, 11, 11, 11, 28, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 5684.682597846395/12892.262359502693
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=2: 5439.186125442613/12892.262359502693
.E.E.E

iteration=3: 1e-10/12892.262359502693
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 1: 12892.262359502693/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [8, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[784, 1, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 2497.9274851651053/4755.424610249449
.E.E.Y.Y.E
*E*E
iteration=2: 1e-10/4755.424610249449
.E.Y.Y
*Y*E
iteration=3: 4616.912378923858/4755.424610249449
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 2: 4755.424610249449/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 4, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 1394.488369030018/12524.584988293986
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=2: 9384.099218701036/12524.584988293986
.Y.Y.E
*E*E
iteration=3: 1e-10/12524.584988293986
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 3: 12524.584988293986/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/24211.11742069991
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=2: 18902.91638730942/24211.11742069991
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/24211.11742069991
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 4: 24211.11742069991/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 1041.5140871219971/25295.5390611969
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 2550.6866504563177/25295.5390611969
.Y.Y.Y
*Y*E*Y
iteration=3: 21912.89512221605/25295.5390611969
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 5: 25295.5390611969/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [32, 1, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[16, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 3785.5167106525846/26647.658053540385
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=2: 857.7009505557753/26647.658053540385
.Y.Y.E
*E*E
iteration=3: 1e-10/26647.658053540385
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 6: 26647.658053540385/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 24465.544377091195/24465.544377091195
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 8811.432076191852/24465.544377091195
.Y.E.Y
*Y*Y
iteration=3: 16799.739944531004/24465.544377091195
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 7: 24465.544377091195/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 11912.11404392848/21231.599231001903
.E.E.Y.Y.Y
*Y*Y*E
iteration=2: 9738.096985019025/21231.599231001903
.Y.Y.E
*E*Y
iteration=3: 9450.43618703032/21231.599231001903
Best record value:26647.658053540385 (larger is better)
Round 2, Match 1, Mapping 8: 21231.599231001903/26647.658053540385(0.0375267499301741 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 7, 1], [[16, 1, 2, 2], [0, -1, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 2, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.46358704178872595, 0.07663042260161057, 0.07663042260161057]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 36 schedules
mapping (0,0,0,1,0,0,1): explored 20 schedules
mapping (0,0,0,1,0,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 41 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 38 schedules
mapping (1,0,0,1,0,1,0): explored 35 schedules
Tensorize use time 788.0461394786835 s.
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 9, 9] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 8)) && (v3 >= 1)) && (v3 < 8)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 9, 9],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph3/at:resnet50:subgraph3:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 479.4657026589615/647.5180103697758
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/647.5180103697758
.Y.Y.Y
*E*Y*Y
iteration=3: 266.7460396182155/647.5180103697758
Best record value:647.5180103697758 (larger is better)
Round 1, Match 1, Mapping 1: 647.5180103697758/647.5180103697758(1.5443585876923078 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[16, 1, 1, 1], [0, 0, 0]], [[32, 1, 2, 2], [0, -1, 1]]], "reduce_factors": [[[4, 4, 6], [-1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 8, 7], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 465.15379747952795/1115.4355066164305
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/1115.4355066164305
.Y.Y.Y
*E*E*Y
iteration=3: 466.77456114885416/1115.4355066164305
Best record value:1115.4355066164305 (larger is better)
Round 1, Match 1, Mapping 2: 1115.4355066164305/1115.4355066164305(0.8965108193779905 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[8, 1, 2, 1], [0, -1, 1]], [[4, 1, 2, 16], [1, 0, -1]]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[12544, 8, 1], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 94.93598483868145/116.76599741834349
.E.E.Y.Y.E
*E*E
iteration=2: 1e-10/116.76599741834349
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/116.76599741834349
Best record value:1115.4355066164305 (larger is better)
Round 1, Match 1, Mapping 3: 116.76599741834349/1115.4355066164305(0.8965108193779905 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[1, 7, 1, 1], [0, 0, 0]], [[4, 2, 1, 2], [1, -1, 0]], [[32, 2, 1, 2], [0, 1, 0]]], "reduce_factors": [[[16, 3, 2], [1, -1]], [[1, 3, 1], [0, 0]]], "last_factors": [[[49, 128, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1031.9196526720036
.E.Y.E.Y.E
*E*E
iteration=2: 1e-10/1031.9196526720036
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1031.9196526720036
Best record value:1115.4355066164305 (larger is better)
Round 1, Match 1, Mapping 4: 1031.9196526720036/1115.4355066164305(0.8965108193779905 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[2, 2, 4, 1], [1, 1, 1]], [[8, 1, 1, 16], [1, 0, 0]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 32, 14], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1989.148782695498/1989.148782695498
.Y.Y.E.E.Y
*E*E*Y
iteration=2: 2130.9960943033916/2130.9960943033916
.Y.Y.E
*E*E
iteration=3: 1e-10/2130.9960943033916
Best record value:2130.9960943033916 (larger is better)
Round 1, Match 1, Mapping 5: 2130.9960943033916/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 14, 1, 7], [-1, 0, 0]], [[4, 1, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 3], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 8], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1857.8225206972422/1857.8225206972422
.E.Y.E.Y.Y
*Y*Y*Y
iteration=2: 988.8261822379367/1857.8225206972422
.Y.Y.Y
*Y*Y*Y
iteration=3: 265.099750408585/1857.8225206972422
Best record value:2130.9960943033916 (larger is better)
Round 1, Match 1, Mapping 6: 1857.8225206972422/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 2]], "reduce_factors": [[32, 3, 3]], "last_factors": [[14, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 1639.6969865114438/1639.6969865114438
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=2: 1669.9189187568186/1669.9189187568186
.Y.Y.Y
*Y*Y*Y
iteration=3: 1191.3591702850222/1669.9189187568186
Best record value:2130.9960943033916 (larger is better)
Round 1, Match 1, Mapping 7: 1669.9189187568186/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 150.14366691955965/360.0784474827411
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=2: 93.17656563140159/360.0784474827411
.Y.E.Y
*E*E
iteration=3: 1e-10/360.0784474827411
Best record value:2130.9960943033916 (larger is better)
Round 1, Match 1, Mapping 8: 360.0784474827411/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[49, 16, 1, 1], [0, 0, 0]], [[4, 1, 2, 2], [1, 0, 1]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 448, 1], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 11 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 13 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 21 schedules
mapping (0,1,0,1,0,0,1): explored 18 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 11, 11, 11, 28, 11, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 553.062703896711/647.5180103697758
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 723.7653506187254/723.7653506187254
.Y.Y.Y
*Y*Y*Y
iteration=3: 1080.8999724216665/1080.8999724216665
Best record value:2130.9960943033916 (larger is better)
Round 2, Match 1, Mapping 1: 1080.8999724216665/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[2, 2, 1, 4], [0, 0, 0]], [[1, 32, 1, 4], [0, -1, -1]]], "reduce_factors": [[[96, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[14, 896, 8], [0, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1115.4355066164305
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/1115.4355066164305
.E.Y.E
*E
iteration=3: 1e-10/1115.4355066164305
Best record value:2130.9960943033916 (larger is better)
Round 2, Match 1, Mapping 2: 1115.4355066164305/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[8, 1, 2, 1], [0, -1, 1]], [[4, 1, 2, 16], [1, 0, -1]]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[12544, 8, 1], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*T
iteration=1: 1e-10/116.76599741834349
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 354.55787507849266/354.55787507849266
.Y.Y.Y
*Y*Y*Y
iteration=3: 326.45731098601584/354.55787507849266
Best record value:2130.9960943033916 (larger is better)
Round 2, Match 1, Mapping 3: 354.55787507849266/2130.9960943033916(0.4692641167542324 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[1, 16, 1, 1], [0, 0, 0]], [[16, 4, 2, 1], [0, 1, 1]]], "reduce_factors": [[[32, 1, 3], [0, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2, 12544, 4], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 4235.778179976768/4235.778179976768
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 4839.582074390659/4839.582074390659
.Y.Y.Y
*Y*E*Y
iteration=3: 1264.014140248623/4839.582074390659
Best record value:4839.582074390659 (larger is better)
Round 2, Match 1, Mapping 4: 4839.582074390659/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[2, 1, 8, 1], [-1, 0, 1]], [[8, 1, 1, 16], [1, 0, 0]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 32, 14], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 73.19638312984607/2130.9960943033916
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/2130.9960943033916
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2130.9960943033916
Best record value:4839.582074390659 (larger is better)
Round 2, Match 1, Mapping 5: 2130.9960943033916/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 14, 1, 7], [-1, 0, 0]], [[4, 1, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 3], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 8], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1857.8225206972422
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=2: 1744.9887231952694/1857.8225206972422
.Y.Y.Y
*E*Y*Y
iteration=3: 823.9431148980669/1857.8225206972422
Best record value:4839.582074390659 (larger is better)
Round 2, Match 1, Mapping 6: 1857.8225206972422/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 2]], "reduce_factors": [[32, 3, 3]], "last_factors": [[14, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1669.9189187568186
.Y.Y.E.Y.E
*E*E*E
iteration=2: 1e-10/1669.9189187568186
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1669.9189187568186
Best record value:4839.582074390659 (larger is better)
Round 2, Match 1, Mapping 7: 1669.9189187568186/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 1312.3217506924368/1312.3217506924368
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=2: 1153.3156225096027/1312.3217506924368
.E.E.Y
*Y
iteration=3: 220.95819795261372/1312.3217506924368
Best record value:4839.582074390659 (larger is better)
Round 2, Match 1, Mapping 8: 1312.3217506924368/4839.582074390659(0.20662941233947515 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1]], "reduce_factors": [[4, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[196, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.09137574887758486, 0.09137574887758486, 0.09137574887758486, 0.24838503773577592, 0.20336046899871474, 0.09137574887758486, 0.09137574887758486, 0.09137574887758486]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 20 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 25 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,1,0,1,0,0,1): explored 18 schedules
mapping (1,0,0,1,0,1,0): explored 20 schedules
Tensorize use time 973.3857936859131 s.
#############################################
operations:inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 2048, 7, 7],[512, 2048, 1, 1],body:R[1, 512, 7, 7] [2048, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 2048, 7, 7] [512, 2048, 1, 1] [1, 512, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph4/at:resnet50:subgraph4:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1508.0244402403287
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=2: 5505.159919146333/5505.159919146333
.E.Y.Y
*Y*Y
iteration=3: 13315.014269188905/13315.014269188905
Best record value:13315.014269188905 (larger is better)
Round 1, Match 1, Mapping 1: 13315.014269188905/13315.014269188905(0.07510318650683022 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[4, 2, 2, 1], [-1, 1, 0]], [[2, 16, 4, 1], [-1, 1, 1]]], "reduce_factors": [[[16, 2, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[448, 8, 28], [-1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1591.1988401640294
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/1591.1988401640294
.E.Y.E
*E
iteration=3: 1e-10/1591.1988401640294
Best record value:13315.014269188905 (larger is better)
Round 1, Match 1, Mapping 2: 1591.1988401640294/13315.014269188905(0.07510318650683022 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[1, 1, 1, 7], [0, -1, 0]], [[16, 1, 1, 1], [1, 0, -1]], [[32, 2, 2, 1], [0, 0, 0]]], "reduce_factors": [[[64, 2, 1], [1, 1]]], "last_factors": [[[256, 196, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 2582.972813163216/2582.972813163216
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 3539.3668526808/3539.3668526808
.E.Y.Y
*E*E
iteration=3: 1e-10/3539.3668526808
Best record value:13315.014269188905 (larger is better)
Round 1, Match 1, Mapping 3: 3539.3668526808/13315.014269188905(0.07510318650683022 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[2, 4, 2, 1], [1, -1, 1]], [1, 1, 1, 1]], "reduce_factors": [[[64, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[32, 112, 28], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 6839.832709151469/6839.832709151469
.E.Y.Y.E.Y
*E*Y*Y
iteration=2: 6059.278831785296/6839.832709151469
.Y.Y.Y
*Y*Y*Y
iteration=3: 11705.885603337349/11705.885603337349
Best record value:13315.014269188905 (larger is better)
Round 1, Match 1, Mapping 4: 11705.885603337349/13315.014269188905(0.07510318650683022 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[7, 1, 1, 1], [[8, 1, 2, 1], [1, 0, 0]], [[4, 8, 2, 2], [1, 0, 0]]], "reduce_factors": [[[128, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 64, 1], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 4575.057268032053/4575.057268032053
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 7659.64870925589/7659.64870925589
.Y.Y.Y
*E*E*Y
iteration=3: 13497.704808853781/13497.704808853781
Best record value:13497.704808853781 (larger is better)
Round 1, Match 1, Mapping 5: 13497.704808853781/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/2652.715526953497
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/2652.715526953497
.Y.Y.Y
*Y*E*Y
iteration=3: 8527.479157776252/8527.479157776252
Best record value:13497.704808853781 (larger is better)
Round 1, Match 1, Mapping 6: 8527.479157776252/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[64, 2, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/818.1877101375292
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 8164.807999601224/8164.807999601224
.E.Y.Y
*E*Y
iteration=3: 3509.3063832447497/8164.807999601224
Best record value:13497.704808853781 (larger is better)
Round 1, Match 1, Mapping 7: 8164.807999601224/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[1, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 5692.138456990515/5692.138456990515
.Y.E.Y.E.Y
*E*E*E
iteration=2: 1e-10/5692.138456990515
.Y.Y.Y
*Y*Y*Y
iteration=3: 3584.807071241794/5692.138456990515
Best record value:13497.704808853781 (larger is better)
Round 1, Match 1, Mapping 8: 5692.138456990515/13497.704808853781(0.07408666985694137 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[7, 1, 7, 16], [-1, 0, 0]], [8, 1, 2, 1]], "reduce_factors": [[[128, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 128, 8], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 19 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 11, 11, 11, 28, 11, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 12865.540512848715/13315.014269188905
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=2: 2845.8192498531885/13315.014269188905
.E.Y.Y
*E*Y
iteration=3: 5761.020223931041/13315.014269188905
Best record value:13497.704808853781 (larger is better)
Round 2, Match 1, Mapping 1: 13315.014269188905/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[4, 2, 2, 1], [-1, 1, 0]], [[2, 16, 4, 1], [-1, 1, 1]]], "reduce_factors": [[[16, 2, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[448, 8, 28], [-1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 9195.470203021361/9195.470203021361
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/9195.470203021361
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/9195.470203021361
Best record value:13497.704808853781 (larger is better)
Round 2, Match 1, Mapping 2: 9195.470203021361/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [[16, 1, 1, 1], [1, 0, -1]], [[2, 16, 2, 2], [1, 0, 0]]], "reduce_factors": [[[8, 8, 2], [-1, 0]]], "last_factors": [[[256, 196, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 5034.094707621807/5034.094707621807
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=2: 4693.97214457409/5034.094707621807
.Y.E.Y
*E*E
iteration=3: 1e-10/5034.094707621807
Best record value:13497.704808853781 (larger is better)
Round 2, Match 1, Mapping 3: 5034.094707621807/13497.704808853781(0.07408666985694137 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 5848.012607242243/11705.885603337349
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 1994.5634171370637/11705.885603337349
.Y.Y.Y
*Y*Y*Y
iteration=3: 15996.95987375775/15996.95987375775
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 4: 15996.95987375775/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/13497.704808853781
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 9452.757592098564/13497.704808853781
.E.Y.Y
*E*Y
iteration=3: 2787.899591008331/13497.704808853781
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 5: 13497.704808853781/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4352.118601289789/8527.479157776252
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/8527.479157776252
.Y.E.E
*E
iteration=3: 1e-10/8527.479157776252
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 6: 8527.479157776252/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[64, 2, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 5679.16732342987/8164.807999601224
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/8164.807999601224
.Y.Y.Y
*Y*Y*Y
iteration=3: 8565.297037945887/8565.297037945887
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 7: 8565.297037945887/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3346.4907369433313/5692.138456990515
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/5692.138456990515
.Y.Y.E
*E*E
iteration=3: 1e-10/5692.138456990515
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 8: 5692.138456990515/15996.95987375775(0.06251187775 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[7, 1, 7, 16], [-1, 0, 0]], [8, 1, 2, 1]], "reduce_factors": [[[128, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 128, 8], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.09137574887758486, 0.09137574887758486, 0.09137574887758486, 0.24838503773577592, 0.20336046899871474, 0.09137574887758486, 0.09137574887758486, 0.09137574887758486]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 28 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 26 schedules
mapping (0,0,0,1,0,1,0): explored 34 schedules
mapping (0,0,1,0,1,1,0): explored 36 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 32 schedules
Tensorize use time 954.4026570320129 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048, 7, 7] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph5.log by 200 trials...
.Y.Y.Y.Y.Y.Y.E.T.Y.Y.B.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.E.N.N.N.N.N.N

Currently best performance: 0.01241547470706964
.N.B.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.T.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.010066543318101822
.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.007518083554404802
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.B.N

Currently best performance: 0.007145572369067695
.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.B.N.N.N.N

Currently best performance: 0.004401163575234299
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003087076970378128
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N

Currently best performance: 0.003087076970378128
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003087076970378128
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.T.Y.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.E.Y.Y.N.N.N

Currently best performance: 0.003087076970378128
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003087076970378128
.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0030598024708628907
.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.E.E.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.0030598024708628907
.N.N.N.N.N.N.NSchedule cost 1296.109928 seconds
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph9.log by 200 trials...
.Y.Y.Y.T.Y.Y.Y.Y.Y.E.B.B.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.02515565437044595
.B.B.N.N.T.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.E.Y.E.E.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.005126542822702075
.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.005126542822702075
.N.N.E.Y.E.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.Y.T.E.Y.Y.E.Y.Y.Y.E.N.B

Currently best performance: 0.0042894729235357035
.N.N.N.N.Y.E.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0042894729235357035
.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.B.N.N.N

Currently best performance: 0.003952260250586167
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.B.N.N.N.N.N.N.N.T.Y.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.0038904868795235884
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.0038904868795235884
.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.E.Y.Y.E.E.Y.Y.Y.Y.E.N.N

Currently best performance: 0.0038904868795235884
.N.N.N.N.Y.Y.Y.Y.E.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0038904868795235884
.Y.E.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.E.T.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0038904868795235884
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.0038904868795235884
.N.N.N.N.N.N.NSchedule cost 1802.566907 seconds
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[2048, 1024, 1, 1],body:R[1, 2048, 7, 7] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [2048, 1024, 1, 1] [1, 2048, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph10/at:resnet50:subgraph10:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 2357.1291269678213/2357.1291269678213
.Y.E.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/2357.1291269678213
.E.Y.Y
*E*Y
iteration=3: 3688.6917664759308/3688.6917664759308
Best record value:3688.6917664759308 (larger is better)
Round 1, Match 1, Mapping 1: 3688.6917664759308/3688.6917664759308(0.2710988240026818 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [1, -1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, 0]], [[2, 4, 8, 1], [1, 0, -1]], [[16, 1, 4, 2], [0, -1, 0]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 14, 8], [1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 2439.347762316616/2439.347762316616
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 14875.299843832068/14875.299843832068
.Y.E.E
*Y
iteration=3: 2141.231280840328/14875.299843832068
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 2: 14875.299843832068/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 761.6263339345503/1001.7346072377698
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/1001.7346072377698
.E.Y.Y
*E*Y
iteration=3: 2099.393624150215/2099.393624150215
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 3: 2099.393624150215/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 4, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[1, 784, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 11292.024386264278/11292.024386264278
.E.Y.E.Y.Y
*E*Y*Y
iteration=2: 1312.9944379577123/11292.024386264278
.Y.E.Y
*E*Y
iteration=3: 2263.4769082622593/11292.024386264278
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 4: 11292.024386264278/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": 4, "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[8, 1, 2, 4], [0, 0, 1]], [[32, 4, 1, 1], [1, 1, 0]]], "reduce_factors": [[[16, 1, 4], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[896, 112, 4], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2297.579285661844/2297.579285661844
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=2: 2159.994535213826/2297.579285661844
.Y.Y.Y
*E*E*Y
iteration=3: 2018.5325680347455/2297.579285661844
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 5: 2297.579285661844/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[1, 1, 7, 1], [[16, 2, 2, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 4], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[56, 1024, 7], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/835.8535083141329
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=2: 724.0308162048269/835.8535083141329
.Y.E.Y
*E*Y
iteration=3: 208.68689893803725/835.8535083141329
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 6: 835.8535083141329/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[98, 1, 2, 4], [0, 0, 0]], [[4, 4, 2, 2], [0, 0, 1]]], "reduce_factors": [[[16, 4, 1], [0, 0]]], "last_factors": [[[56, 1024, 7], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 5437.996845961829/5437.996845961829
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/5437.996845961829
.Y.Y.Y
*Y*Y*Y
iteration=3: 4467.348068676457/5437.996845961829
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 7: 5437.996845961829/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 4, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[14, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 4790.59193350507/4790.59193350507
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=2: 314.3602073707915/4790.59193350507
.E.Y.Y
*E*E
iteration=3: 1e-10/4790.59193350507
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 8: 4790.59193350507/14875.299843832068(0.0672255356529598 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 4, 1, 2]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 30 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,1): explored 15 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,1,0,1,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,1): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Original weights [0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 28, 11, 11, 11, 11, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 150.7209479187676/3688.6917664759308
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 1122.05421476227/3688.6917664759308
.Y.E.Y
*Y*E
iteration=3: 5351.689694935078/5351.689694935078
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 1: 5351.689694935078/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 8181.82127668199/14875.299843832068
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=2: 1747.4145710329485/14875.299843832068
.Y.Y.Y
*Y*E*E
iteration=3: 533.5871150744678/14875.299843832068
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 2: 14875.299843832068/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*Y*Y*E
iteration=1: 5319.948106355873/5319.948106355873
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=2: 637.2854150998012/5319.948106355873
.Y.E.Y
*E*E
iteration=3: 1e-10/5319.948106355873
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 3: 5319.948106355873/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[32, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2371.9228271188967/11292.024386264278
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=2: 339.838498074786/11292.024386264278
.Y.E.E
*Y
iteration=3: 5445.470541854713/11292.024386264278
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 4: 11292.024386264278/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": 4, "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[8, 1, 2, 4], [0, 0, 1]], [[32, 4, 1, 1], [1, 1, 0]]], "reduce_factors": [[[16, 1, 4], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[896, 112, 4], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 1484.6563182079724/2297.579285661844
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 8059.233339344995/8059.233339344995
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/8059.233339344995
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 5: 8059.233339344995/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 4, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/835.8535083141329
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=2: 4146.20726490843/4146.20726490843
.Y.Y.Y
*E*Y*E
iteration=3: 1219.2048955273817/4146.20726490843
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 6: 4146.20726490843/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 2, 2]], "reduce_factors": [[32, 2, 1]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 3429.9509412992293/5437.996845961829
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=2: 1033.3819631825154/5437.996845961829
.Y.Y.Y
*E*Y*E
iteration=3: 6981.732909397034/6981.732909397034
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 7: 6981.732909397034/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [32, 2, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[49, 32, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 140.55969899466558/4790.59193350507
.Y.E.E.E.Y
*E*E
iteration=2: 1e-10/4790.59193350507
.E.Y.Y
*Y*Y
iteration=3: 310.66189366768776/4790.59193350507
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 8: 4790.59193350507/14875.299843832068(0.0672255356529598 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 4, 1, 2]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.07663042260161056, 0.4635870417887259, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 37 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 20 schedules
mapping (0,0,1,0,1,1,0): explored 25 schedules
mapping (0,0,1,0,1,1,1): explored 20 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Tensorize use time 764.5554010868073 s.
#############################################
operations:inputs:[1, 512, 14, 14],[512],[512],body:S[1, 512, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 14, 14],body:S[1, 512, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 14, 14],body:S[1, 512, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 16, 16],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 14, 14] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph12/at:resnet50:subgraph12:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 258.3552003990823/258.3552003990823
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=2: 1089.4393374759975/1089.4393374759975
.E.Y.Y
*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:1089.4393374759975 (larger is better)
Round 1, Match 1, Mapping 1: 1089.4393374759975/1089.4393374759975(0.917903333944954 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 251.69882517471663/251.69882517471663
.Y.E.Y.E.Y
*E*E*E
iteration=2: 1e-10/251.69882517471663
.E.Y.E
*E
iteration=3: 1e-10/251.69882517471663
Best record value:1089.4393374759975 (larger is better)
Round 1, Match 1, Mapping 2: 251.69882517471663/1089.4393374759975(0.917903333944954 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[24, 3, 4]], "last_factors": [[14, 28, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/208.87811443587188
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/208.87811443587188
.Y.Y.E
*E*E
iteration=3: 1e-10/208.87811443587188
Best record value:1089.4393374759975 (larger is better)
Round 1, Match 1, Mapping 3: 208.87811443587188/1089.4393374759975(0.917903333944954 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [[4, 4, 1, 1], [1, 1, -1]], [[4, 16, 1, 2], [0, 0, 0]]], "reduce_factors": [[[8, 4, 3], [0, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[3584, 7, 4], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/394.90660440047867
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 2787.8951447291565/2787.8951447291565
.Y.E.Y
*E*E
iteration=3: 1e-10/2787.8951447291565
Best record value:2787.8951447291565 (larger is better)
Round 1, Match 1, Mapping 4: 2787.8951447291565/2787.8951447291565(0.35869354767184036 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[1, 4, 2, 2], [0, 1, 1]], [[4, 4, 4, 2], [-1, 1, -1]]], "reduce_factors": [[[16, 1, 2], [0, 0]], [[1, 3, 1], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 14, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 348.0169915259116/728.9537360800465
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=2: 5834.146424501155/5834.146424501155
.Y.Y.E
*E*E
iteration=3: 1e-10/5834.146424501155
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 5: 5834.146424501155/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1821.2367997916267/1821.2367997916267
.Y.Y.E.E.Y
*E*E*Y
iteration=2: 1659.8221334601783/1821.2367997916267
.Y.Y.Y
*Y*Y*Y
iteration=3: 907.8785530859537/1821.2367997916267
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 6: 1821.2367997916267/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 7, 4, 7], [-1, 1, -1]], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 1084.6684003303242/1084.6684003303242
.E.E.E.Y.E
*E
iteration=2: 1e-10/1084.6684003303242
.Y.Y.Y
*Y*Y*Y
iteration=3: 4842.098140199478/4842.098140199478
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 7: 4842.098140199478/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[16, 2, 3], [1, 3, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 423.13844195465913/423.13844195465913
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/423.13844195465913
.E.E.Y
*Y
iteration=3: 5802.828372136154/5802.828372136154
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 8: 5802.828372136154/5834.146424501155(0.1714046798346348 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.1028988475176344, 0.1028988475176344, 0.1028988475176344, 0.1028988475176344, 0.2797080673765567, 0.1028988475176344, 0.1028988475176344, 0.10289884751763698]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 10 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 9 schedules
mapping (0,0,0,1,0,1,0): explored 9 schedules
mapping (0,0,1,0,1,1,0): explored 12 schedules
mapping (0,0,1,0,1,1,1): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 14 schedules
mapping (1,0,0,1,0,1,0): explored 7 schedules
Original weights [0.1028988475176344, 0.1028988475176344, 0.1028988475176344, 0.1028988475176344, 0.2797080673765567, 0.1028988475176344, 0.1028988475176344, 0.10289884751763698]
Original trials for each mapping [11, 11, 11, 11, 28, 11, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 247.71586311758946/1089.4393374759975
.Y.E.Y.Y.E
*E*E*Y
iteration=2: 999.5210071838195/1089.4393374759975
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 1: 1089.4393374759975/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/251.69882517471663
.Y.Y.E.E.Y
*E*Y*Y
iteration=2: 2075.696244723331/2075.696244723331
.Y.Y.Y
*E*Y*Y
iteration=3: 952.2339469282011/2075.696244723331
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 2: 2075.696244723331/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[96, 3, 1]], "last_factors": [[1, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*T*E*E
iteration=1: 1e-10/208.87811443587188
.E.Y.Y.Y.E
*Y*E*E
iteration=2: 1256.9411699307452/1256.9411699307452
.E.Y.Y
*E*Y
iteration=3: 77.1807055244197/1256.9411699307452
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 3: 1256.9411699307452/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 6], [3, 1, 1]], "last_factors": [[1, 392, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 3925.6131871493685/3925.6131871493685
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=2: 2296.2991738263045/3925.6131871493685
.Y.E.Y
*Y*E
iteration=3: 396.9466860905912/3925.6131871493685
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 4: 3925.6131871493685/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 2065.4684227848384/5834.146424501155
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=2: 3346.091090823247/5834.146424501155
.E.E.E

iteration=3: 1e-10/5834.146424501155
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 5: 5834.146424501155/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 662.9687335718046/1821.2367997916267
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=2: 706.6357421839815/1821.2367997916267
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1821.2367997916267
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 6: 1821.2367997916267/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 7, 4, 7], [-1, 1, -1]], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 232.98903840278288/4842.098140199478
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/4842.098140199478
.Y.Y.E
*E*Y
iteration=3: 77.47884120350173/4842.098140199478
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 7: 4842.098140199478/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[16, 2, 3], [1, 3, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 426.566218131672/5802.828372136154
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=2: 605.583629554347/5802.828372136154
.Y.Y.Y
*Y*Y*Y
iteration=3: 667.3004769176529/5802.828372136154
Best record value:5834.146424501155 (larger is better)
Round 2, Match 1, Mapping 8: 5802.828372136154/5834.146424501155(0.1714046798346348 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.0766304226016119, 0.0766304226016119, 0.0766304226016119, 0.0766304226016119, 0.4635870417887131, 0.0766304226016119, 0.0766304226016119, 0.07663042260161536]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 12 schedules
mapping (0,0,0,0,1,1,1): explored 9 schedules
mapping (0,0,0,1,0,0,1): explored 11 schedules
mapping (0,0,0,1,0,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,0): explored 17 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 18 schedules
mapping (1,0,0,1,0,1,0): explored 16 schedules
Tensorize use time 1019.8450803756714 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[512, 1024, 1, 1],body:R[1, 512, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [512, 1024, 1, 1] [1, 512, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph13/at:resnet50:subgraph13:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 3978.0711952929437/3978.0711952929437
Best record value:3978.0711952929437 (larger is better)
Round 1, Match 1, Mapping 1: 3978.0711952929437/3978.0711952929437(0.2513781053449347 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 16401.682335283098/16401.682335283098
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 2: 16401.682335283098/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/726.6045225905567
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 3: 726.6045225905567/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[1, 1, 5, 5], [0, 0, -1]], [[8, 1, 2, 1], [0, 0, 0]], [[16, 4, 2, 1], [1, 0, 1]]], "reduce_factors": [[[64, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[224, 112, 16], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/743.9340920506392
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 4: 743.9340920506392/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[1, 25, 1, 1], [0, 0, 0]], [[4, 1, 2, 2], [-1, 0, 1]], [[32, 1, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 2], [0, 0]]], "last_factors": [[[3584, 8, 14], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 8682.203436042348/8682.203436042348
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 5: 8682.203436042348/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[64, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/486.05606645289924
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 6: 486.05606645289924/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[25, 1, 1, 1], [0, 0, 0]], [[2, 2, 2, 2], [1, -1, -1]], [[2, 16, 2, 2], [1, 1, 0]]], "reduce_factors": [[[8, 2, 4], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[256, 1568, 1], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 11148.75698205737/11148.75698205737
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 7: 11148.75698205737/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 12730.280584749318/12730.280584749318
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 8: 12730.280584749318/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4615.056920938198/4615.056920938198
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 9: 4615.056920938198/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 2, 8, 1], [0, 1, 0]], [2, 2, 2, 2], [[14, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 98, 32], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1440.2796009206788
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 10: 1440.2796009206788/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[14, 1, 1, 16], [1, 0, 0]], [[4, 2, 2, 1], [0, 1, -1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[32, 1, 2], [0, 0]]], "last_factors": [[[25088, 8, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1529.62680471144/1529.62680471144
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 11: 1529.62680471144/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[5, 5, 1, 1], [[4, 4, 1, 1], [1, 0, 0]]], "reduce_factors": [[[64, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16, 784, 32], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 4536.539673846266/4536.539673846266
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 12: 4536.539673846266/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/820.0082949724741
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 13: 820.0082949724741/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[112, 2, 1, 1], [1, 1, 0]], [[2, 2, 1, 4], [1, -1, 0]], [[7, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[32, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/670.7075900431519
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 14: 670.7075900431519/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[28, 1, 8, 1], [0, 0, 0]], [[2, 4, 1, 2], [0, -1, 0]], [[2, 7, 1, 1], [1, 1, 0]]], "reduce_factors": [[[16, 2, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 28, 7], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 2207.4892338592163/2207.4892338592163
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 15: 2207.4892338592163/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[1, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 1739.3858228659458/1739.3858228659458
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 16: 1739.3858228659458/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[56, 28, 2, 1], [1, -1, 0]], [2, 2, 4, 1]], "reduce_factors": [[[8, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 256, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/667.7968176856506
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 17: 667.7968176856506/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[2, 7, 2, 8], [1, -1, -1]], [[4, 1, 2, 2], [1, -1, 1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[16, 2, 2], [0, 1]]], "last_factors": [[[32, 448, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 4465.463294111649/4465.463294111649
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 18: 4465.463294111649/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [2, 4, 2, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11904.041765600941/11904.041765600941
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 19: 11904.041765600941/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*E
iteration=1: 9858.460178843994/9858.460178843994
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 20: 9858.460178843994/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 18 schedules
mapping (0,0,0,0,0,1,1): explored 13 schedules
mapping (0,0,0,0,1,1,0): explored 16 schedules
mapping (0,0,0,0,1,1,1): explored 21 schedules
mapping (0,0,0,1,0,0,0): explored 14 schedules
mapping (0,0,0,1,0,0,1): explored 14 schedules
mapping (0,0,0,1,0,1,0): explored 18 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,1): explored 7 schedules
mapping (0,0,1,1,0,0,0): explored 17 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 17 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (0,1,0,1,1,0,0): explored 11 schedules
mapping (1,0,0,0,0,1,0): explored 18 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 13 schedules
Original weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/3978.0711952929437
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 1: 3978.0711952929437/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1213.1228442487288/16401.682335283098
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 2: 16401.682335283098/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 13226.63899024339/13226.63899024339
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 3: 13226.63899024339/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1663.5825372709319/1663.5825372709319
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 4: 1663.5825372709319/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2]], "last_factors": [[32, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 5697.062561125997/8682.203436042348
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 5: 8682.203436042348/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[64, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 1214.4608550188802/1214.4608550188802
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 6: 1214.4608550188802/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [-1, 1, 0]], [[1, 2, 2, 4], [0, 1, -1]], [[2, 8, 8, 1], [-1, 1, 0]]], "reduce_factors": [[[32, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1, 14336, 28], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 12429.991534877847/12429.991534877847
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 7: 12429.991534877847/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1560.670979996355/12730.280584749318
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 8: 12730.280584749318/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 4066.4053268252046/4615.056920938198
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 9: 4615.056920938198/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 2, 8, 1], [0, 1, 0]], [2, 2, 2, 2], [[14, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 98, 32], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1246.5579593146217/1440.2796009206788
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 10: 1440.2796009206788/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[14, 1, 1, 16], [1, 0, 0]], [[4, 2, 2, 1], [0, 1, -1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[32, 1, 2], [0, 0]]], "last_factors": [[[25088, 8, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 4166.1162685192385/4166.1162685192385
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 11: 4166.1162685192385/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [2, 2, 2, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 1298.5541326922785/4536.539673846266
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 12: 4536.539673846266/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/820.0082949724741
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 13: 820.0082949724741/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[112, 2, 1, 1], [1, 1, 0]], [[2, 2, 1, 4], [1, -1, 0]], [[7, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[32, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2984.600672384814/2984.600672384814
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 14: 2984.600672384814/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[4, 2, 1, 2], [0, 1, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 6715.773366217173/6715.773366217173
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 15: 6715.773366217173/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 1, 2, 8], [14, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 645.4604841088318/1739.3858228659458
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 16: 1739.3858228659458/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[56, 28, 2, 1], [1, -1, 0]], [2, 2, 4, 1]], "reduce_factors": [[[8, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 256, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/667.7968176856506
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 17: 667.7968176856506/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[2, 7, 2, 8], [1, -1, -1]], [[4, 1, 2, 2], [1, -1, 1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[16, 2, 2], [0, 1]]], "last_factors": [[[32, 448, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 5498.043243270321/5498.043243270321
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 18: 5498.043243270321/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 4], [2, 1, 1, 7]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 2728.2396646768016/11904.041765600941
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 19: 11904.041765600941/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/9858.460178843994
Best record value:16401.682335283098 (larger is better)
Round 2, Match 1, Mapping 20: 9858.460178843994/16401.682335283098(0.06096935543305898 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 18 schedules
mapping (0,0,0,0,0,1,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 20 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 18 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,0,1,0): explored 19 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 21 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 11 schedules
mapping (0,0,1,1,0,0,0): explored 17 schedules
mapping (0,1,0,0,0,1,0): explored 25 schedules
mapping (0,1,0,1,0,0,0): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 32 schedules
mapping (0,1,0,1,1,0,0): explored 11 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 21 schedules
mapping (1,0,0,1,0,1,0): explored 13 schedules
Tensorize use time 856.346764087677 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1, 1024, 14, 14] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph14.log by 200 trials...
.Y.E.Y.Y.Y.Y.Y.E.E.Y.B.N.B.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N

Currently best performance: 0.00412462358601515
.N.N.N.N.E.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004044147969699477
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N

Currently best performance: 0.004044147969699477
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.004044147969699477
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004044147969699477
.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.E.Y.N.N.B.N.N.N

Currently best performance: 0.004043426203832104
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.E.Y.Y.N.N

Currently best performance: 0.004043426203832104
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.004043426203832104
.N.N.Y.Y.Y.Y.Y.Y.E.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.004043426203832104
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004043426203832104
.E.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.004043426203832104
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B

Currently best performance: 0.004014523196694231
.N.N.N.N.N.N.N.NSchedule cost 925.921797 seconds
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 14, 14],[1024, 256, 1, 1],body:R[1, 1024, 14, 14] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [1024, 256, 1, 1] [1, 1024, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph15/at:resnet50:subgraph15:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 2555.146403998638/2555.146403998638
Best record value:2555.146403998638 (larger is better)
Round 1, Match 1, Mapping 1: 2555.146403998638/2555.146403998638(0.3913670067731011 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, 0]], [[1, 16, 2, 1], [0, 1, -1]], [[2, 16, 4, 1], [0, -1, 1]], [[7, 1, 1, 2], [0, -1, 0]]], "reduce_factors": [[[2, 2, 4], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[49, 512, 32], [-1, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 15385.034986008104/15385.034986008104
Best record value:15385.034986008104 (larger is better)
Round 1, Match 1, Mapping 2: 15385.034986008104/15385.034986008104(0.06499822723246639 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[1, 1, 1, 2], [0, -1, 0]], [[16, 2, 1, 1], [-1, 1, 0]], [[16, 2, 2, 2], [0, -1, 0]], [[2, 7, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[2, 8, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 8, 14], [0, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 3166.961912023882/3166.961912023882
Best record value:15385.034986008104 (larger is better)
Round 1, Match 1, Mapping 3: 3166.961912023882/15385.034986008104(0.06499822723246639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 25, 1, 1], [4, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 10711.938627233962/10711.938627233962
Best record value:15385.034986008104 (larger is better)
Round 1, Match 1, Mapping 4: 10711.938627233962/15385.034986008104(0.06499822723246639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [1, 8, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 27803.525468618962/27803.525468618962
Best record value:27803.525468618962 (larger is better)
Round 1, Match 1, Mapping 5: 27803.525468618962/27803.525468618962(0.0359666618943224 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, 0]], [32, 1, 1, 1], [[2, 16, 2, 2], [0, -1, 0]], [[1, 2, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[4, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8192, 7, 14], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 9268.546217573501/9268.546217573501
Best record value:27803.525468618962 (larger is better)
Round 1, Match 1, Mapping 6: 9268.546217573501/27803.525468618962(0.0359666618943224 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [4, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 11117.952938884968/11117.952938884968
Best record value:27803.525468618962 (larger is better)
Round 1, Match 1, Mapping 7: 11117.952938884968/27803.525468618962(0.0359666618943224 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [8, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 30058.69417756331/30058.69417756331
Best record value:30058.69417756331 (larger is better)
Round 1, Match 1, Mapping 8: 30058.69417756331/30058.69417756331(0.033268244924173365 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=1: 4075.7118556645028/4075.7118556645028
Best record value:30058.69417756331 (larger is better)
Round 1, Match 1, Mapping 9: 4075.7118556645028/30058.69417756331(0.033268244924173365 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [2, 4, 2, 2], [7, 2, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 46087.472006544514/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 17736.005721620604/17736.005721620604
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 11: 17736.005721620604/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[16, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 6978.744979858451/6978.744979858451
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 12: 6978.744979858451/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 4, 1, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[8, 784, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 6215.499753712524/6215.499753712524
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 13: 6215.499753712524/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 16], [14, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[7, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 13472.13732244338/13472.13732244338
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 14: 13472.13732244338/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[98, 32, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 6004.604083053354/6004.604083053354
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 15: 6004.604083053354/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[1, 8, 1, 28], [0, -1, 0]], [[2, 4, 2, 2], [0, 0, -1]], [[7, 2, 1, 1], [0, 1, 0]]], "reduce_factors": [[[8, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 8, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/771.5650611595103
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 16: 771.5650611595103/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[7, 28, 2, 8], [1, 0, 0]], [[4, 2, 4, 1], [-1, 0, 1]]], "reduce_factors": [[[4, 2, 2], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[224, 896, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 30667.450876959014/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 1625.785747451058/1625.785747451058
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 18: 1625.785747451058/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[56, 2, 2, 1], [-1, 1, 1]], [[1, 4, 2, 4], [0, -1, 0]], [[1, 2, 1, 7], [0, -1, -1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14, 28672, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 14680.318098638145/14680.318098638145
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 19: 14680.318098638145/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[2, 8, 2, 1], [1, 1, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[1, 8, 2], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 16, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 12776.071240927855/12776.071240927855
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 20: 12776.071240927855/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 1, 5], [8, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 18 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 16 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 20 schedules
mapping (0,0,0,1,1,0,0): explored 22 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 25 schedules
mapping (0,0,1,0,1,1,1): explored 16 schedules
mapping (0,0,1,1,0,0,0): explored 17 schedules
mapping (0,1,0,0,0,1,0): explored 21 schedules
mapping (0,1,0,1,0,0,0): explored 17 schedules
mapping (0,1,0,1,0,0,1): explored 15 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 14 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 6226.040207912518/6226.040207912518
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 1: 6226.040207912518/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 4], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 30246.044365331698/30246.044365331698
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 2: 30246.044365331698/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 25134.908618828045/25134.908618828045
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 3: 25134.908618828045/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 9124.452856648373/10711.938627233962
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 4: 10711.938627233962/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [1, 8, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 27151.71693676177/27803.525468618962
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 5: 27803.525468618962/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, 0]], [32, 1, 1, 1], [[2, 16, 2, 2], [0, -1, 0]], [[1, 2, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[4, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8192, 7, 14], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 8880.015060267982/9268.546217573501
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 6: 9268.546217573501/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [4, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 30339.865847604102/30339.865847604102
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 7: 30339.865847604102/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [8, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 9044.826596555977/30058.69417756331
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 8: 30058.69417756331/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 9403.537556677502/9403.537556677502
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 9: 9403.537556677502/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 41980.88505654869/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 7460.769976252435/17736.005721620604
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 11: 17736.005721620604/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[16, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 2038.8435312498916/6978.744979858451
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 12: 6978.744979858451/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 4, 1, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[8, 784, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 2626.83876430239/6215.499753712524
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 13: 6215.499753712524/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 16], [14, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[7, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 20568.877482174754/20568.877482174754
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 14: 20568.877482174754/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 4, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 4207.482218823187/6004.604083053354
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 15: 6004.604083053354/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[1, 8, 1, 28], [0, -1, 0]], [[2, 4, 2, 2], [0, 0, -1]], [[7, 2, 1, 1], [0, 1, 0]]], "reduce_factors": [[[8, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 8, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 39998.48586548887/39998.48586548887
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 16: 39998.48586548887/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 8061.207309240453/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 8575.891894803812/8575.891894803812
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 18: 8575.891894803812/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 2, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 40036.246843112414/40036.246843112414
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 19: 40036.246843112414/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 4], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 14524.11355550379/14524.11355550379
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 20: 14524.11355550379/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 19 schedules
mapping (0,0,0,0,1,1,0): explored 28 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 20 schedules
mapping (0,0,0,1,0,0,1): explored 25 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 31 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 17 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 23 schedules
mapping (0,1,0,1,0,0,0): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 21 schedules
mapping (1,0,0,1,0,0,0): explored 27 schedules
mapping (1,0,0,1,0,1,0): explored 17 schedules
Tensorize use time 652.7987034320831 s.
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 16, 16],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph16/at:resnet50:subgraph16:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 2814.965840110349/2814.965840110349
Best record value:2814.965840110349 (larger is better)
Round 1, Match 1, Mapping 1: 2814.965840110349/2814.965840110349(0.35524409772617316 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 3375.834536846011/3375.834536846011
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 2: 3375.834536846011/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 889.689361186647/889.689361186647
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 3: 889.689361186647/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[3, 16, 1], [3, 1, 1]], "last_factors": [[1, 1568, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/408.14488060603514
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 4: 408.14488060603514/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[1, 5, 1, 5], [0, -1, 0]], [[2, 2, 2, 1], [1, -1, 1]], [[16, 1, 2, 4], [-1, 0, 1]]], "reduce_factors": [[[36, 1, 4], [0, 0]]], "last_factors": [[[112, 448, 4], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/98.56450876138292
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 5: 98.56450876138292/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 1, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[4, 4, 2, 4], [-1, -1, 1]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[8, 784, 32], [1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 256.3599792883184/861.0278444578252
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 6: 861.0278444578252/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 1, 2, 4], [0, 0, 1]], [[16, 1, 4, 2], [0, 0, -1]]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 2335.885564532314/2335.885564532314
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 7: 2335.885564532314/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[25, 1, 1, 1], [1, 0, -1]], [[1, 2, 1, 4], [0, 0, 0]], [[4, 8, 1, 4], [1, 0, -1]]], "reduce_factors": [[[8, 1, 2], [0, -1]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[448, 112, 4], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/690.9293772927098
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 8: 690.9293772927098/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [[4, 1, 1, 2], [-1, 0, 0]], [[16, 4, 1, 2], [0, 0, 0]], [[7, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 1412.8117528125192/1412.8117528125192
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 9: 1412.8117528125192/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/843.8218056449293
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 10: 843.8218056449293/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[32, 1, 1, 7], [-1, -1, -1]], [[2, 2, 1, 2], [0, 1, -1]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[144, 1, 1], [1, 0]]], "last_factors": [[[1568, 16, 8], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 1035.9506680291886/1035.9506680291886
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 11: 1035.9506680291886/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[5, 5, 1, 1], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[8, 6, 1], [-1, 1]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[1, 14336, 14], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 275.67960481041945/275.67960481041945
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 12: 275.67960481041945/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": [8, -1], "spatial_factors": [[[112, 28, 1, 1], [-1, 1, 0]], [[1, 1, 2, 4], [0, 0, -1]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[56, 3584, 1], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.E.Y.E
*E*Y
iteration=1: 179.3321431937717/424.46111756916946
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 13: 424.46111756916946/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[16, 7, 2, 1], [0, 0, 0]], [[4, 1, 2, 1], [1, -1, 1]], [[1, 7, 1, 2], [0, -1, 0]]], "reduce_factors": [[[12, 4, 1], [0, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*Y*Y
iteration=1: 232.83051197759025/232.83051197759025
Best record value:3375.834536846011 (larger is better)
Round 1, Match 1, Mapping 14: 232.83051197759025/3375.834536846011(0.2962230491706161 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[48, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 11402.959042867305/11402.959042867305
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 15: 11402.959042867305/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 56, 2, 1], [1, -1, 1]], [[8, 1, 1, 1], [0, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 2529.6517782548126/2529.6517782548126
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 16: 2529.6517782548126/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [4, 1, 1, 2]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[98, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 4301.099135001353/4301.099135001353
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 17: 4301.099135001353/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/330.2783625177285
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 18: 330.2783625177285/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[14, 16, 1, 1], [-1, 1, 0]], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3186.2702489823528/3186.2702489823528
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 19: 3186.2702489823528/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[1, 28, 1, 8], [0, 1, 0]], [4, 1, 2, 1], [[7, 2, 1, 1], [0, 1, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]], [[1, 1, 3], [0, 0]]], "last_factors": [[[2, 14336, 7], [0, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 580.7420934269867/580.7420934269867
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 20: 580.7420934269867/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [1, 4, 2, 1]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 32, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 24 schedules
mapping (0,0,0,0,0,1,1): explored 12 schedules
mapping (0,0,0,0,1,1,0): explored 7 schedules
mapping (0,0,0,0,1,1,1): explored 9 schedules
mapping (0,0,0,1,0,0,0): explored 8 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 11 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 6 schedules
mapping (0,0,1,0,0,1,1): explored 15 schedules
mapping (0,0,1,0,1,1,0): explored 18 schedules
mapping (0,0,1,0,1,1,1): explored 14 schedules
mapping (0,0,1,1,0,0,0): explored 16 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 12 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (0,1,0,1,1,0,0): explored 22 schedules
mapping (1,0,0,0,0,1,0): explored 11 schedules
mapping (1,0,0,1,0,0,0): explored 15 schedules
mapping (1,0,0,1,0,1,0): explored 9 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/2814.965840110349
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 1: 2814.965840110349/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/3375.834536846011
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 2: 3375.834536846011/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3824.0954873500777/3824.0954873500777
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 3: 3824.0954873500777/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[25, 1, 1, 1], [[2, 2, 2, 1], [-1, 1, 0]], [[1, 8, 2, 8], [0, -1, 0]]], "reduce_factors": [[[24, 2, 1], [-1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[4096, 49, 1], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 10941.02996715534/10941.02996715534
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 4: 10941.02996715534/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[49, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/98.56450876138292
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 5: 98.56450876138292/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 1, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[4, 4, 2, 4], [-1, -1, 1]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[8, 784, 32], [1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/861.0278444578252
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 6: 861.0278444578252/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 1, 2, 4], [0, 0, 1]], [[16, 1, 4, 2], [0, 0, -1]]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 3812.5308352442935/3812.5308352442935
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 7: 3812.5308352442935/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[2, 28, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/690.9293772927098
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 8: 690.9293772927098/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [[4, 1, 1, 2], [-1, 0, 0]], [[16, 4, 1, 2], [0, 0, 0]], [[7, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1412.8117528125192
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 9: 1412.8117528125192/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 3662.8733060011023/3662.8733060011023
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 10: 3662.8733060011023/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 1, 1, 4], [7, 1, 1, 2]], "reduce_factors": [[16, 9, 1]], "last_factors": [[32, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 520.7563937929928/1035.9506680291886
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 11: 1035.9506680291886/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[5, 5, 1, 1], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[8, 6, 1], [-1, 1]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[1, 14336, 14], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/275.67960481041945
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 12: 275.67960481041945/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": [8, -1], "spatial_factors": [[[112, 28, 1, 1], [-1, 1, 0]], [[1, 1, 2, 4], [0, 0, -1]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[56, 3584, 1], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 696.3833627552414/696.3833627552414
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 13: 696.3833627552414/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[2, 1, 24], [3, 1, 1]], "last_factors": [[7, 28, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 170.01326414584614/232.83051197759025
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 14: 232.83051197759025/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[48, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2229.4952106033156/11402.959042867305
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 15: 11402.959042867305/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 56, 2, 1], [1, -1, 1]], [[8, 1, 1, 1], [0, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 9884.645285559383/9884.645285559383
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 16: 9884.645285559383/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 953.8666856100548/4301.099135001353
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 17: 4301.099135001353/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 5942.112726474381/5942.112726474381
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 18: 5942.112726474381/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 1, 1], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 11010.567165834947/11010.567165834947
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 19: 11010.567165834947/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 2, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2499.551095620533/2499.551095620533
Best record value:11402.959042867305 (larger is better)
Round 2, Match 1, Mapping 20: 2499.551095620533/11402.959042867305(0.08769653528006947 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 4, 2, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[3, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[128, 112, 14], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
New weights [0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.24150629157585723, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 24 schedules
mapping (0,0,0,0,0,1,1): explored 12 schedules
mapping (0,0,0,0,1,1,0): explored 11 schedules
mapping (0,0,0,0,1,1,1): explored 14 schedules
mapping (0,0,0,1,0,0,0): explored 8 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 6 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 20 schedules
mapping (0,0,1,0,1,1,1): explored 14 schedules
mapping (0,0,1,1,0,0,0): explored 18 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 16 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 14 schedules
mapping (1,0,0,1,0,0,0): explored 16 schedules
mapping (1,0,0,1,0,1,0): explored 13 schedules
Tensorize use time 1043.6193327903748 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[256, 1024, 1, 1],body:R[1, 256, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [256, 1024, 1, 1] [1, 256, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph17/at:resnet50:subgraph17:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 2127.728151902484/2127.728151902484
Best record value:2127.728151902484 (larger is better)
Round 1, Match 1, Mapping 1: 2127.728151902484/2127.728151902484(0.469984851732991 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[1, 2, 1, 1], [0, 1, 0]], [[2, 2, 2, 1], [0, 1, 0]], [[16, 4, 2, 1], [0, 1, -1]], [[2, 1, 7, 1], [-1, 0, 1]]], "reduce_factors": [[[32, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7, 1792, 16], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 19610.30288708449/19610.30288708449
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 2: 19610.30288708449/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 6498.40968257568/6498.40968257568
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 3: 6498.40968257568/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[1, 196, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 7828.9331717462655/7828.9331717462655
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 4: 7828.9331717462655/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4]], "last_factors": [[112, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/990.4696807625559
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 5: 990.4696807625559/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, 0]], [[4, 1, 2, 1], [1, 0, 1]], [[2, 16, 4, 1], [0, 1, -1]], [[7, 2, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[8, 2, 4], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[448, 32, 14], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 1179.1989017924761/1179.1989017924761
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 6: 1179.1989017924761/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[1, 5, 1, 5], [0, 0, 0]], [[2, 2, 1, 2], [0, 0, 0]], [1, 1, 1, 1]], "reduce_factors": [[[8, 2, 4], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 3136, 8], [0, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 7692.42762683031/7692.42762683031
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 7: 7692.42762683031/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 3126.192757543303/3126.192757543303
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 8: 3126.192757543303/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [1, 8, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[56, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 11537.18858953466/11537.18858953466
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 9: 11537.18858953466/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 5382.2820023082895/5382.2820023082895
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 10: 5382.2820023082895/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [1, 1, 1, 8], [2, 1, 7, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[16, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 631.354549332516/664.0629032216781
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 11: 664.0629032216781/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[56, 7, 2, 4], [0, 1, 0]], [[2, 4, 1, 1], [1, 1, 0]]], "reduce_factors": [[[32, 2, 1], [1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14, 448, 32], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 1397.1649955177486/1397.1649955177486
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 12: 1397.1649955177486/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[32, 1, 7, 14], [-1, -1, -1]], [[1, 2, 1, 4], [-1, 0, 0]]], "reduce_factors": [[[64, 1, 1], [1, 0]]], "last_factors": [[[32, 896, 7], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2413.5714896905774/2413.5714896905774
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 13: 2413.5714896905774/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[112, 1, 2, 1], [1, -1, 1]], [[2, 1, 2, 2], [-1, 0, 0]], [[1, 7, 2, 1], [0, 0, 0]]], "reduce_factors": [[[64, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[49, 512, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 2046.1048526711493/2046.1048526711493
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 14: 2046.1048526711493/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 2], [1, 14, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[8, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 696.6748790710224/1112.779968073044
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 15: 1112.779968073044/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[56, 1, 4, 1], [0, -1, 1]], [[1, 4, 1, 2], [0, 1, 0]], [[1, 7, 2, 1], [0, 0, 1]]], "reduce_factors": [[[16, 1, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[896, 8, 28], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 2339.153595984522/2339.153595984522
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 16: 2339.153595984522/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 25], [1, 2, 2, 2]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 5189.587392799871/5189.587392799871
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 17: 5189.587392799871/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [4, 1, 2, 1], [1, 14, 1, 1]], "reduce_factors": [[8, 4, 2]], "last_factors": [[2, 56, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 5640.409197403841/5640.409197403841
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 18: 5640.409197403841/19610.30288708449(0.0509936029931801 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5026.988992081869/5026.988992081869
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 19: 5026.988992081869/19610.30288708449(0.0509936029931801 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[7, 2, 8, 2], [1, 0, -1]], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 4076.7247365318585/4076.7247365318585
Best record value:19610.30288708449 (larger is better)
Round 1, Match 1, Mapping 20: 4076.7247365318585/19610.30288708449(0.0509936029931801 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [8, 1, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 22 schedules
mapping (0,0,0,0,0,1,1): explored 17 schedules
mapping (0,0,0,0,1,1,0): explored 20 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 31 schedules
mapping (0,0,0,1,0,0,1): explored 24 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 17 schedules
mapping (0,0,1,0,0,1,0): explored 17 schedules
mapping (0,0,1,0,0,1,1): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,1): explored 15 schedules
mapping (0,0,1,1,0,0,0): explored 16 schedules
mapping (0,1,0,0,0,1,0): explored 17 schedules
mapping (0,1,0,1,0,0,0): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 24 schedules
mapping (0,1,0,1,1,0,0): explored 16 schedules
mapping (1,0,0,0,0,1,0): explored 16 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Original weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 13290.165831064649/13290.165831064649
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 1: 13290.165831064649/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 12822.426448602771/19610.30288708449
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 2: 19610.30288708449/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 9266.982870527318/9266.982870527318
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 3: 9266.982870527318/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 7211.232262878461/7828.9331717462655
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 4: 7828.9331717462655/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4]], "last_factors": [[112, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3781.088192801963/3781.088192801963
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 5: 3781.088192801963/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 1, 1, 2], [0, -1, 0]], [[1, 2, 4, 1], [-1, 0, 1]], [[4, 2, 4, 4], [-1, 0, 1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7, 3584, 8], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 6170.813383582646/6170.813383582646
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 6: 6170.813383582646/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/7692.42762683031
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 7: 7692.42762683031/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 2662.7597313106303/3126.192757543303
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 8: 3126.192757543303/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [1, 8, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[56, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 905.1291793287597/11537.18858953466
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 9: 11537.18858953466/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 15333.986651025125/15333.986651025125
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 10: 15333.986651025125/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 3344.2505206772435/3344.2505206772435
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 11: 3344.2505206772435/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[4, 196, 4, 1], [0, 1, -1]], [[2, 1, 2, 2], [0, 0, 0]]], "reduce_factors": [[[16, 4, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 128, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 8349.947481551804/8349.947481551804
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 12: 8349.947481551804/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 1, 1, 8], [0, 0, -1]]], "reduce_factors": [[[64, 1, 1], [0, 0]]], "last_factors": [[[224, 32, 28], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2745.0925712192875/2745.0925712192875
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 13: 2745.0925712192875/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[7, 8, 2, 2], [1, 1, 1]], [[2, 1, 2, 2], [0, 0, 1]], [[1, 7, 2, 1], [0, -1, 1]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 3136, 8], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 4416.548397652983/4416.548397652983
Best record value:19610.30288708449 (larger is better)
Round 2, Match 1, Mapping 14: 4416.548397652983/19610.30288708449(0.0509936029931801 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [1, 4, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1]], "last_factors": [[4, 392, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 29582.76885314248/29582.76885314248
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 15: 29582.76885314248/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2440.896010392214/2440.896010392214
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 16: 2440.896010392214/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[5, 1, 1, 5], [[2, 1, 2, 2], [1, 0, 0]]], "reduce_factors": [[[16, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 1792, 14], [-1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 10040.6255638049/10040.6255638049
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 17: 10040.6255638049/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[4, 1, 16]], "last_factors": [[56, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 742.6173919691622/5640.409197403841
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 18: 5640.409197403841/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/5026.988992081869
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 19: 5026.988992081869/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[7, 2, 8, 2], [1, 0, -1]], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 393.55122786379377/4076.7247365318585
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 20: 4076.7247365318585/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [8, 1, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 19 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 36 schedules
mapping (0,0,0,1,0,0,1): explored 27 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 29 schedules
mapping (0,0,1,0,1,1,0): explored 17 schedules
mapping (0,0,1,0,1,1,1): explored 19 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 19 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 29 schedules
mapping (0,1,0,1,1,0,0): explored 17 schedules
mapping (1,0,0,0,0,1,0): explored 19 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Tensorize use time 815.7228050231934 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph34.log by 200 trials...
.Y.Y.E.Y.Y.E.Y.Y.Y.Y.B.N.B.B.N.N.B.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.005082100092552017
.N.N.N.N.E.Y.Y.Y.E.Y.T.Y.Y.Y.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N

Currently best performance: 0.005082100092552017
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.E.Y.N.N.N.N.N.N.N

Currently best performance: 0.005082100092552017
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.N.Y.Y.Y.Y.E.Y.T.Y.Y.Y.N.N.N.N

Currently best performance: 0.003924769799338103
.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N

Currently best performance: 0.003924769799338103
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003924769799338103
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.E.E.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.003924769799338103
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003924769799338103
.N.N.Y.Y.Y.T.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.T.E.N.N.N.N

Currently best performance: 0.003924769799338103
.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003924769799338103
.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.003924769799338103
.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N

Currently best performance: 0.003924769799338103
.N.N.N.B.N.N.NSchedule cost 1624.755105 seconds
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[1024, 512, 1, 1],body:R[1, 1024, 14, 14] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [1024, 512, 1, 1] [1, 1024, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph35/at:resnet50:subgraph35:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 7997.5401094535455/7997.5401094535455
Best record value:7997.5401094535455 (larger is better)
Round 1, Match 1, Mapping 1: 7997.5401094535455/7997.5401094535455(0.12503844761190297 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 4], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/371.08765325453896
Best record value:7997.5401094535455 (larger is better)
Round 1, Match 1, Mapping 2: 371.08765325453896/7997.5401094535455(0.12503844761190297 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[16, 1, 2, 1], [-1, 0, 1]], [[4, 16, 2, 1], [1, -1, 1]], [[1, 2, 1, 7], [0, -1, 0]]], "reduce_factors": [[[8, 1, 4], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[256, 3136, 1], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 22413.56872588828/22413.56872588828
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 3: 22413.56872588828/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4583.923078455872/4583.923078455872
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 4: 4583.923078455872/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[5, 1, 1, 5], [0, -1, 0]], [[4, 1, 8, 1], [0, -1, 1]], [1, 1, 1, 1]], "reduce_factors": [[[16, 2, 1], [1, 1]]], "last_factors": [[[56, 7168, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 779.7216175503291/779.7216175503291
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 5: 779.7216175503291/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 8, 2, 2], [1, 1, 1, 1], [1, 1, 14, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 224, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2470.556964266257/2470.556964266257
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 6: 2470.556964266257/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[5, 5, 1, 1], [-1, 1, 0]], [[8, 2, 1, 2], [1, 0, -1]], [[2, 64, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[8, 2, 2], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 16, 8], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1271.079532503583/1271.079532503583
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 7: 1271.079532503583/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 5, 5, 1], [[8, 4, 1, 1], [1, 1, 0]], [[16, 2, 2, 2], [0, 1, 0]]], "reduce_factors": [[[16, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4, 14336, 14], [-1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 4200.66323871106/4200.66323871106
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 8: 4200.66323871106/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 4, 2, 1], [1, 1, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[64, 98, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 3108.4962525038663/3108.4962525038663
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 9: 3108.4962525038663/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 2, 4, 1], [1, 1, 1, 14]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 12423.143439314239/12423.143439314239
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 10: 12423.143439314239/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 544.1901929830849/559.8905742927974
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 11: 559.8905742927974/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[112, 14, 1, 2], [1, -1, 0]], [[4, 4, 2, 1], [-1, 1, 0]]], "reduce_factors": [[[8, 1, 4], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 28, 14], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 940.7180402535166/940.7180402535166
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 12: 940.7180402535166/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[56, 1, 4, 14], [0, -1, 1]], [[2, 8, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[16, 2, 1], [-1, 1]]], "last_factors": [[[128, 6272, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 4599.166327174758/4599.166327174758
Best record value:22413.56872588828 (larger is better)
Round 1, Match 1, Mapping 13: 4599.166327174758/22413.56872588828(0.04461583125069114 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [4, 4, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 29179.869919232413/29179.869919232413
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 14: 29179.869919232413/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 4793.358236306063/4793.358236306063
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 15: 4793.358236306063/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 1533.3574680200306/1533.3574680200306
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 16: 1533.3574680200306/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 2, 4, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 7387.3592455758135/7387.3592455758135
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 17: 7387.3592455758135/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 2, 1, 2], [1, 1, 2, 7]], "reduce_factors": [[4, 8, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 1630.942680104966/1630.942680104966
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 18: 1630.942680104966/29179.869919232413(0.03427020075030908 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[2, 16, 1, 1], [1, 0, 0]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[1, 8, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 4], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 3240.027210358134/3240.027210358134
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 19: 3240.027210358134/29179.869919232413(0.03427020075030908 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 4, 2], [1, 2, 1, 7]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 1608.05579300791/1608.05579300791
Best record value:29179.869919232413 (larger is better)
Round 1, Match 1, Mapping 20: 1608.05579300791/29179.869919232413(0.03427020075030908 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[392, 4, 1, 2], [0, 1, 0]], [16, 1, 2, 1]], "reduce_factors": [[[4, 1, 8], [-1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2, 12544, 32], [0, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 13 schedules
mapping (0,0,0,0,0,1,1): explored 20 schedules
mapping (0,0,0,0,1,1,0): explored 21 schedules
mapping (0,0,0,0,1,1,1): explored 26 schedules
mapping (0,0,0,1,0,0,0): explored 12 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,0,1,0): explored 12 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 16 schedules
mapping (0,0,1,0,0,1,1): explored 25 schedules
mapping (0,0,1,0,1,1,0): explored 18 schedules
mapping (0,0,1,0,1,1,1): explored 20 schedules
mapping (0,0,1,1,0,0,0): explored 28 schedules
mapping (0,1,0,0,0,1,0): explored 21 schedules
mapping (0,1,0,1,0,0,0): explored 15 schedules
mapping (0,1,0,1,0,0,1): explored 18 schedules
mapping (0,1,0,1,1,0,0): explored 17 schedules
mapping (1,0,0,0,0,1,0): explored 17 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 10116.886530624432/10116.886530624432
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 1: 10116.886530624432/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 4, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 10630.75219864774/10630.75219864774
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 2: 10630.75219864774/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 64, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 5755.3861938784175/22413.56872588828
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 3: 22413.56872588828/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 4190.677622345241/4583.923078455872
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 4: 4583.923078455872/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[5, 1, 1, 5], [0, -1, 0]], [[4, 1, 8, 1], [0, -1, 1]], [1, 1, 1, 1]], "reduce_factors": [[[16, 2, 1], [1, 1]]], "last_factors": [[[56, 7168, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 780.4059942229957/780.4059942229957
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 5: 780.4059942229957/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 8, 2, 2], [1, 1, 1, 1], [1, 1, 14, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 224, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6262.7674857685715/6262.7674857685715
Best record value:29179.869919232413 (larger is better)
Round 2, Match 1, Mapping 6: 6262.7674857685715/29179.869919232413(0.03427020075030908 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 30869.59917949008/30869.59917949008
Best record value:30869.59917949008 (larger is better)
Round 2, Match 1, Mapping 7: 30869.59917949008/30869.59917949008(0.03239433055756698 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 5765.741496519166/5765.741496519166
Best record value:30869.59917949008 (larger is better)
Round 2, Match 1, Mapping 8: 5765.741496519166/30869.59917949008(0.03239433055756698 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 4, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 3806.3299326118026/3806.3299326118026
Best record value:30869.59917949008 (larger is better)
Round 2, Match 1, Mapping 9: 3806.3299326118026/30869.59917949008(0.03239433055756698 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 1, 1, 4], [2, 7, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 11471.946327852564/12423.143439314239
Best record value:30869.59917949008 (larger is better)
Round 2, Match 1, Mapping 10: 12423.143439314239/30869.59917949008(0.03239433055756698 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 5164.4170104058/5164.4170104058
Best record value:30869.59917949008 (larger is better)
Round 2, Match 1, Mapping 11: 5164.4170104058/30869.59917949008(0.03239433055756698 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 1, 1, 16]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 448, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 40411.1505641937/40411.1505641937
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 12: 40411.1505641937/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [16, 1, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[49, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/4599.166327174758
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 13: 4599.166327174758/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [4, 4, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 3272.710955563219/29179.869919232413
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 14: 29179.869919232413/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 4426.228259512922/4793.358236306063
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 15: 4793.358236306063/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 703.1388798765927/1533.3574680200306
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 16: 1533.3574680200306/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 2, 4, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1486.6752876479861/7387.3592455758135
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 17: 7387.3592455758135/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 2, 1, 2], [1, 1, 2, 7]], "reduce_factors": [[4, 8, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 2640.848030398963/2640.848030398963
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 18: 2640.848030398963/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1418.6266899210616/3240.027210358134
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 19: 3240.027210358134/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 4, 2], [1, 2, 1, 7]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 8969.522293912092/8969.522293912092
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 20: 8969.522293912092/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 8, 4, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 14 schedules
mapping (0,0,0,0,0,1,1): explored 21 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 30 schedules
mapping (0,0,0,1,0,0,0): explored 14 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,0,1,1,0,0): explored 16 schedules
mapping (0,0,1,0,0,1,0): explored 20 schedules
mapping (0,0,1,0,0,1,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 20 schedules
mapping (0,0,1,0,1,1,1): explored 21 schedules
mapping (0,0,1,1,0,0,0): explored 28 schedules
mapping (0,1,0,0,0,1,0): explored 24 schedules
mapping (0,1,0,1,0,0,0): explored 19 schedules
mapping (0,1,0,1,0,0,1): explored 20 schedules
mapping (0,1,0,1,1,0,0): explored 18 schedules
mapping (1,0,0,0,0,1,0): explored 18 schedules
mapping (1,0,0,1,0,0,0): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 21 schedules
Tensorize use time 689.0318593978882 s.
#############################################
operations:inputs:[1, 256, 28, 28],[256],[256],body:S[1, 256, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 28, 28],body:S[1, 256, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 28, 28],body:S[1, 256, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 30, 30],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 28, 28] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph37/at:resnet50:subgraph37:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 4094.385839804651/4094.385839804651
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 1: 4094.385839804651/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/491.3975369074237
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 2: 491.3975369074237/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[2, 4, 1, 1], [-1, 1, 0]], [[16, 1, 8, 1], [0, 0, 0]], [[14, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 3, 1], [0, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[1568, 32, 4], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/308.77208986601096
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 3: 308.77208986601096/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [1, 1, -1]], [[2, 1, 4, 1], [1, -1, 0]], [[2, 2, 2, 16], [0, 1, 1]]], "reduce_factors": [[[48, 1, 1], [0, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[1568, 8, 16], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 338.1800915142044/552.4575146359806
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 4: 552.4575146359806/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [1, 1, -1]], [[4, 1, 2, 1], [1, -1, 1]], [[4, 2, 4, 4], [0, 0, 0]]], "reduce_factors": [[[72, 2, 1], [0, 1]]], "last_factors": [[[12544, 8, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 473.62594496532506/473.62594496532506
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 5: 473.62594496532506/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[2, 2, 1, 2], [1, -1, 0]], [[4, 2, 8, 2], [1, 1, 1]], [[1, 14, 1, 1], [0, 1, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[56, 448, 8], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/583.4428640436366
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 7: 583.4428640436366/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [[1, 2, 2, 2], [0, 1, 1]], [[16, 1, 1, 8], [-1, 0, -1]]], "reduce_factors": [[[16, 1, 1], [1, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 7, 8], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 418.2836253317795/418.2836253317795
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 8: 418.2836253317795/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 1], [[1, 8, 1, 1], [-1, 1, 0]], [[2, 8, 2, 4], [1, -1, -1]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 3, 1], [0, 1]]], "last_factors": [[[56, 512, 7], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 48.73278051658211/629.4868943966277
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 9: 629.4868943966277/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[7, 2, 4, 4], [0, -1, 0]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 362.9569089627071/384.307778018378
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 10: 384.307778018378/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[28, 4, 1, 2], [0, 0, -1]], [[2, 1, 4, 1], [1, -1, 0]], [[1, 7, 1, 2], [0, 1, 0]]], "reduce_factors": [[[24, 6, 1], [1, -1]]], "last_factors": [[[2048, 98, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 743.4272097712108/743.4272097712108
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 11: 743.4272097712108/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [4, 1, 1, 2]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[4, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4047.377240191769/4047.377240191769
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 12: 4047.377240191769/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 5, 5, 1], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 363.14202104414915/363.14202104414915
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 13: 363.14202104414915/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[48, 1, 1], [1, 3, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 2516.3928175729257/2516.3928175729257
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 14: 2516.3928175729257/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [1, 2, 2, 2], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 3], [1, 3, 1]], "last_factors": [[2, 392, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/331.72660831853267
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 15: 331.72660831853267/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[4, 2, 4, 7], [-1, -1, 0]], [[2, 2, 1, 2], [-1, 1, 0]], [[7, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[24, 1, 2], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[7, 2048, 14], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 1040.6482866096649/1040.6482866096649
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 16: 1040.6482866096649/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 1, 4], [1, 3, 1]], "last_factors": [[4, 98, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 2008.5866780698432/2008.5866780698432
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 17: 2008.5866780698432/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 2, 1, 1]], "reduce_factors": [[16, 9, 1]], "last_factors": [[32, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 2259.3107249654063/2259.3107249654063
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 18: 2259.3107249654063/4094.385839804651(0.24423687437520825 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[1, 4, 4], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.E
*Y
iteration=1: 579.4151748453994/579.4151748453994
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 19: 579.4151748453994/4094.385839804651(0.24423687437520825 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 4, 1, 2], [1, 2, 7, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[49, 16, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 736.4189732692606/736.4189732692606
Best record value:4094.385839804651 (larger is better)
Round 1, Match 1, Mapping 20: 736.4189732692606/4094.385839804651(0.24423687437520825 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 8, 1, 1], [-1, 1, 0]], [[4, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 8, 1], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1, 28672, 7], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
New weights [0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 11 schedules
mapping (0,0,0,0,0,1,1): explored 9 schedules
mapping (0,0,0,0,1,1,0): explored 18 schedules
mapping (0,0,0,0,1,1,1): explored 21 schedules
mapping (0,0,0,1,0,0,0): explored 12 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 12 schedules
mapping (0,0,1,0,0,1,0): explored 11 schedules
mapping (0,0,1,0,0,1,1): explored 11 schedules
mapping (0,0,1,0,1,1,0): explored 8 schedules
mapping (0,0,1,0,1,1,1): explored 17 schedules
mapping (0,0,1,1,0,0,0): explored 15 schedules
mapping (0,1,0,0,0,1,0): explored 8 schedules
mapping (0,1,0,1,0,0,0): explored 9 schedules
mapping (0,1,0,1,0,0,1): explored 13 schedules
mapping (0,1,0,1,1,0,0): explored 5 schedules
mapping (1,0,0,0,0,1,0): explored 17 schedules
mapping (1,0,0,1,0,0,0): explored 16 schedules
mapping (1,0,0,1,0,1,0): explored 21 schedules
Original weights [0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 2843.5933320303993/4094.385839804651
Best record value:4094.385839804651 (larger is better)
Round 2, Match 1, Mapping 1: 4094.385839804651/4094.385839804651(0.24423687437520825 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 5752.4412169937905/5752.4412169937905
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 2: 5752.4412169937905/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 3, 2], [1, 1, 3]], "last_factors": [[98, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 572.6425990655518/572.6425990655518
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 3: 572.6425990655518/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 1], [1, 1, 3]], "last_factors": [[14, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 320.5113812934449/552.4575146359806
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 4: 552.4575146359806/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [1, 1, -1]], [[4, 1, 2, 1], [1, -1, 1]], [[4, 2, 4, 4], [0, 0, 0]]], "reduce_factors": [[[72, 2, 1], [0, 1]]], "last_factors": [[[12544, 8, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/473.62594496532506
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 5: 473.62594496532506/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[2, 2, 1, 2], [1, -1, 0]], [[4, 2, 8, 2], [1, 1, 1]], [[1, 14, 1, 1], [0, 1, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[56, 448, 8], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 1404.622868525144/1404.622868525144
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 6: 1404.622868525144/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[8, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/583.4428640436366
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 7: 583.4428640436366/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [[1, 2, 2, 2], [0, 1, 1]], [[16, 1, 1, 8], [-1, 0, -1]]], "reduce_factors": [[[16, 1, 1], [1, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 7, 8], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 1768.1001338408146/1768.1001338408146
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 8: 1768.1001338408146/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[12, 4, 1], [1, 3, 1]], "last_factors": [[1, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 237.33271773973004/629.4868943966277
Best record value:5752.4412169937905 (larger is better)
Round 2, Match 1, Mapping 9: 629.4868943966277/5752.4412169937905(0.17383923838209983 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[7, 2, 4, 4], [0, -1, 0]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 7284.428508009884/7284.428508009884
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 10: 7284.428508009884/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[9, 2, 8]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 889.7652105357744/889.7652105357744
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 11: 889.7652105357744/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[784, 1, 4, 1], [0, -1, 1]], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 6, 4], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[49, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 4045.8880481171773/4047.377240191769
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 12: 4047.377240191769/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 5, 5, 1], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/363.14202104414915
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 13: 363.14202104414915/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[48, 1, 1], [1, 3, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2911.124912577461/2911.124912577461
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 14: 2911.124912577461/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[32, 1, 7, 1], [-1, 0, 1]], [[2, 4, 1, 1], [1, 1, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[256, 784, 1], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 2426.959809879405/2426.959809879405
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 15: 2426.959809879405/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[2, 4, 1, 1], [1, 0, 0]], [[1, 2, 7, 1], [-1, 1, 0]]], "reduce_factors": [[[12, 2, 2], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[512, 49, 8], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 406.4637670263849/1040.6482866096649
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 16: 1040.6482866096649/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 1, 4], [1, 3, 1]], "last_factors": [[4, 98, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 644.7212341154061/2008.5866780698432
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 17: 2008.5866780698432/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 2, 1, 1]], "reduce_factors": [[16, 9, 1]], "last_factors": [[32, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 961.4726197333222/2259.3107249654063
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 18: 2259.3107249654063/7284.428508009884(0.13727912888436067 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[1, 4, 4], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2029.431122044455/2029.431122044455
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 19: 2029.431122044455/7284.428508009884(0.13727912888436067 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 224, 1, 1], [0, 0, 0]], [[8, 1, 1, 1], [0, 0, 0]], [[1, 1, 7, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[14, 1792, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/736.4189732692606
Best record value:7284.428508009884 (larger is better)
Round 2, Match 1, Mapping 20: 736.4189732692606/7284.428508009884(0.13727912888436067 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 8, 1, 1], [-1, 1, 0]], [[4, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 8, 1], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1, 28672, 7], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
New weights [0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 12 schedules
mapping (0,0,0,0,0,1,1): explored 11 schedules
mapping (0,0,0,0,1,1,0): explored 20 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 12 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 12 schedules
mapping (0,0,1,0,0,1,1): explored 12 schedules
mapping (0,0,1,0,1,1,0): explored 12 schedules
mapping (0,0,1,0,1,1,1): explored 19 schedules
mapping (0,0,1,1,0,0,0): explored 15 schedules
mapping (0,1,0,0,0,1,0): explored 11 schedules
mapping (0,1,0,1,0,0,0): explored 13 schedules
mapping (0,1,0,1,0,0,1): explored 15 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 18 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 21 schedules
Tensorize use time 1007.2693047523499 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[256, 512, 1, 1],body:R[1, 256, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [256, 512, 1, 1] [1, 256, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph38/at:resnet50:subgraph38:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 5244.477237518436/5244.477237518436
Best record value:5244.477237518436 (larger is better)
Round 1, Match 1, Mapping 1: 5244.477237518436/5244.477237518436(0.19067677381572098 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 3938.838804275933/3938.838804275933
Best record value:5244.477237518436 (larger is better)
Round 1, Match 1, Mapping 2: 3938.838804275933/5244.477237518436(0.19067677381572098 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[2, 224, 14]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 3534.824613274041/3534.824613274041
Best record value:5244.477237518436 (larger is better)
Round 1, Match 1, Mapping 3: 3534.824613274041/5244.477237518436(0.19067677381572098 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 7], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[1, 448, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 2431.769784593683/2431.769784593683
Best record value:5244.477237518436 (larger is better)
Round 1, Match 1, Mapping 4: 2431.769784593683/5244.477237518436(0.19067677381572098 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[49, 1, 1, 2], [-1, 0, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[16, 2, 4, 1], [0, -1, 1]]], "reduce_factors": [[[2, 1, 16], [1, 0]]], "last_factors": [[[4, 25088, 8], [-1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 8094.113916678058/8094.113916678058
Best record value:8094.113916678058 (larger is better)
Round 1, Match 1, Mapping 5: 8094.113916678058/8094.113916678058(0.12354656856749732 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 4, 2, 1], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 4966.864724879743/4966.864724879743
Best record value:8094.113916678058 (larger is better)
Round 1, Match 1, Mapping 6: 4966.864724879743/8094.113916678058(0.12354656856749732 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 1, 1, 7], [1, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 5218.102098829575/5218.102098829575
Best record value:8094.113916678058 (larger is better)
Round 1, Match 1, Mapping 7: 5218.102098829575/8094.113916678058(0.12354656856749732 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[98, 1, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 12247.380367607124/12247.380367607124
Best record value:12247.380367607124 (larger is better)
Round 1, Match 1, Mapping 8: 12247.380367607124/12247.380367607124(0.08165011373737374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 1, 2, 2], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[112, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/310.89890464564263
Best record value:12247.380367607124 (larger is better)
Round 1, Match 1, Mapping 9: 310.89890464564263/12247.380367607124(0.08165011373737374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[8, 7, 1, 8], [1, 1, 0]], [[2, 1, 2, 2], [1, 0, -1]], [[1, 7, 2, 2], [0, 1, 1]]], "reduce_factors": [[[8, 1, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[896, 28, 32], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 19257.425902210063/19257.425902210063
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 10: 19257.425902210063/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 2, 1], [-1, 0, 1]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 16, 1], [1, 1]]], "last_factors": [[[6272, 128, 1], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/427.2555828518081
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 11: 427.2555828518081/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1568, 2, 4, 1], [1, 0, -1]], [[4, 1, 1, 2], [1, 0, -1]]], "reduce_factors": [[[8, 2, 2], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[32, 3584, 7], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 8404.023453450334/8404.023453450334
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 12: 8404.023453450334/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 2, 2]], "reduce_factors": [[16, 2, 1]], "last_factors": [[14, 56, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 2325.6184547767843/2325.6184547767843
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 13: 2325.6184547767843/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 112, 2, 1], [-1, 0, 1]], [[4, 2, 1, 1], [1, 1, -1]], [[7, 2, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 4, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[112, 224, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 2196.736244453303/2196.736244453303
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 14: 2196.736244453303/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[28, 8, 2, 1], [-1, 1, 0]], [4, 1, 2, 1], [[1, 4, 1, 7], [0, 1, -1]]], "reduce_factors": [[[8, 1, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 1142.277380070126/1142.277380070126
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 15: 1142.277380070126/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 2], [1, 7, 2, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 784, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 1125.7733030299687/1125.7733030299687
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 16: 1125.7733030299687/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[784, 8, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [0, -1, 0]]], "reduce_factors": [[[2, 16, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1, 401408, 2], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 2455.7824332083915/2455.7824332083915
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 17: 2455.7824332083915/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[16, 1, 2]], "last_factors": [[7, 112, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 5356.2196283193425/5356.2196283193425
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 18: 5356.2196283193425/19257.425902210063(0.051928020135091665 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 1, 2, 2], [2, 7, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 6312.0895004468/6312.0895004468
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 19: 6312.0895004468/19257.425902210063(0.051928020135091665 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[2, 112, 1, 2], [1, 0, -1]], [[1, 2, 1, 4], [0, -1, -1]], [[7, 1, 2, 2], [1, 0, 1]]], "reduce_factors": [[[8, 1, 4], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3136, 8, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/392.68198404292383
Best record value:19257.425902210063 (larger is better)
Round 1, Match 1, Mapping 20: 392.68198404292383/19257.425902210063(0.051928020135091665 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[28, 8, 14, 4], [0, 1, 1]], [[4, 2, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16, 3136, 16], [-1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 17 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 18 schedules
mapping (0,0,0,1,0,0,0): explored 21 schedules
mapping (0,0,0,1,0,0,1): explored 12 schedules
mapping (0,0,0,1,0,1,0): explored 18 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 16 schedules
mapping (0,0,1,0,1,1,0): explored 20 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 16 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 19 schedules
mapping (0,1,0,1,1,0,0): explored 28 schedules
mapping (1,0,0,0,0,1,0): explored 18 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 567.8418172999964/5244.477237518436
Best record value:19257.425902210063 (larger is better)
Round 2, Match 1, Mapping 1: 5244.477237518436/19257.425902210063(0.051928020135091665 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 32603.213258919433/32603.213258919433
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 2: 32603.213258919433/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 2], [[8, 1, 1, 1], [0, 0, 0]], [[4, 2, 1, 16], [0, -1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 2, 8], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 2542.17439284062/3534.824613274041
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 3: 3534.824613274041/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 7], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[1, 448, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/2431.769784593683
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 4: 2431.769784593683/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[49, 1, 1, 2], [-1, 0, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[16, 2, 4, 1], [0, -1, 1]]], "reduce_factors": [[[2, 1, 16], [1, 0]]], "last_factors": [[[4, 25088, 8], [-1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 16836.864239151226/16836.864239151226
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 5: 16836.864239151226/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [4, 1, 2, 1], [1, 1, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 49, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 10809.539715225239/10809.539715225239
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 6: 10809.539715225239/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15696.504530945278/15696.504530945278
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 7: 15696.504530945278/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 4439.052262341989/12247.380367607124
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 8: 12247.380367607124/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 1, 2, 2], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[112, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 24936.009333641858/24936.009333641858
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 9: 24936.009333641858/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [8, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 13795.430061662595/19257.425902210063
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 10: 19257.425902210063/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 2, 1], [-1, 0, 1]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 16, 1], [1, 1]]], "last_factors": [[[6272, 128, 1], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 7343.868829508598/7343.868829508598
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 11: 7343.868829508598/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 1]], "reduce_factors": [[1, 32, 1], [1, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 14506.054493104079/14506.054493104079
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 12: 14506.054493104079/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [2, 1, 1, 4]], "reduce_factors": [[4, 2, 4]], "last_factors": [[56, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2282.3593152977023/2325.6184547767843
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 13: 2325.6184547767843/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 112, 2, 1], [-1, 0, 1]], [[4, 2, 1, 1], [1, 1, -1]], [[7, 2, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 4, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[112, 224, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/2196.736244453303
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 14: 2196.736244453303/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[28, 8, 2, 1], [-1, 1, 0]], [4, 1, 2, 1], [[1, 4, 1, 7], [0, 1, -1]]], "reduce_factors": [[[8, 1, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 5211.102272435319/5211.102272435319
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 15: 5211.102272435319/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [1, 8, 1, 1], [2, 1, 14, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[56, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 2209.864197930159/2209.864197930159
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 16: 2209.864197930159/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[784, 8, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [0, -1, 0]]], "reduce_factors": [[[2, 2, 8], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 7, 8], [1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 13321.924195527821/13321.924195527821
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 17: 13321.924195527821/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 2469.0883956542853/5356.2196283193425
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 18: 5356.2196283193425/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 1, 2, 2], [2, 7, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 7917.489745759652/7917.489745759652
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 19: 7917.489745759652/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[2, 28, 1, 8], [1, 1, -1]], [[1, 4, 2, 1], [-1, 1, 0]], [[14, 1, 2, 1], [0, 0, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 4, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 9785.686718514024/9785.686718514024
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 20: 9785.686718514024/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [2, 1, 2, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 18 schedules
mapping (0,0,0,0,0,1,1): explored 30 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 18 schedules
mapping (0,0,0,1,0,0,0): explored 23 schedules
mapping (0,0,0,1,0,0,1): explored 16 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 21 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 19 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 27 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (0,1,0,1,1,0,0): explored 31 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Tensorize use time 710.2802920341492 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [1, 512, 28, 28] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph39.log by 200 trials...
.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N

Currently best performance: 0.014599424653871899
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.014599424653871899
.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.010358555108828417
.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.E.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0038482458147607855
.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N.N.N.N.N

Currently best performance: 0.0038482458147607855
.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0038482458147607855
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.E.Y.Y.N.N.N.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.E.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0038482458147607855
.N.N.N.N.N.NSchedule cost 950.666219 seconds
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 128, 28, 28],[512, 128, 1, 1],body:R[1, 512, 28, 28] [128, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [512, 128, 1, 1] [1, 512, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph40/at:resnet50:subgraph40:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 38779.52067648477/38779.52067648477
Best record value:38779.52067648477 (larger is better)
Round 1, Match 1, Mapping 1: 38779.52067648477/38779.52067648477(0.025786806607085856 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 44207.936145967775/44207.936145967775
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 2: 44207.936145967775/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 34087.62210439588/34087.62210439588
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 3: 34087.62210439588/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [[2, 8, 4, 2], [1, -1, -1]]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 32, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/661.2502400927705
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 4: 661.2502400927705/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [-1, 0, 0]], [[2, 2, 4, 1], [1, 1, 0]], [[2, 16, 2, 2], [1, 0, 0]]], "reduce_factors": [[[2, 4, 1], [-1, 1]]], "last_factors": [[[112, 896, 16], [0, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2402.5963279119755/2402.5963279119755
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 5: 2402.5963279119755/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[2, 1, 1, 2], [1, -1, 0]], [[4, 1, 4, 1], [1, 0, 0]], [[4, 4, 1, 8], [-1, -1, 0]], [[14, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[2, 2, 2], [-1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1, 100352, 16], [0, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 853.6413869606207/950.5853920523296
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 6: 950.5853920523296/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 2, 1], [0, 0, 0]], [[8, 2, 1, 1], [0, 1, -1]], [[2, 16, 4, 1], [1, 1, 1]]], "reduce_factors": [[[4, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28672, 4, 14], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 8227.283313211155/8227.283313211155
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 7: 8227.283313211155/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 7, 1, 2], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 8961.538561400568/8961.538561400568
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 8: 8961.538561400568/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[2, 1, 1, 2], [[4, 4, 1, 1], [0, 0, 0]], [[2, 32, 1, 2], [1, -1, 0]], [[2, 7, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 4, 1], [1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 12892.917513187022/12892.917513187022
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 9: 12892.917513187022/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 7, 2, 2], [0, 0, 0]], [[2, 8, 1, 1], [0, 1, -1]], [[14, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[1, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11770.307138340582/11770.307138340582
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 10: 11770.307138340582/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[4, 7, 2, 8], [0, 1, 0]], [8, 1, 2, 1], [[1, 14, 1, 2], [0, 1, 0]]], "reduce_factors": [[[8, 1, 1], [1, 0]]], "last_factors": [[[32768, 7, 7], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 800.370511817829/821.6179144022543
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 11: 821.6179144022543/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[64, 98, 2, 1], [1, -1, 0]], [[8, 1, 2, 1], [1, 0, 1]]], "reduce_factors": [[[1, 8, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 16, 14], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 26455.260887197714/26455.260887197714
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 12: 26455.260887197714/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 27891.97700503213/27891.97700503213
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 13: 27891.97700503213/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [7, 2, 2, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[112, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 36075.71786748248/36075.71786748248
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 14: 36075.71786748248/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 4351.724927809753/4351.724927809753
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 15: 4351.724927809753/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 8], [2, 1, 1, 14]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 24627.54162270827/24627.54162270827
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 16: 24627.54162270827/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[56, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 8265.941255816168/8265.941255816168
Best record value:44207.936145967775 (larger is better)
Round 1, Match 1, Mapping 17: 8265.941255816168/44207.936145967775(0.02262037288278183 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [4, 1, 4, 1], [4, 7, 1, 1]], "reduce_factors": [[1, 4, 2]], "last_factors": [[56, 14, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 47636.208566517395/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 3059.6886474740004/3059.6886474740004
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 19: 3059.6886474740004/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [2, 2, 2, 2], [7, 4, 1, 1]], "reduce_factors": [[1, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 3136, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 28354.036223795014/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 27 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 20 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 27 schedules
mapping (0,0,0,1,0,1,0): explored 24 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 37 schedules
mapping (0,0,1,0,0,1,1): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 25 schedules
mapping (0,1,0,0,0,1,0): explored 26 schedules
mapping (0,1,0,1,0,0,0): explored 26 schedules
mapping (0,1,0,1,0,0,1): explored 33 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 21 schedules
mapping (1,0,0,1,0,0,0): explored 19 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 3925.8588953684066/38779.52067648477
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 1: 38779.52067648477/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 35821.936273764564/44207.936145967775
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 2: 44207.936145967775/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/34087.62210439588
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 3: 34087.62210439588/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [[2, 8, 4, 2], [1, -1, -1]]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 32, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 27350.72072749853/27350.72072749853
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 4: 27350.72072749853/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11836.847808553934/11836.847808553934
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 5: 11836.847808553934/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[4, 1, 1, 1], [0, 0, 0]], [[8, 1, 2, 1], [-1, 0, 1]], [[8, 8, 2, 1], [-1, 0, 1]], [[1, 14, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[2, 2, 2], [-1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1792, 28, 32], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 24910.065246255665/24910.065246255665
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 6: 24910.065246255665/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4392.643651915701/8227.283313211155
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 7: 8227.283313211155/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 7, 1, 2], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 35834.059865070136/35834.059865070136
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 8: 35834.059865070136/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 12272.867516949991/12892.917513187022
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 9: 12892.917513187022/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 7, 2, 2], [0, 0, 0]], [[2, 8, 1, 1], [0, 1, -1]], [[14, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[1, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 8313.389949819937/11770.307138340582
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 10: 11770.307138340582/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[4, 7, 2, 8], [0, 1, 0]], [8, 1, 2, 1], [[1, 14, 1, 2], [0, 1, 0]]], "reduce_factors": [[[8, 1, 1], [1, 0]]], "last_factors": [[[32768, 7, 7], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=1: 14166.786718181325/14166.786718181325
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 11: 14166.786718181325/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 1, 2, 8]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[32, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 19419.611327704093/26455.260887197714
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 12: 26455.260887197714/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 6661.716069616076/27891.97700503213
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 13: 27891.97700503213/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [7, 2, 2, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[112, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 9903.879997965905/36075.71786748248
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 14: 36075.71786748248/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*Y
iteration=1: 5225.600136349794/5225.600136349794
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 15: 5225.600136349794/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 1, 8], [4, 1, 1, 7]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/24627.54162270827
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 16: 24627.54162270827/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[56, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 8669.481733705115/8669.481733705115
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 17: 8669.481733705115/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 1, 1, 8], [1, 7, 2, 2]], "reduce_factors": [[4, 2, 1]], "last_factors": [[784, 1, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 10904.044940586096/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 4417.116687958902/4417.116687958902
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 19: 4417.116687958902/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 4, 2, 1], [1, 1, 4, 7]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 448, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 24478.60208298944/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 25 schedules
mapping (0,0,0,0,0,1,1): explored 31 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 32 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 35 schedules
mapping (0,0,1,0,0,1,0): explored 42 schedules
mapping (0,0,1,0,0,1,1): explored 31 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 32 schedules
mapping (0,0,1,1,0,0,0): explored 27 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,1,0,0,0): explored 28 schedules
mapping (0,1,0,1,0,0,1): explored 33 schedules
mapping (0,1,0,1,1,0,0): explored 31 schedules
mapping (1,0,0,0,0,1,0): explored 23 schedules
mapping (1,0,0,1,0,0,0): explored 21 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Tensorize use time 691.6008493900299 s.
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 30, 30],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph41/at:resnet50:subgraph41:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 3254.4458905557176/3254.4458905557176
Best record value:3254.4458905557176 (larger is better)
Round 1, Match 1, Mapping 1: 3254.4458905557176/3254.4458905557176(0.3072719699848024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*Y*Y*E
iteration=1: 5114.969535208765/5114.969535208765
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 2: 5114.969535208765/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/307.0935263407138
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 3: 307.0935263407138/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [[4, 4, 8, 1], [0, -1, 1]]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 1186.664112874931/1186.664112874931
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 4: 1186.664112874931/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 7, 7, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[18, 1, 4]], "last_factors": [[16, 196, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 1426.948379841373/1426.948379841373
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 5: 1426.948379841373/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 2, 2, 1], [0, 1, -1]], [[2, 2, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [1, 0, 0]], [[7, 2, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[2, 2, 2], [-1, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [1, -1]]], "last_factors": [[[2, 7168, 28], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/524.3820007543925
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 6: 524.3820007543925/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 1, 2, 7], [1, 0, 1]], [[1, 1, 2, 2], [-1, -1, 1]], [[32, 2, 1, 2], [1, 1, -1]]], "reduce_factors": [[[6, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[392, 32, 32], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 3041.723878121404/3041.723878121404
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 7: 3041.723878121404/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 3], [3, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1104.231438634791/1104.231438634791
Best record value:5114.969535208765 (larger is better)
Round 1, Match 1, Mapping 8: 1104.231438634791/5114.969535208765(0.19550458572949947 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 2], [0, 0, 1]], [2, 1, 1, 2], [[16, 2, 1, 4], [-1, 1, 0]], [[1, 14, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[24, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[392, 1024, 1], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 6695.159681432256/6695.159681432256
Best record value:6695.159681432256 (larger is better)
Round 1, Match 1, Mapping 9: 6695.159681432256/6695.159681432256(0.14936163550711248 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 2450.056954923894/2450.056954923894
Best record value:6695.159681432256 (larger is better)
Round 1, Match 1, Mapping 10: 2450.056954923894/6695.159681432256(0.14936163550711248 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[12, 6, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/198.0184052642385
Best record value:6695.159681432256 (larger is better)
Round 1, Match 1, Mapping 11: 198.0184052642385/6695.159681432256(0.14936163550711248 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[112, 8, 1, 14], [-1, -1, 0]], [[2, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[12, 2, 1], [0, 0]], [[1, 3, 1], [0, 1]]], "last_factors": [[[14, 7168, 4], [1, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 361.89998199873304/387.04817892128807
Best record value:6695.159681432256 (larger is better)
Round 1, Match 1, Mapping 12: 387.04817892128807/6695.159681432256(0.14936163550711248 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[128, 7, 1, 14], [1, 0, 0]], [[1, 2, 2, 1], [0, 1, 0]]], "reduce_factors": [[[72, 1, 1], [1, 0]]], "last_factors": [[[32, 784, 16], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/142.57521035892282
Best record value:6695.159681432256 (larger is better)
Round 1, Match 1, Mapping 13: 142.57521035892282/6695.159681432256(0.14936163550711248 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[4, 28, 1, 4], [0, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[7, 4, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[112, 512, 7], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7091.036074450569/7091.036074450569
Best record value:7091.036074450569 (larger is better)
Round 1, Match 1, Mapping 14: 7091.036074450569/7091.036074450569(0.14102311559280603 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 2112.7583223399597/2112.7583223399597
Best record value:7091.036074450569 (larger is better)
Round 1, Match 1, Mapping 15: 2112.7583223399597/7091.036074450569(0.14102311559280603 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[12, 1, 2], [3, 1, 1]], "last_factors": [[8, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 182.86188698414176/404.77936911488547
Best record value:7091.036074450569 (larger is better)
Round 1, Match 1, Mapping 16: 404.77936911488547/7091.036074450569(0.14102311559280603 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[98, 16, 2, 4], [-1, 1, 0]], [[2, 2, 1, 1], [1, 0, 0]]], "reduce_factors": [[[8, 1, 3], [-1, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[224, 224, 8], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 6205.294458020124/6205.294458020124
Best record value:7091.036074450569 (larger is better)
Round 1, Match 1, Mapping 17: 6205.294458020124/7091.036074450569(0.14102311559280603 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[36, 1, 2]], "last_factors": [[98, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 10290.212221797356/10290.212221797356
Best record value:10290.212221797356 (larger is better)
Round 1, Match 1, Mapping 18: 10290.212221797356/10290.212221797356(0.09717972559222239 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1619.2229769931382/1619.2229769931382
Best record value:10290.212221797356 (larger is better)
Round 1, Match 1, Mapping 19: 1619.2229769931382/10290.212221797356(0.09717972559222239 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[4, 4, 2, 14], [0, -1, 0]], [[2, 2, 1, 1], [0, 0, 0]], [[7, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 1, 4], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[32, 392, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1636.3533964858389/1636.3533964858389
Best record value:10290.212221797356 (larger is better)
Round 1, Match 1, Mapping 20: 1636.3533964858389/10290.212221797356(0.09717972559222239 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 49], [2, 1, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 9 schedules
mapping (0,0,0,0,0,1,1): explored 12 schedules
mapping (0,0,0,0,1,1,0): explored 13 schedules
mapping (0,0,0,0,1,1,1): explored 15 schedules
mapping (0,0,0,1,0,0,0): explored 19 schedules
mapping (0,0,0,1,0,0,1): explored 13 schedules
mapping (0,0,0,1,0,1,0): explored 15 schedules
mapping (0,0,0,1,1,0,0): explored 20 schedules
mapping (0,0,1,0,0,1,0): explored 13 schedules
mapping (0,0,1,0,0,1,1): explored 10 schedules
mapping (0,0,1,0,1,1,0): explored 12 schedules
mapping (0,0,1,0,1,1,1): explored 25 schedules
mapping (0,0,1,1,0,0,0): explored 9 schedules
mapping (0,1,0,0,0,1,0): explored 22 schedules
mapping (0,1,0,1,0,0,0): explored 7 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 13 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 13 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 101.6671003073496/3254.4458905557176
Best record value:10290.212221797356 (larger is better)
Round 2, Match 1, Mapping 1: 3254.4458905557176/10290.212221797356(0.09717972559222239 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3204.9244098794447/5114.969535208765
Best record value:10290.212221797356 (larger is better)
Round 2, Match 1, Mapping 2: 5114.969535208765/10290.212221797356(0.09717972559222239 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1551.5705935288172/1551.5705935288172
Best record value:10290.212221797356 (larger is better)
Round 2, Match 1, Mapping 3: 1551.5705935288172/10290.212221797356(0.09717972559222239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 340.4237020288494/1186.664112874931
Best record value:10290.212221797356 (larger is better)
Round 2, Match 1, Mapping 4: 1186.664112874931/10290.212221797356(0.09717972559222239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 7, 7, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[18, 1, 4]], "last_factors": [[16, 196, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 18709.425497966746/18709.425497966746
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 5: 18709.425497966746/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 4587.815845215498/4587.815845215498
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 6: 4587.815845215498/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[14, 1, 7, 1], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 6], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 1607.6495774063137/3041.723878121404
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 7: 3041.723878121404/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 3], [3, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1104.231438634791
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 8: 1104.231438634791/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 2], [0, 0, 1]], [2, 1, 1, 2], [[16, 2, 1, 4], [-1, 1, 0]], [[1, 14, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[24, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[392, 1024, 1], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 311.71896815578924/6695.159681432256
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 9: 6695.159681432256/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2716.585992968025/2716.585992968025
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 10: 2716.585992968025/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [1, 2, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[18, 1, 4]], "last_factors": [[49, 32, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 797.9961041032201/797.9961041032201
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 11: 797.9961041032201/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[7, 7, 2, 1], [[2, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[4, 2, 3], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[1568, 32, 8], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/387.04817892128807
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 12: 387.04817892128807/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[128, 7, 1, 14], [1, 0, 0]], [[1, 2, 2, 1], [0, 1, 0]]], "reduce_factors": [[[72, 1, 1], [1, 0]]], "last_factors": [[[32, 784, 16], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 1329.7119547585414/1329.7119547585414
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 13: 1329.7119547585414/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[4, 28, 1, 4], [0, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[7, 4, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[112, 512, 7], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 2295.8320461108347/7091.036074450569
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 14: 7091.036074450569/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 15740.468346399526/15740.468346399526
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 15: 15740.468346399526/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [4, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[98, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 3647.27887536679/3647.27887536679
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 16: 3647.27887536679/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 14], [2, 1, 1, 2]], "reduce_factors": [[3, 1, 8], [3, 1, 1]], "last_factors": [[2, 224, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 3016.073501008153/6205.294458020124
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 17: 6205.294458020124/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[36, 1, 2]], "last_factors": [[98, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 2855.6927103302123/10290.212221797356
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 18: 10290.212221797356/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 1797.15030374209/1797.15030374209
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 19: 1797.15030374209/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 1, 1], [0, 0, 0]], [[7, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 1, 4], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[32, 392, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1636.3533964858389
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 20: 1636.3533964858389/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 49], [2, 1, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 11 schedules
mapping (0,0,0,0,0,1,1): explored 17 schedules
mapping (0,0,0,0,1,1,0): explored 18 schedules
mapping (0,0,0,0,1,1,1): explored 18 schedules
mapping (0,0,0,1,0,0,0): explored 23 schedules
mapping (0,0,0,1,0,0,1): explored 15 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 20 schedules
mapping (0,0,1,0,0,1,0): explored 14 schedules
mapping (0,0,1,0,0,1,1): explored 11 schedules
mapping (0,0,1,0,1,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,1): explored 25 schedules
mapping (0,0,1,1,0,0,0): explored 10 schedules
mapping (0,1,0,0,0,1,0): explored 24 schedules
mapping (0,1,0,1,0,0,0): explored 10 schedules
mapping (0,1,0,1,0,0,1): explored 19 schedules
mapping (0,1,0,1,1,0,0): explored 14 schedules
mapping (1,0,0,0,0,1,0): explored 8 schedules
mapping (1,0,0,1,0,0,0): explored 17 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Tensorize use time 1001.915824174881 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[128, 512, 1, 1],body:R[1, 128, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [128, 512, 1, 1] [1, 128, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph42/at:resnet50:subgraph42:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2706.342934938586/2706.342934938586
Best record value:2706.342934938586 (larger is better)
Round 1, Match 1, Mapping 1: 2706.342934938586/2706.342934938586(0.3695023225216994 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 2, 1, 1], [1, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[1, 64, 2, 1], [0, -1, 1]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 32], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 5236.282809581586/5236.282809581586
Best record value:5236.282809581586 (larger is better)
Round 1, Match 1, Mapping 2: 5236.282809581586/5236.282809581586(0.19097517005196032 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 12246.213692007024/12246.213692007024
Best record value:12246.213692007024 (larger is better)
Round 1, Match 1, Mapping 3: 12246.213692007024/12246.213692007024(0.08165789240250557 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 1, 2], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[112, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 12931.972352257158/12931.972352257158
Best record value:12931.972352257158 (larger is better)
Round 1, Match 1, Mapping 4: 12931.972352257158/12931.972352257158(0.07732772486367549 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 7, 2], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 5910.288374884417/5910.288374884417
Best record value:12931.972352257158 (larger is better)
Round 1, Match 1, Mapping 5: 5910.288374884417/12931.972352257158(0.07732772486367549 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [1, 1, 1, 4], [1, 1, 1, 1], [4, 1, 1, 7]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 23720.70037360382/23720.70037360382
Best record value:23720.70037360382 (larger is better)
Round 1, Match 1, Mapping 6: 23720.70037360382/23720.70037360382(0.04215727125463761 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 10208.421705775663/10208.421705775663
Best record value:23720.70037360382 (larger is better)
Round 1, Match 1, Mapping 7: 10208.421705775663/23720.70037360382(0.04215727125463761 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2995.496600805241/2995.496600805241
Best record value:23720.70037360382 (larger is better)
Round 1, Match 1, Mapping 8: 2995.496600805241/23720.70037360382(0.04215727125463761 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[1, 2, 1, 2], [0, 0, 0]], [[2, 1, 2, 1], [0, 0, 1]], [[1, 8, 4, 4], [0, 1, 1]], [[7, 4, 1, 1], [0, 0, 0]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14, 3584, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 30132.91146992123/30132.91146992123
Best record value:30132.91146992123 (larger is better)
Round 1, Match 1, Mapping 9: 30132.91146992123/30132.91146992123(0.03318630531265468 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 1, 4, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/549.335134499495
Best record value:30132.91146992123 (larger is better)
Round 1, Match 1, Mapping 10: 549.335134499495/30132.91146992123(0.03318630531265468 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[8, 4, 7, 2], [-1, 1, 1]], [[2, 1, 1, 2], [0, -1, 0]], [[14, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 2, 2], [-1, 1]]], "last_factors": [[[32, 784, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 14128.727200863004/14128.727200863004
Best record value:30132.91146992123 (larger is better)
Round 1, Match 1, Mapping 11: 14128.727200863004/30132.91146992123(0.03318630531265468 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 18052.205921128745/18052.205921128745
Best record value:30132.91146992123 (larger is better)
Round 1, Match 1, Mapping 12: 18052.205921128745/30132.91146992123(0.03318630531265468 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 30610.955266009743/30610.955266009743
Best record value:30610.955266009743 (larger is better)
Round 1, Match 1, Mapping 13: 30610.955266009743/30610.955266009743(0.032668042905227304 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 37834.748423347526/37834.748423347526
Best record value:37834.748423347526 (larger is better)
Round 1, Match 1, Mapping 14: 37834.748423347526/37834.748423347526(0.02643072946622021 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 18294.62417580691/18294.62417580691
Best record value:37834.748423347526 (larger is better)
Round 1, Match 1, Mapping 15: 18294.62417580691/37834.748423347526(0.02643072946622021 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 2625.1333072919742/2625.1333072919742
Best record value:37834.748423347526 (larger is better)
Round 1, Match 1, Mapping 16: 2625.1333072919742/37834.748423347526(0.02643072946622021 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 1, 2], [2, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*E*Y
iteration=1: 18445.314514671096/18445.314514671096
Best record value:37834.748423347526 (larger is better)
Round 1, Match 1, Mapping 17: 18445.314514671096/37834.748423347526(0.02643072946622021 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 44226.35255363897/44226.35255363897
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 18: 44226.35255363897/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 570.64366457058/910.3296349321045
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 19: 910.3296349321045/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[56, 2, 2, 2], [1, 1, 0]], [[2, 1, 2, 1], [1, 0, -1]], [[28, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[4, 2, 4], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[56, 1024, 7], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 4754.7625367899445/4754.7625367899445
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 20: 4754.7625367899445/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[112, 56, 2, 1], [1, -1, 1]], [[2, 1, 2, 1], [1, -1, 0]]], "reduce_factors": [[[2, 8, 2], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 14], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 24 schedules
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 13 schedules
mapping (0,0,0,1,0,0,0): explored 13 schedules
mapping (0,0,0,1,0,0,1): explored 28 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 27 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 19 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 24 schedules
mapping (0,1,0,0,0,1,0): explored 13 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (0,1,0,1,1,0,0): explored 23 schedules
mapping (1,0,0,0,0,1,0): explored 21 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/2706.342934938586
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 1: 2706.342934938586/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 2, 1, 1], [1, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[1, 64, 2, 1], [0, -1, 1]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 32], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 3403.2354039848083/5236.282809581586
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 2: 5236.282809581586/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 14401.294250511062/14401.294250511062
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 3: 14401.294250511062/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 20708.40229666723/20708.40229666723
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 4: 20708.40229666723/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[28, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 2805.378574712937/5910.288374884417
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 5: 5910.288374884417/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [1, 1, 1, 4], [1, 1, 1, 1], [4, 1, 1, 7]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 2638.042894176932/23720.70037360382
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 6: 23720.70037360382/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/10208.421705775663
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 7: 10208.421705775663/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 15920.155851199206/15920.155851199206
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 8: 15920.155851199206/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 5055.070296980099/30132.91146992123
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 9: 30132.91146992123/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 1, 4, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 5553.867184820142/5553.867184820142
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 10: 5553.867184820142/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[4, 1, 8]], "last_factors": [[2, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 5989.854114543379/14128.727200863004
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 11: 14128.727200863004/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 2100.342964854297/18052.205921128745
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 12: 18052.205921128745/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 19550.37154527792/30610.955266009743
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 13: 30610.955266009743/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15883.22112760061/37834.748423347526
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 14: 37834.748423347526/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 7367.879204448202/18294.62417580691
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 15: 18294.62417580691/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/2625.1333072919742
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 16: 2625.1333072919742/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 1, 2], [2, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 10943.582152146268/18445.314514671096
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 17: 18445.314514671096/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 20333.83625647075/44226.35255363897
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 18: 44226.35255363897/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 22042.82291325643/22042.82291325643
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 19: 22042.82291325643/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 11319.110261152282/11319.110261152282
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 20: 11319.110261152282/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 28 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 17 schedules
mapping (0,0,0,1,0,0,0): explored 15 schedules
mapping (0,0,0,1,0,0,1): explored 30 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 18 schedules
mapping (0,1,0,1,0,0,0): explored 26 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Tensorize use time 616.8339133262634 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [512] [512] [1, 512, 28, 28] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph51.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.B.N.N.N.N.N.B.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.03255799718820318
.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.016902887974918894
.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.Y.Y.Y.Y.Y.E.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.N.Y.Y.Y.Y.Y.Y.T.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.T.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.Y.E.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.N.N.N.NSchedule cost 1558.908430 seconds
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[512, 256, 1, 1],body:R[1, 512, 28, 28] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [512, 256, 1, 1] [1, 512, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph52/at:resnet50:subgraph52:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 8856.604014569459/8856.604014569459
Best record value:8856.604014569459 (larger is better)
Round 1, Match 1, Mapping 1: 8856.604014569459/8856.604014569459(0.1129100949252062 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 2], [8, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 10538.157480840096/10538.157480840096
Best record value:10538.157480840096 (larger is better)
Round 1, Match 1, Mapping 2: 10538.157480840096/10538.157480840096(0.09489324882629108 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 4, 1], [[8, 1, 1, 2], [0, 0, -1]], [[16, 8, 1, 1], [1, -1, 0]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 128, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 1028.0331338055269/1028.0331338055269
Best record value:10538.157480840096 (larger is better)
Round 1, Match 1, Mapping 3: 1028.0331338055269/10538.157480840096(0.09489324882629108 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[1, 49, 2, 1], [-1, 0, 1]], [[1, 8, 1, 2], [-1, 1, -1]], [[2, 16, 2, 2], [1, -1, 1]]], "reduce_factors": [[[2, 1, 8], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 28, 28], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 13964.802646165183/13964.802646165183
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 4: 13964.802646165183/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 1], [2, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[16, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1506.2437263826594/1506.2437263826594
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 5: 1506.2437263826594/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[2, 1, 2, 1], [[2, 8, 1, 1], [1, -1, 0]], [[4, 32, 1, 1], [0, 1, 0]], [[2, 1, 2, 7], [1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[49, 1024, 32], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 3775.800033630219/3775.800033630219
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 6: 3775.800033630219/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[49, 1, 2, 1], [0, -1, 1]], [[4, 4, 1, 1], [-1, 1, 0]], [[2, 16, 2, 2], [0, 0, 1]]], "reduce_factors": [[[2, 1, 8], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14, 4096, 28], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 303.8002986964537/355.95908786359394
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 7: 355.95908786359394/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 2, 1], [0, -1, 1]], [[2, 8, 1, 1], [1, -1, 0]], [[16, 1, 8, 1], [-1, 0, 1]]], "reduce_factors": [[[4, 1, 4], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 3136, 4], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 1871.49842798031/1871.49842798031
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 8: 1871.49842798031/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 8, 1, 1], [1, 1, 1, 1], [2, 2, 1, 7]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[784, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 11437.696148760779/11437.696148760779
Best record value:13964.802646165183 (larger is better)
Round 1, Match 1, Mapping 9: 11437.696148760779/13964.802646165183(0.07160860237968389 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [4, 1, 4, 1], [1, 14, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 20732.404143420124/20732.404143420124
Best record value:20732.404143420124 (larger is better)
Round 1, Match 1, Mapping 10: 20732.404143420124/20732.404143420124(0.048233672905579145 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1303.234870807349/1303.234870807349
Best record value:20732.404143420124 (larger is better)
Round 1, Match 1, Mapping 11: 1303.234870807349/20732.404143420124(0.048233672905579145 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[896, 14, 1, 1], [0, 0, 0]], [[2, 4, 2, 1], [1, -1, 1]]], "reduce_factors": [[1, 2, 8], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 50176, 4], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 2094.712585455554/2094.712585455554
Best record value:20732.404143420124 (larger is better)
Round 1, Match 1, Mapping 12: 2094.712585455554/20732.404143420124(0.048233672905579145 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 196, 4, 1], [0, 0, 0]], [[16, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[2, 8, 1], [0, 0]]], "last_factors": [[[16, 7168, 14], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 5379.4297018995585/5379.4297018995585
Best record value:20732.404143420124 (larger is better)
Round 1, Match 1, Mapping 13: 5379.4297018995585/20732.404143420124(0.048233672905579145 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[8, 14, 1, 4], [0, 0, 0]], [[2, 1, 8, 1], [-1, 0, 1]], [[1, 14, 1, 2], [-1, 1, -1]]], "reduce_factors": [[[4, 1, 4], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[57344, 1, 28], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/328.1360035794388
Best record value:20732.404143420124 (larger is better)
Round 1, Match 1, Mapping 14: 328.1360035794388/20732.404143420124(0.048233672905579145 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[32, 7, 2, 1], [0, 0, 1]], [[1, 8, 2, 1], [0, 1, 1]], [[2, 7, 2, 1], [1, 0, -1]]], "reduce_factors": [[[2, 8, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 1568, 8], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 21086.8508898989/21086.8508898989
Best record value:21086.8508898989 (larger is better)
Round 1, Match 1, Mapping 15: 21086.8508898989/21086.8508898989(0.04742291797012818 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 2043.443835891186/2043.443835891186
Best record value:21086.8508898989 (larger is better)
Round 1, Match 1, Mapping 16: 2043.443835891186/21086.8508898989(0.04742291797012818 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 49, 2, 1], [4, 2, 2, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[4, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 3644.350106464797/3644.350106464797
Best record value:21086.8508898989 (larger is better)
Round 1, Match 1, Mapping 17: 3644.350106464797/21086.8508898989(0.04742291797012818 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 112, 1, 2], [0, 0, 0]], [[4, 2, 2, 1], [1, 0, 0]], [[2, 1, 1, 14], [1, 0, -1]]], "reduce_factors": [[[4, 4, 1], [1, -1]]], "last_factors": [[[784, 64, 32], [1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 12409.74095891379/12409.74095891379
Best record value:21086.8508898989 (larger is better)
Round 1, Match 1, Mapping 18: 12409.74095891379/21086.8508898989(0.04742291797012818 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 28756.265656913532/28756.265656913532
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 19: 28756.265656913532/28756.265656913532(0.03477502996845426 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 17752.72412549589/17752.72412549589
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 20: 17752.72412549589/28756.265656913532(0.03477502996845426 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[14, 1, 1, 7], [4, 1, 2, 2]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 224, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 17 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 20 schedules
mapping (0,0,0,0,1,1,1): explored 21 schedules
mapping (0,0,0,1,0,0,0): explored 33 schedules
mapping (0,0,0,1,0,0,1): explored 28 schedules
mapping (0,0,0,1,0,1,0): explored 13 schedules
mapping (0,0,0,1,1,0,0): explored 27 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 15 schedules
mapping (0,0,1,1,0,0,0): explored 19 schedules
mapping (0,1,0,0,0,1,0): explored 17 schedules
mapping (0,1,0,1,0,0,0): explored 26 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (0,1,0,1,1,0,0): explored 17 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 14808.756410973985/14808.756410973985
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 1: 14808.756410973985/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 4], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 3366.579665203031/10538.157480840096
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 2: 10538.157480840096/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 4, 1], [[8, 1, 1, 2], [0, 0, -1]], [[16, 8, 1, 1], [1, -1, 0]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 128, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 15165.99924217716/15165.99924217716
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 3: 15165.99924217716/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[28, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 27250.32972353314/27250.32972353314
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 4: 27250.32972353314/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 4542.67604658837/4542.67604658837
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 5: 4542.67604658837/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [8, 2, 1, 1], [1, 1, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 11904.320927118997/11904.320927118997
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 6: 11904.320927118997/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 12446.251756298905/12446.251756298905
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 7: 12446.251756298905/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, -1]], [2, 4, 2, 1], [[128, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 4, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 5696.486801712849/5696.486801712849
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 8: 5696.486801712849/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [4, 4, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[49, 16, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 24297.944343867257/24297.944343867257
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 9: 24297.944343867257/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [14, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 6034.474548821/20732.404143420124
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 10: 20732.404143420124/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 25549.689216206054/25549.689216206054
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 11: 25549.689216206054/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [2, 1, 4, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[56, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 7464.3377234089385/7464.3377234089385
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 12: 7464.3377234089385/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 2, 7, 1], [4, 4, 1, 1]], "reduce_factors": [[16, 1, 1]], "last_factors": [[98, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 5975.813488529035/5975.813488529035
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 13: 5975.813488529035/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 4], [14, 1, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[7, 56, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*Y
iteration=1: 949.0921155659079/949.0921155659079
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 14: 949.0921155659079/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [8, 1, 1, 2], [2, 2, 1, 7]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[2, 3136, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 6192.534558296099/21086.8508898989
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 15: 21086.8508898989/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 2539.8788630175072/2539.8788630175072
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 16: 2539.8788630175072/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 1, 1, 1], [2, 4, 2, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[8, 1568, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 20478.509400152692/20478.509400152692
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 17: 20478.509400152692/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 1, 1, 4], [7, 1, 4, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 2003.0390345776466/12409.74095891379
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 18: 12409.74095891379/28756.265656913532(0.03477502996845426 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 6507.532007539237/28756.265656913532
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 19: 28756.265656913532/28756.265656913532(0.03477502996845426 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 20079.41100029786/20079.41100029786
Best record value:28756.265656913532 (larger is better)
Round 2, Match 1, Mapping 20: 20079.41100029786/28756.265656913532(0.03477502996845426 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [2, 2, 4, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 21 schedules
mapping (0,0,0,0,0,1,1): explored 27 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 37 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 16 schedules
mapping (0,0,0,1,1,0,0): explored 28 schedules
mapping (0,0,1,0,0,1,0): explored 23 schedules
mapping (0,0,1,0,0,1,1): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 16 schedules
mapping (0,0,1,1,0,0,0): explored 20 schedules
mapping (0,1,0,0,0,1,0): explored 19 schedules
mapping (0,1,0,1,0,0,0): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
mapping (1,0,0,0,0,1,0): explored 32 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Tensorize use time 683.7864181995392 s.
#############################################
operations:inputs:[1, 128, 56, 56],[128],[128],body:S[1, 128, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 56, 56],body:S[1, 128, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 56, 56],body:S[1, 128, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 58, 58],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 56, 56] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph54/at:resnet50:subgraph54:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1420.5882336193113/1420.5882336193113
Best record value:1420.5882336193113 (larger is better)
Round 1, Match 1, Mapping 1: 1420.5882336193113/1420.5882336193113(0.7039337482419129 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 1, 1], [0, 1, 0]], [[4, 2, 4, 4], [-1, 1, -1]], [[4, 7, 1, 1], [1, 0, 0]]], "reduce_factors": [[[4, 1, 2], [0, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, -1]]], "last_factors": [[[28, 3584, 4], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 984.4346866773463/984.4346866773463
Best record value:1420.5882336193113 (larger is better)
Round 1, Match 1, Mapping 2: 984.4346866773463/1420.5882336193113(0.7039337482419129 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [1, 1, 1, 1], [1, 4, 1, 7]], "reduce_factors": [[6, 1, 4], [3, 1, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1383.5279485651172/1383.5279485651172
Best record value:1420.5882336193113 (larger is better)
Round 1, Match 1, Mapping 3: 1383.5279485651172/1420.5882336193113(0.7039337482419129 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*Y*Y
iteration=1: 1740.569625144869/1740.569625144869
Best record value:1740.569625144869 (larger is better)
Round 1, Match 1, Mapping 4: 1740.569625144869/1740.569625144869(0.5745245611285267 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 14, 1, 1], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 6, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 3361.5806347518524/3361.5806347518524
Best record value:3361.5806347518524 (larger is better)
Round 1, Match 1, Mapping 5: 3361.5806347518524/3361.5806347518524(0.2974791054131054 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 5021.392471767626/5021.392471767626
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 6: 5021.392471767626/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1296.3506027142334/1296.3506027142334
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 7: 1296.3506027142334/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 7, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[98, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 3670.7454211904846/3670.7454211904846
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 8: 3670.7454211904846/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[2, 6, 2], [3, 1, 1]], "last_factors": [[4, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/394.04538707368977
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 9: 394.04538707368977/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 8, 4, 1], [1, -1, 1]], [[1, 2, 1, 2], [0, -1, 0]], [[28, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[2, 3, 4], [0, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1792, 28, 8], [0, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/397.8012055504764
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 10: 397.8012055504764/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[64, 1, 1, 7], [1, 0, 0]], [[1, 1, 2, 2], [0, -1, 1]], [[1, 7, 2, 2], [0, 0, 1]]], "reduce_factors": [[[18, 2, 2], [0, 0]]], "last_factors": [[[3584, 56, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/415.5546323924342
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 11: 415.5546323924342/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[224, 14, 1, 4], [0, 0, 0]], [[1, 4, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[6, 1, 4], [0, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[25088, 8, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2090.319596257208/2090.319596257208
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 12: 2090.319596257208/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[7, 1, 1, 14], [[1, 2, 1, 2], [-1, 1, -1]]], "reduce_factors": [[[36, 2, 1], [1, 1]]], "last_factors": [[[56, 256, 28], [0, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 4110.955418912157/4110.955418912157
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 13: 4110.955418912157/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 2, 1, 14]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[196, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 135.13740480437244/351.3024020140138
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 14: 351.3024020140138/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[32, 7, 2, 1], [-1, 1, 0]], [[2, 1, 1, 2], [0, -1, 0]], [[1, 4, 1, 7], [-1, -1, -1]]], "reduce_factors": [[[8, 3, 1], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1024, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 1006.7381584191899/1006.7381584191899
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 15: 1006.7381584191899/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 28, 1, 1], [1, -1, 0]], [[4, 1, 1, 1], [0, 0, 0]], [[2, 14, 1, 1], [1, -1, 0]]], "reduce_factors": [[[12, 2, 1], [1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[896, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 1875.91044028376/1875.91044028376
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 16: 1875.91044028376/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 1409.6498627092012/1409.6498627092012
Best record value:5021.392471767626 (larger is better)
Round 1, Match 1, Mapping 17: 1409.6498627092012/5021.392471767626(0.19914794663480684 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": 8, "spatial_factors": [[[2, 7, 4, 8], [-1, -1, -1]], [[2, 2, 1, 1], [-1, 1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[72, 1, 1], [1, -1]]], "last_factors": [[[7168, 4, 14], [-1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 21742.738697325945/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/230.93754844672844
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 19: 230.93754844672844/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 14, 1, 8], [0, 1, 0]], [[2, 2, 1, 1], [1, 1, -1]], [[7, 2, 2, 1], [1, 1, 1]]], "reduce_factors": [[[4, 1, 2], [0, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14336, 28, 1], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 14151.93817815408/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 20 schedules
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 39 schedules
mapping (0,0,0,0,1,1,1): explored 19 schedules
mapping (0,0,0,1,0,0,0): explored 16 schedules
mapping (0,0,0,1,0,0,1): explored 11 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 11 schedules
mapping (0,0,1,0,0,1,1): explored 10 schedules
mapping (0,0,1,0,1,1,0): explored 23 schedules
mapping (0,0,1,0,1,1,1): explored 22 schedules
mapping (0,0,1,1,0,0,0): explored 11 schedules
mapping (0,1,0,0,0,1,0): explored 15 schedules
mapping (0,1,0,1,0,0,0): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 16 schedules
mapping (0,1,0,1,1,0,0): explored 19 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 14 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 5220.108360480306/5220.108360480306
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 1: 5220.108360480306/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[112, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/984.4346866773463
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 2: 984.4346866773463/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [1, 1, 1, 1], [1, 4, 1, 7]], "reduce_factors": [[6, 1, 4], [3, 1, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 1027.0659020492724/1383.5279485651172
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 3: 1383.5279485651172/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3022.2368787585197/3022.2368787585197
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 4: 3022.2368787585197/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[49, 2, 1, 1], [-1, 1, 0]], [[2, 1, 1, 2], [0, 0, -1]], [[8, 8, 1, 2], [1, 0, -1]]], "reduce_factors": [[[36, 1, 2], [1, 0]]], "last_factors": [[[256, 784, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2617.8643334162466/3361.5806347518524
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 5: 3361.5806347518524/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 132.42974365050102/5021.392471767626
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 6: 5021.392471767626/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1296.3506027142334
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 7: 1296.3506027142334/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 7, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[98, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/3670.7454211904846
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 8: 3670.7454211904846/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[2, 6, 2], [3, 1, 1]], "last_factors": [[4, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=1: 1392.39751174463/1392.39751174463
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 9: 1392.39751174463/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 7, 1, 4]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/397.8012055504764
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 10: 397.8012055504764/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[64, 1, 1, 7], [1, 0, 0]], [[1, 1, 2, 2], [0, -1, 1]], [[1, 7, 2, 2], [0, 0, 1]]], "reduce_factors": [[[18, 2, 2], [0, 0]]], "last_factors": [[[3584, 56, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/415.5546323924342
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 11: 415.5546323924342/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[224, 14, 1, 4], [0, 0, 0]], [[1, 4, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[6, 1, 4], [0, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[25088, 8, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 2411.3107152370035/2411.3107152370035
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 12: 2411.3107152370035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[9, 8, 1]], "last_factors": [[8, 392, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2218.6482973994025/4110.955418912157
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 13: 4110.955418912157/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 2, 1, 14]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[196, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 2636.4584391461667/2636.4584391461667
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 14: 2636.4584391461667/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 2, 1], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 3005.12749674423/3005.12749674423
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 15: 3005.12749674423/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [1, 1, 4, 1], [7, 2, 1, 2]], "reduce_factors": [[12, 2, 1], [1, 1, 3]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1875.91044028376
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 16: 1875.91044028376/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1442.4543445897102/1442.4543445897102
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 17: 1442.4543445897102/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [1, 2, 1, 2], [2, 2, 1, 7]], "reduce_factors": [[24, 1, 3]], "last_factors": [[2, 98, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2297.5708918748082/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 1916.5692427289177/1916.5692427289177
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 19: 1916.5692427289177/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [1, 1, 4, 1], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[1, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 41 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 21 schedules
mapping (0,0,0,1,0,0,1): explored 13 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 14 schedules
mapping (0,0,1,0,0,1,1): explored 10 schedules
mapping (0,0,1,0,1,1,0): explored 23 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 14 schedules
mapping (0,1,0,0,0,1,0): explored 16 schedules
mapping (0,1,0,1,0,0,0): explored 19 schedules
mapping (0,1,0,1,0,0,1): explored 16 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 16 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Tensorize use time 905.2610878944397 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[128, 256, 1, 1],body:R[1, 128, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [128, 256, 1, 1] [1, 128, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph55/at:resnet50:subgraph55:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*Y*Y
iteration=1: 19903.947737077124/19903.947737077124
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 1: 19903.947737077124/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/151.91191932417954
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 2: 151.91191932417954/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[2, 2, 1, 1], [-1, 1, 0]], [[8, 1, 8, 2], [1, 0, -1]], [[2, 14, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 2, 2], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 64, 7], [0, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 10639.188343287058/10639.188343287058
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 3: 10639.188343287058/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[7, 112, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4171.114015479908/4171.114015479908
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 4: 4171.114015479908/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 1, 8], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[4, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 666.5354589620085/666.5354589620085
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 5: 666.5354589620085/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[7, 1, 1, 1], [[2, 1, 1, 2], [-1, 0, 0]], [[2, 4, 1, 16], [0, 0, 0]], [[4, 7, 2, 1], [1, 0, 0]]], "reduce_factors": [[[4, 2, 2], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[32, 25088, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7861.926050231429/7861.926050231429
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 6: 7861.926050231429/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[14, 7, 4, 1], [0, 0, 0]], [[1, 2, 1, 2], [0, 0, 0]], [[2, 32, 2, 1], [0, 0, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1429.9619038976127/1429.9619038976127
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 7: 1429.9619038976127/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[98, 2, 1, 2], [-1, 1, -1]], [[2, 1, 1, 2], [0, 0, 0]], [[2, 64, 1, 1], [0, 0, 0]]], "reduce_factors": [[[4, 4, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[56, 4096, 7], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11447.354719703675/11447.354719703675
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 8: 11447.354719703675/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 1, 2, 2], [0, 0, 1]], [[8, 1, 2, 8], [0, -1, 0]], [[7, 2, 1, 4], [1, 0, 0]]], "reduce_factors": [[[8, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 392, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 15336.34068216761/15336.34068216761
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 9: 15336.34068216761/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 17076.442356508247/17076.442356508247
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 10: 17076.442356508247/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 2, 7, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 1853.7402687434658/1853.7402687434658
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 11: 1853.7402687434658/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 98, 4, 1], [2, 2, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[784, 8, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 2854.407634448232/2854.407634448232
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 12: 2854.407634448232/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[6272, 8, 1, 1], [1, -1, 0]], [[2, 2, 1, 1], [0, 1, 0]]], "reduce_factors": [[[4, 4, 1], [0, 0]]], "last_factors": [[[98, 512, 32], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2928.115587788554/2928.115587788554
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 13: 2928.115587788554/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[16, 7, 4, 2], [-1, 1, 0]], [[2, 2, 1, 1], [0, 1, 0]], [[1, 8, 1, 7], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 56, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 7165.670948116855/7165.670948116855
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 14: 7165.670948116855/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[16, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3843.819394301939/3843.819394301939
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 15: 3843.819394301939/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[7, 128, 1, 1], [-1, 1, 0]], [[2, 1, 2, 1], [0, 0, 0]], [[4, 2, 7, 1], [-1, 1, 1]]], "reduce_factors": [[[4, 2, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 56, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 898.6759340152666/898.6759340152666
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 16: 898.6759340152666/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [1, 1], "vectorize": 4, "spatial_factors": [[[1024, 7, 7, 1], [1, 0, -1]], [[4, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 8, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[64, 25088, 1], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/304.87544107301846
Best record value:19903.947737077124 (larger is better)
Round 1, Match 1, Mapping 17: 304.87544107301846/19903.947737077124(0.05024128947732301 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[448, 1, 2, 1], [1, -1, 1]], [[1, 2, 1, 2], [0, 1, -1]], [[14, 2, 2, 1], [0, 0, 1]]], "reduce_factors": [[[2, 4, 2], [-1, 0]]], "last_factors": [[[8192, 28, 7], [1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 23397.430823519346/23397.430823519346
Best record value:23397.430823519346 (larger is better)
Round 1, Match 1, Mapping 18: 23397.430823519346/23397.430823519346(0.04273973529584237 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 1813.008621503641/1813.008621503641
Best record value:23397.430823519346 (larger is better)
Round 1, Match 1, Mapping 19: 1813.008621503641/23397.430823519346(0.04273973529584237 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 1], [1, 14, 4, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 256, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 5180.27059154562/5180.27059154562
Best record value:23397.430823519346 (larger is better)
Round 1, Match 1, Mapping 20: 5180.27059154562/23397.430823519346(0.04273973529584237 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 4, 14, 1], [2, 2, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 448, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 13 schedules
mapping (0,0,0,0,1,1,0): explored 29 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 16 schedules
mapping (0,0,0,1,0,0,1): explored 39 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 22 schedules
mapping (0,0,1,1,0,0,0): explored 33 schedules
mapping (0,1,0,0,0,1,0): explored 14 schedules
mapping (0,1,0,1,0,0,0): explored 23 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 12 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 33 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 11656.312718290948/19903.947737077124
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 1: 19903.947737077124/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1859.1694457968015/1859.1694457968015
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 2: 1859.1694457968015/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[1, 7, 1, 1], [-1, 1, 0]], [[2, 2, 1, 1], [-1, 1, 0]], [[8, 1, 8, 2], [1, 0, -1]], [[2, 14, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 2, 2], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 64, 7], [0, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 976.1717669445602/10639.188343287058
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 3: 10639.188343287058/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[7, 112, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 20919.575408866498/20919.575408866498
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 4: 20919.575408866498/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 1, 1, 1], [0, 0, 0]], [[1, 2, 2, 1], [-1, 0, 1]], [[1, 64, 2, 1], [0, 0, 0]]], "reduce_factors": [[[1, 1, 16], [0, -1]]], "last_factors": [[[7168, 14, 16], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 1278.780350452952/1278.780350452952
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 5: 1278.780350452952/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, -1]], [[1, 4, 1, 1], [0, 0, 0]], [[2, 64, 1, 1], [0, 0, 0]], [[1, 7, 8, 1], [0, 1, -1]]], "reduce_factors": [[[1, 8, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16, 6272, 16], [-1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 2618.2851839715117/7861.926050231429
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 6: 7861.926050231429/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[14, 7, 4, 1], [0, 0, 0]], [[1, 2, 1, 2], [0, 0, 0]], [[2, 32, 2, 1], [0, 0, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 7627.03575408849/7627.03575408849
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 7: 7627.03575408849/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 4, 1, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 10812.40229258479/11447.354719703675
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 8: 11447.354719703675/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 1, 2, 2], [0, 0, 1]], [[8, 1, 2, 8], [0, -1, 0]], [[7, 2, 1, 4], [1, 0, 0]]], "reduce_factors": [[[8, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 392, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 8967.532238766358/15336.34068216761
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 9: 15336.34068216761/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2421.1148500952645/17076.442356508247
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 10: 17076.442356508247/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 2, 7, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1997.3905690674071/1997.3905690674071
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 11: 1997.3905690674071/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 98, 4, 1], [2, 2, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[196, 2, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 513.096133057665/2854.407634448232
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 12: 2854.407634448232/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[6272, 8, 1, 1], [1, -1, 0]], [[2, 2, 1, 1], [0, 1, 0]]], "reduce_factors": [[[4, 4, 1], [0, 0]]], "last_factors": [[[98, 512, 32], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 328.1963881501754/2928.115587788554
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 13: 2928.115587788554/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[16, 7, 4, 2], [-1, 1, 0]], [[2, 2, 1, 1], [0, 1, 0]], [[1, 8, 1, 7], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 56, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 2714.872100955914/7165.670948116855
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 14: 7165.670948116855/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[16, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 13835.913333116614/13835.913333116614
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 15: 13835.913333116614/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 2, 14, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[98, 16, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 4387.6600612173/4387.6600612173
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 16: 4387.6600612173/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 56, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[28, 448, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7681.553992397589/7681.553992397589
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 17: 7681.553992397589/23397.430823519346(0.04273973529584237 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 4], [4, 2, 1, 7]], "reduce_factors": [[4, 2, 2]], "last_factors": [[896, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 5684.442027781026/23397.430823519346
Best record value:23397.430823519346 (larger is better)
Round 2, Match 1, Mapping 18: 23397.430823519346/23397.430823519346(0.04273973529584237 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 24698.83842594094/24698.83842594094
Best record value:24698.83842594094 (larger is better)
Round 2, Match 1, Mapping 19: 24698.83842594094/24698.83842594094(0.0404877339879154 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 1809.4751870546474/5180.27059154562
Best record value:24698.83842594094 (larger is better)
Round 2, Match 1, Mapping 20: 5180.27059154562/24698.83842594094(0.0404877339879154 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 4, 14, 1], [2, 2, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 448, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.09699956942956131, 0.1184755416416151, 0.0435847160516013]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 32 schedules
mapping (0,0,0,0,0,1,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,0): explored 20 schedules
mapping (0,0,0,1,0,0,1): explored 42 schedules
mapping (0,0,0,1,0,1,0): explored 26 schedules
mapping (0,0,0,1,1,0,0): explored 23 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 37 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 34 schedules
mapping (0,1,0,0,0,1,0): explored 17 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 28 schedules
mapping (0,1,0,1,1,0,0): explored 17 schedules
mapping (1,0,0,0,0,1,0): explored 26 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 35 schedules
Tensorize use time 567.802006483078 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [1, 256, 56, 56] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph56.log by 200 trials...
.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.N.N.N.E.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.035911144617163084
.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.B.Y.E.Y.Y.Y.Y.Y.E.Y.E.N

Currently best performance: 0.03589672583237616
.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.03589672583237616
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.Y.T.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.034637848591351564
.N.N.N.B.N.B.Y.E.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.018120057842545716
.T.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.018120057842545716
.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.011966516263552858
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.011966516263552858
.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.E.Y.E.Y.Y.Y.N.N.N.N

Currently best performance: 0.009820530162860476
.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N

Currently best performance: 0.009760621093950605
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.009760621093950605
.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.009760621093950605
.N.N.N.N.N.N.N.NSchedule cost 1232.555446 seconds
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph57/at:resnet50:subgraph57:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 15055.30887162286/15055.30887162286
Best record value:15055.30887162286 (larger is better)
Round 1, Match 1, Mapping 1: 15055.30887162286/15055.30887162286(0.06642175252112292 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 2, 2, 1], [1, 1, 1, 1], [14, 4, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 32, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 23117.605283907164/23117.605283907164
Best record value:23117.605283907164 (larger is better)
Round 1, Match 1, Mapping 2: 23117.605283907164/23117.605283907164(0.04325707562349155 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[128, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 5070.495064443655/5070.495064443655
Best record value:23117.605283907164 (larger is better)
Round 1, Match 1, Mapping 3: 5070.495064443655/23117.605283907164(0.04325707562349155 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 28, 2, 7], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[112, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 28800.016425155183/28800.016425155183
Best record value:28800.016425155183 (larger is better)
Round 1, Match 1, Mapping 4: 28800.016425155183/28800.016425155183(0.03472220241952906 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 14, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[6272, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 3115.5053823654957/3115.5053823654957
Best record value:28800.016425155183 (larger is better)
Round 1, Match 1, Mapping 5: 3115.5053823654957/28800.016425155183(0.03472220241952906 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 4, 1, 2], [1, 1, 1, 1], [1, 2, 4, 7]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 4634.892788190171/4634.892788190171
Best record value:28800.016425155183 (larger is better)
Round 1, Match 1, Mapping 6: 4634.892788190171/28800.016425155183(0.03472220241952906 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 7, 8, 1], [1, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[16, 1568, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1646.844675879773/1646.844675879773
Best record value:28800.016425155183 (larger is better)
Round 1, Match 1, Mapping 7: 1646.844675879773/28800.016425155183(0.03472220241952906 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[2, 49, 4, 1], [[1, 4, 1, 2], [0, -1, 0]], [[16, 1, 2, 4], [0, -1, 1]]], "reduce_factors": [[[1, 1, 4], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[784, 128, 32], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 28454.542706159056/28454.542706159056
Best record value:28800.016425155183 (larger is better)
Round 1, Match 1, Mapping 8: 28454.542706159056/28800.016425155183(0.03472220241952906 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[392, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 33795.787029443105/33795.787029443105
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 9: 33795.787029443105/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 16559.730289422117/16559.730289422117
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 10: 16559.730289422117/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 2], [14, 4, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[28, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 20586.935591413083/20586.935591413083
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 11: 20586.935591413083/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 2, 28], [2, 1, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 2866.647435473815/2866.647435473815
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 12: 2866.647435473815/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[896, 14, 1, 4], [1, 1, 0]], [[2, 2, 2, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 1], [1, 1]]], "last_factors": [[[256, 392, 32], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 18177.067684373378/18177.067684373378
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 13: 18177.067684373378/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 112, 1, 8], [0, -1, 0]], [8, 1, 1, 1], [[7, 2, 1, 4], [0, -1, 0]]], "reduce_factors": [[[1, 4, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 32, 2], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 23993.335556100326/23993.335556100326
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 14: 23993.335556100326/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 2, 2], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 13960.26263961901/13960.26263961901
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 15: 13960.26263961901/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 2], [1, 4, 14, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1792, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 19213.203344033594/19213.203344033594
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 16: 19213.203344033594/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 2, 7], [2, 4, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[98, 32, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 23549.57928705717/23549.57928705717
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 17: 23549.57928705717/33795.787029443105(0.029589486971520848 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [8, 1, 7, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[224, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 20338.70131069586/20338.70131069586
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 18: 20338.70131069586/33795.787029443105(0.029589486971520848 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 4], [28, 2, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 1375.8901805127791/1375.8901805127791
Best record value:33795.787029443105 (larger is better)
Round 1, Match 1, Mapping 19: 1375.8901805127791/33795.787029443105(0.029589486971520848 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 4], [1, 8, 1, 7]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 16, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 36336.97839989095/36336.97839989095
Best record value:36336.97839989095 (larger is better)
Round 1, Match 1, Mapping 20: 36336.97839989095/36336.97839989095(0.027520174875162465 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 2, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 21 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 39 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 26 schedules
mapping (0,0,0,1,1,0,0): explored 27 schedules
mapping (0,0,1,0,0,1,0): explored 21 schedules
mapping (0,0,1,0,0,1,1): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 34 schedules
mapping (0,0,1,0,1,1,1): explored 32 schedules
mapping (0,0,1,1,0,0,0): explored 38 schedules
mapping (0,1,0,0,0,1,0): explored 39 schedules
mapping (0,1,0,1,0,0,0): explored 27 schedules
mapping (0,1,0,1,0,0,1): explored 33 schedules
mapping (0,1,0,1,1,0,0): explored 36 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 29 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 30255.87926791854/30255.87926791854
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 1: 30255.87926791854/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 3623.751526605323/23117.605283907164
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 2: 23117.605283907164/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[128, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 22046.34626950978/22046.34626950978
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 3: 22046.34626950978/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 2, 7, 1], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[224, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2048.865633248958/28800.016425155183
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 4: 28800.016425155183/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 14, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[6272, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 14206.820017728136/14206.820017728136
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 5: 14206.820017728136/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 4], [1, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 18592.999013958422/18592.999013958422
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 6: 18592.999013958422/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 7, 2, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[14, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 31422.562786164624/31422.562786164624
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 7: 31422.562786164624/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[56, 1, 1, 7], [1, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 17433.55373589147/28454.542706159056
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 8: 28454.542706159056/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[392, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 22133.51508626506/33795.787029443105
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 9: 33795.787029443105/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 23396.179408899578/23396.179408899578
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 10: 23396.179408899578/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 4, 1], [1, 4, 1, 14]], "reduce_factors": [[2, 2, 1]], "last_factors": [[32, 56, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*Y
iteration=1: 6415.920045319265/20586.935591413083
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 11: 20586.935591413083/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 2, 28], [2, 1, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2866.647435473815
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 12: 2866.647435473815/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[896, 14, 1, 4], [1, 1, 0]], [[2, 2, 2, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 1], [1, 1]]], "last_factors": [[[256, 392, 32], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 3749.234447317652/18177.067684373378
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 13: 18177.067684373378/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 112, 1, 8], [0, -1, 0]], [8, 1, 1, 1], [[7, 2, 1, 4], [0, -1, 0]]], "reduce_factors": [[[1, 4, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 32, 2], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 8067.671370163325/23993.335556100326
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 14: 23993.335556100326/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 2, 2], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 2615.1142134123334/13960.26263961901
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 15: 13960.26263961901/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 2], [1, 4, 14, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1792, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1565.4313300513581/19213.203344033594
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 16: 19213.203344033594/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 2, 7], [2, 4, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[98, 32, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 5629.18802985859/23549.57928705717
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 17: 23549.57928705717/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [8, 1, 7, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[224, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 5826.189686340659/20338.70131069586
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 18: 20338.70131069586/36336.97839989095(0.027520174875162465 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 4], [28, 2, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 10750.482115154879/10750.482115154879
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 19: 10750.482115154879/36336.97839989095(0.027520174875162465 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 1, 7], [[2, 4, 1, 1], [-1, 1, 0]], [[28, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[1, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3136, 64, 16], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 8844.912050491483/36336.97839989095
Best record value:36336.97839989095 (larger is better)
Round 2, Match 1, Mapping 20: 36336.97839989095/36336.97839989095(0.027520174875162465 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 2, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 29 schedules
mapping (0,0,0,0,1,1,1): explored 44 schedules
mapping (0,0,0,1,0,0,0): explored 30 schedules
mapping (0,0,0,1,0,0,1): explored 37 schedules
mapping (0,0,0,1,0,1,0): explored 30 schedules
mapping (0,0,0,1,1,0,0): explored 30 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 36 schedules
mapping (0,0,1,0,1,1,1): explored 32 schedules
mapping (0,0,1,1,0,0,0): explored 42 schedules
mapping (0,1,0,0,0,1,0): explored 43 schedules
mapping (0,1,0,1,0,0,0): explored 31 schedules
mapping (0,1,0,1,0,0,1): explored 38 schedules
mapping (0,1,0,1,1,0,0): explored 39 schedules
mapping (1,0,0,0,0,1,0): explored 25 schedules
mapping (1,0,0,1,0,0,0): explored 33 schedules
mapping (1,0,0,1,0,1,0): explored 32 schedules
Tensorize use time 685.5991411209106 s.
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 58, 58],[64, 64, 3, 3],body:R[1, 64, 56, 56] [64, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [64, 64, 3, 3] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph58/at:resnet50:subgraph58:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 12846.252376118484/12846.252376118484
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 1: 12846.252376118484/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[14, 14, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 1878.2572139658485/1878.2572139658485
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 2: 1878.2572139658485/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[6, 2, 1], [1, 3, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2415.1919540583144/2415.1919540583144
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 3: 2415.1919540583144/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[49, 4, 1, 2], [[2, 1, 1, 4], [0, -1, -1]], [[4, 16, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[12, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1024, 784, 1], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 437.8955426212781/437.8955426212781
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 4: 437.8955426212781/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[1, 49, 2, 1], [0, 0, 1]], [[1, 2, 2, 2], [-1, -1, 1]], [1, 1, 1, 1]], "reduce_factors": [[[18, 1, 2], [-1, 0]]], "last_factors": [[[4, 50176, 4], [0, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 168.73556179363803/168.73556179363803
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 5: 168.73556179363803/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [1, -1], "spatial_factors": [[[1, 2, 1, 1], [-1, 1, 0]], [[1, 4, 1, 2], [0, 0, -1]], [[16, 4, 1, 2], [1, -1, 0]], [[1, 56, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[4, 1, 1], [0, 0]], [[1, 1, 3], [0, -1]], [[1, 3, 1], [0, 0]]], "last_factors": [[[128, 3136, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 9854.827515129777/9854.827515129777
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 6: 9854.827515129777/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 7, 4, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[3, 4, 1], [1, 3, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6053.610385410307/6053.610385410307
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 7: 6053.610385410307/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[49, 1, 8, 1], [[1, 2, 1, 4], [0, 0, 0]], [[8, 1, 2, 8], [1, 0, -1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[8, 3584, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1131.7905440511747/1131.7905440511747
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 8: 1131.7905440511747/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[7, 1, 1, 1], [[1, 2, 4, 1], [0, 1, -1]], [[1, 16, 2, 4], [0, 1, -1]], [[2, 28, 1, 1], [1, 1, -1]]], "reduce_factors": [[[3, 4, 1], [-1, 1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[56, 1024, 14], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 694.9593053897719/694.9593053897719
Best record value:12846.252376118484 (larger is better)
Round 1, Match 1, Mapping 9: 694.9593053897719/12846.252376118484(0.07784371431617099 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[56, 4, 1, 1], [1, -1, 0]], [[2, 1, 4, 1], [1, 0, 0]], [[28, 1, 2, 1], [1, 0, 0]]], "reduce_factors": [[2, 2, 3], [[3, 1, 1], [1, -1]]], "last_factors": [[[14, 4096, 14], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 15252.909127210763/15252.909127210763
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 10: 15252.909127210763/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 9]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 12300.972839729848/12300.972839729848
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 11: 12300.972839729848/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 4, 1], [1, 1, 2, 1]], "reduce_factors": [[3, 2, 2], [1, 3, 1]], "last_factors": [[32, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 2727.748561593089/2727.748561593089
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 12: 2727.748561593089/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 14, 4, 7], [1, 1, 2, 1]], "reduce_factors": [[9, 4, 1]], "last_factors": [[1568, 1, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 7375.4926699275065/7375.4926699275065
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 13: 7375.4926699275065/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 14, 4, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 1995.6178254124363/1995.6178254124363
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 14: 1995.6178254124363/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 3], [3, 1, 1]], "last_factors": [[1, 1568, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 3278.7983608287914/3278.7983608287914
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 15: 3278.7983608287914/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 14, 1, 1]], "reduce_factors": [[4, 3, 1], [1, 3, 1]], "last_factors": [[2, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 5597.691138994869/5597.691138994869
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 16: 5597.691138994869/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[2, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/105.05008850462077
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 17: 105.05008850462077/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 16, 1, 2], [-1, 1, -1]], [[1, 2, 4, 1], [0, 1, -1]], [[7, 4, 2, 1], [1, -1, 1]]], "reduce_factors": [[[6, 6, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 7467.546332990333/7467.546332990333
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 18: 7467.546332990333/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 152.67560419933304/160.72847106381306
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 19: 160.72847106381306/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[16, 14, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[7, 4, 2, 1], [0, 0, 1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[28672, 4, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/240.19915911510736
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 20: 240.19915911510736/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[224, 14, 2, 2], [1, -1, 0]], [[2, 1, 1, 4], [1, 0, -1]]], "reduce_factors": [[[4, 1, 1], [1, -1]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[256, 448, 7], [0, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 12 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 12 schedules
mapping (0,0,1,0,0,1,1): explored 11 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 11 schedules
mapping (0,0,1,1,0,0,0): explored 15 schedules
mapping (0,1,0,0,0,1,0): explored 11 schedules
mapping (0,1,0,1,0,0,0): explored 9 schedules
mapping (0,1,0,1,0,0,1): explored 13 schedules
mapping (0,1,0,1,1,0,0): explored 12 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 6 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 14070.838041803818/14070.838041803818
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 1: 14070.838041803818/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1878.2572139658485
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 2: 1878.2572139658485/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[6, 2, 1], [1, 3, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.E
*Y*Y
iteration=1: 1711.9266918752007/2415.1919540583144
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 3: 2415.1919540583144/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[49, 4, 1, 2], [[2, 1, 1, 4], [0, -1, -1]], [[4, 16, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[12, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1024, 784, 1], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 1388.3204016481636/1388.3204016481636
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 4: 1388.3204016481636/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 14, 1, 1], [1, -1, 0]], [[2, 1, 2, 2], [-1, 0, 0]], [[4, 4, 8, 1], [0, 0, 0]]], "reduce_factors": [[[18, 1, 2], [0, 0]]], "last_factors": [[[98, 1024, 8], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 578.7217089182636/578.7217089182636
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 5: 578.7217089182636/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[1, 2, 1, 1], [-1, 1, 0]], [1, 1, 1, 2], [[1, 32, 4, 1], [0, 0, 0]], [[1, 56, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[4, 1, 1], [0, 0]], [[1, 1, 3], [0, -1]], [[1, 3, 1], [0, 0]]], "last_factors": [[[128, 3136, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 9639.128552676086/9854.827515129777
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 6: 9854.827515129777/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 7, 4, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[3, 4, 1], [1, 3, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 2713.876936536436/6053.610385410307
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 7: 6053.610385410307/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[49, 1, 8, 1], [[1, 2, 1, 4], [0, 0, 0]], [[8, 1, 2, 8], [1, 0, -1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[8, 3584, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 11286.28306526074/11286.28306526074
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 8: 11286.28306526074/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 3, 4], [3, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 1603.1074416539163/1603.1074416539163
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 9: 1603.1074416539163/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 1], [14, 4, 1, 1]], "reduce_factors": [[3, 1, 4], [3, 1, 1]], "last_factors": [[28, 224, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 2900.1814366363487/15252.909127210763
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 10: 15252.909127210763/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 9]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 468.6072264494906/12300.972839729848
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 11: 12300.972839729848/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 4, 1], [1, 1, 2, 1]], "reduce_factors": [[3, 2, 2], [1, 3, 1]], "last_factors": [[32, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 3706.5314028536272/3706.5314028536272
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 12: 3706.5314028536272/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[7, 7, 8, 1], [2, 1, 1, 1]], "reduce_factors": [[6, 2, 3]], "last_factors": [[49, 4, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 1341.9722158072439/7375.4926699275065
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 13: 7375.4926699275065/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 14, 4, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/1995.6178254124363
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 14: 1995.6178254124363/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 3], [3, 1, 1]], "last_factors": [[1, 1568, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 30.765301936044818/3278.7983608287914
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 15: 3278.7983608287914/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 14, 1, 1]], "reduce_factors": [[4, 3, 1], [1, 3, 1]], "last_factors": [[2, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 1083.2412787422486/5597.691138994869
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 16: 5597.691138994869/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[2, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 3511.1131349554685/3511.1131349554685
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 17: 3511.1131349554685/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 2, 4, 1], [0, 1, -1]], [[7, 4, 2, 1], [1, -1, 1]]], "reduce_factors": [[[6, 6, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/7467.546332990333
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 18: 7467.546332990333/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 1767.3739219271488/1767.3739219271488
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 19: 1767.3739219271488/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 16, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/240.19915911510736
Best record value:15252.909127210763 (larger is better)
Round 2, Match 1, Mapping 20: 240.19915911510736/15252.909127210763(0.0655612638651356 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[224, 14, 2, 2], [1, -1, 0]], [[2, 1, 1, 4], [1, 0, -1]]], "reduce_factors": [[[4, 1, 1], [1, -1]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[256, 448, 7], [0, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 9 schedules
mapping (0,0,0,1,0,0,1): explored 25 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,0,1,1,0,0): explored 18 schedules
mapping (0,0,1,0,0,1,0): explored 14 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 13 schedules
mapping (0,0,1,1,0,0,0): explored 17 schedules
mapping (0,1,0,0,0,1,0): explored 11 schedules
mapping (0,1,0,1,0,0,0): explored 10 schedules
mapping (0,1,0,1,0,0,1): explored 14 schedules
mapping (0,1,0,1,1,0,0): explored 16 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 8 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Tensorize use time 900.7867603302002 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[64, 256, 1, 1],body:R[1, 64, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [64, 256, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph59/at:resnet50:subgraph59:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/487.37118283590354
Best record value:487.37118283590354 (larger is better)
Round 1, Match 1, Mapping 1: 487.37118283590354/487.37118283590354(2.051824226006192 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [[4, 1, 1, 2], [0, 0, 0]], [[2, 16, 2, 2], [0, 0, 1]], [[14, 2, 2, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 2, 32], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 7111.740029148462/7111.740029148462
Best record value:7111.740029148462 (larger is better)
Round 1, Match 1, Mapping 2: 7111.740029148462/7111.740029148462(0.140612564 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [1, 28, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 4019.497259615396/4019.497259615396
Best record value:7111.740029148462 (larger is better)
Round 1, Match 1, Mapping 3: 4019.497259615396/7111.740029148462(0.140612564 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 14, 1, 1], [1, 1, 0]], [[1, 2, 2, 2], [0, 1, 0]], [[4, 16, 1, 2], [-1, 1, -1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[896, 896, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 11496.56548646822/11496.56548646822
Best record value:11496.56548646822 (larger is better)
Round 1, Match 1, Mapping 4: 11496.56548646822/11496.56548646822(0.08698249935400516 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[14, 14, 2, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[784, 1, 8]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 4381.220314983328/4381.220314983328
Best record value:11496.56548646822 (larger is better)
Round 1, Match 1, Mapping 5: 4381.220314983328/11496.56548646822(0.08698249935400516 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 8, 1, 1], [0, 0, 0]], [[1, 64, 1, 2], [0, 1, 0]], [[28, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[8, 1, 2], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28, 1024, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 26334.41149731607/26334.41149731607
Best record value:26334.41149731607 (larger is better)
Round 1, Match 1, Mapping 6: 26334.41149731607/26334.41149731607(0.03797312881291907 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 2, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 12895.375957544638/12895.375957544638
Best record value:26334.41149731607 (larger is better)
Round 1, Match 1, Mapping 7: 12895.375957544638/26334.41149731607(0.03797312881291907 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 28], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 392, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 24016.396618017265/24016.396618017265
Best record value:26334.41149731607 (larger is better)
Round 1, Match 1, Mapping 8: 24016.396618017265/26334.41149731607(0.03797312881291907 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[1, 1, 8, 1], [0, 0, 1]], [[1, 16, 1, 8], [0, 0, 0]], [[28, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 7, 16], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 40719.06344620151/40719.06344620151
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 9: 40719.06344620151/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 7, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 7691.788389320996/7691.788389320996
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 10: 7691.788389320996/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[7, 1, 1, 1], [[1, 1, 8, 1], [-1, 0, 1]], [[1, 14, 1, 4], [0, -1, 0]]], "reduce_factors": [[[16, 1, 1], [1, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 11515.016352578752/11515.016352578752
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 11: 11515.016352578752/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 2, 7, 2], [1, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[4, 56, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 546.046839218268/1123.8273778671048
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 12: 1123.8273778671048/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[112, 8, 2, 7], [0, 0, 0]], [[1, 1, 2, 4], [0, 0, 1]]], "reduce_factors": [[[16, 1, 1], [1, 0]]], "last_factors": [[[448, 64, 28], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1239.649466799572/1239.649466799572
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 13: 1239.649466799572/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[[7, 16, 2, 1], [0, 0, 0]], [1, 1, 1, 2], [[28, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 8, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[56, 14336, 1], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 9520.69410267341/9520.69410267341
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 14: 9520.69410267341/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [1, 2, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[14, 56, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 28681.933664966058/28681.933664966058
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 15: 28681.933664966058/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [7, 1, 4, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13747.84881448691/13747.84881448691
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 16: 13747.84881448691/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[1792, 7, 1, 1], [1, -1, 0]], [2, 1, 1, 1]], "reduce_factors": [[[4, 1, 4], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 16131.901186734542/16131.901186734542
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 17: 16131.901186734542/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[4, 4, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 5010.833339982673/5010.833339982673
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 18: 5010.833339982673/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 4, 2, 1], [0, -1, 1]], [[2, 14, 1, 2], [1, -1, -1]]], "reduce_factors": [[[16, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4, 6272, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 19094.34597403164/19094.34597403164
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 19: 19094.34597403164/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 17370.15211931868/17370.15211931868
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 20: 17370.15211931868/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [1, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 15 schedules
mapping (0,0,0,0,1,1,1): explored 17 schedules
mapping (0,0,0,1,0,0,0): explored 19 schedules
mapping (0,0,0,1,0,0,1): explored 12 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 18 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 9 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 19 schedules
mapping (0,1,0,0,0,1,0): explored 11 schedules
mapping (0,1,0,1,0,0,0): explored 8 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 30 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 10493.375714969676/10493.375714969676
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 1: 10493.375714969676/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [1, 1, 1, 1], [7, 4, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 5495.623593748817/7111.740029148462
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 2: 7111.740029148462/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [1, 28, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 16370.002420933628/16370.002420933628
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 3: 16370.002420933628/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 2, 7, 2], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[64, 49, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 26024.05314093094/26024.05314093094
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 4: 26024.05314093094/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 1], [1, 0, -1]], [[2, 8, 1, 8], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [1, 1]]], "last_factors": [[[12544, 64, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4366.345015140197/4381.220314983328
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 5: 4381.220314983328/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 8, 1, 1], [0, 0, 0]], [[1, 64, 1, 2], [0, 1, 0]], [[28, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[8, 1, 2], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28, 1024, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 6037.34079707542/26334.41149731607
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 6: 26334.41149731607/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 2, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 25878.99624128313/25878.99624128313
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 7: 25878.99624128313/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[[7, 2, 7, 1], [0, -1, 1]], [2, 1, 1, 1], [[4, 32, 1, 1], [0, 0, 0]]], "reduce_factors": [[[8, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 2917.914971957717/24016.396618017265
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 8: 24016.396618017265/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[1, 1, 8, 1], [0, 0, 1]], [[1, 16, 1, 8], [0, 0, 0]], [[28, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 7, 16], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 11096.725271783418/40719.06344620151
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 9: 40719.06344620151/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 7, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 8628.556616557325/8628.556616557325
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 10: 8628.556616557325/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [[1, 14, 1, 4], [0, -1, 0]]], "reduce_factors": [[[16, 1, 1], [1, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 8933.961793408775/11515.016352578752
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 11: 11515.016352578752/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 2, 7, 2], [1, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[4, 56, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*Y*E*Y
iteration=1: 27724.43320120948/27724.43320120948
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 12: 27724.43320120948/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[8, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 25923.241713444306/25923.241713444306
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 13: 25923.241713444306/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [4, 2, 7, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[224, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 19002.848353426183/19002.848353426183
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 14: 19002.848353426183/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 2, 28]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 10809.191083376083/28681.933664966058
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 15: 28681.933664966058/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [7, 1, 4, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 6018.366964877183/13747.84881448691
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 16: 13747.84881448691/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[1792, 7, 1, 1], [1, -1, 0]], [2, 1, 1, 1]], "reduce_factors": [[[4, 1, 4], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 27685.930374025305/27685.930374025305
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 17: 27685.930374025305/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [14, 4, 1, 1]], "reduce_factors": [[1, 2, 8]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 19750.917298130327/19750.917298130327
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 18: 19750.917298130327/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 1], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 56, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 16467.202368477007/19094.34597403164
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 19: 19094.34597403164/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11639.59521237769/17370.15211931868
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 20: 17370.15211931868/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [1, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 22 schedules
mapping (0,0,0,0,0,1,1): explored 19 schedules
mapping (0,0,0,0,1,1,0): explored 18 schedules
mapping (0,0,0,0,1,1,1): explored 21 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 14 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 20 schedules
mapping (0,0,1,0,0,1,0): explored 20 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 26 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 14 schedules
mapping (0,1,0,1,0,0,0): explored 12 schedules
mapping (0,1,0,1,0,0,1): explored 35 schedules
mapping (0,1,0,1,1,0,0): explored 11 schedules
mapping (1,0,0,0,0,1,0): explored 27 schedules
mapping (1,0,0,1,0,0,0): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 35 schedules
Tensorize use time 594.7403092384338 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [256] [256] [1, 256, 56, 56] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph64.log by 200 trials...
.Y.Y.Y.Y.E.E.Y.Y.Y.Y.B.B.N.N.B.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.B.B.N

Currently best performance: 0.012765989487168847
.N.N.N.N.E.Y.Y.E.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.E.E.Y.T.Y.Y.Y.Y.Y.Y

Currently best performance: 0.012765989487168847
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.012765989487168847
.N.E.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.E.N.N.N

Currently best performance: 0.012765989487168847
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.B.N.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.009826862596003147
.N.N.N.N.N.N.N.Y.Y.E.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.E.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.009826862596003147
.N.N.N.N.N.N.N.NSchedule cost 1068.321985 seconds
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph65/at:resnet50:subgraph65:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 1951.8606228139374/1951.8606228139374
Best record value:1951.8606228139374 (larger is better)
Round 1, Match 1, Mapping 1: 1951.8606228139374/1951.8606228139374(0.512331663599182 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[7, 1, 1, 1], [1, 0, 0]], [1, 1, 2, 4], [[1, 128, 1, 1], [0, 1, 0]], [[14, 1, 4, 1], [-1, 0, 1]]], "reduce_factors": [[[2, 1, 2], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[32, 3136, 32], [1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 10980.50475396731/10980.50475396731
Best record value:10980.50475396731 (larger is better)
Round 1, Match 1, Mapping 2: 10980.50475396731/10980.50475396731(0.0910704947000451 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 4], [1, 1, 1, 1], [1, 4, 7, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 256, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 26744.1524947093/26744.1524947093
Best record value:26744.1524947093 (larger is better)
Round 1, Match 1, Mapping 3: 26744.1524947093/26744.1524947093(0.037391351256983237 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 25270.17925299139/25270.17925299139
Best record value:26744.1524947093 (larger is better)
Round 1, Match 1, Mapping 4: 25270.17925299139/26744.1524947093(0.037391351256983237 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 7, 1, 2], [1, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[56, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 7136.101335489445/7136.101335489445
Best record value:26744.1524947093 (larger is better)
Round 1, Match 1, Mapping 5: 7136.101335489445/26744.1524947093(0.037391351256983237 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 2, 2], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 40384.67067752168/40384.67067752168
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 6: 40384.67067752168/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 4, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 21473.26289865012/21473.26289865012
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 7: 21473.26289865012/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 28], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 256, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.E
*Y*Y
iteration=1: 8659.521842352284/8659.521842352284
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 8: 8659.521842352284/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 4], [1, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[224, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 2454.575310489135/2454.575310489135
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 9: 2454.575310489135/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 2, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[2, 1792, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 21094.256393364958/21094.256393364958
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 10: 21094.256393364958/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[196, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 6822.954092269008/6822.954092269008
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 11: 6822.954092269008/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 7, 7, 2], [1, 4, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[112, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 38468.01807498731/38468.01807498731
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 12: 38468.01807498731/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2]], "last_factors": [[3136, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 6009.249597325838/6009.249597325838
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 13: 6009.249597325838/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 1, 7], [[2, 2, 1, 2], [0, 0, -1]], [[4, 7, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 112, 14], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1394.9412843469865/1394.9412843469865
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 14: 1394.9412843469865/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[112, 4, 2, 1], [0, 0, 1]], [[1, 4, 2, 1], [0, -1, 1]], [7, 1, 8, 1]], "reduce_factors": [[[1, 4, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[112, 2048, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 29004.936521955246/29004.936521955246
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 15: 29004.936521955246/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 3858.7302834269813/3858.7302834269813
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 16: 3858.7302834269813/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 4], [2, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[4, 896, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 20700.03280350474/20700.03280350474
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 17: 20700.03280350474/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 4, 1], [2, 2, 1, 14]], "reduce_factors": [[1, 2, 2]], "last_factors": [[392, 4, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 16200.920029663323/16200.920029663323
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 18: 16200.920029663323/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [2, 1, 7, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 98, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 19426.52327076896/19426.52327076896
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 19: 19426.52327076896/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 2], [2, 7, 2, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 33477.41927058226/33477.41927058226
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 20: 33477.41927058226/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 14, 1], [2, 1, 1, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 26 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 28 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 29 schedules
mapping (0,0,1,0,0,1,1): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 40 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 33 schedules
mapping (0,1,0,0,0,1,0): explored 36 schedules
mapping (0,1,0,1,0,0,0): explored 33 schedules
mapping (0,1,0,1,0,0,1): explored 42 schedules
mapping (0,1,0,1,1,0,0): explored 31 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 39 schedules
mapping (1,0,0,1,0,1,0): explored 28 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 12601.344035970938/12601.344035970938
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 1: 12601.344035970938/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1], [1, 4, 1, 14]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 33996.098843255524/33996.098843255524
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 2: 33996.098843255524/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [2, 1, 28, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[224, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7962.949616034707/26744.1524947093
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 3: 26744.1524947093/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.E.Y
*Y*Y
iteration=1: 6811.568869957126/25270.17925299139
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 4: 25270.17925299139/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 7, 1, 2], [1, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[56, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 19517.57974474846/19517.57974474846
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 5: 19517.57974474846/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 10176.333770312975/40384.67067752168
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 6: 40384.67067752168/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 4, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1367.3761592401177/21473.26289865012
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 7: 21473.26289865012/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 28], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 256, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 7859.62703139154/8659.521842352284
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 8: 8659.521842352284/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 4], [1, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[224, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 27510.397264752373/27510.397264752373
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 9: 27510.397264752373/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [4, 1, 2, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[6272, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 16453.25529615081/21094.256393364958
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 10: 21094.256393364958/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[196, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 9206.340232143184/9206.340232143184
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 11: 9206.340232143184/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 4, 1], [[4, 2, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[2, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3136, 256, 4], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 20298.18690869402/38468.01807498731
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 12: 38468.01807498731/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2]], "last_factors": [[3136, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 25269.92211793129/25269.92211793129
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 13: 25269.92211793129/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 4], [7, 1, 8, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[12544, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 29917.8833394387/29917.8833394387
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 14: 29917.8833394387/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [4, 1, 2, 7]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*Y*E
iteration=1: 6638.720701954839/29004.936521955246
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 15: 29004.936521955246/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1902.4944934698212/3858.7302834269813
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 16: 3858.7302834269813/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 4], [2, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[4, 896, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 27455.331552172316/27455.331552172316
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 17: 27455.331552172316/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 32, 1, 7], [-1, 0, 0]], [4, 2, 1, 1], [[14, 2, 2, 1], [0, 1, 0]]], "reduce_factors": [[[2, 1, 2], [0, 0]]], "last_factors": [[[50176, 2, 32], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 26000.351223095553/26000.351223095553
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 18: 26000.351223095553/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 4], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 27161.1115624816/27161.1115624816
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 19: 27161.1115624816/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 23606.636384934278/33477.41927058226
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 20: 33477.41927058226/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 14, 1], [2, 1, 1, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 32 schedules
mapping (0,0,0,0,0,1,1): explored 30 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 30 schedules
mapping (0,0,0,1,0,0,0): explored 33 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 35 schedules
mapping (0,0,1,0,0,1,0): explored 32 schedules
mapping (0,0,1,0,0,1,1): explored 25 schedules
mapping (0,0,1,0,1,1,0): explored 44 schedules
mapping (0,0,1,0,1,1,1): explored 37 schedules
mapping (0,0,1,1,0,0,0): explored 35 schedules
mapping (0,1,0,0,0,1,0): explored 40 schedules
mapping (0,1,0,1,0,0,0): explored 34 schedules
mapping (0,1,0,1,0,0,1): explored 47 schedules
mapping (0,1,0,1,1,0,0): explored 36 schedules
mapping (1,0,0,0,0,1,0): explored 30 schedules
mapping (1,0,0,1,0,0,0): explored 41 schedules
mapping (1,0,0,1,0,1,0): explored 32 schedules
Tensorize use time 562.8474662303925 s.
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[64, 64, 1, 1],body:R[1, 64, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64, 64, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph68/at:resnet50:subgraph68:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*Y*Y
iteration=1: 26881.62075528048/26881.62075528048
Best record value:26881.62075528048 (larger is better)
Round 1, Match 1, Mapping 1: 26881.62075528048/26881.62075528048(0.03720013793452411 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [1, 4, 7, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 8702.62033881443/8702.62033881443
Best record value:26881.62075528048 (larger is better)
Round 1, Match 1, Mapping 2: 8702.62033881443/26881.62075528048(0.03720013793452411 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[1, 1, 4, 2], [0, -1, 1]], [[1, 64, 2, 1], [0, 1, -1]], [[56, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[2, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4, 12544, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 61732.50888273826/61732.50888273826
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 3: 61732.50888273826/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [1, 0, 0]], [1, 1, 1, 2], [[1, 32, 2, 2], [0, 1, -1]]], "reduce_factors": [[[2, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[25088, 16, 2], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 38757.088423504014/38757.088423504014
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 4: 38757.088423504014/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 2, 2, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[56, 56, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 44654.670181051995/44654.670181051995
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 5: 44654.670181051995/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 6179.022438241078/6179.022438241078
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 6: 6179.022438241078/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[49, 2, 1, 1], [0, 1, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[4, 4, 2, 4], [0, -1, 1]]], "reduce_factors": [[[1, 2, 2], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28, 7168, 4], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.E
*Y
iteration=1: 25862.963915968918/25862.963915968918
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 7: 25862.963915968918/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 4, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 53387.9552209353/53387.9552209353
Best record value:61732.50888273826 (larger is better)
Round 1, Match 1, Mapping 8: 53387.9552209353/61732.50888273826(0.01619892044076021 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 63078.128966567456/63078.128966567456
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 9: 63078.128966567456/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [28, 1, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 36385.97477928009/36385.97477928009
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 10: 36385.97477928009/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[1, 4, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 20268.909461080868/20268.909461080868
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 11: 20268.909461080868/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[7, 8, 1, 7], [[1, 2, 1, 4], [0, -1, 0]]], "reduce_factors": [[[2, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[784, 128, 8], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 49887.02393852124/49887.02393852124
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 12: 49887.02393852124/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 2, 14], [1, 1, 2, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*E*Y
iteration=1: 18498.74329886334/18498.74329886334
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 13: 18498.74329886334/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 28, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[8, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 24624.726951074474/24624.726951074474
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 14: 24624.726951074474/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [2, 14, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[56, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4562.821704749893/4562.821704749893
Best record value:63078.128966567456 (larger is better)
Round 1, Match 1, Mapping 15: 4562.821704749893/63078.128966567456(0.015853355455898478 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 1, 7], [[1, 2, 1, 4], [0, 0, 0]], [[7, 8, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 2, 2], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[64, 448, 28], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 79371.20346850847/79371.20346850847
Best record value:79371.20346850847 (larger is better)
Round 1, Match 1, Mapping 16: 79371.20346850847/79371.20346850847(0.012599027812357196 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 4, 7], [2, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 43682.0915457671/43682.0915457671
Best record value:79371.20346850847 (larger is better)
Round 1, Match 1, Mapping 17: 43682.0915457671/79371.20346850847(0.012599027812357196 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 4, 14]], "reduce_factors": [[2, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 19713.670151559/19713.670151559
Best record value:79371.20346850847 (larger is better)
Round 1, Match 1, Mapping 18: 19713.670151559/79371.20346850847(0.012599027812357196 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 2, 1], [4, 14, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 22425.22537760724/22425.22537760724
Best record value:79371.20346850847 (larger is better)
Round 1, Match 1, Mapping 19: 22425.22537760724/79371.20346850847(0.012599027812357196 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [14, 1, 1, 4]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 55428.3324264997/55428.3324264997
Best record value:79371.20346850847 (larger is better)
Round 1, Match 1, Mapping 20: 55428.3324264997/79371.20346850847(0.012599027812357196 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 1, 14, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 21 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 18 schedules
mapping (0,0,0,1,0,0,1): explored 26 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 31 schedules
mapping (0,0,1,0,0,1,0): explored 17 schedules
mapping (0,0,1,0,0,1,1): explored 26 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 23 schedules
mapping (0,0,1,1,0,0,0): explored 16 schedules
mapping (0,1,0,0,0,1,0): explored 16 schedules
mapping (0,1,0,1,0,0,0): explored 28 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (0,1,0,1,1,0,0): explored 16 schedules
mapping (1,0,0,0,0,1,0): explored 32 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 24 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 11072.836145874542/26881.62075528048
Best record value:79371.20346850847 (larger is better)
Round 2, Match 1, Mapping 1: 26881.62075528048/79371.20346850847(0.012599027812357196 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [1, 4, 7, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 79451.37390033742/79451.37390033742
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 2: 79451.37390033742/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 23114.277305174033/61732.50888273826
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 3: 61732.50888273826/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [1, 0, 0]], [1, 1, 1, 2], [[1, 32, 2, 2], [0, 1, -1]]], "reduce_factors": [[[2, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[25088, 16, 2], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 35351.44538729678/38757.088423504014
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 4: 38757.088423504014/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 2, 2, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[56, 56, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 45516.316728528356/45516.316728528356
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 5: 45516.316728528356/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 35616.292335693346/35616.292335693346
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 6: 35616.292335693346/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 7283.908134118693/25862.963915968918
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 7: 25862.963915968918/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 4, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 32941.098802173394/53387.9552209353
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 8: 53387.9552209353/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 33360.99664462867/63078.128966567456
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 9: 63078.128966567456/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [28, 1, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 8334.933159590897/36385.97477928009
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 10: 36385.97477928009/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[1, 4, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.E
*Y*Y
iteration=1: 28874.501399965215/28874.501399965215
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 11: 28874.501399965215/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 14, 2], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 55649.958784952374/55649.958784952374
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 12: 55649.958784952374/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 4, 2, 1], [1, 1, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[98, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 23811.863912302073/23811.863912302073
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 13: 23811.863912302073/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 1], [2, 2, 14, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[56, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 23550.077287983/24624.726951074474
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 14: 24624.726951074474/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [2, 14, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[56, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 35212.987003041686/35212.987003041686
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 15: 35212.987003041686/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 13362.018386174406/79371.20346850847
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 16: 79371.20346850847/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 4, 7], [2, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 38507.105809547895/43682.0915457671
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 17: 43682.0915457671/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 4, 14]], "reduce_factors": [[2, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 39562.42042740462/39562.42042740462
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 18: 39562.42042740462/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 4, 1, 14]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 45798.0900964654/45798.0900964654
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 19: 45798.0900964654/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 28, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 24995.316426002097/55428.3324264997
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 20: 55428.3324264997/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 1, 14, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 22 schedules
mapping (0,0,0,0,0,1,1): explored 28 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 23 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 35 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 29 schedules
mapping (0,0,1,0,1,1,0): explored 26 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 19 schedules
mapping (0,1,0,0,0,1,0): explored 19 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 19 schedules
mapping (1,0,0,0,0,1,0): explored 35 schedules
mapping (1,0,0,1,0,0,0): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Tensorize use time 562.4064383506775 s.
#############################################
operations:inputs:[1, 64, 112, 112],[64],[64],body:S[1, 64, 112, 112] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 112, 112],body:S[1, 64, 112, 112] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 112, 112],body:S[1, 64, 114, 114] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 113)) && (v3 >= 1)) && (v3 < 113)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 114, 114],body:R[1, 64, 56, 56] [3, 3] { comm_reducer(result=[(v6 + v7)], lhs=[v6], rhs=[v7], identity_element=[0h]) } { (T0[n, c, ((i*2) + r), ((j*2) + s)]/9h) }$tensors:[1, 64, 112, 112] [64] [64] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph69.log by 200 trials...
.Y.E.Y.Y.E.E.Y.Y.Y.Y.B.N.N.B.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.E.N.N.N.N.B

Currently best performance: 0.09172766934213157
.N.N.N.E.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.029399612998513677
.N.N.N.N.N.N.N.Y.Y.Y.E.E.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.029399612998513677
.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.E.N.N.B.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N

Currently best performance: 0.013072979998510394
.N.N.N.N.N.E.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.013072979998510394
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.B.N.N

Currently best performance: 0.00766503918920233
.N.N.N.Y.Y.Y.Y.Y.E.E.Y.Y.Y.N.N.N.N.N.B.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N

Currently best performance: 0.006446948735346756
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006446948735346756
.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N

Currently best performance: 0.006446948735346756
.N.N.N.N.N.Y.E.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006446948735346756
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.006446948735346756
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006437422290457732
.N.N.N.N.N.N.N.NSchedule cost 1018.656707 seconds
#############################################
operations:inputs:[1, 3, 224, 224],body:S[1, 3, 230, 230] [ ] { } { tir.if_then_else(((((v2 >= 3) && (v2 < 227)) && (v3 >= 3)) && (v3 < 227)), T0[b, c, (h - 3), (w - 3)], 0h) }$inputs:[1, 3, 230, 230],[64, 3, 7, 7],body:R[1, 64, 112, 112] [3, 7, 7] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 3, 224, 224] [64, 3, 7, 7] [1, 64, 112, 112] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph70/at:resnet50:subgraph70:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 18
Initial trials per matching: 100
Original weights [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
Original trials for each mapping [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/56.75202596539123
.E

iteration=2: 1e-10/56.75202596539123
Best record value:56.75202596539123 (larger is better)
Round 1, Match 1, Mapping 1: 56.75202596539123/56.75202596539123(17.620516324999997 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 2, 1, 1], [1, -1, 0]], [[4, 2, 1, 1], [1, 0, -1]], [[64, 1, 2, 1], [0, 0, 1]], [[7, 2, 4, 2], [0, -1, 0]]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [1, 0]]], "last_factors": [[[25088, 32, 4], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.E.E.E
*Y*Y
iteration=1: 5464.204333044186/5464.204333044186
.Y
*Y
iteration=2: 165.57969228391812/5464.204333044186
Best record value:5464.204333044186 (larger is better)
Round 1, Match 1, Mapping 2: 5464.204333044186/5464.204333044186(0.1830092615593835 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 1, "vectorize": [8, 1], "spatial_factors": [[[49, 2, 2, 2], [0, 1, 0]], [[4, 2, 1, 1], [-1, 1, 0]], [[2, 64, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 2, 1], [-1, 1]], [[1, 3, 1], [0, 0]]], "last_factors": [[[16384, 28, 7], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 9717.0659629561/9717.0659629561
.Y
*Y
iteration=2: 10763.696466458012/10763.696466458012
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 3: 10763.696466458012/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[49, 16, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 359.2686419989512/359.2686419989512
.Y
*Y
iteration=2: 933.9361691985799/933.9361691985799
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 4: 933.9361691985799/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 28, 1, 4], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 5, 1]], "last_factors": [[1, 784, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 1108.0643696803102/1108.0643696803102
.Y
*Y
iteration=2: 1229.8228046706574/1229.8228046706574
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 5: 1229.8228046706574/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[16, 14, 1, 7], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[32, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 4216.223751106784/4216.223751106784
.Y
*E
iteration=2: 1e-10/4216.223751106784
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 6: 4216.223751106784/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[2, 2, 1, 1], [1, 1, -1]], [[4, 1, 2, 1], [-1, 0, 1]], [[8, 1, 2, 8], [1, 0, -1]], [[7, 8, 1, 2], [1, -1, -1]]], "reduce_factors": [[[2, 1, 1], [0, 0]], [[7, 1, 1], [1, 0]]], "last_factors": [[[4096, 98, 8], [0, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 3951.4811784242356/3951.4811784242356
.Y
*E
iteration=2: 1e-10/3951.4811784242356
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 7: 3951.4811784242356/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 2, 1, 1], [1, 2, 1, 1], [1, 4, 4, 7]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[56, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 4536.272384788887/4536.272384788887
.Y
*Y
iteration=2: 2141.4419664493835/4536.272384788887
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 8: 4536.272384788887/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[112, 2, 2, 1], [-1, 1, 0]], [[4, 1, 2, 1], [1, 0, -1]], [[8, 7, 2, 1], [1, -1, 1]]], "reduce_factors": [[[2, 1, 1], [1, 0]], [[1, 1, 7], [0, -1]]], "last_factors": [[[2048, 392, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 511.4555278674786/511.4555278674786
.E

iteration=2: 1e-10/511.4555278674786
Best record value:10763.696466458012 (larger is better)
Round 1, Match 1, Mapping 9: 511.4555278674786/10763.696466458012(0.09290488663594469 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[56, 2, 4, 1], [0, 1, 0]], [[1, 4, 1, 2], [0, 0, 0]], [[2, 56, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 1, 5], [1, -1]]], "last_factors": [[[2, 57344, 28], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 13767.008497053332/13767.008497053332
.Y
*Y
iteration=2: 1310.8502244294482/13767.008497053332
Best record value:13767.008497053332 (larger is better)
Round 1, Match 1, Mapping 10: 13767.008497053332/13767.008497053332(0.0726374215730337 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[196, 1, 8, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 4, 1], [3, 1, 1]], "last_factors": [[28, 56, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 9132.782862102413/9132.782862102413
.Y
*E
iteration=2: 1e-10/9132.782862102413
Best record value:13767.008497053332 (larger is better)
Round 1, Match 1, Mapping 11: 9132.782862102413/13767.008497053332(0.0726374215730337 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 4, 1, 2], [1, 1, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[256, 98, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 19679.56406782171/19679.56406782171
.Y
*Y
iteration=2: 910.5803321584006/19679.56406782171
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 12: 19679.56406782171/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[392, 1, 1, 4], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 5]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 15003.436800840282/15003.436800840282
.Y
*Y
iteration=2: 6180.699005225777/15003.436800840282
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 13: 15003.436800840282/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [2, 1, 1, 1], [14, 4, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[3136, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/118.50490706244959
.Y
*E
iteration=2: 1e-10/118.50490706244959
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 14: 118.50490706244959/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[8, 28, 1, 2], [0, 0, -1]], [[1, 1, 1, 8], [0, -1, 0]], [[14, 2, 4, 1], [1, 0, -1]]], "reduce_factors": [[[1, 2, 1], [0, 1]], [[7, 1, 1], [1, 0]]], "last_factors": [[[56, 8192, 7], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 4610.981158340219/4610.981158340219
.Y
*E
iteration=2: 1e-10/4610.981158340219
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 15: 4610.981158340219/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 7], [1, 2, 1, 1], [28, 4, 1, 1]], "reduce_factors": [[4, 1, 1], [3, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1071.8110118515242/1071.8110118515242
.Y
*Y
iteration=2: 245.7716798126518/1071.8110118515242
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 16: 1071.8110118515242/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [8, 1], "spatial_factors": [[[112, 2, 2, 1], [1, 1, 1]], [[2, 1, 2, 2], [-1, 0, 0]], [7, 4, 1, 4]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [0, 0]]], "last_factors": [[[14, 7168, 32], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 83.54941729572202/133.3622043835115
.Y
*E
iteration=2: 1e-10/133.3622043835115
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 17: 133.3622043835115/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[16, 224, 14, 1], [0, 1, -1]], [[4, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[1, 1, 2], [0, 0]], [[7, 1, 1], [0, 0]]], "last_factors": [[[12544, 64, 4], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 13491.628048640687/13491.628048640687
.Y
*Y
iteration=2: 7687.505565987847/13491.628048640687
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 18: 13491.628048640687/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[14, 1, 1, 1], [1, 1, 1, 2], [4, 4, 7, 1]], "reduce_factors": [[1, 10, 1]], "last_factors": [[98, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.13785591727042856, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,0,1): explored 7 schedules
mapping (0,0,0,0,1,1,0): explored 17 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 11 schedules
mapping (0,0,1,0,0,0,1): explored 11 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 15 schedules
mapping (0,0,1,0,1,0,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 18 schedules
mapping (0,0,1,0,1,1,1): explored 16 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,0,1,0,0): explored 9 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 18 schedules
mapping (0,1,0,1,1,0,0): explored 17 schedules
Original weights [0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.13785591727042856, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185]
Original trials for each mapping [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 14, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 19365.248548673157/19365.248548673157
.E

iteration=2: 1e-10/19365.248548673157
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 1: 19365.248548673157/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 2, 1, 1], [1, -1, 0]], [1, 1, 2, 1], [[64, 1, 2, 1], [0, 0, 1]], [[7, 2, 4, 2], [0, -1, 0]]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [1, 0]]], "last_factors": [[[25088, 32, 4], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13432.961103422498/13432.961103422498
.Y
*E
iteration=2: 1e-10/13432.961103422498
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 2: 13432.961103422498/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[28, 4, 2, 7], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 3]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 10332.97042651075/10763.696466458012
.Y
*E
iteration=2: 1e-10/10763.696466458012
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 3: 10763.696466458012/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[49, 16, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 1757.8938161819274/1757.8938161819274
.Y
*Y
iteration=2: 137.66678062883378/1757.8938161819274
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 4: 1757.8938161819274/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 196, 1, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[5, 1, 2]], "last_factors": [[784, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*Y*E*Y
iteration=1: 5597.100730550057/5597.100730550057
.Y
*Y
iteration=2: 2605.7859152301994/5597.100730550057
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 5: 5597.100730550057/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 16, 7, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[3584, 7, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 6157.127523611502/6157.127523611502
.Y
*E
iteration=2: 1e-10/6157.127523611502
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 6: 6157.127523611502/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, 1], "spatial_factors": [[[2, 2, 1, 1], [1, 1, -1]], [2, 1, 1, 1], [[4, 2, 4, 4], [0, 1, -1]], [[7, 8, 1, 2], [1, -1, -1]]], "reduce_factors": [[[2, 1, 1], [0, 0]], [[7, 1, 1], [1, 0]]], "last_factors": [[[4096, 98, 8], [0, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3804.1059130687277/3951.4811784242356
.Y
*E
iteration=2: 1e-10/3951.4811784242356
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 7: 3951.4811784242356/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 2, 1, 1], [1, 2, 1, 1], [1, 4, 4, 7]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[56, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/4536.272384788887
.Y
*Y
iteration=2: 1847.3260128309555/4536.272384788887
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 8: 4536.272384788887/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[112, 2, 2, 1], [-1, 1, 0]], [[4, 1, 2, 1], [1, 0, -1]], [[8, 7, 2, 1], [1, -1, 1]]], "reduce_factors": [[[2, 1, 1], [1, 0]], [[1, 1, 7], [0, -1]]], "last_factors": [[[2048, 392, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 514.8644901050361/514.8644901050361
.Y
*Y
iteration=2: 342.0406086618104/514.8644901050361
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 9: 514.8644901050361/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[[56, 2, 4, 1], [0, 1, 0]], [[1, 4, 1, 2], [0, 0, 0]], [[2, 56, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 1, 5], [1, -1]]], "last_factors": [[[2, 57344, 28], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.E.Y.E.E
*Y*Y
iteration=1: 19147.23620859019/19147.23620859019
.Y
*E
iteration=2: 1e-10/19147.23620859019
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 10: 19147.23620859019/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 2, 8], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [3, 1, 1]], "last_factors": [[98, 16, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 18521.137177088745/18521.137177088745
.Y
*E
iteration=2: 1e-10/18521.137177088745
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 11: 18521.137177088745/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[56, 1, 4, 7], [1, 1, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[896, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 12660.76548948143/19679.56406782171
.Y
*E
iteration=2: 1e-10/19679.56406782171
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 12: 19679.56406782171/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[392, 1, 1, 4], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 5]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 12002.819376391266/15003.436800840282
.Y
*E
iteration=2: 1e-10/15003.436800840282
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 13: 15003.436800840282/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [2, 1, 1, 1], [14, 4, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[3136, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 5160.911084283445/5160.911084283445
.Y
*Y
iteration=2: 2887.204973464097/5160.911084283445
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 14: 5160.911084283445/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[8, 14, 2, 2], [-1, 1, 0]], [[1, 2, 2, 2], [0, 1, 0]], [14, 2, 2, 2]], "reduce_factors": [[[1, 2, 1], [0, 0]], [[7, 1, 1], [0, 0]]], "last_factors": [[[3584, 64, 14], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 808.7111215023723/4610.981158340219
.Y
*E
iteration=2: 1e-10/4610.981158340219
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 15: 4610.981158340219/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 7], [1, 2, 1, 1], [28, 4, 1, 1]], "reduce_factors": [[4, 1, 1], [3, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 251.93486892599057/1071.8110118515242
.Y
*E
iteration=2: 1e-10/1071.8110118515242
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 16: 1071.8110118515242/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [8, 1], "spatial_factors": [[[112, 2, 2, 1], [1, 1, 1]], [[2, 1, 2, 2], [-1, 0, 0]], [7, 4, 1, 4]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [0, 0]]], "last_factors": [[[14, 7168, 32], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 4549.528941773368/4549.528941773368
.Y
*Y
iteration=2: 1697.119463143504/4549.528941773368
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 17: 4549.528941773368/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 8, 2, 7], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[256, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 1344.8744723513955/13491.628048640687
.Y
*E
iteration=2: 1e-10/13491.628048640687
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 18: 13491.628048640687/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[14, 1, 1, 1], [1, 1, 1, 2], [4, 4, 7, 1]], "reduce_factors": [[1, 10, 1]], "last_factors": [[98, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.2624616048359604, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,0,1): explored 12 schedules
mapping (0,0,0,0,1,1,0): explored 21 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 20 schedules
mapping (0,0,0,1,1,0,0): explored 15 schedules
mapping (0,0,1,0,0,0,1): explored 15 schedules
mapping (0,0,1,0,0,1,0): explored 23 schedules
mapping (0,0,1,0,0,1,1): explored 20 schedules
mapping (0,0,1,0,1,0,1): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 20 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 26 schedules
mapping (0,1,0,0,1,0,0): explored 14 schedules
mapping (0,1,0,1,0,0,0): explored 29 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
Tensorize use time 1005.1489510536194 s.
Query subgraph task id: 0, perf=0.000091 ms after 200 tuning
Query subgraph task id: 1, perf=0.004153 ms after 200 tuning
Query subgraph task id: 2, perf=0.000743 ms after 200 tuning
Query subgraph task id: 3, perf=0.001101 ms after 200 tuning
Query subgraph task id: 4, perf=0.000773 ms after 200 tuning
Query subgraph task id: 5, perf=0.003060 ms after 200 tuning
Query subgraph task id: 6, perf=0.003890 ms after 200 tuning
Query subgraph task id: 7, perf=0.001196 ms after 200 tuning
Query subgraph task id: 8, perf=0.001372 ms after 200 tuning
Query subgraph task id: 9, perf=0.000694 ms after 200 tuning
Query subgraph task id: 10, perf=0.004015 ms after 200 tuning
Query subgraph task id: 11, perf=0.000879 ms after 200 tuning
Query subgraph task id: 12, perf=0.001260 ms after 200 tuning
Query subgraph task id: 13, perf=0.000592 ms after 200 tuning
Query subgraph task id: 14, perf=0.003843 ms after 200 tuning
Query subgraph task id: 15, perf=0.001308 ms after 200 tuning
Query subgraph task id: 16, perf=0.005256 ms after 200 tuning
Query subgraph task id: 17, perf=0.001655 ms after 200 tuning
Query subgraph task id: 18, perf=0.003848 ms after 200 tuning
Query subgraph task id: 19, perf=0.001191 ms after 200 tuning
Query subgraph task id: 20, perf=0.002666 ms after 200 tuning
Query subgraph task id: 21, perf=0.000980 ms after 200 tuning
Query subgraph task id: 22, perf=0.006022 ms after 200 tuning
Query subgraph task id: 23, perf=0.002400 ms after 200 tuning
Query subgraph task id: 24, perf=0.002347 ms after 200 tuning
Query subgraph task id: 25, perf=0.002043 ms after 200 tuning
Query subgraph task id: 26, perf=0.009761 ms after 200 tuning
Query subgraph task id: 27, perf=0.002311 ms after 200 tuning
Query subgraph task id: 28, perf=0.002997 ms after 200 tuning
Query subgraph task id: 29, perf=0.002208 ms after 200 tuning
Query subgraph task id: 30, perf=0.009827 ms after 200 tuning
Query subgraph task id: 31, perf=0.001924 ms after 200 tuning
Query subgraph task id: 32, perf=0.000554 ms after 200 tuning
Query subgraph task id: 33, perf=0.006437 ms after 200 tuning
Query subgraph task id: 34, perf=0.006411 ms after 200 tuning
[NOTICE] totally 71 subgraphs, mapped 54 subgraphs, ratio= 76.05633802816901 %
.GYWhole graph cost is 19.772480 ms
#############################################
operations:inputs:[1, 2048],[1000, 2048],body:R[1, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[1, 2048] [1000, 2048] [1, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 18788.7153893675/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=2: 19861.034561178734/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=3: 5125.192536166312/29313.204507817783
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=4: 1080.9775573773547/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=5: 363.93715438594404/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=6: 28096.962465203844/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=7: 1452.013472270736/29313.204507817783
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=8: 28147.209454656575/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=9: 18301.016615967/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=10: 5518.662408680033/29313.204507817783
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=11: 13163.746161755322/29313.204507817783
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=12: 14789.462777142837/29313.204507817783
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=13: 36161.403546029374/36161.403546029374
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=14: 36056.53245816197/36161.403546029374
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=15: 1284.3584255342887/36161.403546029374
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=16: 983.5680905206004/36161.403546029374
.Y.E.Y.Y.Y
*E*E*E*E
iteration=17: 1e-10/36161.403546029374
.E.Y.Y.Y.Y
*E*E*E*E
iteration=18: 1e-10/36161.403546029374
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=19: 29322.29278439496/36161.403546029374
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=20: 28044.984383601077/36161.403546029374
Best record value:36161.403546029374 (larger is better)
Round 1, Match 1, Mapping 1: 36161.403546029374/36161.403546029374(0.027653793877970283 ms), {"vmap": [[1], -1]}, {"inline": 1, "vectorize": [8, 1], "spatial_factors": [[[2, 1, 4, 2], [-1, 0, 0]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 8], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 694 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 29230.478164025604/36161.403546029374
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/36161.403546029374
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=3: 23964.814680841657/36161.403546029374
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=4: 12878.354593689714/36161.403546029374
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=5: 2938.343132194458/36161.403546029374
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=6: 1e-10/36161.403546029374
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=7: 2094.4254404837575/36161.403546029374
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=8: 36169.044981858424/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=9: 6385.833117769214/36169.044981858424
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=10: 26588.971151475504/36169.044981858424
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=11: 486.0632337989797/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=12: 4436.625510081585/36169.044981858424
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=13: 4854.40911154241/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=14: 2837.8529538113453/36169.044981858424
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=15: 3001.996087130269/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=16: 35848.70227827545/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=17: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=18: 35845.2511320936/36169.044981858424
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=19: 2411.3244963782336/36169.044981858424
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=20: 29323.03907293054/36169.044981858424
Best record value:36169.044981858424 (larger is better)
Round 2, Match 1, Mapping 1: 36169.044981858424/36169.044981858424(0.02764795145964118 ms), {"vmap": [[1], -1]}, {"inline": [1, 1], "vectorize": 8, "spatial_factors": [[[2, 1, 4, 2], [-1, 0, 0]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 8], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 733 schedules
Tensorize use time 683.8936047554016 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 2048, 7, 7],body:R[1, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.Y.Y.E.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.004153150587521339
.N.N.Y.Y.Y.E.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.E.Y.Y.N.N.N

Currently best performance: 0.004153150587521339
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004153150587521339
.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B.N.N.N

Currently best performance: 0.0040995772926131656
.N.N.N.N.Y.Y.E.Y.Y.Y.Y.T.Y.Y.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0040995772926131656
.N.N.N.N.N.N.N.T.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.0040995772926131656
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0040995772926131656
.N.N.N.N.N.N.Y.T.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0040995772926131656
.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.B.N

Currently best performance: 0.0037276707145209092
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.0037276707145209092
.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003586928799245485
.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003586928799245485
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003586928799245485
Schedule cost 1355.993772 seconds
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 7, 7],[2048, 512, 1, 1],body:R[1, 2048, 7, 7] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [2048, 512, 1, 1] [1, 2048, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph2/at:resnet50:subgraph2:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.07663042260161057, 0.46358704178872595, 0.07663042260161057, 0.07663042260161057]
Original trials for each mapping [8, 8, 8, 8, 8, 47, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/12892.262359502693
.Y.Y.E.E.Y
*E*E*Y
iteration=2: 2216.963814286078/12892.262359502693
.E.Y.Y
*E*Y
iteration=3: 7863.819783184598/12892.262359502693
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 1: 12892.262359502693/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [8, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[784, 1, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 19050.9744306063/19050.9744306063
.Y.E.E.Y.Y
*Y*E*Y
iteration=2: 5906.370040617647/19050.9744306063
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/19050.9744306063
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 2: 19050.9744306063/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 10394.76356765134/12524.584988293986
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=2: 3585.816305802286/12524.584988293986
.E.Y.Y
*Y*Y
iteration=3: 7491.165919509661/12524.584988293986
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 3: 12524.584988293986/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 246.53208523687584/24211.11742069991
.E.Y.E.Y.Y
*Y*Y*Y
iteration=2: 18686.45644453519/24211.11742069991
.E.Y.Y
*E*E
iteration=3: 1e-10/24211.11742069991
Best record value:26647.658053540385 (larger is better)
Round 1, Match 1, Mapping 4: 24211.11742069991/26647.658053540385(0.0375267499301741 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/25295.5390611969
.Y.E.E.Y.Y
*Y*Y*Y
iteration=2: 29049.952283933242/29049.952283933242
.Y.Y.Y
*E*Y*Y
iteration=3: 9953.051740796545/29049.952283933242
Best record value:29049.952283933242 (larger is better)
Round 1, Match 1, Mapping 5: 29049.952283933242/29049.952283933242(0.03442346445963264 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[[7, 7, 8, 2], [0, -1, 1]], [[32, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 14], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2466.176124649958/26647.658053540385
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=2: 1021.578686647525/26647.658053540385
.Y.Y.Y
*E*Y*E
iteration=3: 3609.5755521614983/26647.658053540385
Best record value:29049.952283933242 (larger is better)
Round 1, Match 1, Mapping 6: 26647.658053540385/29049.952283933242(0.03442346445963264 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 20366.619092720957/24465.544377091195
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=2: 4025.870101275312/24465.544377091195
.Y.Y.Y
*Y*E*Y
iteration=3: 9335.039888834133/24465.544377091195
Best record value:29049.952283933242 (larger is better)
Round 1, Match 1, Mapping 7: 24465.544377091195/29049.952283933242(0.03442346445963264 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 6610.644253822955/21231.599231001903
.Y.Y.E.Y.E
*E*E*E
iteration=2: 1e-10/21231.599231001903
.Y.Y.Y
*Y*E*Y
iteration=3: 8580.849454460593/21231.599231001903
Best record value:29049.952283933242 (larger is better)
Round 1, Match 1, Mapping 8: 21231.599231001903/29049.952283933242(0.03442346445963264 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 7, 1], [[16, 1, 2, 2], [0, -1, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 2, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.08076062628106778, 0.08076062628106778, 0.08076062628106778, 0.08076062628106778, 0.21953014287479852, 0.2959060994387947, 0.08076062628106778, 0.08076062628106778]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 29 schedules
mapping (0,0,0,0,1,1,1): explored 41 schedules
mapping (0,0,0,1,0,0,1): explored 26 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 46 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 46 schedules
mapping (1,0,0,1,0,1,0): explored 39 schedules
Original weights [0.08076062628106778, 0.08076062628106778, 0.08076062628106778, 0.08076062628106778, 0.21953014287479852, 0.2959060994387947, 0.08076062628106778, 0.08076062628106778]
Original trials for each mapping [9, 9, 9, 9, 22, 30, 9, 9]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 26426.687739785866/26426.687739785866
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/26426.687739785866
.Y.Y.Y
*Y*Y*E
iteration=3: 7328.193055491096/26426.687739785866
Best record value:29049.952283933242 (larger is better)
Round 2, Match 1, Mapping 1: 26426.687739785866/29049.952283933242(0.03442346445963264 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [32, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[224, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 14803.135529379562/19050.9744306063
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=2: 30139.170185743464/30139.170185743464
.Y.Y.Y
*E*Y*Y
iteration=3: 5689.152459989894/30139.170185743464
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 2: 30139.170185743464/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 1098.4836729106203/12524.584988293986
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=2: 5251.452714603895/12524.584988293986
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/12524.584988293986
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 3: 12524.584988293986/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 10002.258196905026/24211.11742069991
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=2: 10265.971725765134/24211.11742069991
.Y.Y.Y
*E*Y*Y
iteration=3: 12240.259031521999/24211.11742069991
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 4: 24211.11742069991/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 6448.670636619782/29049.952283933242
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=2: 14229.14433979284/29049.952283933242
.Y.Y.Y
*Y*E*Y
iteration=3: 9433.252888538997/29049.952283933242
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 5: 29049.952283933242/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[[7, 7, 8, 2], [0, -1, 1]], [[32, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 14], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 3180.388296765757/26647.658053540385
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=2: 9022.016269667205/26647.658053540385
.Y.E.Y
*Y*E
iteration=3: 3519.9766484749143/26647.658053540385
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 6: 26647.658053540385/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/24465.544377091195
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 5753.305694387228/24465.544377091195
.Y.Y.E
*Y*E
iteration=3: 681.346419728642/24465.544377091195
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 7: 24465.544377091195/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 8894.70650803729/21231.599231001903
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=2: 12258.370606389426/21231.599231001903
.E.Y.Y
*E*Y
iteration=3: 2662.824024019123/21231.599231001903
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 8: 21231.599231001903/30139.170185743464(0.0331794138271605 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 7, 1], [[16, 1, 2, 2], [0, -1, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 2, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
New weights [0.08321265267886407, 0.2261954416748301, 0.08321265267886407, 0.08321265267886407, 0.18519316430524038, 0.17254813062560911, 0.08321265267886407, 0.08321265267886407]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 46 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 36 schedules
mapping (0,0,1,0,1,1,0): explored 52 schedules
mapping (0,0,1,0,1,1,1): explored 34 schedules
mapping (0,1,0,1,0,0,1): explored 48 schedules
mapping (1,0,0,1,0,1,0): explored 44 schedules
Tensorize use time 861.413122177124 s.
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 9, 9] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 8)) && (v3 >= 1)) && (v3 < 8)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 9, 9],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph3/at:resnet50:subgraph3:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.09137574887758486, 0.09137574887758486, 0.09137574887758486, 0.24838503773577592, 0.20336046899871474, 0.09137574887758486, 0.09137574887758486, 0.09137574887758486]
Original trials for each mapping [10, 10, 10, 25, 21, 10, 10, 10]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 1077.903692427466/1080.8999724216665
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=2: 1885.2063695929414/1885.2063695929414
.E.Y.Y
*E*E
iteration=3: 1e-10/1885.2063695929414
Best record value:4839.582074390659 (larger is better)
Round 1, Match 1, Mapping 1: 1885.2063695929414/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 4, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1115.4355066164305
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=2: 869.5963733649171/1115.4355066164305
.Y.Y.Y
*Y*E*E
iteration=3: 3139.3976939948157/3139.3976939948157
Best record value:4839.582074390659 (larger is better)
Round 1, Match 1, Mapping 2: 3139.3976939948157/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/354.55787507849266
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=2: 2349.0677414703023/2349.0677414703023
.Y.Y.Y
*E*Y*E
iteration=3: 1047.2991866270675/2349.0677414703023
Best record value:4839.582074390659 (larger is better)
Round 1, Match 1, Mapping 3: 2349.0677414703023/4839.582074390659(0.20662941233947515 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 2, 1], [3, 1, 1]], "last_factors": [[7, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 2387.4141619884463/4839.582074390659
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=2: 5282.897680287298/5282.897680287298
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/5282.897680287298
Best record value:5282.897680287298 (larger is better)
Round 1, Match 1, Mapping 4: 5282.897680287298/5282.897680287298(0.18929005642706626 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[8, 1, 1, 2], [0, -1, 0]], [[8, 2, 2, 4], [1, -1, 0]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 32, 14], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 6234.053295994352/6234.053295994352
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 268.3454396729941/6234.053295994352
.E.Y.E
*E
iteration=3: 1e-10/6234.053295994352
Best record value:6234.053295994352 (larger is better)
Round 1, Match 1, Mapping 5: 6234.053295994352/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[49, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1032.3917252033411/1857.8225206972422
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=2: 1938.458209767859/1938.458209767859
.E.Y.Y
*E*E
iteration=3: 1e-10/1938.458209767859
Best record value:6234.053295994352 (larger is better)
Round 1, Match 1, Mapping 6: 1938.458209767859/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 4, 4]], "reduce_factors": [[144, 2, 1]], "last_factors": [[28, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 1795.5722013318884/1795.5722013318884
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/1795.5722013318884
.Y.Y.Y
*E*E*Y
iteration=3: 186.54964626241542/1795.5722013318884
Best record value:6234.053295994352 (larger is better)
Round 1, Match 1, Mapping 7: 1795.5722013318884/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 269.5424524686077/1312.3217506924368
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 2032.2154674815406/2032.2154674815406
.E.E.E

iteration=3: 1e-10/2032.2154674815406
Best record value:6234.053295994352 (larger is better)
Round 1, Match 1, Mapping 8: 2032.2154674815406/6234.053295994352(0.1604092798889838 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [4, 2, 2, 1]], "reduce_factors": [[16, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[98, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.07873552013046219, 0.07873552013046219, 0.07873552013046219, 0.1752291225764862, 0.3523577566407405, 0.07873552013046219, 0.07873552013046219, 0.07873552013046219]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Original weights [0.07873552013046219, 0.07873552013046219, 0.07873552013046219, 0.1752291225764862, 0.3523577566407405, 0.07873552013046219, 0.07873552013046219, 0.07873552013046219]
Original trials for each mapping [8, 8, 8, 18, 36, 8, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1885.2063695929414
.E.E.Y.E.E
*E
iteration=2: 1e-10/1885.2063695929414
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1885.2063695929414
Best record value:6234.053295994352 (larger is better)
Round 2, Match 1, Mapping 1: 1885.2063695929414/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 4, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/3139.3976939948157
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=2: 247.28749267403077/3139.3976939948157
.Y.E.Y
*E*E
iteration=3: 1e-10/3139.3976939948157
Best record value:6234.053295994352 (larger is better)
Round 2, Match 1, Mapping 2: 3139.3976939948157/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 267.23419763317645/2349.0677414703023
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 754.7198020075259/2349.0677414703023
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2349.0677414703023
Best record value:6234.053295994352 (larger is better)
Round 2, Match 1, Mapping 3: 2349.0677414703023/6234.053295994352(0.1604092798889838 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 2, 1], [3, 1, 1]], "last_factors": [[7, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 4811.888622968048/5282.897680287298
.E.Y.Y.E.Y
*Y*E*E
iteration=2: 7514.617935122427/7514.617935122427
.Y.E.Y
*E*Y
iteration=3: 367.4853949728248/7514.617935122427
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 4: 7514.617935122427/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 1389.478850946333/6234.053295994352
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 354.4094031066426/6234.053295994352
.Y.E.Y
*E*Y
iteration=3: 5281.714907069255/6234.053295994352
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 5: 6234.053295994352/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[49, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1938.458209767859
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=2: 2023.540576496042/2023.540576496042
.Y.Y.Y
*E*E*Y
iteration=3: 505.81653783613405/2023.540576496042
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 6: 2023.540576496042/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 4, 1]], "reduce_factors": [[96, 3, 1]], "last_factors": [[7, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1795.5722013318884
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 359.72951276033245/1795.5722013318884
.Y.E.E
*E
iteration=3: 1e-10/1795.5722013318884
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 7: 1795.5722013318884/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 2654.9773186667135/2654.9773186667135
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/2654.9773186667135
.E.Y.E
*E
iteration=3: 1e-10/2654.9773186667135
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 8: 2654.9773186667135/7514.617935122427(0.1330739644561461 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[7, 1, 1, 1], [[4, 1, 2, 2], [1, 0, 1]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 448, 1], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
New weights [0.0736444536430549, 0.0736444536430549, 0.0736444536430549, 0.3348361815879345, 0.22329709655373609, 0.0736444536430549, 0.0736444536430549, 0.0736444536430549]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 26 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,1,0,1,0,0,1): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 30 schedules
Tensorize use time 835.1337902545929 s.
#############################################
operations:inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 2048, 7, 7],[512, 2048, 1, 1],body:R[1, 512, 7, 7] [2048, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 2048, 7, 7] [512, 2048, 1, 1] [1, 512, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph4/at:resnet50:subgraph4:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.09137574887758486, 0.09137574887758486, 0.09137574887758486, 0.24838503773577592, 0.20336046899871474, 0.09137574887758486, 0.09137574887758486, 0.09137574887758486]
Original trials for each mapping [10, 10, 10, 25, 21, 10, 10, 10]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 10765.550728871447/13315.014269188905
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=2: 2759.1294622277846/13315.014269188905
.Y.E.Y
*Y*Y
iteration=3: 13654.140504581572/13654.140504581572
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 1: 13654.140504581572/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 8, 1], [1, 1, 1]], "last_factors": [[1, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 5071.032362128803/9195.470203021361
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 9192.081851511717/9195.470203021361
.Y.E.E
*E
iteration=3: 1e-10/9195.470203021361
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 2: 9195.470203021361/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [[16, 1, 1, 1], [1, 0, -1]], [[2, 16, 2, 2], [1, 0, 0]]], "reduce_factors": [[[8, 8, 2], [-1, 0]]], "last_factors": [[[256, 196, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 6511.472538602427/6511.472538602427
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/6511.472538602427
.Y.E.Y
*Y*E
iteration=3: 507.05359270138706/6511.472538602427
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 3: 6511.472538602427/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [4, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[28, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 6844.404305120164/15996.95987375775
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 7241.016663325596/15996.95987375775
.E.Y.Y
*Y*Y
iteration=3: 1916.5618235070112/15996.95987375775
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 4: 15996.95987375775/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 4496.377932551449/13497.704808853781
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=2: 3694.9464753738634/13497.704808853781
.E.Y.Y
*E*E
iteration=3: 1e-10/13497.704808853781
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 5: 13497.704808853781/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 2966.772575475621/8527.479157776252
.Y.E.E.E.E
*E
iteration=2: 1e-10/8527.479157776252
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/8527.479157776252
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 6: 8527.479157776252/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[64, 2, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 2842.665880049175/8565.297037945887
.Y.E.E.Y.Y
*E*Y*E
iteration=2: 3314.615368838367/8565.297037945887
.Y.E.Y
*E*E
iteration=3: 1e-10/8565.297037945887
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 7: 8565.297037945887/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 10377.587776187867/10377.587776187867
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=2: 6432.5589059134645/10377.587776187867
.Y.E.Y
*Y*E
iteration=3: 486.57431569510123/10377.587776187867
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 8: 10377.587776187867/15996.95987375775(0.06251187775 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 2, 4, 1]], "reduce_factors": [[32, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.07301410323239399, 0.07301410323239399, 0.07301410323239399, 0.4417095844862374, 0.12020579611939852, 0.07301410323239399, 0.07301410323239399, 0.07301410323239399]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,1): explored 30 schedules
mapping (0,0,0,1,0,1,0): explored 40 schedules
mapping (0,0,1,0,1,1,0): explored 39 schedules
mapping (0,0,1,0,1,1,1): explored 34 schedules
mapping (0,1,0,1,0,0,1): explored 29 schedules
mapping (1,0,0,1,0,1,0): explored 37 schedules
Original weights [0.07301410323239399, 0.07301410323239399, 0.07301410323239399, 0.4417095844862374, 0.12020579611939852, 0.07301410323239399, 0.07301410323239399, 0.07301410323239399]
Original trials for each mapping [8, 8, 8, 45, 13, 8, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/13654.140504581572
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 6103.903455911474/13654.140504581572
.Y.Y.Y
*E*Y*Y
iteration=3: 2637.6103648952203/13654.140504581572
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 1: 13654.140504581572/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 8, 1], [1, 1, 1]], "last_factors": [[1, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 7969.875884618982/9195.470203021361
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 5709.2452945676705/9195.470203021361
.Y.Y.E
*E*Y
iteration=3: 2622.643253173382/9195.470203021361
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 2: 9195.470203021361/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [[16, 1, 1, 1], [1, 0, -1]], [[2, 16, 2, 2], [1, 0, 0]]], "reduce_factors": [[[8, 8, 2], [-1, 0]]], "last_factors": [[[256, 196, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 1785.6381477611699/6511.472538602427
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=2: 5513.664168020124/6511.472538602427
.Y.Y.Y
*Y*Y*Y
iteration=3: 2769.6378175921977/6511.472538602427
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 3: 6511.472538602427/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [4, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[28, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2778.547951342776/15996.95987375775
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=2: 1891.8130452016162/15996.95987375775
.Y.Y.Y
*E*Y*E
iteration=3: 1006.4866075369029/15996.95987375775
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 4: 15996.95987375775/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/13497.704808853781
.E.Y.E.Y.Y
*E*E*Y
iteration=2: 1068.1574753539433/13497.704808853781
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/13497.704808853781
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 5: 13497.704808853781/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 2705.886093019028/8527.479157776252
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=2: 7902.220591518107/8527.479157776252
.Y.Y.E
*E*E
iteration=3: 1e-10/8527.479157776252
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 6: 8527.479157776252/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[64, 2, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 10168.971928300716/10168.971928300716
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/10168.971928300716
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/10168.971928300716
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 7: 10168.971928300716/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 2]], "reduce_factors": [[16, 2, 4], [1, 1, 1]], "last_factors": [[196, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 6645.413779393026/10377.587776187867
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=2: 6064.945291718121/10377.587776187867
.Y.Y.Y
*Y*E*Y
iteration=3: 10459.321252806618/10459.321252806618
Best record value:15996.95987375775 (larger is better)
Round 2, Match 1, Mapping 8: 10459.321252806618/15996.95987375775(0.06251187775 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.057204365198540066, 0.057204365198540066, 0.057204365198540066, 0.5788380771993903, 0.0779357316093693, 0.057204365198540066, 0.057204365198540066, 0.057204365198540066]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 40 schedules
mapping (0,0,0,0,1,1,1): explored 41 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 45 schedules
mapping (0,0,1,0,1,1,0): explored 40 schedules
mapping (0,0,1,0,1,1,1): explored 38 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 41 schedules
Tensorize use time 744.8387408256531 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048, 7, 7] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph5.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0030598024708628907
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.B

Currently best performance: 0.0029489580424999686
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0029489580424999686
.Y.Y.Y.E.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B

Currently best performance: 0.0025354378690461182
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.T.E.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.Y.Y.Y.Y.Y.Y.Y.E.Y.T.N.N.N.N.N.N.N.N.T.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.Y.Y.Y.T.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.T.Y.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.E.Y.Y.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
Schedule cost 1481.004972 seconds
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph9.log by 200 trials...
.Y.E.Y.Y.Y.T.Y.Y.Y.T.N.N.N.N.N.N

Currently best performance: 0.0038904868795235884
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.0038904868795235884
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.E.B.N.N.N.N.N.N.N

Currently best performance: 0.0026149079764263843
.Y.E.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0026149079764263843
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.E.Y.E.Y.E.N

Currently best performance: 0.0026149079764263843
.N.N.N.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0026149079764263843
.N.N.Y.Y.Y.E.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.E.N.N.N

Currently best performance: 0.0026149079764263843
.N.N.N.N.Y.Y.E.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0026149079764263843
.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N.N.N.N.N.N.Y.E.T.Y.Y.Y.Y.Y.Y.T.N.N.N.N

Currently best performance: 0.0026149079764263843
.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.E.Y.Y.N.N

Currently best performance: 0.0026149079764263843
.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.E.E.N.N.N.N.N.N.N

Currently best performance: 0.0026149079764263843
.E.Y.Y.Y.Y.E.Y.E.Y.Y.N.N.B.N.N.N.N.T.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.002609645474769548
.N.N.N.N.N.N.Y.E.Y.Y.T.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.002609645474769548
Schedule cost 1607.199350 seconds
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[2048, 1024, 1, 1],body:R[1, 2048, 7, 7] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [2048, 1024, 1, 1] [1, 2048, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph10/at:resnet50:subgraph10:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.07663042260161056, 0.4635870417887259, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056]
Original trials for each mapping [8, 47, 8, 8, 8, 8, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/5351.689694935078
.Y.E.Y.E.Y
*Y*E*E
iteration=2: 4545.137216384562/5351.689694935078
.Y.Y.Y
*Y*E*E
iteration=3: 1038.9450282057892/5351.689694935078
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 1: 5351.689694935078/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/14875.299843832068
.Y.Y.E.E.Y
*E*E*E
iteration=2: 1e-10/14875.299843832068
.Y.Y.Y
*E*Y*E
iteration=3: 12584.031996067333/14875.299843832068
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 2: 14875.299843832068/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 159.18223450746845/5319.948106355873
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=2: 3926.162604629482/5319.948106355873
.Y.Y.E
*E*Y
iteration=3: 5109.801680323657/5319.948106355873
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 3: 5319.948106355873/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[32, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 11632.041459545846/11632.041459545846
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 1269.5122508541972/11632.041459545846
.Y.Y.Y
*E*E*Y
iteration=3: 2548.885595272075/11632.041459545846
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 4: 11632.041459545846/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 518.4570417955797/8059.233339344995
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 2296.271651849148/8059.233339344995
.Y.Y.E
*E*Y
iteration=3: 2177.8865013657733/8059.233339344995
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 5: 8059.233339344995/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 4, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 766.7782814293028/4146.20726490843
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/4146.20726490843
.Y.Y.E
*E*E
iteration=3: 1e-10/4146.20726490843
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 6: 4146.20726490843/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 2, 2]], "reduce_factors": [[32, 2, 1]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/6981.732909397034
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=2: 12916.949467504443/12916.949467504443
.E.E.Y
*E
iteration=3: 1e-10/12916.949467504443
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 7: 12916.949467504443/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 269.7841684161664/4790.59193350507
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=2: 997.3824148244461/4790.59193350507
.E.Y.Y
*Y*E
iteration=3: 138.80703129793181/4790.59193350507
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 8: 4790.59193350507/14875.299843832068(0.0672255356529598 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 4, 1, 2]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.05896311068168377, 0.5872582252282134, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 35 schedules
mapping (0,0,0,0,1,1,1): explored 38 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,0): explored 30 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 29 schedules
Original weights [0.05896311068168377, 0.5872582252282134, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377, 0.05896311068168377]
Original trials for each mapping [6, 59, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/5351.689694935078
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=2: 1641.7458068890915/5351.689694935078
.Y.Y.E
*E*E
iteration=3: 1e-10/5351.689694935078
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 1: 5351.689694935078/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/14875.299843832068
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=2: 14128.256492433211/14875.299843832068
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/14875.299843832068
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 2: 14875.299843832068/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 2662.819859442836/5319.948106355873
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 3110.273588841109/5319.948106355873
.Y.E.Y
*Y*Y
iteration=3: 7407.666068173515/7407.666068173515
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 3: 7407.666068173515/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 8], [1, 1, 1]], "last_factors": [[28, 56, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/11632.041459545846
.Y.E.E.E.Y
*E*E
iteration=2: 1e-10/11632.041459545846
.Y.Y.E
*E*E
iteration=3: 1e-10/11632.041459545846
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 4: 11632.041459545846/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 128.62639026967443/8059.233339344995
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 1529.1967649320713/8059.233339344995
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/8059.233339344995
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 5: 8059.233339344995/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 4, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 789.3403167237013/4146.20726490843
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=2: 4556.045854364919/4556.045854364919
.E.Y.Y
*E*E
iteration=3: 1e-10/4556.045854364919
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 6: 4556.045854364919/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [[16, 2, 1, 2], [0, 0, -1]]], "reduce_factors": [[[16, 2, 2], [1, 0]]], "last_factors": [[[16, 12544, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 538.0436228478715/12916.949467504443
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 1235.2664559541372/12916.949467504443
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/12916.949467504443
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 7: 12916.949467504443/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1787.9497013990006/4790.59193350507
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=2: 2471.857888658873/4790.59193350507
.Y.Y.Y
*Y*E*Y
iteration=3: 901.0481219513931/4790.59193350507
Best record value:14875.299843832068 (larger is better)
Round 2, Match 1, Mapping 8: 4790.59193350507/14875.299843832068(0.0672255356529598 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 4, 1, 2]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.051165470697955975, 0.641841705114308, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 36 schedules
mapping (0,0,0,0,1,1,1): explored 40 schedules
mapping (0,0,0,1,0,0,1): explored 30 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,0): explored 36 schedules
mapping (0,0,1,0,1,1,1): explored 29 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 36 schedules
Tensorize use time 800.5237994194031 s.
#############################################
operations:inputs:[1, 512, 14, 14],[512],[512],body:S[1, 512, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 14, 14],body:S[1, 512, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 14, 14],body:S[1, 512, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 16, 16],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 14, 14] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph12/at:resnet50:subgraph12:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.0766304226016119, 0.0766304226016119, 0.0766304226016119, 0.0766304226016119, 0.4635870417887131, 0.0766304226016119, 0.0766304226016119, 0.07663042260161536]
Original trials for each mapping [8, 8, 8, 8, 47, 8, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 258.31586780103737/1089.4393374759975
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/1089.4393374759975
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 1: 1089.4393374759975/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/2075.696244723331
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 916.1290263346776/2075.696244723331
.E.Y.Y
*E*Y
iteration=3: 1905.960340777229/2075.696244723331
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 2: 2075.696244723331/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[96, 3, 1]], "last_factors": [[1, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 100.18620156585122/1256.9411699307452
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/1256.9411699307452
.Y.Y.Y
*E*Y*Y
iteration=3: 404.26742035531/1256.9411699307452
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 3: 1256.9411699307452/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 6], [3, 1, 1]], "last_factors": [[1, 392, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 564.2527942029834/3925.6131871493685
.Y.E.Y.E.Y
*E*E*E
iteration=2: 1e-10/3925.6131871493685
.E.E.Y
*Y
iteration=3: 1922.3135532189722/3925.6131871493685
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 4: 3925.6131871493685/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/5834.146424501155
.E.Y.Y.E.E
*E*E
iteration=2: 1e-10/5834.146424501155
.Y.Y.Y
*E*Y*Y
iteration=3: 349.01993970635175/5834.146424501155
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 5: 5834.146424501155/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1821.2367997916267
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=2: 182.21376674624574/1821.2367997916267
.E.Y.Y
*E*Y
iteration=3: 1103.647479543969/1821.2367997916267
Best record value:5834.146424501155 (larger is better)
Round 1, Match 1, Mapping 6: 1821.2367997916267/5834.146424501155(0.1714046798346348 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 7, 4, 7], [-1, 1, -1]], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 5740.454809585628/5740.454809585628
.Y.E.Y.Y.E
*E*E*E
iteration=2: 1e-10/5740.454809585628
.Y.Y.Y
*Y*E*Y
iteration=3: 7949.350977020189/7949.350977020189
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 7: 7949.350977020189/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[12, 2, 4], [3, 1, 1]], "last_factors": [[98, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 427.95160927771104/5802.828372136154
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/5802.828372136154
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/5802.828372136154
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 8: 5802.828372136154/7949.350977020189(0.12579643330515639 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.0807606262810683, 0.0807606262810683, 0.0807606262810683, 0.0807606262810683, 0.2959060994387874, 0.0807606262810683, 0.21953014287479997, 0.08076062628107104]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 13 schedules
mapping (0,0,0,0,1,1,1): explored 14 schedules
mapping (0,0,0,1,0,0,1): explored 14 schedules
mapping (0,0,0,1,0,1,0): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 26 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 17 schedules
Original weights [0.0807606262810683, 0.0807606262810683, 0.0807606262810683, 0.0807606262810683, 0.2959060994387874, 0.0807606262810683, 0.21953014287479997, 0.08076062628107104]
Original trials for each mapping [9, 9, 9, 9, 30, 9, 22, 9]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1089.4393374759975
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/1089.4393374759975
.Y.Y.E
*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 1: 1089.4393374759975/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 827.7892398070418/2075.696244723331
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=2: 2860.0239465348122/2860.0239465348122
.Y.Y.Y
*E*E*Y
iteration=3: 1130.899582684667/2860.0239465348122
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 2: 2860.0239465348122/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 8, 2], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[2, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1019.1764870532841/1256.9411699307452
.E.E.Y.Y.Y
*E*E*E
iteration=2: 1e-10/1256.9411699307452
.Y.Y.E
*T*E
iteration=3: 1e-10/1256.9411699307452
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 3: 1256.9411699307452/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 6], [3, 1, 1]], "last_factors": [[1, 392, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/3925.6131871493685
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=2: 288.9629383388256/3925.6131871493685
.E.Y.Y
*E*Y
iteration=3: 1640.9792223108448/3925.6131871493685
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 4: 3925.6131871493685/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 358.583743313034/5834.146424501155
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=2: 375.727012983773/5834.146424501155
.Y.Y.E
*E*E
iteration=3: 1e-10/5834.146424501155
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 5: 5834.146424501155/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1821.2367997916267
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=2: 1226.771371296847/1821.2367997916267
.Y.Y.E
*E*E
iteration=3: 1e-10/1821.2367997916267
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 6: 1821.2367997916267/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 7, 4, 7], [-1, 1, -1]], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 176.59277495772756/7949.350977020189
.E.E.Y.Y.Y
*E*E*E
iteration=2: 1e-10/7949.350977020189
.E.Y.Y
*E*E
iteration=3: 1e-10/7949.350977020189
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 7: 7949.350977020189/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[12, 2, 4], [3, 1, 1]], "last_factors": [[98, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/5802.828372136154
.E.Y.Y.E.Y
*E*Y*E
iteration=2: 254.09060754945804/5802.828372136154
.Y.Y.E
*E*E
iteration=3: 1e-10/5802.828372136154
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 8: 5802.828372136154/7949.350977020189(0.12579643330515639 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.07080534317982438, 0.07080534317982438, 0.07080534317982438, 0.07080534317982438, 0.1468205760863389, 0.07080534317982438, 0.4283473648347131, 0.0708053431798261]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 13 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Tensorize use time 947.7662274837494 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[512, 1024, 1, 1],body:R[1, 512, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [512, 1024, 1, 1] [1, 512, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph13/at:resnet50:subgraph13:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Original trials for each mapping [4, 25, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 881.6517675491034/3978.0711952929437
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 1: 3978.0711952929437/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 5437.639747465177/16401.682335283098
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 2: 16401.682335283098/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 8556.650120401302/13226.63899024339
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 3: 13226.63899024339/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 8952.58685078775/8952.58685078775
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 4: 8952.58685078775/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[5, 1, 5, 1], [-1, 0, 1]], [[4, 4, 1, 1], [1, 1, -1]], [[32, 1, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 2], [0, 0]]], "last_factors": [[[3584, 8, 14], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 1778.907700862255/8682.203436042348
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 5: 8682.203436042348/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[64, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 2295.1156552161947/2295.1156552161947
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 6: 2295.1156552161947/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[32, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 675.8034722954357/12429.991534877847
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 7: 12429.991534877847/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 10356.048213856146/12730.280584749318
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 8: 12730.280584749318/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 3693.3645688736465/4615.056920938198
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 9: 4615.056920938198/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 2, 8, 1], [0, 1, 0]], [2, 2, 2, 2], [[14, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 98, 32], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1440.2796009206788
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 10: 1440.2796009206788/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[14, 1, 1, 16], [1, 0, 0]], [[4, 2, 2, 1], [0, 1, -1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[32, 1, 2], [0, 0]]], "last_factors": [[[25088, 8, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/4166.1162685192385
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 11: 4166.1162685192385/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [2, 2, 2, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1124.4025186145088/4536.539673846266
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 12: 4536.539673846266/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 1085.882155724932/1085.882155724932
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 13: 1085.882155724932/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[1, 2, 1, 1], [[1, 8, 2, 1], [0, 0, 1]], [[2, 1, 1, 7], [0, 0, 0]]], "reduce_factors": [[[16, 2, 2], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[392, 64, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2550.626850565131/2984.600672384814
Best record value:16401.682335283098 (larger is better)
Round 1, Match 1, Mapping 14: 2984.600672384814/16401.682335283098(0.06096935543305898 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[4, 2, 1, 2], [0, 1, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 27239.05951412685/27239.05951412685
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 15: 27239.05951412685/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 2, 1], [[16, 1, 1, 1], [0, 0, 0]], [[14, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 16], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1535.9589929668057/1739.3858228659458
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 16: 1739.3858228659458/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[56, 28, 2, 1], [1, -1, 0]], [2, 2, 4, 1]], "reduce_factors": [[[8, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 256, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2078.8527168088926/2078.8527168088926
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 17: 2078.8527168088926/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 7, 2, 8], [1, -1, -1]], [[4, 1, 2, 2], [1, -1, 1]], [[7, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[16, 2, 2], [0, 1]]], "last_factors": [[[32, 448, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 12544.560513289447/12544.560513289447
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 18: 12544.560513289447/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 1598.600460466072/11904.041765600941
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 19: 11904.041765600941/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15524.478087850383/15524.478087850383
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 20: 15524.478087850383/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.04051845180322717, 0.1605272962879045, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 17 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 19 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 31 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 15 schedules
mapping (0,0,1,1,0,0,0): explored 20 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,1,0,0,0): explored 22 schedules
mapping (0,1,0,1,0,0,1): explored 34 schedules
mapping (0,1,0,1,1,0,0): explored 16 schedules
mapping (1,0,0,0,0,1,0): explored 21 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Original weights [0.04051845180322717, 0.1605272962879045, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717]
Original trials for each mapping [5, 17, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 16693.99003413472/16693.99003413472
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 1: 16693.99003413472/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 6469.079651274333/16401.682335283098
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 2: 16401.682335283098/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/13226.63899024339
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 3: 13226.63899024339/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 11618.217188780984/11618.217188780984
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 4: 11618.217188780984/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[5, 1, 5, 1], [-1, 0, 1]], [[4, 4, 1, 1], [1, 1, -1]], [[4, 16, 1, 2], [1, -1, -1]]], "reduce_factors": [[[16, 2, 2], [0, 0]]], "last_factors": [[[3584, 8, 14], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15061.898286553858/15061.898286553858
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 5: 15061.898286553858/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2295.1156552161947
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 6: 2295.1156552161947/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[32, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 11151.375927780991/12429.991534877847
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 7: 12429.991534877847/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 937.6055287267429/12730.280584749318
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 8: 12730.280584749318/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 863.3930295198894/4615.056920938198
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 9: 4615.056920938198/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 2, 8, 1], [0, 1, 0]], [2, 2, 2, 2], [[14, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[128, 98, 32], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 11006.709794974735/11006.709794974735
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 10: 11006.709794974735/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [8, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 4]], "last_factors": [[14, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 4368.8749413604055/4368.8749413604055
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 11: 4368.8749413604055/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [2, 2, 2, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 6821.053348577542/6821.053348577542
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 12: 6821.053348577542/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1085.882155724932
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 13: 1085.882155724932/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[1, 2, 1, 1], [[1, 8, 2, 1], [0, 0, 1]], [[2, 1, 1, 7], [0, 0, 0]]], "reduce_factors": [[[16, 2, 2], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[392, 64, 16], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 261.7653619086943/2984.600672384814
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 14: 2984.600672384814/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[4, 2, 1, 2], [0, 1, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/27239.05951412685
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 15: 27239.05951412685/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 2, 1], [[16, 1, 1, 1], [0, 0, 0]], [[14, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 16], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 1530.5213755432585/1739.3858228659458
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 16: 1739.3858228659458/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[56, 28, 2, 1], [1, -1, 0]], [2, 2, 4, 1]], "reduce_factors": [[[8, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 256, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2481.4195612247554/2481.4195612247554
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 17: 2481.4195612247554/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[112, 1, 1, 2], [1, 0, -1]], [[2, 2, 2, 2], [0, 1, -1]], [[7, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 4, 1], [1, -1]]], "last_factors": [[[56, 448, 16], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1497.1633840126647/12544.560513289447
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 18: 12544.560513289447/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 6073.167539337898/11904.041765600941
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 19: 11904.041765600941/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 590.1702076093447/15524.478087850383
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 20: 15524.478087850383/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.03758003144763057, 0.0962134919829326, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 21 schedules
mapping (0,0,0,0,0,1,1): explored 18 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 25 schedules
mapping (0,0,1,0,1,1,1): explored 16 schedules
mapping (0,0,1,1,0,0,0): explored 20 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 22 schedules
mapping (0,1,0,1,0,0,1): explored 36 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
mapping (1,0,0,0,0,1,0): explored 23 schedules
mapping (1,0,0,1,0,0,0): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Tensorize use time 678.222416639328 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1, 1024, 14, 14] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph14.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.004014523196694231
.N.Y.Y.Y.Y.Y.E.Y.Y.Y.E.N.N.N.N.N.N.N.N.E.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004014523196694231
.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.B.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.E.Y.E.Y.Y.E.Y.Y.Y.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.T.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.E.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0031483827626506023
Schedule cost 886.247984 seconds
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 14, 14],[1024, 256, 1, 1],body:R[1, 1024, 14, 14] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [1024, 256, 1, 1] [1, 1024, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph15/at:resnet50:subgraph15:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 3686.3290014528143/6226.040207912518
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 1: 6226.040207912518/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 4], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15461.482581770302/30246.044365331698
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 2: 30246.044365331698/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 18606.422419919636/25134.908618828045
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 3: 25134.908618828045/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 4866.64034432521/10711.938627233962
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 4: 10711.938627233962/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [1, 8, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 5634.234387231923/27803.525468618962
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 5: 27803.525468618962/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, 0]], [32, 1, 1, 1], [[2, 16, 2, 2], [0, -1, 0]], [[1, 2, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[4, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8192, 7, 14], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=1: 13635.191393141622/13635.191393141622
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 6: 13635.191393141622/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[5, 1, 5, 1], [0, -1, 1]], [[2, 4, 1, 4], [1, 1, -1]], [[32, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/30339.865847604102
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 7: 30339.865847604102/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [8, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 5421.784089448886/30058.69417756331
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 8: 30058.69417756331/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 7705.6010159191155/9403.537556677502
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 9: 9403.537556677502/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 4379.524525098434/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1997.9396702137183/17736.005721620604
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 11: 17736.005721620604/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[16, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 9013.339800253303/9013.339800253303
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 12: 9013.339800253303/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 16, 1]], "reduce_factors": [[8, 1, 2]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 6433.093797983551/6433.093797983551
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 13: 6433.093797983551/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [[4, 8, 1, 1], [1, -1, 0]], [[1, 7, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 7, 32], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 10667.115011223195/20568.877482174754
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 14: 20568.877482174754/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 4, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 12056.445149124753/12056.445149124753
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 15: 12056.445149124753/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[896, 7, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 10132.73084354931/39998.48586548887
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 16: 39998.48586548887/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 10766.3590093293/10766.3590093293
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 18: 10766.3590093293/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 8, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 30840.062779890322/40036.246843112414
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 19: 40036.246843112414/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 4], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 5786.7062869421925/14524.11355550379
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 20: 14524.11355550379/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 33 schedules
mapping (0,0,0,0,0,1,1): explored 24 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 26 schedules
mapping (0,0,0,1,0,0,0): explored 21 schedules
mapping (0,0,0,1,0,0,1): explored 28 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 28 schedules
mapping (0,0,1,0,0,1,0): explored 29 schedules
mapping (0,0,1,0,0,1,1): explored 34 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 21 schedules
mapping (0,0,1,1,0,0,0): explored 24 schedules
mapping (0,1,0,0,0,1,0): explored 27 schedules
mapping (0,1,0,1,0,0,0): explored 20 schedules
mapping (0,1,0,1,0,0,1): explored 19 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 20 schedules
Original weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 37, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 2556.5296375442626/6226.040207912518
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 1: 6226.040207912518/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 4], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 4406.4826865430505/30246.044365331698
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 2: 30246.044365331698/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 24554.85717034156/25134.908618828045
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 3: 25134.908618828045/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*Y*E*Y
iteration=1: 14393.026699115324/14393.026699115324
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 4: 14393.026699115324/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[448, 1, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/27803.525468618962
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 5: 27803.525468618962/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, 0]], [32, 1, 1, 1], [[2, 16, 2, 2], [0, -1, 0]], [[1, 2, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[4, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8192, 7, 14], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 4796.308713333359/13635.191393141622
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 6: 13635.191393141622/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[5, 1, 5, 1], [0, -1, 1]], [[2, 4, 1, 4], [1, 1, -1]], [[32, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/30339.865847604102
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 7: 30339.865847604102/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [8, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14711.944201635019/30058.69417756331
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 8: 30058.69417756331/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 3732.180255096563/9403.537556677502
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 9: 9403.537556677502/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 42162.15395589032/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 19237.171494441558/19237.171494441558
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 11: 19237.171494441558/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 1, 5], [32, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 18053.40927734779/18053.40927734779
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 12: 18053.40927734779/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*Y*Y
iteration=1: 4254.449991700977/6433.093797983551
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 13: 6433.093797983551/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [[4, 8, 1, 1], [1, -1, 0]], [[1, 7, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 7, 32], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 6211.152258496339/20568.877482174754
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 14: 20568.877482174754/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 4, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 8398.034858358737/12056.445149124753
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 15: 12056.445149124753/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[896, 7, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 1828.4737948651116/39998.48586548887
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 16: 39998.48586548887/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 16268.037136509292/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 9734.734807233512/10766.3590093293
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 18: 10766.3590093293/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 8, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 20106.852175972344/40036.246843112414
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 19: 40036.246843112414/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 4], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 2632.0991357979497/14524.11355550379
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 20: 14524.11355550379/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.4490914672569309, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 35 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 21 schedules
mapping (0,0,0,1,0,0,1): explored 30 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 33 schedules
mapping (0,0,1,0,0,1,0): explored 32 schedules
mapping (0,0,1,0,0,1,1): explored 37 schedules
mapping (0,0,1,0,1,1,0): explored 30 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 31 schedules
mapping (0,1,0,1,0,0,0): explored 23 schedules
mapping (0,1,0,1,0,0,1): explored 21 schedules
mapping (0,1,0,1,1,0,0): explored 30 schedules
mapping (1,0,0,0,0,1,0): explored 27 schedules
mapping (1,0,0,1,0,0,0): explored 34 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Tensorize use time 617.1025297641754 s.
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 16, 16],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph16/at:resnet50:subgraph16:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.24150629157585723, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752, 0.03992072149600752]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 825.4455119300342/2814.965840110349
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 1: 2814.965840110349/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 3177.2486311959397/3375.834536846011
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 2: 3375.834536846011/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 4012.178346497324/4012.178346497324
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 3: 4012.178346497324/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [0, 0, 0]], [2, 1, 4, 1], [[1, 8, 2, 8], [0, -1, 0]]], "reduce_factors": [[[24, 2, 1], [-1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[4096, 49, 1], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/10941.02996715534
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 4: 10941.02996715534/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[49, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 4347.072929484619/4347.072929484619
Best record value:11402.959042867305 (larger is better)
Round 1, Match 1, Mapping 5: 4347.072929484619/11402.959042867305(0.08769653528006947 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13576.90576455772/13576.90576455772
Best record value:13576.90576455772 (larger is better)
Round 1, Match 1, Mapping 6: 13576.90576455772/13576.90576455772(0.0736544848540146 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 2, 4, 1], [0, 1, -1]], [1, 1, 1, 1]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/3812.5308352442935
Best record value:13576.90576455772 (larger is better)
Round 1, Match 1, Mapping 7: 3812.5308352442935/13576.90576455772(0.0736544848540146 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[2, 28, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 3308.3037349848473/3308.3037349848473
Best record value:13576.90576455772 (larger is better)
Round 1, Match 1, Mapping 8: 3308.3037349848473/13576.90576455772(0.0736544848540146 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [4, 2, 1, 1], [[16, 4, 1, 2], [0, 0, 0]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1879.9580355767298/1879.9580355767298
Best record value:13576.90576455772 (larger is better)
Round 1, Match 1, Mapping 9: 1879.9580355767298/13576.90576455772(0.0736544848540146 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 4692.089428654026/4692.089428654026
Best record value:13576.90576455772 (larger is better)
Round 1, Match 1, Mapping 10: 4692.089428654026/13576.90576455772(0.0736544848540146 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[24, 6, 1]], "last_factors": [[7, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 18233.390451352392/18233.390451352392
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 11: 18233.390451352392/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 2, 2], [1, 1, 3]], "last_factors": [[16, 7, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 344.99805867004903/344.99805867004903
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 12: 344.99805867004903/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[48, 1, 3]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/696.3833627552414
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 13: 696.3833627552414/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[2, 1, 24], [3, 1, 1]], "last_factors": [[7, 28, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 219.605010456531/232.83051197759025
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 14: 232.83051197759025/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[48, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 17946.16177464942/17946.16177464942
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 15: 17946.16177464942/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[28, 4, 2, 1], [1, -1, 0]], [[8, 1, 1, 1], [0, 0, 0]], [7, 1, 1, 2]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/9884.645285559383
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 16: 9884.645285559383/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/4301.099135001353
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 17: 4301.099135001353/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 2345.430780424945/5942.112726474381
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 18: 5942.112726474381/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 1, 1], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 876.5951458278225/11010.567165834947
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 19: 11010.567165834947/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 2, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/2499.551095620533
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 20: 2499.551095620533/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 4, 2, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[3, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[128, 112, 14], [0, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
New weights [0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.1605272962879045, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 13 schedules
mapping (0,0,0,0,1,1,0): explored 15 schedules
mapping (0,0,0,0,1,1,1): explored 14 schedules
mapping (0,0,0,1,0,0,0): explored 11 schedules
mapping (0,0,0,1,0,0,1): explored 26 schedules
mapping (0,0,0,1,0,1,0): explored 14 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 11 schedules
mapping (0,0,1,0,0,1,1): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 15 schedules
mapping (0,0,1,1,0,0,0): explored 18 schedules
mapping (0,1,0,0,0,1,0): explored 6 schedules
mapping (0,1,0,1,0,0,0): explored 21 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 16 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 13 schedules
Original weights [0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.1605272962879045, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 17, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/2814.965840110349
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 1: 2814.965840110349/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 2975.126785417796/3375.834536846011
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 2: 3375.834536846011/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 207.18898948067417/4012.178346497324
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 3: 4012.178346497324/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [0, 0, 0]], [2, 1, 4, 1], [[1, 8, 2, 8], [0, -1, 0]]], "reduce_factors": [[[24, 2, 1], [-1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[4096, 49, 1], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1267.335563845258/10941.02996715534
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 4: 10941.02996715534/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[49, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/4347.072929484619
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 5: 4347.072929484619/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 13273.193097247247/13576.90576455772
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 6: 13576.90576455772/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 2, 4, 1], [0, 1, -1]], [1, 1, 1, 1]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 541.799466524452/3812.5308352442935
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 7: 3812.5308352442935/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[2, 28, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1326.0732235626028/3308.3037349848473
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 8: 3308.3037349848473/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [4, 2, 1, 1], [[16, 4, 1, 2], [0, 0, 0]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1879.9580355767298
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 9: 1879.9580355767298/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 3848.9774146051004/4692.089428654026
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 10: 4692.089428654026/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[24, 6, 1]], "last_factors": [[7, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/18233.390451352392
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 11: 18233.390451352392/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 2, 2], [1, 1, 3]], "last_factors": [[16, 7, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/344.99805867004903
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 12: 344.99805867004903/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[48, 1, 3]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3573.068418661297/3573.068418661297
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 13: 3573.068418661297/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[4, 2, 1, 1], [-1, 1, 0]], [[1, 7, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 6], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2695.214749182826/2695.214749182826
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 14: 2695.214749182826/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[3, 8, 2], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 14136.6912731847/17946.16177464942
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 15: 17946.16177464942/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[28, 4, 2, 1], [1, -1, 0]], [[8, 1, 1, 1], [0, 0, 0]], [7, 1, 1, 2]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 1485.614618153985/9884.645285559383
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 16: 9884.645285559383/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*T*E*Y*Y*Y
iteration=1: 875.944763793154/4301.099135001353
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 17: 4301.099135001353/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5699.7138655742065/5942.112726474381
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 18: 5942.112726474381/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 1, 1], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3204.6383758855814/11010.567165834947
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 19: 11010.567165834947/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 2, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 3197.76573807756/3197.76573807756
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 20: 3197.76573807756/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.0962134919829326, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 14 schedules
mapping (0,0,0,0,1,1,0): explored 16 schedules
mapping (0,0,0,0,1,1,1): explored 16 schedules
mapping (0,0,0,1,0,0,0): explored 11 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 15 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 11 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 22 schedules
mapping (0,0,1,0,1,1,1): explored 15 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 9 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 27 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Tensorize use time 920.1223599910736 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[256, 1024, 1, 1],body:R[1, 256, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [256, 1024, 1, 1] [1, 256, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph17/at:resnet50:subgraph17:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Original trials for each mapping [5, 10, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 5561.711109362886/13290.165831064649
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 1: 13290.165831064649/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 12445.018464796094/19610.30288708449
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 2: 19610.30288708449/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/9266.982870527318
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 3: 9266.982870527318/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 13532.965165142945/13532.965165142945
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 4: 13532.965165142945/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8]], "last_factors": [[49, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 6053.465630905255/6053.465630905255
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 5: 6053.465630905255/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[[1, 1, 1, 2], [0, -1, 0]], [[1, 2, 4, 1], [-1, 0, 1]], [[4, 2, 4, 4], [-1, 0, 1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7, 3584, 8], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 2117.2916803127887/6170.813383582646
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 6: 6170.813383582646/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 1505.208903003615/7692.42762683031
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 7: 7692.42762683031/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 4958.78251971576/4958.78251971576
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 8: 4958.78251971576/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [1, 1, 14, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[196, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 865.2811050955781/11537.18858953466
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 9: 11537.18858953466/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 10905.623604136657/15333.986651025125
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 10: 15333.986651025125/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 29414.445807708387/29414.445807708387
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 11: 29414.445807708387/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 5473.721551784662/8349.947481551804
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 12: 8349.947481551804/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 1, 1, 8], [0, 0, -1]]], "reduce_factors": [[[64, 1, 1], [0, 0]]], "last_factors": [[[224, 32, 28], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 9616.58860987874/9616.58860987874
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 13: 9616.58860987874/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[4, 8, 2], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2999.118517080171/4416.548397652983
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 14: 4416.548397652983/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [1, 4, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1]], "last_factors": [[4, 392, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/29582.76885314248
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 15: 29582.76885314248/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 11389.684244924627/11389.684244924627
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 16: 11389.684244924627/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[2, 56, 4, 7], [0, 0, 0]], [[2, 1, 2, 2], [1, 0, 0]]], "reduce_factors": [[[16, 2, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[8, 14, 14]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13738.260830308433/13738.260830308433
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 17: 13738.260830308433/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[112, 1, 1, 2], [0, -1, 0]], [[1, 4, 1, 2], [-1, 1, 0]], [7, 1, 2, 1]], "reduce_factors": [[[8, 4, 2], [-1, 0]]], "last_factors": [[[3584, 14, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 21066.888600269576/21066.888600269576
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 18: 21066.888600269576/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 3282.30365954657/5026.988992081869
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 19: 5026.988992081869/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[7, 2, 8, 2], [1, 0, -1]], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 10186.477209770044/10186.477209770044
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 20: 10186.477209770044/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.0387149526885566, 0.06891903623878733, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.2342118153671936, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 21 schedules
mapping (0,0,0,0,1,1,0): explored 22 schedules
mapping (0,0,0,0,1,1,1): explored 30 schedules
mapping (0,0,0,1,0,0,0): explored 37 schedules
mapping (0,0,0,1,0,0,1): explored 28 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 22 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 23 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 24 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 32 schedules
mapping (0,1,0,1,1,0,0): explored 22 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 24 schedules
Original weights [0.0387149526885566, 0.06891903623878733, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.2342118153671936, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566]
Original trials for each mapping [4, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 24, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 3083.8082567387223/13290.165831064649
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 1: 13290.165831064649/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 7123.774077126012/19610.30288708449
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 2: 19610.30288708449/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 2400.9347484689297/9266.982870527318
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 3: 9266.982870527318/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 2126.473390671101/13532.965165142945
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 4: 13532.965165142945/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8]], "last_factors": [[49, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/6053.465630905255
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 5: 6053.465630905255/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[[1, 1, 1, 2], [0, -1, 0]], [[1, 2, 4, 1], [-1, 0, 1]], [[4, 2, 4, 4], [-1, 0, 1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7, 3584, 8], [0, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 6684.270934611943/6684.270934611943
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 6: 6684.270934611943/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 8945.125981588524/8945.125981588524
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 7: 8945.125981588524/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7473.64112283227/7473.64112283227
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 8: 7473.64112283227/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, -1]], [[2, 2, 2, 1], [0, 1, 0]], [[4, 16, 2, 1], [0, 0, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28, 3584, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.E.Y.E
*E*Y
iteration=1: 7267.770014010358/11537.18858953466
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 9: 11537.18858953466/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 12337.227334391966/15333.986651025125
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 10: 15333.986651025125/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/29414.445807708387
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 11: 29414.445807708387/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 2782.003181787343/8349.947481551804
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 12: 8349.947481551804/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 1, 1, 8], [0, 0, -1]]], "reduce_factors": [[[64, 1, 1], [0, 0]]], "last_factors": [[[224, 32, 28], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 12055.4232401008/12055.4232401008
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 13: 12055.4232401008/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 4, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[49, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 17629.3407806432/17629.3407806432
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 14: 17629.3407806432/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[98, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 596.8882474888347/29582.76885314248
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 15: 29582.76885314248/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 19644.156953774353/19644.156953774353
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 16: 19644.156953774353/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 10559.209687179438/13738.260830308433
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 17: 13738.260830308433/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[112, 1, 1, 2], [0, -1, 0]], [[1, 4, 1, 2], [-1, 1, 0]], [7, 1, 2, 1]], "reduce_factors": [[[8, 4, 2], [-1, 0]]], "last_factors": [[[3584, 14, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/21066.888600269576
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 18: 21066.888600269576/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11676.283724112813/11676.283724112813
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 19: 11676.283724112813/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 6062.138058478784/10186.477209770044
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 20: 10186.477209770044/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.03297529899888271, 0.05011859544049359, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.3563260225796174, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 23 schedules
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 37 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 26 schedules
mapping (0,0,0,1,1,0,0): explored 27 schedules
mapping (0,0,1,0,0,1,0): explored 20 schedules
mapping (0,0,1,0,0,1,1): explored 32 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 24 schedules
mapping (0,1,0,0,0,1,0): explored 25 schedules
mapping (0,1,0,1,0,0,0): explored 26 schedules
mapping (0,1,0,1,0,0,1): explored 34 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Tensorize use time 883.0479538440704 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph34.log by 200 trials...
.Y.E.Y.Y.E.Y.Y.Y.E.Y.B.N.N.N.N.N

Currently best performance: 0.0037969394854451615
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.E.Y.Y.E.Y.E.N.N.B

Currently best performance: 0.0037740306735634757
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0037740306735634757
.Y.Y.Y.Y.Y.Y.E.Y.Y.T.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N.N.N

Currently best performance: 0.0037740306735634757
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.E.Y.Y.Y.Y.Y.T.Y.Y.Y.N

Currently best performance: 0.0037736668625595734
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.T.Y.Y.N.N.N.B.N.N.N

Currently best performance: 0.003593671550283241
.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
Schedule cost 1450.717360 seconds
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[1024, 512, 1, 1],body:R[1, 1024, 14, 14] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [1024, 512, 1, 1] [1, 1024, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph35/at:resnet50:subgraph35:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 10, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5584.732116368236/10116.886530624432
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 1: 10116.886530624432/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 4, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 5266.01741470475/10630.75219864774
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 2: 10630.75219864774/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 64, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/22413.56872588828
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 3: 22413.56872588828/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 7772.726546742941/7772.726546742941
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 4: 7772.726546742941/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 5428.8785359753465/5428.8785359753465
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 5: 5428.8785359753465/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": 2, "spatial_factors": [[[1, 1, 2, 1], [0, 0, 0]], [[32, 1, 1, 1], [1, -1, 0]], [[16, 4, 2, 1], [1, 0, 1]], [[1, 1, 2, 7], [0, -1, 1]]], "reduce_factors": [[[16, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16, 6272, 8], [-1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2428.998829836311/6262.7674857685715
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 6: 6262.7674857685715/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1285.2016687090447/30869.59917949008
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 7: 30869.59917949008/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 716.9739760610082/5765.741496519166
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 8: 5765.741496519166/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 4, 1, 1], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 6047.062479469592/6047.062479469592
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 9: 6047.062479469592/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 1, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 5512.553867391697/12423.143439314239
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 10: 12423.143439314239/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 12445.914659835833/12445.914659835833
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 11: 12445.914659835833/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[224, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 2823.4357919497124/40411.1505641937
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 12: 40411.1505641937/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [16, 1, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[49, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 21340.672472348368/21340.672472348368
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 13: 21340.672472348368/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [16, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 31113.300300120893/31113.300300120893
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 14: 31113.300300120893/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 445.8761470776446/4793.358236306063
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 15: 4793.358236306063/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1449.7634937675616/1533.3574680200306
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 16: 1533.3574680200306/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 2, 4, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 13113.274171211528/13113.274171211528
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 17: 13113.274171211528/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 1, 8, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1]], "last_factors": [[448, 14, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 1100.3589554638718/2640.848030398963
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 18: 2640.848030398963/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 2227.7482095638734/3240.027210358134
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 19: 3240.027210358134/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 4, 2], [1, 2, 1, 7]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 2336.8154201756142/8969.522293912092
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 20: 8969.522293912092/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 8, 4, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.2342118153671936, 0.0387149526885566, 0.06891903623878733, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 18 schedules
mapping (0,0,0,0,0,1,1): explored 23 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,0): explored 18 schedules
mapping (0,0,0,1,0,0,1): explored 25 schedules
mapping (0,0,0,1,0,1,0): explored 19 schedules
mapping (0,0,0,1,1,0,0): explored 17 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 32 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 25 schedules
mapping (0,0,1,1,0,0,0): explored 29 schedules
mapping (0,1,0,0,0,1,0): explored 26 schedules
mapping (0,1,0,1,0,0,0): explored 20 schedules
mapping (0,1,0,1,0,0,1): explored 21 schedules
mapping (0,1,0,1,1,0,0): explored 20 schedules
mapping (1,0,0,0,0,1,0): explored 20 schedules
mapping (1,0,0,1,0,0,0): explored 33 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Original weights [0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.2342118153671936, 0.0387149526885566, 0.06891903623878733, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566, 0.0387149526885566]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 24, 4, 7, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 7370.484735158576/10116.886530624432
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 1: 10116.886530624432/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 4, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 20526.335436547204/20526.335436547204
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 2: 20526.335436547204/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [32, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/22413.56872588828
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 3: 22413.56872588828/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 2314.2291148536483/7772.726546742941
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 4: 7772.726546742941/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 5876.209355471275/5876.209355471275
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 5: 5876.209355471275/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [16, 1, 1, 2], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 3706.322662560882/6262.7674857685715
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 6: 6262.7674857685715/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 3068.3621932480582/30869.59917949008
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 7: 30869.59917949008/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 9421.131332117226/9421.131332117226
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 8: 9421.131332117226/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 20437.046207681367/20437.046207681367
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 9: 20437.046207681367/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/12423.143439314239
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 10: 12423.143439314239/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/12445.914659835833
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 11: 12445.914659835833/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[224, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 9215.052158395189/40411.1505641937
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 12: 40411.1505641937/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [16, 1, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[49, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 3447.8640162432/21340.672472348368
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 13: 21340.672472348368/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [16, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 6591.835260149096/31113.300300120893
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 14: 31113.300300120893/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 1580.9921456087534/4793.358236306063
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 15: 4793.358236306063/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 1782.9410649450613/1782.9410649450613
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 16: 1782.9410649450613/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [1, 16, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[1, 896, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11659.74095660144/13113.274171211528
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 17: 13113.274171211528/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 1, 8, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1]], "last_factors": [[448, 14, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*Y
iteration=1: 5541.553620549572/5541.553620549572
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 18: 5541.553620549572/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [32, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/3240.027210358134
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 19: 3240.027210358134/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 4, 2], [1, 2, 1, 7]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/8969.522293912092
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 20: 8969.522293912092/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 8, 4, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.3563260225796174, 0.03297529899888271, 0.05011859544049359, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 24 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 36 schedules
mapping (0,0,0,1,0,0,0): explored 20 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,1,0): explored 25 schedules
mapping (0,0,1,0,0,1,1): explored 32 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 30 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 21 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (0,1,0,1,1,0,0): explored 25 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 33 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Tensorize use time 631.7885801792145 s.
#############################################
operations:inputs:[1, 256, 28, 28],[256],[256],body:S[1, 256, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 28, 28],body:S[1, 256, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 28, 28],body:S[1, 256, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 30, 30],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 28, 28] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph37/at:resnet50:subgraph37:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Original trials for each mapping [10, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 1001.5859706375688/4094.385839804651
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 1: 4094.385839804651/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1776.666771488008/5752.4412169937905
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 2: 5752.4412169937905/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 3, 2], [1, 1, 3]], "last_factors": [[98, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 2518.8363429486117/2518.8363429486117
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 3: 2518.8363429486117/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 1], [1, 1, 3]], "last_factors": [[14, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 1974.1291300991422/1974.1291300991422
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 4: 1974.1291300991422/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[144, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*E*E
iteration=1: 1e-10/473.62594496532506
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 5: 473.62594496532506/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[2, 2, 1, 2], [1, -1, 0]], [[4, 2, 8, 2], [1, 1, 1]], [[1, 14, 1, 1], [0, 1, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[56, 448, 8], [0, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 3399.78973660395/3399.78973660395
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 6: 3399.78973660395/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 903.4398564477241/903.4398564477241
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 7: 903.4398564477241/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [4, 1, 1, 2], [[32, 2, 1, 2], [1, 0, 0]]], "reduce_factors": [[[1, 1, 16], [-1, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14, 3584, 4], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 1006.2309393481464/1768.1001338408146
Best record value:7284.428508009884 (larger is better)
Round 1, Match 1, Mapping 8: 1768.1001338408146/7284.428508009884(0.13727912888436067 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[12, 4, 1], [1, 3, 1]], "last_factors": [[1, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 10879.563992904737/10879.563992904737
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 9: 10879.563992904737/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[112, 1, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 58.045706580717244/7284.428508009884
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 10: 7284.428508009884/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[9, 2, 8]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/889.7652105357744
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 11: 889.7652105357744/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[784, 1, 4, 1], [0, -1, 1]], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 6, 4], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[49, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1442.0762443490532/4047.377240191769
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 12: 4047.377240191769/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 5, 5, 1], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 235.89876976585916/363.14202104414915
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 13: 363.14202104414915/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 2], [2, 1, 1, 7]], "reduce_factors": [[48, 1, 1], [1, 3, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1653.5178110570466/2911.124912577461
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 14: 2911.124912577461/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[32, 1, 7, 1], [-1, 0, 1]], [[2, 4, 1, 1], [1, 1, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[256, 784, 1], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 1333.8661171900856/2426.959809879405
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 15: 2426.959809879405/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[2, 4, 1, 1], [1, 0, 0]], [[1, 2, 7, 1], [-1, 1, 0]]], "reduce_factors": [[[12, 2, 2], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[512, 49, 8], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2319.1324458152403/2319.1324458152403
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 16: 2319.1324458152403/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[49, 8, 4, 2], [0, 0, 0]], [[2, 2, 2, 1], [1, 0, 0]]], "reduce_factors": [[[12, 1, 4], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[6272, 1, 32], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2008.5866780698432
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 17: 2008.5866780698432/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 2, 1, 1]], "reduce_factors": [[16, 9, 1]], "last_factors": [[32, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 1787.55941308122/2259.3107249654063
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 18: 2259.3107249654063/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[1, 4, 4], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*Y*Y
iteration=1: 2019.1965292085147/2029.431122044455
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 19: 2029.431122044455/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 224, 1, 1], [0, 0, 0]], [[8, 1, 1, 1], [0, 0, 0]], [[1, 1, 7, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[14, 1792, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/736.4189732692606
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 20: 736.4189732692606/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 8, 1, 1], [-1, 1, 0]], [[4, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 8, 1], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1, 28672, 7], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
New weights [0.07503653240678768, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.11457946109916489, 0.0938097284729886, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 13 schedules
mapping (0,0,0,0,0,1,1): explored 14 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 12 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 16 schedules
mapping (0,0,1,0,0,1,0): explored 15 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 12 schedules
mapping (0,0,1,0,1,1,1): explored 23 schedules
mapping (0,0,1,1,0,0,0): explored 18 schedules
mapping (0,1,0,0,0,1,0): explored 13 schedules
mapping (0,1,0,1,0,0,0): explored 16 schedules
mapping (0,1,0,1,0,0,1): explored 19 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 21 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 21 schedules
Original weights [0.07503653240678768, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.11457946109916489, 0.0938097284729886, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795]
Original trials for each mapping [8, 5, 5, 5, 5, 5, 5, 5, 12, 10, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 591.3670765812693/4094.385839804651
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 1: 4094.385839804651/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 6130.7708896893055/6130.7708896893055
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 2: 6130.7708896893055/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[196, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/2518.8363429486117
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 3: 2518.8363429486117/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 1], [1, 1, 3]], "last_factors": [[14, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 3765.7377234804817/3765.7377234804817
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 4: 3765.7377234804817/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [1, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[784, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 2883.448670517337/2883.448670517337
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 5: 2883.448670517337/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [1, 8, 1, 1], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/3399.78973660395
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 6: 3399.78973660395/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 479.46125441540033/903.4398564477241
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 7: 903.4398564477241/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [4, 1, 1, 2], [[32, 2, 1, 2], [1, 0, 0]]], "reduce_factors": [[[1, 1, 16], [-1, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14, 3584, 4], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 839.2928990896886/1768.1001338408146
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 8: 1768.1001338408146/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[12, 4, 1], [1, 3, 1]], "last_factors": [[1, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 5683.16230823631/10879.563992904737
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 9: 10879.563992904737/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[112, 1, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 1479.461443486419/7284.428508009884
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 10: 7284.428508009884/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[9, 2, 8]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 734.3713552705622/889.7652105357744
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 11: 889.7652105357744/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[784, 1, 4, 1], [0, -1, 1]], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 6, 4], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[49, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1852.3516450337147/4047.377240191769
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 12: 4047.377240191769/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 5, 5, 1], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 2563.7712193114735/2563.7712193114735
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 13: 2563.7712193114735/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[4, 12, 1], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/2911.124912577461
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 14: 2911.124912577461/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[32, 1, 7, 1], [-1, 0, 1]], [[2, 4, 1, 1], [1, 1, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[256, 784, 1], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/2426.959809879405
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 15: 2426.959809879405/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[2, 4, 1, 1], [1, 0, 0]], [[1, 2, 7, 1], [-1, 1, 0]]], "reduce_factors": [[[12, 2, 2], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[512, 49, 8], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 265.41082720989306/2319.1324458152403
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 16: 2319.1324458152403/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[49, 8, 4, 2], [0, 0, 0]], [[2, 2, 2, 1], [1, 0, 0]]], "reduce_factors": [[[12, 1, 4], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[6272, 1, 32], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 8043.447076275373/8043.447076275373
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 17: 8043.447076275373/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 2, 7, 2], [1, 1, 1]], [[4, 2, 1, 1], [0, 1, -1]], [[7, 1, 1, 2], [0, -1, 0]]], "reduce_factors": [[[24, 3, 2], [1, -1]]], "last_factors": [[[3584, 7, 8], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 5351.784052098863/5351.784052098863
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 18: 5351.784052098863/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1860.2031330632112/2029.431122044455
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 19: 2029.431122044455/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 224, 1, 1], [0, 0, 0]], [[8, 1, 1, 1], [0, 0, 0]], [[1, 1, 7, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[14, 1792, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 281.9614004203943/736.4189732692606
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 20: 736.4189732692606/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 8, 1, 1], [-1, 1, 0]], [[4, 1, 2, 1], [0, -1, 1]]], "reduce_factors": [[[2, 8, 1], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1, 28672, 7], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
New weights [0.05766803909260984, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.22953826901990948, 0.06777254044140643, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 16 schedules
mapping (0,0,0,0,0,1,1): explored 17 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,0): explored 13 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 31 schedules
mapping (0,0,0,1,1,0,0): explored 17 schedules
mapping (0,0,1,0,0,1,0): explored 18 schedules
mapping (0,0,1,0,0,1,1): explored 15 schedules
mapping (0,0,1,0,1,1,0): explored 14 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 13 schedules
mapping (0,1,0,1,0,0,0): explored 16 schedules
mapping (0,1,0,1,0,0,1): explored 21 schedules
mapping (0,1,0,1,1,0,0): explored 9 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Tensorize use time 907.803234577179 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[256, 512, 1, 1],body:R[1, 256, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [256, 512, 1, 1] [1, 256, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph38/at:resnet50:subgraph38:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Original trials for each mapping [5, 12, 5, 5, 5, 5, 5, 5, 5, 10, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 3204.746420644046/5244.477237518436
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 1: 5244.477237518436/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 8376.309022727562/32603.213258919433
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 2: 32603.213258919433/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 2], [[8, 1, 1, 1], [0, 0, 0]], [[4, 2, 1, 16], [0, -1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 2, 8], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 2329.323969621593/3534.824613274041
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 3: 3534.824613274041/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 7], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[1, 448, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 25632.308630740503/25632.308630740503
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 4: 25632.308630740503/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 1, 7, 1], [[4, 1, 1, 2], [-1, 0, 0]], [[2, 16, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 1], [-1, 1]]], "last_factors": [[[14336, 56, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 25268.11746638482/25268.11746638482
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 5: 25268.11746638482/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[1, 1, 2, 2], [0, -1, 0]], [[4, 1, 2, 1], [0, -1, 1]], [[64, 2, 1, 1], [0, 1, -1]], [[7, 2, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[4, 8, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 14, 16], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 14516.57253422937/14516.57253422937
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 6: 14516.57253422937/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 1735.5779421560267/15696.504530945278
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 7: 15696.504530945278/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 21292.14599581217/21292.14599581217
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 8: 21292.14599581217/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 2, 4, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 12679.733127527064/24936.009333641858
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 9: 24936.009333641858/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [8, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 9500.856273737374/19257.425902210063
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 10: 19257.425902210063/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 2, 1], [-1, 0, 1]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 16, 1], [1, 1]]], "last_factors": [[[6272, 128, 1], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1893.5994993913134/7343.868829508598
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 11: 7343.868829508598/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 1]], "reduce_factors": [[1, 32, 1], [1, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 24956.799175891672/24956.799175891672
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 12: 24956.799175891672/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 1], [8, 1, 1, 1]], "reduce_factors": [[1, 32, 1]], "last_factors": [[64, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 976.9813074526071/2325.6184547767843
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 13: 2325.6184547767843/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 112, 2, 1], [-1, 0, 1]], [[4, 2, 1, 1], [1, 1, -1]], [[7, 2, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 4, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[112, 224, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 9642.552786177032/9642.552786177032
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 14: 9642.552786177032/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [1, 1, 2, 4], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[3136, 1, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1564.166712512327/5211.102272435319
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 15: 5211.102272435319/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [1, 8, 1, 1], [2, 1, 14, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[56, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2654.2577295010838/2654.2577295010838
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 16: 2654.2577295010838/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[7, 2, 1, 7], [[2, 1, 4, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 2], [1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 14336, 7], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 741.9324968151554/13321.924195527821
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 17: 13321.924195527821/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3298.4159044837897/5356.2196283193425
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 18: 5356.2196283193425/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 1, 2, 2], [2, 7, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 24377.902125799596/24377.902125799596
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 19: 24377.902125799596/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 2], [[14, 1, 2, 1], [0, 0, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 4, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 21296.33469059542/21296.33469059542
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 20: 21296.33469059542/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 22 schedules
mapping (0,0,0,0,0,1,1): explored 32 schedules
mapping (0,0,0,0,1,1,0): explored 30 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 25 schedules
mapping (0,0,0,1,0,0,1): explored 20 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 25 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 26 schedules
mapping (0,0,1,0,1,1,1): explored 37 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 31 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 32 schedules
mapping (1,0,0,0,0,1,0): explored 25 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 24 schedules
Original weights [0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659]
Original trials for each mapping [4, 24, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 4376.114269333418/5244.477237518436
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 1: 5244.477237518436/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/32603.213258919433
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 2: 32603.213258919433/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 2], [[8, 1, 1, 1], [0, 0, 0]], [[4, 2, 1, 16], [0, -1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 2, 8], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 9291.137781277019/9291.137781277019
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 3: 9291.137781277019/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/25632.308630740503
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 4: 25632.308630740503/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 1, 7, 1], [[4, 1, 1, 2], [-1, 0, 0]], [[2, 16, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 1], [-1, 1]]], "last_factors": [[[14336, 56, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 25251.599734266885/25268.11746638482
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 5: 25268.11746638482/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[1, 1, 2, 2], [0, -1, 0]], [[4, 1, 2, 1], [0, -1, 1]], [[64, 2, 1, 1], [0, 1, -1]], [[7, 2, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[4, 8, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 14, 16], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 2190.6977406835413/14516.57253422937
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 6: 14516.57253422937/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 3329.9685754579255/15696.504530945278
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 7: 15696.504530945278/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 7194.267026548256/21292.14599581217
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 8: 21292.14599581217/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 2, 4, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 25007.863028200652/25007.863028200652
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 9: 25007.863028200652/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 2, 8], [1, 1, 1]], "last_factors": [[98, 4, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 31247.460988797327/31247.460988797327
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 10: 31247.460988797327/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 2], [14, 1, 1, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[448, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 2731.8783931652065/7343.868829508598
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 11: 7343.868829508598/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 1]], "reduce_factors": [[1, 32, 1], [1, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1714.0738472238068/24956.799175891672
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 12: 24956.799175891672/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 1], [8, 1, 1, 1]], "reduce_factors": [[1, 32, 1]], "last_factors": [[64, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2325.6184547767843
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 13: 2325.6184547767843/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 1, "spatial_factors": [[[2, 112, 2, 1], [-1, 0, 1]], [[4, 2, 1, 1], [1, 1, -1]], [[7, 2, 1, 2], [0, 0, 0]]], "reduce_factors": [[[2, 4, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[112, 224, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 13777.586271390754/13777.586271390754
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 14: 13777.586271390754/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [1, 2, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[98, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 4472.383047059568/5211.102272435319
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 15: 5211.102272435319/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [1, 8, 1, 1], [2, 1, 14, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[56, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/2654.2577295010838
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 16: 2654.2577295010838/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[7, 2, 1, 7], [[2, 1, 4, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 2], [1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 14336, 7], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/13321.924195527821
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 17: 13321.924195527821/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 9647.668180341461/9647.668180341461
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 18: 9647.668180341461/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 9601.065083480249/24377.902125799596
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 19: 24377.902125799596/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 2], [[14, 1, 2, 1], [0, 0, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 4, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 2540.6664556160185/21296.33469059542
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 20: 21296.33469059542/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.0329752989988827, 0.35632602257961726, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.050118595440493574, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 32 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 30 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 26 schedules
mapping (0,0,1,0,0,1,0): explored 25 schedules
mapping (0,0,1,0,0,1,1): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 40 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 32 schedules
mapping (0,1,0,1,0,0,0): explored 36 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 32 schedules
mapping (1,0,0,0,0,1,0): explored 26 schedules
mapping (1,0,0,1,0,0,0): explored 32 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Tensorize use time 669.824296951294 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [1, 512, 28, 28] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph39.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0038482458147607855
.N.N.E.Y.Y.Y.Y.Y.T.Y.Y.Y.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003824642525898524
.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003824642525898524
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.T.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.T.Y.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003824642525898524
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003824642525898524
Schedule cost 1261.253816 seconds
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 128, 28, 28],[512, 128, 1, 1],body:R[1, 512, 28, 28] [128, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [512, 128, 1, 1] [1, 512, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph40/at:resnet50:subgraph40:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 26849.719607082923/38779.52067648477
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 1: 38779.52067648477/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 6853.071093625543/44207.936145967775
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 2: 44207.936145967775/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 43337.15426033236/43337.15426033236
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 3: 43337.15426033236/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 16, 16], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3963.725147370831/27350.72072749853
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 4: 27350.72072749853/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 42043.08406845557/42043.08406845557
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 5: 42043.08406845557/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [4, 1, 4, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 6096.460886943457/24910.065246255665
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 6: 24910.065246255665/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3361.1146111345/8227.283313211155
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 7: 8227.283313211155/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 7, 1, 2], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 16583.546621223242/35834.059865070136
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 8: 35834.059865070136/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 8307.397760844002/12892.917513187022
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 9: 12892.917513187022/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 7, 2, 2], [0, 0, 0]], [[2, 8, 1, 1], [0, 1, -1]], [[14, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[1, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 23909.580226272134/23909.580226272134
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 10: 23909.580226272134/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 1, 2], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 1]], "last_factors": [[196, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2913.1871311137365/14166.786718181325
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 11: 14166.786718181325/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 1, 2, 8]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[32, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 10766.698946465327/26455.260887197714
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 12: 26455.260887197714/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.E.E
*Y*E
iteration=1: 673.0484427655213/27891.97700503213
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 13: 27891.97700503213/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [7, 2, 2, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[112, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 18086.090823858063/36075.71786748248
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 14: 36075.71786748248/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 11359.23693377128/11359.23693377128
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 15: 11359.23693377128/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 1, 1, 16], [14, 1, 1, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[56, 32, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 33693.38231836143/33693.38231836143
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 16: 33693.38231836143/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 7], [2, 1, 8, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 3769.614517586922/8669.481733705115
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 17: 8669.481733705115/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 1, 1, 8], [1, 7, 2, 2]], "reduce_factors": [[4, 2, 1]], "last_factors": [[784, 1, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 22535.072477572503/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 1517.2950131488603/4417.116687958902
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 19: 4417.116687958902/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 4, 2, 1], [1, 1, 4, 7]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 448, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 26427.66879251868/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 27 schedules
mapping (0,0,0,0,0,1,1): explored 34 schedules
mapping (0,0,0,0,1,1,0): explored 38 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 36 schedules
mapping (0,0,0,1,0,0,1): explored 33 schedules
mapping (0,0,0,1,0,1,0): explored 34 schedules
mapping (0,0,0,1,1,0,0): explored 38 schedules
mapping (0,0,1,0,0,1,0): explored 45 schedules
mapping (0,0,1,0,0,1,1): explored 35 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 36 schedules
mapping (0,0,1,1,0,0,0): explored 28 schedules
mapping (0,1,0,0,0,1,0): explored 32 schedules
mapping (0,1,0,1,0,0,0): explored 31 schedules
mapping (0,1,0,1,0,0,1): explored 37 schedules
mapping (0,1,0,1,1,0,0): explored 34 schedules
mapping (1,0,0,0,0,1,0): explored 25 schedules
mapping (1,0,0,1,0,0,0): explored 22 schedules
mapping (1,0,0,1,0,1,0): explored 20 schedules
Original weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 37, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 22347.073387873144/38779.52067648477
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 1: 38779.52067648477/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4814.328253399975/44207.936145967775
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 2: 44207.936145967775/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 1987.3823573362226/43337.15426033236
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 3: 43337.15426033236/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 16, 16], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 24413.005049927247/27350.72072749853
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 4: 27350.72072749853/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2604.412105565709/42043.08406845557
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 5: 42043.08406845557/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [4, 1, 4, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 2599.005431750642/24910.065246255665
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 6: 24910.065246255665/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 15292.563303454395/15292.563303454395
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 7: 15292.563303454395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[49, 2, 1, 1], [0, 1, 0]], [[4, 2, 2, 1], [1, -1, 1]], [[8, 2, 8, 1], [0, 1, 1]]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1792, 32, 28], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 5305.346759381044/35834.059865070136
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 8: 35834.059865070136/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 12501.72042634959/12892.917513187022
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 9: 12892.917513187022/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 7, 2, 2], [0, 0, 0]], [[2, 8, 1, 1], [0, 1, -1]], [[14, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[1, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 8076.706456179922/23909.580226272134
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 10: 23909.580226272134/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 1, 2], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 1]], "last_factors": [[196, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 12873.451347462318/14166.786718181325
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 11: 14166.786718181325/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 1, 2, 8]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[32, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 39882.62992523138/39882.62992523138
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 12: 39882.62992523138/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 37711.35820645354/37711.35820645354
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 13: 37711.35820645354/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 6623.741530362717/36075.71786748248
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 14: 36075.71786748248/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 3842.311990923969/11359.23693377128
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 15: 11359.23693377128/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 1, 1, 16], [14, 1, 1, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[56, 32, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 17688.27118712156/33693.38231836143
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 16: 33693.38231836143/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 7], [2, 1, 8, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 15727.847729045647/15727.847729045647
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 17: 15727.847729045647/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [4, 1, 2, 2], [1, 2, 2, 7]], "reduce_factors": [[2, 4, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 23105.13879883733/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 37261.41222980756/37261.41222980756
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 19: 37261.41222980756/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [4, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 28018.53680439506/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 37 schedules
mapping (0,0,0,0,1,1,0): explored 40 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 41 schedules
mapping (0,0,0,1,0,0,1): explored 35 schedules
mapping (0,0,0,1,0,1,0): explored 37 schedules
mapping (0,0,0,1,1,0,0): explored 40 schedules
mapping (0,0,1,0,0,1,0): explored 49 schedules
mapping (0,0,1,0,0,1,1): explored 38 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 40 schedules
mapping (0,0,1,1,0,0,0): explored 32 schedules
mapping (0,1,0,0,0,1,0): explored 34 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 39 schedules
mapping (0,1,0,1,1,0,0): explored 37 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Tensorize use time 561.3174846172333 s.
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 30, 30],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph41/at:resnet50:subgraph41:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316]
Original trials for each mapping [5, 5, 5, 5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 10, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 2372.694533804511/3254.4458905557176
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 1: 3254.4458905557176/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3786.1676369247953/5114.969535208765
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 2: 5114.969535208765/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 744.2499506136054/1551.5705935288172
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 3: 1551.5705935288172/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1186.664112874931
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 4: 1186.664112874931/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 7, 7, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[18, 1, 4]], "last_factors": [[16, 196, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 948.4275318113725/18709.425497966746
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 5: 18709.425497966746/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 4787.3653229635365/4787.3653229635365
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 6: 4787.3653229635365/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[6, 1, 4], [1, 3, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 1382.6178743376256/3041.723878121404
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 7: 3041.723878121404/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 3], [3, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4193.489231819809/4193.489231819809
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 8: 4193.489231819809/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[2, 1, 1, 2], [[4, 1, 1, 1], [0, 0, 0]], [[16, 4, 2, 1], [0, 0, 1]], [[1, 14, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[4, 1, 6], [-1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[28672, 7, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/6695.159681432256
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 9: 6695.159681432256/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 8041.72122012158/8041.72122012158
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 10: 8041.72122012158/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[24, 1, 3]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/797.9961041032201
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 11: 797.9961041032201/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[7, 7, 2, 1], [[2, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[4, 2, 3], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[1568, 32, 8], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 874.4669929019514/874.4669929019514
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 12: 874.4669929019514/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 2, 7], [[2, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[12, 3, 2], [1, -1]]], "last_factors": [[[8, 6272, 8], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 4583.502882733829/4583.502882733829
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 13: 4583.502882733829/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1376.12148690868/7091.036074450569
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 14: 7091.036074450569/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 6705.141797521837/15740.468346399526
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 15: 15740.468346399526/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [4, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[98, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1373.7410784904182/3647.27887536679
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 16: 3647.27887536679/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 14], [2, 1, 1, 2]], "reduce_factors": [[3, 1, 8], [3, 1, 1]], "last_factors": [[2, 224, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 120.7769393545979/6205.294458020124
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 17: 6205.294458020124/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[36, 1, 2]], "last_factors": [[98, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 8089.459040109095/10290.212221797356
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 18: 10290.212221797356/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 1051.6423154156807/1797.15030374209
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 19: 1797.15030374209/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 1, 1], [0, 0, 0]], [[7, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 1, 4], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[32, 392, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1636.3533964858389
Best record value:18709.425497966746 (larger is better)
Round 1, Match 1, Mapping 20: 1636.3533964858389/18709.425497966746(0.05344899554017174 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 49], [2, 1, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 13 schedules
mapping (0,0,0,0,0,1,1): explored 22 schedules
mapping (0,0,0,0,1,1,0): explored 19 schedules
mapping (0,0,0,0,1,1,1): explored 18 schedules
mapping (0,0,0,1,0,0,0): explored 26 schedules
mapping (0,0,0,1,0,0,1): explored 16 schedules
mapping (0,0,0,1,0,1,0): explored 20 schedules
mapping (0,0,0,1,1,0,0): explored 23 schedules
mapping (0,0,1,0,0,1,0): explored 14 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,1): explored 29 schedules
mapping (0,0,1,1,0,0,0): explored 11 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,1,0,0,0): explored 11 schedules
mapping (0,1,0,1,0,0,1): explored 20 schedules
mapping (0,1,0,1,1,0,0): explored 15 schedules
mapping (1,0,0,0,0,1,0): explored 12 schedules
mapping (1,0,0,1,0,0,0): explored 18 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Original weights [0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659]
Original trials for each mapping [4, 4, 4, 4, 24, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 3156.513661350151/3254.4458905557176
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 1: 3254.4458905557176/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 3511.411494456352/5114.969535208765
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 2: 5114.969535208765/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 818.3111906408465/1551.5705935288172
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 3: 1551.5705935288172/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 12864.601026325301/12864.601026325301
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 4: 12864.601026325301/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[6, 6, 2]], "last_factors": [[1568, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/18709.425497966746
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 5: 18709.425497966746/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 11275.675299207296/11275.675299207296
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 6: 11275.675299207296/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[8, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 15676.638784790579/15676.638784790579
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 7: 15676.638784790579/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 1116.9739767462843/4193.489231819809
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 8: 4193.489231819809/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[2, 1, 1, 2], [[4, 1, 1, 1], [0, 0, 0]], [[16, 4, 2, 1], [0, 0, 1]], [[1, 14, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[4, 1, 6], [-1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[28672, 7, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 1589.4915016608434/6695.159681432256
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 9: 6695.159681432256/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/8041.72122012158
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 10: 8041.72122012158/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[24, 1, 3]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 1183.8966188912134/1183.8966188912134
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 11: 1183.8966188912134/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[14, 1, 1, 7], [[1, 2, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[12, 2, 1], [0, 0]], [[1, 3, 1], [0, 1]]], "last_factors": [[[14, 7168, 4], [1, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 709.9858443022362/874.4669929019514
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 12: 874.4669929019514/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 2, 7], [[2, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[12, 3, 2], [1, -1]]], "last_factors": [[[8, 6272, 8], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2653.148602829743/4583.502882733829
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 13: 4583.502882733829/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1137.770882526302/7091.036074450569
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 14: 7091.036074450569/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 1657.5811971366625/15740.468346399526
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 15: 15740.468346399526/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [4, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[98, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 526.6516906165763/3647.27887536679
Best record value:18709.425497966746 (larger is better)
Round 2, Match 1, Mapping 16: 3647.27887536679/18709.425497966746(0.05344899554017174 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 14], [2, 1, 1, 2]], "reduce_factors": [[3, 1, 8], [3, 1, 1]], "last_factors": [[2, 224, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 20696.21415000286/20696.21415000286
Best record value:20696.21415000286 (larger is better)
Round 2, Match 1, Mapping 17: 20696.21415000286/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[18, 1, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/10290.212221797356
Best record value:20696.21415000286 (larger is better)
Round 2, Match 1, Mapping 18: 10290.212221797356/20696.21415000286(0.04831801568886752 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*T*Y
iteration=1: 980.6375572453384/1797.15030374209
Best record value:20696.21415000286 (larger is better)
Round 2, Match 1, Mapping 19: 1797.15030374209/20696.21415000286(0.04831801568886752 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 1, 1], [0, 0, 0]], [[7, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 1, 4], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[32, 392, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 5188.540368203689/5188.540368203689
Best record value:20696.21415000286 (larger is better)
Round 2, Match 1, Mapping 20: 5188.540368203689/20696.21415000286(0.04831801568886752 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 2, 7], [1, 1, 1, 4]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[14, 32, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.1576640462228908, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.10781094026426008, 0.06028072975092513, 0.03966142845658374, 0.03966142845658374]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 14 schedules
mapping (0,0,0,0,0,1,1): explored 23 schedules
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 19 schedules
mapping (0,0,0,1,0,0,0): explored 26 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 16 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 18 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 14 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 13 schedules
mapping (0,1,0,1,0,0,1): explored 22 schedules
mapping (0,1,0,1,1,0,0): explored 18 schedules
mapping (1,0,0,0,0,1,0): explored 12 schedules
mapping (1,0,0,1,0,0,0): explored 19 schedules
mapping (1,0,0,1,0,1,0): explored 22 schedules
Tensorize use time 1345.8110799789429 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[128, 512, 1, 1],body:R[1, 128, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [128, 512, 1, 1] [1, 128, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph42/at:resnet50:subgraph42:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/2706.342934938586
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 1: 2706.342934938586/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 2, 1, 1], [1, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[1, 64, 2, 1], [0, -1, 1]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 32], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 1395.5065081180421/5236.282809581586
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 2: 5236.282809581586/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 4707.158414063841/14401.294250511062
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 3: 14401.294250511062/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 24573.766450060364/24573.766450060364
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 4: 24573.766450060364/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[28, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 8966.444465892599/8966.444465892599
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 5: 8966.444465892599/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 1, 1], [1, 1, 1, 4], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 6678.160593183798/23720.70037360382
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 6: 23720.70037360382/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 7893.526633253677/10208.421705775663
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 7: 10208.421705775663/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 10168.658971658018/15920.155851199206
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 8: 15920.155851199206/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11388.366683209535/30132.91146992123
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 9: 30132.91146992123/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 1, 4, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 3444.696526742785/5553.867184820142
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 10: 5553.867184820142/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[4, 1, 8]], "last_factors": [[2, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 1940.5969561630818/14128.727200863004
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 11: 14128.727200863004/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 2967.73422213533/18052.205921128745
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 12: 18052.205921128745/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 11360.90929295599/30610.955266009743
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 13: 30610.955266009743/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 3015.6041918977994/37834.748423347526
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 14: 37834.748423347526/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 11562.185196997125/18294.62417580691
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 15: 18294.62417580691/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 5783.9881659602115/5783.9881659602115
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 16: 5783.9881659602115/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [2, 1, 1, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[1, 3136, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 11726.43872637217/18445.314514671096
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 17: 18445.314514671096/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [7, 2, 1, 2]], "reduce_factors": [[4, 2, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 28999.98516352151/44226.35255363897
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 18: 44226.35255363897/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/22042.82291325643
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 19: 22042.82291325643/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 17273.101672926856/17273.101672926856
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 20: 17273.101672926856/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 2, 1]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 29 schedules
mapping (0,0,0,0,1,1,0): explored 28 schedules
mapping (0,0,0,0,1,1,1): explored 18 schedules
mapping (0,0,0,1,0,0,0): explored 17 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 30 schedules
mapping (0,0,1,0,0,1,0): explored 23 schedules
mapping (0,0,1,0,0,1,1): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 31 schedules
mapping (0,0,1,1,0,0,0): explored 30 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 27 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 31 schedules
Original weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 37, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2706.342934938586
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 1: 2706.342934938586/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 2, 1, 1], [1, 0, -1]], [[1, 2, 2, 1], [0, 1, 1]], [[1, 64, 2, 1], [0, -1, 1]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 64, 32], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 14426.643534925734/14426.643534925734
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 2: 14426.643534925734/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [1, 1, 4, 1], [1, 1, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 2790.345462558726/14401.294250511062
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 3: 14401.294250511062/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 25437.06487850397/25437.06487850397
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 4: 25437.06487850397/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 7947.987066322911/8966.444465892599
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 5: 8966.444465892599/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 1, 1], [1, 1, 1, 4], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 5291.942151995744/23720.70037360382
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 6: 23720.70037360382/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.E
*E*Y
iteration=1: 2078.4228553257676/10208.421705775663
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 7: 10208.421705775663/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 2158.9863990653666/15920.155851199206
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 8: 15920.155851199206/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 1307.937322000542/30132.91146992123
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 9: 30132.91146992123/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 1, 4, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 37066.19633169733/37066.19633169733
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 10: 37066.19633169733/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [7, 2, 2, 1]], "reduce_factors": [[2, 1, 16]], "last_factors": [[392, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 11920.513304284366/14128.727200863004
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 11: 14128.727200863004/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*Y*E*Y
iteration=1: 1330.6588847976857/18052.205921128745
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 12: 18052.205921128745/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 30347.536690555997/30610.955266009743
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 13: 30610.955266009743/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 2948.878096152795/37834.748423347526
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 14: 37834.748423347526/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 11375.952665640001/18294.62417580691
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 15: 18294.62417580691/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 19968.894483783984/19968.894483783984
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 16: 19968.894483783984/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 14], [2, 1, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 26081.150480228338/26081.150480228338
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 17: 26081.150480228338/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 4]], "last_factors": [[49, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 17939.957412273237/44226.35255363897
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 18: 44226.35255363897/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 5187.008884012663/22042.82291325643
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 19: 22042.82291325643/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 5404.674141115708/17273.101672926856
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 20: 17273.101672926856/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 2, 1]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 23 schedules
mapping (0,0,0,0,0,1,1): explored 32 schedules
mapping (0,0,0,0,1,1,0): explored 29 schedules
mapping (0,0,0,0,1,1,1): explored 22 schedules
mapping (0,0,0,1,0,0,0): explored 19 schedules
mapping (0,0,0,1,0,0,1): explored 34 schedules
mapping (0,0,0,1,0,1,0): explored 24 schedules
mapping (0,0,0,1,1,0,0): explored 31 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 26 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 34 schedules
mapping (0,1,0,0,0,1,0): explored 22 schedules
mapping (0,1,0,1,0,0,0): explored 29 schedules
mapping (0,1,0,1,0,0,1): explored 35 schedules
mapping (0,1,0,1,1,0,0): explored 28 schedules
mapping (1,0,0,0,0,1,0): explored 33 schedules
mapping (1,0,0,1,0,0,0): explored 27 schedules
mapping (1,0,0,1,0,1,0): explored 32 schedules
Tensorize use time 592.8611855506897 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [512] [512] [1, 512, 28, 28] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph51.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006021955009590295
.N.N.N.N.N.N.Y.E.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B

Currently best performance: 0.005929935431277284
.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.005929935431277284
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.B.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.0055949385672276405
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0055949385672276405
.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0055949385672276405
.B.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.Y.E.Y.Y.Y.Y.E.Y.E.Y.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.Y.Y.Y.Y.Y.T.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
Schedule cost 982.841115 seconds
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[512, 256, 1, 1],body:R[1, 512, 28, 28] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [512, 256, 1, 1] [1, 512, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph52/at:resnet50:subgraph52:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 14692.306425323837/14808.756410973985
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 1: 14808.756410973985/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 4], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 2412.7154902100515/10538.157480840096
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 2: 10538.157480840096/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 4, 1], [[8, 1, 1, 2], [0, 0, -1]], [[16, 8, 1, 1], [1, -1, 0]], [[1, 7, 1, 4], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 128, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 13546.806141089572/15165.99924217716
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 3: 15165.99924217716/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[28, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1692.5820495434873/27250.32972353314
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 4: 27250.32972353314/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 3704.5990505028553/4542.67604658837
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 5: 4542.67604658837/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [8, 2, 1, 1], [1, 1, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 6105.999276210142/11904.320927118997
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 6: 11904.320927118997/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*Y
iteration=1: 12235.05326271145/12446.251756298905
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 7: 12446.251756298905/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, -1]], [2, 4, 2, 1], [[128, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 4, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 1941.763629113428/5696.486801712849
Best record value:28756.265656913532 (larger is better)
Round 1, Match 1, Mapping 8: 5696.486801712849/28756.265656913532(0.03477502996845426 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [4, 4, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[49, 16, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 34256.15614496689/34256.15614496689
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 9: 34256.15614496689/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [14, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1098.0744298566965/20732.404143420124
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 10: 20732.404143420124/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*Y
iteration=1: 1449.451972678087/25549.689216206054
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 11: 25549.689216206054/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [2, 1, 4, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[56, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 32238.100533406825/32238.100533406825
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 12: 32238.100533406825/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[448, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 25994.858065912853/25994.858065912853
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 13: 25994.858065912853/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 18589.33446709031/18589.33446709031
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 14: 18589.33446709031/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 6960.850628112788/21086.8508898989
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 15: 21086.8508898989/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 49.49278139617028/2539.8788630175072
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 16: 2539.8788630175072/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 1, 1, 1], [2, 4, 2, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[8, 1568, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 3151.981308750839/20478.509400152692
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 17: 20478.509400152692/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 1, 1, 4], [7, 1, 4, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 3174.5411149913566/12409.74095891379
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 18: 12409.74095891379/34256.15614496689(0.0291918333092642 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 6514.2200814676735/28756.265656913532
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 19: 28756.265656913532/34256.15614496689(0.0291918333092642 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 9231.801874878638/20079.41100029786
Best record value:34256.15614496689 (larger is better)
Round 1, Match 1, Mapping 20: 20079.41100029786/34256.15614496689(0.0291918333092642 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [2, 2, 4, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.1605272962879045, 0.04051845180322717]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 24 schedules
mapping (0,0,0,0,0,1,1): explored 30 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 40 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 18 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 27 schedules
mapping (0,0,1,0,1,1,0): explored 33 schedules
mapping (0,0,1,0,1,1,1): explored 21 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 22 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 27 schedules
mapping (0,1,0,1,1,0,0): explored 23 schedules
mapping (1,0,0,0,0,1,0): explored 34 schedules
mapping (1,0,0,1,0,0,0): explored 27 schedules
mapping (1,0,0,1,0,1,0): explored 29 schedules
Original weights [0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.11014057125400606, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.04051845180322717, 0.1605272962879045, 0.04051845180322717]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 17, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3603.843585980682/14808.756410973985
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 1: 14808.756410973985/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 4], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 30296.739799722767/30296.739799722767
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 2: 30296.739799722767/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [8, 1, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[196, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 8339.174036778491/15165.99924217716
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 3: 15165.99924217716/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[28, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1810.0886805965881/27250.32972353314
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 4: 27250.32972353314/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 10977.675441929608/10977.675441929608
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 5: 10977.675441929608/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [16, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 7859.502052274907/11904.320927118997
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 6: 11904.320927118997/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 10256.46440325668/12446.251756298905
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 7: 12446.251756298905/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, -1]], [2, 4, 2, 1], [[128, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 4, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 31392.028408144077/31392.028408144077
Best record value:34256.15614496689 (larger is better)
Round 2, Match 1, Mapping 8: 31392.028408144077/34256.15614496689(0.0291918333092642 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 37497.35297133777/37497.35297133777
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 9: 37497.35297133777/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [14, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1183.3958527492543/20732.404143420124
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 10: 20732.404143420124/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 544.3971123646782/25549.689216206054
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 11: 25549.689216206054/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [2, 1, 4, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[56, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 16008.880179673026/32238.100533406825
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 12: 32238.100533406825/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[448, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 5089.360559323495/25994.858065912853
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 13: 25994.858065912853/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 5339.266771261038/18589.33446709031
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 14: 18589.33446709031/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 628.8353333781813/21086.8508898989
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 15: 21086.8508898989/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 1166.9226783126192/2539.8788630175072
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 16: 2539.8788630175072/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 1, 1, 1], [2, 4, 2, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[8, 1568, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 2157.511509189159/20478.509400152692
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 17: 20478.509400152692/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 1, 1, 4], [7, 1, 4, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 6062.836116273347/12409.74095891379
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 18: 12409.74095891379/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 9176.359496701902/28756.265656913532
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 19: 28756.265656913532/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 678.3170316825946/20079.41100029786
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 20: 20079.41100029786/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [2, 2, 4, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.0962134919829326, 0.03758003144763057]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 31 schedules
mapping (0,0,0,0,1,1,0): explored 28 schedules
mapping (0,0,0,0,1,1,1): explored 29 schedules
mapping (0,0,0,1,0,0,0): explored 42 schedules
mapping (0,0,0,1,0,0,1): explored 33 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 31 schedules
mapping (0,0,1,0,0,1,1): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 35 schedules
mapping (0,0,1,0,1,1,1): explored 23 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 24 schedules
mapping (0,1,0,1,0,0,0): explored 33 schedules
mapping (0,1,0,1,0,0,1): explored 28 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 36 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 30 schedules
Tensorize use time 684.6013052463531 s.
#############################################
operations:inputs:[1, 128, 56, 56],[128],[128],body:S[1, 128, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 56, 56],body:S[1, 128, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 56, 56],body:S[1, 128, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 58, 58],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 56, 56] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph54/at:resnet50:subgraph54:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751, 0.03992072149600751]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 6545.046368286292/6545.046368286292
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 1: 6545.046368286292/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[1, 4, 1, 1], [0, 0, 0]], [[1, 1, 1, 4], [-1, -1, 0]], [[2, 64, 1, 1], [1, -1, 0]], [[7, 1, 2, 2], [0, 0, 0]]], "reduce_factors": [[[1, 2, 4], [0, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 7, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 796.0885002508832/984.4346866773463
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 2: 984.4346866773463/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [1, 2, 1, 2], [1, 1, 1, 1], [1, 4, 1, 7]], "reduce_factors": [[6, 1, 4], [3, 1, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1383.5279485651172
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 3: 1383.5279485651172/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 378.99646466033823/3022.2368787585197
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 4: 3022.2368787585197/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[49, 2, 1, 1], [-1, 1, 0]], [[2, 1, 1, 2], [0, 0, -1]], [[8, 8, 1, 2], [1, 0, -1]]], "reduce_factors": [[[36, 1, 2], [1, 0]]], "last_factors": [[[256, 784, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 1807.2360704695961/3361.5806347518524
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 5: 3361.5806347518524/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 4291.6985081798/5021.392471767626
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 6: 5021.392471767626/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 6900.045740401974/6900.045740401974
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 7: 6900.045740401974/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[14, 1, 1, 7], [0, 0, 0]], [[1, 2, 2, 1], [-1, 1, 0]], [[1, 64, 2, 1], [-1, 1, 0]]], "reduce_factors": [[[4, 1, 2], [1, 0]], [[1, 3, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3136, 32, 4], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2101.901109756588/3670.7454211904846
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 8: 3670.7454211904846/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[2, 6, 2], [3, 1, 1]], "last_factors": [[4, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 545.8993629386546/1392.39751174463
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 9: 1392.39751174463/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 7, 1, 4]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/397.8012055504764
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 10: 397.8012055504764/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[64, 1, 1, 7], [1, 0, 0]], [[1, 1, 2, 2], [0, -1, 1]], [[1, 7, 2, 2], [0, 0, 1]]], "reduce_factors": [[[18, 2, 2], [0, 0]]], "last_factors": [[[3584, 56, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/415.5546323924342
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 11: 415.5546323924342/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[224, 14, 1, 4], [0, 0, 0]], [[1, 4, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[6, 1, 4], [0, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[25088, 8, 2], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 305.5453267043177/2411.3107152370035
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 12: 2411.3107152370035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[9, 8, 1]], "last_factors": [[8, 392, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2215.599991146398/4110.955418912157
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 13: 4110.955418912157/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 2, 1, 14]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[196, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 1107.9656020999173/2636.4584391461667
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 14: 2636.4584391461667/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 2, 1], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 970.8839824545441/3005.12749674423
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 15: 3005.12749674423/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [1, 1, 4, 1], [7, 2, 1, 2]], "reduce_factors": [[12, 2, 1], [1, 1, 3]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 100.93945613568685/1875.91044028376
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 16: 1875.91044028376/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 559.8811749795301/1442.4543445897102
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 17: 1442.4543445897102/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [1, 2, 1, 2], [2, 2, 1, 7]], "reduce_factors": [[24, 1, 3]], "last_factors": [[2, 98, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 2831.206582667274/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 12912.867797767763/12912.867797767763
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 19: 12912.867797767763/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 10 schedules
mapping (0,0,0,0,1,1,0): explored 41 schedules
mapping (0,0,0,0,1,1,1): explored 26 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,0,1,1,0,0): explored 23 schedules
mapping (0,0,1,0,0,1,0): explored 15 schedules
mapping (0,0,1,0,0,1,1): explored 10 schedules
mapping (0,0,1,0,1,1,0): explored 23 schedules
mapping (0,0,1,0,1,1,1): explored 25 schedules
mapping (0,0,1,1,0,0,0): explored 18 schedules
mapping (0,1,0,0,0,1,0): explored 19 schedules
mapping (0,1,0,1,0,0,0): explored 22 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 22 schedules
mapping (1,0,0,0,0,1,0): explored 25 schedules
mapping (1,0,0,1,0,0,0): explored 19 schedules
mapping (1,0,0,1,0,1,0): explored 15 schedules
Original weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 37, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*E*E
iteration=1: 1e-10/6545.046368286292
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 1: 6545.046368286292/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[1, 4, 1, 1], [0, 0, 0]], [[1, 1, 1, 4], [-1, -1, 0]], [[2, 64, 1, 1], [1, -1, 0]], [[7, 1, 2, 2], [0, 0, 0]]], "reduce_factors": [[[1, 2, 4], [0, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 7, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3227.1956924719566/3227.1956924719566
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 2: 3227.1956924719566/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[28, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1113.8607629491883/1383.5279485651172
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 3: 1383.5279485651172/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 2226.9177635543933/3022.2368787585197
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 4: 3022.2368787585197/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[49, 2, 1, 1], [-1, 1, 0]], [[2, 1, 1, 2], [0, 0, -1]], [[8, 8, 1, 2], [1, 0, -1]]], "reduce_factors": [[[36, 1, 2], [1, 0]]], "last_factors": [[[256, 784, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/3361.5806347518524
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 5: 3361.5806347518524/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 926.2204722414888/5021.392471767626
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 6: 5021.392471767626/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 16091.638917716718/16091.638917716718
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 7: 16091.638917716718/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/3670.7454211904846
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 8: 3670.7454211904846/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[2, 6, 2], [3, 1, 1]], "last_factors": [[4, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 4294.620319983427/4294.620319983427
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 9: 4294.620319983427/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[2, 1, 2, 1], [[2, 1, 2, 1], [-1, 0, 1]], [[7, 2, 2, 1], [0, -1, 1]]], "reduce_factors": [[[4, 2, 3], [-1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[4, 12544, 8], [0, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 2607.358965154263/2607.358965154263
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 10: 2607.358965154263/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [1, 1, 2, 2], [2, 7, 1, 2]], "reduce_factors": [[12, 2, 3]], "last_factors": [[32, 98, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 9261.296800165035/9261.296800165035
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 11: 9261.296800165035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [4, 1, 1, 1]], "reduce_factors": [[2, 4, 3], [3, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 847.2328509870197/2411.3107152370035
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 12: 2411.3107152370035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[9, 8, 1]], "last_factors": [[8, 392, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4521.522362346432/4521.522362346432
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 13: 4521.522362346432/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [1, 2, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[64, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 1007.6137381061284/2636.4584391461667
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 14: 2636.4584391461667/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 2, 1], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 4215.9753120017185/4215.9753120017185
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 15: 4215.9753120017185/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[3, 8, 1], [3, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1875.91044028376
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 16: 1875.91044028376/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 2503.0218814309055/2503.0218814309055
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 17: 2503.0218814309055/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[28, 4, 4, 1], [0, 1, 1]], [[2, 2, 1, 1], [1, 0, 0]], [[14, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[18, 2, 2], [0, 0]]], "last_factors": [[[16, 3136, 8], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 2259.4432144464367/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 3194.6713426705255/12912.867797767763
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 19: 12912.867797767763/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 6255.598873822614/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 14 schedules
mapping (0,0,0,0,1,1,0): explored 46 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 23 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 12 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 28 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 23 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 26 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Tensorize use time 881.2618424892426 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[128, 256, 1, 1],body:R[1, 128, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [128, 256, 1, 1] [1, 128, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph55/at:resnet50:subgraph55:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.0435847160516013, 0.09699956942956131, 0.1184755416416151, 0.0435847160516013]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 10, 12, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 9138.34166773649/19903.947737077124
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 1: 19903.947737077124/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 22413.04377473115/22413.04377473115
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 2: 22413.04377473115/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[49, 8, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 19346.21668405621/19346.21668405621
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 3: 19346.21668405621/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[14, 14, 2, 1], [4, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[896, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 1766.997758326108/20919.575408866498
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 4: 20919.575408866498/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 1, 1, 1], [0, 0, 0]], [[1, 2, 2, 1], [-1, 0, 1]], [[1, 64, 2, 1], [0, 0, 0]]], "reduce_factors": [[[1, 1, 16], [0, -1]]], "last_factors": [[[7168, 14, 16], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 4049.3249613316466/4049.3249613316466
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 5: 4049.3249613316466/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [2, 4, 7, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 8460.276573385996/8460.276573385996
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 6: 8460.276573385996/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[98, 2, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 16151.415695502232/16151.415695502232
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 7: 16151.415695502232/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 4, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 13459.39381449475/13459.39381449475
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 8: 13459.39381449475/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*E*Y
iteration=1: 6552.185087796733/15336.34068216761
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 9: 15336.34068216761/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 17520.69916453619/17520.69916453619
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 10: 17520.69916453619/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 1, 1, 14]], "reduce_factors": [[8, 1, 2]], "last_factors": [[56, 32, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 14607.619897400902/14607.619897400902
Best record value:24698.83842594094 (larger is better)
Round 1, Match 1, Mapping 11: 14607.619897400902/24698.83842594094(0.0404877339879154 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 29126.09114784877/29126.09114784877
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 12: 29126.09114784877/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [2, 1, 2, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 2926.8298437243134/2928.115587788554
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 13: 2928.115587788554/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[16, 7, 4, 2], [-1, 1, 0]], [[2, 2, 1, 1], [0, 1, 0]], [[1, 8, 1, 7], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 56, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 2541.009997095032/7165.670948116855
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 14: 7165.670948116855/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[16, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 9203.524343348488/13835.913333116614
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 15: 13835.913333116614/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 2, 14, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[98, 16, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 11059.157791143933/11059.157791143933
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 16: 11059.157791143933/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[196, 2, 1, 1], [2, 2, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 4007.2973784655283/7681.553992397589
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 17: 7681.553992397589/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 4], [4, 2, 1, 7]], "reduce_factors": [[4, 2, 2]], "last_factors": [[896, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 6621.240792414557/23397.430823519346
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 18: 23397.430823519346/29126.09114784877(0.03433347766865926 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 1126.9815557838904/24698.83842594094
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 19: 24698.83842594094/29126.09114784877(0.03433347766865926 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 6645.535586829463/6645.535586829463
Best record value:29126.09114784877 (larger is better)
Round 1, Match 1, Mapping 20: 6645.535586829463/29126.09114784877(0.03433347766865926 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 7, 1, 4], [2, 2, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 112, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
New weights [0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.11457946109916489, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.07503653240678768, 0.0938097284729886, 0.042151428118885795]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 35 schedules
mapping (0,0,0,0,0,1,1): explored 20 schedules
mapping (0,0,0,0,1,1,0): explored 35 schedules
mapping (0,0,0,0,1,1,1): explored 26 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 43 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 19 schedules
mapping (0,0,1,0,1,1,0): explored 40 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 36 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 29 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (0,1,0,1,1,0,0): explored 18 schedules
mapping (1,0,0,0,0,1,0): explored 27 schedules
mapping (1,0,0,1,0,0,0): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 38 schedules
Original weights [0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.11457946109916489, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.042151428118885795, 0.07503653240678768, 0.0938097284729886, 0.042151428118885795]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 12, 5, 5, 5, 5, 5, 8, 10, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*Y*E*Y
iteration=1: 8345.3425992041/19903.947737077124
Best record value:29126.09114784877 (larger is better)
Round 2, Match 1, Mapping 1: 19903.947737077124/29126.09114784877(0.03433347766865926 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 29577.030565626723/29577.030565626723
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 2: 29577.030565626723/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[196, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 21135.128988535304/21135.128988535304
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 3: 21135.128988535304/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 4, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[224, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 3191.999119008243/20919.575408866498
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 4: 20919.575408866498/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[[392, 1, 1, 1], [0, 0, 0]], [[1, 2, 2, 1], [-1, 0, 1]], [[1, 64, 2, 1], [0, 0, 0]]], "reduce_factors": [[[1, 1, 16], [0, -1]]], "last_factors": [[[7168, 14, 16], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 12798.247402744511/12798.247402744511
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 5: 12798.247402744511/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 2], [1, 1, 1, 1], [1, 8, 7, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 2645.354025709754/8460.276573385996
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 6: 8460.276573385996/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[98, 2, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/16151.415695502232
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 7: 16151.415695502232/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 4, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7827.924651542321/13459.39381449475
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 8: 13459.39381449475/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 3140.8945098281124/15336.34068216761
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 9: 15336.34068216761/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 21365.35590078082/21365.35590078082
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 10: 21365.35590078082/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 2, 7, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 5426.153635134647/14607.619897400902
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 11: 14607.619897400902/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 10144.478175229524/29126.09114784877
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 12: 29126.09114784877/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [2, 1, 2, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 5073.633407938291/5073.633407938291
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 13: 5073.633407938291/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 2], [7, 2, 2, 2]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[1792, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 5779.95096517536/7165.670948116855
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 14: 7165.670948116855/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [2, 14, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[16, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 10387.408767700637/13835.913333116614
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 15: 13835.913333116614/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 2, 14, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[98, 16, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 11521.582180068463/11521.582180068463
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 16: 11521.582180068463/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 7, 7], [1, 2, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[64, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 15714.479580726029/15714.479580726029
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 17: 15714.479580726029/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 4]], "last_factors": [[896, 2, 7]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 1852.5885154491793/23397.430823519346
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 18: 23397.430823519346/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/24698.83842594094
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 19: 24698.83842594094/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.E.Y.Y
*Y*Y
iteration=1: 25530.069945293042/25530.069945293042
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 20: 25530.069945293042/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 7, 2, 1], [1, 1, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.0412372831838123, 0.11209455753357675, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.09177526150540846, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.06267584451696966, 0.07365780550304805, 0.0412372831838123]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 37 schedules
mapping (0,0,0,0,0,1,1): explored 22 schedules
mapping (0,0,0,0,1,1,0): explored 38 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,0): explored 26 schedules
mapping (0,0,0,1,0,0,1): explored 47 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 27 schedules
mapping (0,0,1,0,0,1,1): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 43 schedules
mapping (0,0,1,0,1,1,1): explored 29 schedules
mapping (0,0,1,1,0,0,0): explored 38 schedules
mapping (0,1,0,0,0,1,0): explored 22 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 34 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 40 schedules
Tensorize use time 605.8862698078156 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [1, 256, 56, 56] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph56.log by 200 trials...
.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.009760621093950605
.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N

Currently best performance: 0.009479058132278308
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.009479058132278308
.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.008486938868384296
.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.E.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.Y.Y.Y.E.E.Y.Y.Y.Y.E.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
Schedule cost 820.292454 seconds
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph57/at:resnet50:subgraph57:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 25]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*Y
iteration=1: 9355.225723974516/30255.87926791854
Best record value:36336.97839989095 (larger is better)
Round 1, Match 1, Mapping 1: 30255.87926791854/36336.97839989095(0.027520174875162465 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 36747.50101187343/36747.50101187343
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 2: 36747.50101187343/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [4, 1, 2, 1], [[1, 16, 1, 8], [-1, 1, 0]], [[7, 1, 2, 4], [0, -1, 1]]], "reduce_factors": [[[2, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 32, 8], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*E
iteration=1: 27214.129461835266/27214.129461835266
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 3: 27214.129461835266/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 4], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 64, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 23403.043270871043/28800.016425155183
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 4: 28800.016425155183/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 14, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[6272, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 17415.06535753562/17415.06535753562
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 5: 17415.06535753562/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 2], [1, 1, 1, 1], [1, 7, 2, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1792, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 6593.154425340339/18592.999013958422
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 6: 18592.999013958422/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 7, 2, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[14, 224, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 8285.625303066547/31422.562786164624
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 7: 31422.562786164624/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[56, 1, 1, 7], [1, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 2373.0079760368744/28454.542706159056
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 8: 28454.542706159056/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[392, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 24821.029178840075/33795.787029443105
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 9: 33795.787029443105/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 27277.581803222358/27277.581803222358
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 10: 27277.581803222358/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 2], [14, 1, 2, 2]], "reduce_factors": [[1, 1, 4]], "last_factors": [[392, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 9964.226151709092/20586.935591413083
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 11: 20586.935591413083/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 2, 28], [2, 1, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 5080.840966251775/5080.840966251775
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 12: 5080.840966251775/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 196, 1, 1], [4, 1, 2, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[14, 256, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 13002.635228361814/18177.067684373378
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 13: 18177.067684373378/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 112, 1, 8], [0, -1, 0]], [8, 1, 1, 1], [[7, 2, 1, 4], [0, -1, 0]]], "reduce_factors": [[[1, 4, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 32, 2], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 25304.889471325296/25304.889471325296
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 14: 25304.889471325296/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 2, 2], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1378.2120379022365/13960.26263961901
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 15: 13960.26263961901/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 2], [1, 4, 14, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1792, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 17961.864388495735/19213.203344033594
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 16: 19213.203344033594/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 2, 7], [2, 4, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[98, 32, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 22707.629729285232/23549.57928705717
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 17: 23549.57928705717/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [8, 1, 7, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[224, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 30572.78822235311/30572.78822235311
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 18: 30572.78822235311/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 4], [2, 1, 4, 7]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 18436.645882982677/18436.645882982677
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 19: 18436.645882982677/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 2, 1, 2], [7, 2, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[12544, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6856.8511429864475/36336.97839989095
Best record value:36747.50101187343 (larger is better)
Round 1, Match 1, Mapping 20: 36336.97839989095/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 2, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04051845180322716, 0.11014057125400604, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.16052729628790446]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 31 schedules
mapping (0,0,0,0,0,1,1): explored 30 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 47 schedules
mapping (0,0,0,1,0,0,0): explored 34 schedules
mapping (0,0,0,1,0,0,1): explored 39 schedules
mapping (0,0,0,1,0,1,0): explored 32 schedules
mapping (0,0,0,1,1,0,0): explored 34 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 41 schedules
mapping (0,0,1,0,1,1,1): explored 35 schedules
mapping (0,0,1,1,0,0,0): explored 44 schedules
mapping (0,1,0,0,0,1,0): explored 45 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 42 schedules
mapping (0,1,0,1,1,0,0): explored 43 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 37 schedules
mapping (1,0,0,1,0,1,0): explored 37 schedules
Original weights [0.04051845180322716, 0.11014057125400604, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.16052729628790446]
Original trials for each mapping [5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 17]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 27317.945054844524/30255.87926791854
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 1: 30255.87926791854/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 29114.119676960454/36747.50101187343
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 2: 36747.50101187343/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [4, 1, 2, 1], [[1, 16, 1, 8], [-1, 1, 0]], [[7, 1, 2, 4], [0, -1, 1]]], "reduce_factors": [[[2, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 32, 8], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 28385.707978870938/28385.707978870938
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 3: 28385.707978870938/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 7, 1, 4], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[56, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 1923.4390443902157/28800.016425155183
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 4: 28800.016425155183/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 14, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[6272, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 17848.334885421664/17848.334885421664
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 5: 17848.334885421664/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 32974.98802537182/32974.98802537182
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 6: 32974.98802537182/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 8, 1, 1], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[896, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 2712.247080136602/31422.562786164624
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 7: 31422.562786164624/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[56, 1, 1, 7], [1, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 7306.684354086599/28454.542706159056
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 8: 28454.542706159056/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[392, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 24526.41108912481/33795.787029443105
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 9: 33795.787029443105/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[448, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*Y*Y*Y
iteration=1: 19881.867794637496/27277.581803222358
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 10: 27277.581803222358/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 2], [14, 1, 2, 2]], "reduce_factors": [[1, 1, 4]], "last_factors": [[392, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 14342.92267439208/20586.935591413083
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 11: 20586.935591413083/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 2, 28], [2, 1, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 34674.598054935785/34674.598054935785
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 12: 34674.598054935785/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 2, 2], [2, 1, 2, 2]], "reduce_factors": [[2, 2, 1]], "last_factors": [[224, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 17381.391254387647/18177.067684373378
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 13: 18177.067684373378/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[1, 112, 1, 8], [0, -1, 0]], [8, 1, 1, 1], [[7, 2, 1, 4], [0, -1, 0]]], "reduce_factors": [[[1, 4, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 32, 2], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 13077.740043667302/25304.889471325296
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 14: 25304.889471325296/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 2, 2], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 22915.739249565282/22915.739249565282
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 15: 22915.739249565282/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [2, 7, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 8, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 26923.50718363046/26923.50718363046
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 16: 26923.50718363046/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 2, 7], [2, 4, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 27976.024986401124/27976.024986401124
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 17: 27976.024986401124/36747.50101187343(0.027212734810916572 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [2, 2, 14, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[1568, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 4112.834585554617/30572.78822235311
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 18: 30572.78822235311/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 4], [2, 1, 4, 7]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 2850.898589540714/18436.645882982677
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 19: 18436.645882982677/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 2, 1, 2], [7, 2, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[12544, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 23611.837295325335/36336.97839989095
Best record value:36747.50101187343 (larger is better)
Round 2, Match 1, Mapping 20: 36336.97839989095/36747.50101187343(0.027212734810916572 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 2, 1], [2, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.037580031447630564, 0.22734594195971708, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.0962134919829326]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 35 schedules
mapping (0,0,0,0,0,1,1): explored 33 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 51 schedules
mapping (0,0,0,1,0,0,0): explored 35 schedules
mapping (0,0,0,1,0,0,1): explored 42 schedules
mapping (0,0,0,1,0,1,0): explored 33 schedules
mapping (0,0,0,1,1,0,0): explored 38 schedules
mapping (0,0,1,0,0,1,0): explored 29 schedules
mapping (0,0,1,0,0,1,1): explored 36 schedules
mapping (0,0,1,0,1,1,0): explored 44 schedules
mapping (0,0,1,0,1,1,1): explored 39 schedules
mapping (0,0,1,1,0,0,0): explored 47 schedules
mapping (0,1,0,0,0,1,0): explored 46 schedules
mapping (0,1,0,1,0,0,0): explored 38 schedules
mapping (0,1,0,1,0,0,1): explored 46 schedules
mapping (0,1,0,1,1,0,0): explored 47 schedules
mapping (1,0,0,0,0,1,0): explored 31 schedules
mapping (1,0,0,1,0,0,0): explored 39 schedules
mapping (1,0,0,1,0,1,0): explored 41 schedules
Tensorize use time 506.2281963825226 s.
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 58, 58],[64, 64, 3, 3],body:R[1, 64, 56, 56] [64, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [64, 64, 3, 3] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph58/at:resnet50:subgraph58:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 4900.658274665276/14070.838041803818
Best record value:15252.909127210763 (larger is better)
Round 1, Match 1, Mapping 1: 14070.838041803818/15252.909127210763(0.0655612638651356 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.E.Y.Y
*Y*E
iteration=1: 22012.95823582785/22012.95823582785
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 2: 22012.95823582785/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [7, 1, 8, 1]], "reduce_factors": [[4, 3, 1], [1, 1, 3]], "last_factors": [[56, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 1707.0824429580273/2415.1919540583144
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 3: 2415.1919540583144/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[49, 4, 1, 2], [[2, 1, 1, 4], [0, -1, -1]], [[4, 16, 2, 1], [-1, 1, 1]]], "reduce_factors": [[[12, 1, 1], [0, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1024, 784, 1], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4719.894416777804/4719.894416777804
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 4: 4719.894416777804/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 7, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 36, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 549.7706538954116/578.7217089182636
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 5: 578.7217089182636/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[1, 2, 1, 1], [-1, 1, 0]], [1, 1, 1, 2], [[1, 32, 4, 1], [0, 0, 0]], [[1, 56, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[4, 1, 1], [0, 0]], [[1, 1, 3], [0, -1]], [[1, 3, 1], [0, 0]]], "last_factors": [[[128, 3136, 2], [-1, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 12880.669824599538/12880.669824599538
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 6: 12880.669824599538/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[49, 2, 1, 1], [1, -1, 0]], [[4, 1, 1, 2], [1, -1, 0]], [[2, 32, 2, 1], [1, 1, 0]]], "reduce_factors": [[[6, 2, 1], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[8192, 98, 1], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 4695.902836647731/6053.610385410307
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 7: 6053.610385410307/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[49, 1, 8, 1], [[1, 2, 1, 4], [0, 0, 0]], [[8, 1, 2, 8], [1, 0, -1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[3, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[8, 3584, 28], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 685.2216534264079/11286.28306526074
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 8: 11286.28306526074/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 3, 4], [3, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 12193.126740028807/12193.126740028807
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 9: 12193.126740028807/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[3, 4, 1], [3, 1, 1]], "last_factors": [[14, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 14069.262175996875/15252.909127210763
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 10: 15252.909127210763/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[4, 1, 9]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 12401.096567335258/12401.096567335258
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 11: 12401.096567335258/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 1, 4, 1], [1, 1, 2, 1]], "reduce_factors": [[3, 2, 2], [1, 3, 1]], "last_factors": [[32, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 4567.659791563405/4567.659791563405
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 12: 4567.659791563405/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 2, 1, 2], [2, 1, 1, 1]], "reduce_factors": [[9, 4, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4503.875428988878/7375.4926699275065
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 13: 7375.4926699275065/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 14, 4, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 3673.383158153317/3673.383158153317
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 14: 3673.383158153317/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[3, 4, 1], [3, 1, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 3174.5875176940276/3278.7983608287914
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 15: 3278.7983608287914/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 14, 1, 1]], "reduce_factors": [[4, 3, 1], [1, 3, 1]], "last_factors": [[2, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 2984.7858885357055/5597.691138994869
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 16: 5597.691138994869/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[2, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 291.51265779662157/3511.1131349554685
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 17: 3511.1131349554685/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 2, 4, 1], [0, 1, -1]], [[7, 4, 2, 1], [1, -1, 1]]], "reduce_factors": [[[6, 6, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2045.6236745973147/7467.546332990333
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 18: 7467.546332990333/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 4751.430109024365/4751.430109024365
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 19: 4751.430109024365/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[16, 14, 1, 1], [0, 0, 0]], [1, 1, 1, 2], [[7, 4, 2, 1], [0, 0, 1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[28672, 4, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 16302.240373380755/16302.240373380755
Best record value:22012.95823582785 (larger is better)
Round 1, Match 1, Mapping 20: 16302.240373380755/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 8, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[14, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04051845180322716, 0.11014057125400604, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.16052729628790446, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 6 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,0): explored 12 schedules
mapping (0,0,0,1,0,0,1): explored 30 schedules
mapping (0,0,0,1,0,1,0): explored 15 schedules
mapping (0,0,0,1,1,0,0): explored 22 schedules
mapping (0,0,1,0,0,1,0): explored 16 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 16 schedules
mapping (0,0,1,1,0,0,0): explored 20 schedules
mapping (0,1,0,0,0,1,0): explored 14 schedules
mapping (0,1,0,1,0,0,0): explored 13 schedules
mapping (0,1,0,1,0,0,1): explored 16 schedules
mapping (0,1,0,1,1,0,0): explored 21 schedules
mapping (1,0,0,0,0,1,0): explored 12 schedules
mapping (1,0,0,1,0,0,0): explored 12 schedules
mapping (1,0,0,1,0,1,0): explored 16 schedules
Original weights [0.04051845180322716, 0.11014057125400604, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.16052729628790446, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716, 0.04051845180322716]
Original trials for each mapping [5, 12, 5, 5, 5, 5, 5, 5, 5, 17, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 1231.4540742427148/14070.838041803818
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 1: 14070.838041803818/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 385.8017293848013/22012.95823582785
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 2: 22012.95823582785/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [7, 1, 8, 1]], "reduce_factors": [[4, 3, 1], [1, 1, 3]], "last_factors": [[56, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 3014.8249297760713/3014.8249297760713
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 3: 3014.8249297760713/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 14, 7, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 1, 1], [3, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 1681.284334422504/4719.894416777804
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 4: 4719.894416777804/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 7, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 36, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 795.6560060823305/795.6560060823305
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 5: 795.6560060823305/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 3, 1], [1, 3, 1]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 254.08958650494836/12880.669824599538
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 6: 12880.669824599538/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[49, 2, 1, 1], [1, -1, 0]], [[4, 1, 1, 2], [1, -1, 0]], [[2, 32, 2, 1], [1, 1, 0]]], "reduce_factors": [[[6, 2, 1], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[8192, 98, 1], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 6156.255177529018/6156.255177529018
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 7: 6156.255177529018/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[7, 14, 1, 1], [1, -1, 0]], [[1, 2, 2, 2], [-1, 0, 0]], [[2, 32, 1, 2], [1, 1, 0]]], "reduce_factors": [[[1, 4, 1], [0, 0]], [[1, 1, 3], [0, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14336, 7, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 965.861910722624/11286.28306526074
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 8: 11286.28306526074/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 3, 4], [3, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 11690.585534341002/12193.126740028807
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 9: 12193.126740028807/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[3, 4, 1], [3, 1, 1]], "last_factors": [[14, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 21520.329855195563/21520.329855195563
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 10: 21520.329855195563/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [1, 1, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[18, 1, 2]], "last_factors": [[28, 14, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 843.0114089508374/12401.096567335258
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 11: 12401.096567335258/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 1, 4, 1], [1, 1, 2, 1]], "reduce_factors": [[3, 2, 2], [1, 3, 1]], "last_factors": [[32, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1841.6386483975202/4567.659791563405
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 12: 4567.659791563405/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 2, 1, 2], [2, 1, 1, 1]], "reduce_factors": [[9, 4, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 221.3051286054947/7375.4926699275065
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 13: 7375.4926699275065/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 14, 4, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 542.414896039023/3673.383158153317
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 14: 3673.383158153317/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[3, 4, 1], [3, 1, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 13899.584095882037/13899.584095882037
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 15: 13899.584095882037/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [4, 1, 7, 2]], "reduce_factors": [[2, 1, 6], [3, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 426.06075055671727/5597.691138994869
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 16: 5597.691138994869/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[2, 196, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 395.8298917161217/3511.1131349554685
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 17: 3511.1131349554685/22012.95823582785(0.04542778800045239 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 2, 4, 1], [0, 1, -1]], [[7, 4, 2, 1], [1, -1, 1]]], "reduce_factors": [[[6, 6, 1], [0, 0]]], "last_factors": [[[64, 1792, 7], [1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 1581.6859183004597/7467.546332990333
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 18: 7467.546332990333/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 96.54477106341817/4751.430109024365
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 19: 4751.430109024365/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[16, 14, 1, 1], [0, 0, 0]], [1, 1, 1, 2], [[7, 4, 2, 1], [0, 0, 1]]], "reduce_factors": [[[2, 2, 1], [0, 0]], [[1, 3, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[28672, 4, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/16302.240373380755
Best record value:22012.95823582785 (larger is better)
Round 2, Match 1, Mapping 20: 16302.240373380755/22012.95823582785(0.04542778800045239 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 8, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[14, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.037580031447630564, 0.22734594195971708, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.0962134919829326, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564, 0.037580031447630564]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 6 schedules
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 13 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 19 schedules
mapping (0,0,0,1,1,0,0): explored 26 schedules
mapping (0,0,1,0,0,1,0): explored 17 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 19 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 15 schedules
mapping (0,1,0,1,0,0,0): explored 17 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 25 schedules
mapping (1,0,0,0,0,1,0): explored 16 schedules
mapping (1,0,0,1,0,0,0): explored 13 schedules
mapping (1,0,0,1,0,1,0): explored 16 schedules
Tensorize use time 716.0056235790253 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[64, 256, 1, 1],body:R[1, 64, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [64, 256, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph59/at:resnet50:subgraph59:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 25, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 6771.497011916227/10493.375714969676
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 1: 10493.375714969676/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [1, 1, 1, 1], [7, 4, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 9113.148972479466/9113.148972479466
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 2: 9113.148972479466/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [2, 1, 4, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 36821.14079711368/36821.14079711368
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 3: 36821.14079711368/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 4, 2, 1], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*E*Y
iteration=1: 17901.992363409696/26024.05314093094
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 4: 26024.05314093094/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 1], [1, 0, -1]], [[2, 8, 1, 8], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [1, 1]]], "last_factors": [[[12544, 64, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 33085.486011464076/33085.486011464076
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 5: 33085.486011464076/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 6832.194751748517/26334.41149731607
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 6: 26334.41149731607/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 2, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2805.386480580318/25878.99624128313
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 7: 25878.99624128313/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[[7, 2, 7, 1], [0, -1, 1]], [2, 1, 1, 1], [[4, 32, 1, 1], [0, 0, 0]]], "reduce_factors": [[[8, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 9418.213691385537/24016.396618017265
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 8: 24016.396618017265/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[1, 1, 8, 1], [0, 0, 1]], [[1, 16, 1, 8], [0, 0, 0]], [[28, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 7, 16], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5648.5612053417635/40719.06344620151
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 9: 40719.06344620151/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 7, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4222.353950267304/8628.556616557325
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 10: 8628.556616557325/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [[1, 14, 1, 4], [0, -1, 0]]], "reduce_factors": [[[16, 1, 1], [1, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.E
*Y*E
iteration=1: 2956.9903238259685/11515.016352578752
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 11: 11515.016352578752/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 2, 7, 2], [1, 1, 1, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[4, 56, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 11149.977387845858/27724.43320120948
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 12: 27724.43320120948/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[8, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 30345.373205921234/30345.373205921234
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 13: 30345.373205921234/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [56, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[224, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 11565.705831597445/19002.848353426183
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 14: 19002.848353426183/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 2, 28]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 15219.12431195947/28681.933664966058
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 15: 28681.933664966058/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [7, 1, 4, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/13747.84881448691
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 16: 13747.84881448691/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[[1792, 7, 1, 1], [1, -1, 0]], [2, 1, 1, 1]], "reduce_factors": [[[4, 1, 4], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 11856.583210317618/27685.930374025305
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 17: 27685.930374025305/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [14, 4, 1, 1]], "reduce_factors": [[1, 2, 8]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 27747.817336535216/27747.817336535216
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 18: 27747.817336535216/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [14, 2, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 6923.476945237948/19094.34597403164
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 19: 19094.34597403164/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 4487.204541396412/17370.15211931868
Best record value:40719.06344620151 (larger is better)
Round 1, Match 1, Mapping 20: 17370.15211931868/40719.06344620151(0.024558521620253165 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [1, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.3617602143724342, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 26 schedules
mapping (0,0,0,0,0,1,1): explored 20 schedules
mapping (0,0,0,0,1,1,0): explored 20 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 25 schedules
mapping (0,0,0,1,0,0,1): explored 17 schedules
mapping (0,0,0,1,0,1,0): explored 24 schedules
mapping (0,0,0,1,1,0,0): explored 22 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 33 schedules
mapping (0,0,1,0,1,1,1): explored 28 schedules
mapping (0,0,1,1,0,0,0): explored 23 schedules
mapping (0,1,0,0,0,1,0): explored 16 schedules
mapping (0,1,0,1,0,0,0): explored 15 schedules
mapping (0,1,0,1,0,0,1): explored 35 schedules
mapping (0,1,0,1,1,0,0): explored 13 schedules
mapping (1,0,0,0,0,1,0): explored 30 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 36 schedules
Original weights [0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.3617602143724342, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871, 0.03359156766460871]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 37, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 24588.946740879084/24588.946740879084
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 1: 24588.946740879084/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [4, 7, 1, 2]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 8442.945758766224/9113.148972479466
Best record value:40719.06344620151 (larger is better)
Round 2, Match 1, Mapping 2: 9113.148972479466/40719.06344620151(0.024558521620253165 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [2, 1, 4, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 41482.60666842411/41482.60666842411
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 3: 41482.60666842411/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 4, 2, 1], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 25917.036191948006/26024.05314093094
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 4: 26024.05314093094/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 1], [1, 0, -1]], [[2, 8, 1, 8], [0, -1, 0]]], "reduce_factors": [[[8, 2, 1], [1, 1]]], "last_factors": [[[12544, 64, 1], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 4712.0743430969205/33085.486011464076
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 5: 33085.486011464076/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 4]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 27270.78898757553/27270.78898757553
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 6: 27270.78898757553/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 4], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[98, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 4863.612043281055/25878.99624128313
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 7: 25878.99624128313/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[[7, 2, 7, 1], [0, -1, 1]], [2, 1, 1, 1], [[4, 32, 1, 1], [0, 0, 0]]], "reduce_factors": [[[8, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1024, 196, 4], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 12000.088299267996/24016.396618017265
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 8: 24016.396618017265/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[1, 1, 8, 1], [0, 0, 1]], [[1, 16, 1, 8], [0, 0, 0]], [[28, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 7, 16], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 22461.52933769377/40719.06344620151
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 9: 40719.06344620151/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 7, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 3126.277792314642/8628.556616557325
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 10: 8628.556616557325/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [[1, 14, 1, 4], [0, -1, 0]]], "reduce_factors": [[[16, 1, 1], [1, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 22027.586373305803/22027.586373305803
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 11: 22027.586373305803/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 4, 2], [1, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 21294.56940924753/27724.43320120948
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 12: 27724.43320120948/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 8, 7], [2, 1, 1, 1]], "reduce_factors": [[8, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 14182.706101878033/30345.373205921234
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 13: 30345.373205921234/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [56, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[224, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/19002.848353426183
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 14: 19002.848353426183/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 2, 28]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 14290.494271683701/28681.933664966058
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 15: 28681.933664966058/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [7, 1, 4, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 38122.674418325056/38122.674418325056
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 16: 38122.674418325056/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[196, 1, 2, 1], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 5452.879676764473/27685.930374025305
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 17: 27685.930374025305/41482.60666842411(0.024106488967608294 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [14, 4, 1, 1]], "reduce_factors": [[1, 2, 8]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 2261.095213705855/27747.817336535216
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 18: 27747.817336535216/41482.60666842411(0.024106488967608294 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [14, 2, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/19094.34597403164
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 19: 19094.34597403164/41482.60666842411(0.024106488967608294 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [4, 7, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 21578.752497551315/21578.752497551315
Best record value:41482.60666842411 (larger is better)
Round 2, Match 1, Mapping 20: 21578.752497551315/41482.60666842411(0.024106488967608294 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 4, 1, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.03785559188083524, 0.03785559188083524, 0.1029021675152362, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.21569717862972937, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524, 0.03785559188083524]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 22 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,0): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 19 schedules
mapping (0,0,0,1,0,1,0): explored 26 schedules
mapping (0,0,0,1,1,0,0): explored 26 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 19 schedules
mapping (0,0,1,0,1,1,0): explored 35 schedules
mapping (0,0,1,0,1,1,1): explored 31 schedules
mapping (0,0,1,1,0,0,0): explored 24 schedules
mapping (0,1,0,0,0,1,0): explored 16 schedules
mapping (0,1,0,1,0,0,0): explored 17 schedules
mapping (0,1,0,1,0,0,1): explored 39 schedules
mapping (0,1,0,1,1,0,0): explored 14 schedules
mapping (1,0,0,0,0,1,0): explored 34 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 39 schedules
Tensorize use time 549.763726234436 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [256] [256] [1, 256, 56, 56] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph64.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.Y.Y.Y.E.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.009826862596003147
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.N.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.009826862596003147
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.009826862596003147
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.00979745767949645
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.00979745767949645
.T.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N

Currently best performance: 0.00979745767949645
.N.N.N.Y.Y.E.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.00979745767949645
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.00979745767949645
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N

Currently best performance: 0.00979745767949645
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.00979745767949645
Schedule cost 959.804891 seconds
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph65/at:resnet50:subgraph65:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Original trials for each mapping [4, 4, 4, 4, 4, 25, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 24615.06722701711/24615.06722701711
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 1: 24615.06722701711/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [2, 7, 2, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1367.606622831316/33996.098843255524
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 2: 33996.098843255524/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [2, 1, 28, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[224, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 14619.804605129542/26744.1524947093
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 3: 26744.1524947093/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 20042.712972954203/25270.17925299139
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 4: 25270.17925299139/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 7, 1, 2], [1, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[56, 16, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1525.6776182165604/19517.57974474846
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 5: 19517.57974474846/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6329.952915115042/40384.67067752168
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 6: 40384.67067752168/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 4, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 20317.075402743325/21473.26289865012
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 7: 21473.26289865012/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 28], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 256, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 23864.445461851014/23864.445461851014
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 8: 23864.445461851014/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [2, 2, 14, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[896, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 28264.865103286134/28264.865103286134
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 9: 28264.865103286134/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 2, 1, 56], [1, 0, 0]], [[1, 1, 4, 2], [-1, 0, 1]], [[28, 1, 2, 1], [1, 0, -1]]], "reduce_factors": [[[4, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16384, 7, 28], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 20379.459878526544/21094.256393364958
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 10: 21094.256393364958/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[196, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 6077.17676805782/9206.340232143184
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 11: 9206.340232143184/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 4, 1], [[4, 2, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[2, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3136, 256, 4], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 2658.587064771259/38468.01807498731
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 12: 38468.01807498731/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2]], "last_factors": [[3136, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 19193.605727635426/25269.92211793129
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 13: 25269.92211793129/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 4], [7, 1, 8, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[12544, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 3007.3295821694583/29917.8833394387
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 14: 29917.8833394387/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [4, 1, 2, 7]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 22472.529144522603/29004.936521955246
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 15: 29004.936521955246/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 6438.488740421753/6438.488740421753
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 16: 6438.488740421753/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 28, 1, 1], [2, 2, 2, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[28, 56, 16]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 8489.647745196773/27455.331552172316
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 17: 27455.331552172316/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 32, 1, 7], [-1, 0, 0]], [4, 2, 1, 1], [[14, 2, 2, 1], [0, 1, 0]]], "reduce_factors": [[[2, 1, 2], [0, 0]]], "last_factors": [[[50176, 2, 32], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 33454.4169849612/33454.4169849612
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 18: 33454.4169849612/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 4, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 8, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 29469.70758113258/29469.70758113258
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 19: 29469.70758113258/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 2, 2, 2], [28, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 7262.385397199182/33477.41927058226
Best record value:40384.67067752168 (larger is better)
Round 1, Match 1, Mapping 20: 33477.41927058226/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 14, 1], [2, 1, 1, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 37 schedules
mapping (0,0,0,0,0,1,1): explored 34 schedules
mapping (0,0,0,0,1,1,0): explored 34 schedules
mapping (0,0,0,0,1,1,1): explored 34 schedules
mapping (0,0,0,1,0,0,0): explored 38 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 33 schedules
mapping (0,0,0,1,1,0,0): explored 39 schedules
mapping (0,0,1,0,0,1,0): explored 35 schedules
mapping (0,0,1,0,0,1,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 47 schedules
mapping (0,0,1,0,1,1,1): explored 41 schedules
mapping (0,0,1,1,0,0,0): explored 38 schedules
mapping (0,1,0,0,0,1,0): explored 42 schedules
mapping (0,1,0,1,0,0,0): explored 36 schedules
mapping (0,1,0,1,0,0,1): explored 51 schedules
mapping (0,1,0,1,1,0,0): explored 39 schedules
mapping (1,0,0,0,0,1,0): explored 33 schedules
mapping (1,0,0,1,0,0,0): explored 44 schedules
mapping (1,0,0,1,0,1,0): explored 33 schedules
Original weights [0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.36176021437243416, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704, 0.033591567664608704]
Original trials for each mapping [4, 4, 4, 4, 4, 37, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11687.956282957235/24615.06722701711
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 1: 24615.06722701711/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [2, 7, 2, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 32086.238096434154/33996.098843255524
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 2: 33996.098843255524/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [2, 1, 28, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[224, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 26097.628275468764/26744.1524947093
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 3: 26744.1524947093/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 34100.43712604769/34100.43712604769
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 4: 34100.43712604769/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 4, 2], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4]], "last_factors": [[112, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 15112.749743653068/19517.57974474846
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 5: 19517.57974474846/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 889.9666451476324/40384.67067752168
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 6: 40384.67067752168/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 4, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1764.289869507162/21473.26289865012
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 7: 21473.26289865012/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 28], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 256, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 8430.117558898017/23864.445461851014
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 8: 23864.445461851014/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [2, 2, 14, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[896, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 35463.77659748153/35463.77659748153
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 9: 35463.77659748153/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, -1], "spatial_factors": [[[8, 2, 1, 56], [1, 0, 0]], [[1, 1, 4, 2], [-1, 0, 1]], [[28, 1, 2, 1], [1, 0, -1]]], "reduce_factors": [[[4, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[16384, 7, 28], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 6640.849597030853/21094.256393364958
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 10: 21094.256393364958/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 1, 4], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[196, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 4308.672430063045/9206.340232143184
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 11: 9206.340232143184/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 4, 1], [[4, 2, 1, 1], [-1, 1, 0]]], "reduce_factors": [[[2, 2, 1], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3136, 256, 4], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 13654.34386519296/38468.01807498731
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 12: 38468.01807498731/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2]], "last_factors": [[3136, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 15666.62629144762/25269.92211793129
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 13: 25269.92211793129/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 4], [7, 1, 8, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[12544, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.E
*Y
iteration=1: 4999.945563015428/29917.8833394387
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 14: 29917.8833394387/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [4, 1, 2, 7]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 23495.254641614436/29004.936521955246
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 15: 29004.936521955246/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [4, 2, 1, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 7727.004846952279/7727.004846952279
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 16: 7727.004846952279/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 4, 2, 1], [1, 2, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[8, 112, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 21347.225879835492/27455.331552172316
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 17: 27455.331552172316/40384.67067752168(0.024761870858999113 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 32, 1, 7], [-1, 0, 0]], [4, 2, 1, 1], [[14, 2, 2, 1], [0, 1, 0]]], "reduce_factors": [[[2, 1, 2], [0, 0]]], "last_factors": [[[50176, 2, 32], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*Y*Y
iteration=1: 19778.020304115642/33454.4169849612
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 18: 33454.4169849612/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 4, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 8, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 8131.861585336929/29469.70758113258
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 19: 29469.70758113258/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 2, 2, 2], [28, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 22149.15308820526/33477.41927058226
Best record value:40384.67067752168 (larger is better)
Round 2, Match 1, Mapping 20: 33477.41927058226/40384.67067752168(0.024761870858999113 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 14, 1], [2, 1, 1, 4]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.4490914672569309, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 42 schedules
mapping (0,0,0,0,0,1,1): explored 39 schedules
mapping (0,0,0,0,1,1,0): explored 37 schedules
mapping (0,0,0,0,1,1,1): explored 38 schedules
mapping (0,0,0,1,0,0,0): explored 42 schedules
mapping (0,0,0,1,0,0,1): explored 39 schedules
mapping (0,0,0,1,0,1,0): explored 37 schedules
mapping (0,0,0,1,1,0,0): explored 42 schedules
mapping (0,0,1,0,0,1,0): explored 40 schedules
mapping (0,0,1,0,0,1,1): explored 31 schedules
mapping (0,0,1,0,1,1,0): explored 48 schedules
mapping (0,0,1,0,1,1,1): explored 44 schedules
mapping (0,0,1,1,0,0,0): explored 40 schedules
mapping (0,1,0,0,0,1,0): explored 43 schedules
mapping (0,1,0,1,0,0,0): explored 39 schedules
mapping (0,1,0,1,0,0,1): explored 54 schedules
mapping (0,1,0,1,1,0,0): explored 42 schedules
mapping (1,0,0,0,0,1,0): explored 36 schedules
mapping (1,0,0,1,0,0,0): explored 48 schedules
mapping (1,0,0,1,0,1,0): explored 37 schedules
Tensorize use time 508.5268187522888 s.
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[64, 64, 1, 1],body:R[1, 64, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64, 64, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph68/at:resnet50:subgraph68:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Original trials for each mapping [5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 10, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 38696.442132159296/38696.442132159296
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 1: 38696.442132159296/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [2, 7, 1, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 7494.238541154893/79451.37390033742
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 2: 79451.37390033742/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 21476.386531707787/61732.50888273826
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 3: 61732.50888273826/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [1, 0, 0]], [1, 1, 1, 2], [[1, 32, 2, 2], [0, 1, -1]]], "reduce_factors": [[[2, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[25088, 16, 2], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.E
*Y*Y
iteration=1: 28899.031937319756/38757.088423504014
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 4: 38757.088423504014/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 2, 2, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[56, 56, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 37644.35361344186/45516.316728528356
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 5: 45516.316728528356/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 21332.800323681655/35616.292335693346
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 6: 35616.292335693346/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 18347.12714488965/25862.963915968918
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 7: 25862.963915968918/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 4, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 33376.93919721557/53387.9552209353
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 8: 53387.9552209353/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 34451.30227098524/63078.128966567456
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 9: 63078.128966567456/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [28, 1, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 46495.92838855814/46495.92838855814
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 10: 46495.92838855814/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [28, 2, 1, 1]], "reduce_factors": [[1, 4, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 10545.582662806632/28874.501399965215
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 11: 28874.501399965215/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 14, 2], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 79396.15739465754/79396.15739465754
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 12: 79396.15739465754/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 24937.535256355008/24937.535256355008
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 13: 24937.535256355008/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[98, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 4898.16708770237/24624.726951074474
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 14: 24624.726951074474/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [2, 14, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[56, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 29653.587645944837/35212.987003041686
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 15: 35212.987003041686/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 9974.029126484245/79371.20346850847
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 16: 79371.20346850847/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 4, 7], [2, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 10596.436523869548/43682.0915457671
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 17: 43682.0915457671/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 4, 14]], "reduce_factors": [[2, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 5576.10712617661/39562.42042740462
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 18: 39562.42042740462/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 4, 1, 14]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 30566.219451956476/45798.0900964654
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 19: 45798.0900964654/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 28, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 64391.71968916012/64391.71968916012
Best record value:79451.37390033742 (larger is better)
Round 1, Match 1, Mapping 20: 64391.71968916012/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 4], [1, 1, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 25 schedules
mapping (0,0,0,0,0,1,1): explored 31 schedules
mapping (0,0,0,0,1,1,0): explored 32 schedules
mapping (0,0,0,0,1,1,1): explored 30 schedules
mapping (0,0,0,1,0,0,0): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 38 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 31 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 23 schedules
mapping (0,1,0,0,0,1,0): explored 21 schedules
mapping (0,1,0,1,0,0,0): explored 36 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
mapping (1,0,0,0,0,1,0): explored 39 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 32 schedules
Original weights [0.03871495268855659, 0.23421181536719357, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.06891903623878731, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659, 0.03871495268855659]
Original trials for each mapping [4, 24, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*Y*Y
iteration=1: 36469.27656091531/38696.442132159296
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 1: 38696.442132159296/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [2, 7, 1, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6570.789323432253/79451.37390033742
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 2: 79451.37390033742/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 59885.50343229226/61732.50888273826
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 3: 61732.50888273826/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [1, 0, 0]], [1, 1, 1, 2], [[1, 32, 2, 2], [0, 1, -1]]], "reduce_factors": [[[2, 1, 2], [0, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[25088, 16, 2], [-1, 1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 19004.424001126437/38757.088423504014
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 4: 38757.088423504014/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 2, 2, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[56, 56, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 50092.28567066404/50092.28567066404
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 5: 50092.28567066404/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 35636.08632484596/35636.08632484596
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 6: 35636.08632484596/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 4, 2, 7], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 7061.964885502988/25862.963915968918
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 7: 25862.963915968918/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 4, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 37471.21535273071/53387.9552209353
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 8: 53387.9552209353/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 32914.60346120303/63078.128966567456
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 9: 63078.128966567456/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [28, 1, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13921.25847048625/46495.92838855814
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 10: 46495.92838855814/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [28, 2, 1, 1]], "reduce_factors": [[1, 4, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 50370.73523411887/50370.73523411887
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 11: 50370.73523411887/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 1, 14], [1, 1, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 39492.65296009819/79396.15739465754
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 12: 79396.15739465754/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 6947.847914124185/24937.535256355008
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 13: 24937.535256355008/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[98, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 36006.48262506036/36006.48262506036
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 14: 36006.48262506036/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 8, 7, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[28, 28, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 13298.023114545385/35212.987003041686
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 15: 35212.987003041686/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 48975.07870865959/79371.20346850847
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 16: 79371.20346850847/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 4, 7], [2, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 33773.75080939126/43682.0915457671
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 17: 43682.0915457671/79451.37390033742(0.012586314759696725 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 4, 14]], "reduce_factors": [[2, 1, 2]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 39339.709472219394/39562.42042740462
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 18: 39562.42042740462/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 4, 1, 14]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 43923.76331952638/45798.0900964654
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 19: 45798.0900964654/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 1, 28, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 52365.233807939534/64391.71968916012
Best record value:79451.37390033742 (larger is better)
Round 2, Match 1, Mapping 20: 64391.71968916012/79451.37390033742(0.012586314759696725 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 4], [1, 1, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.0329752989988827, 0.35632602257961726, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.050118595440493574, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 27 schedules
mapping (0,0,0,0,0,1,1): explored 36 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 35 schedules
mapping (0,0,0,1,0,0,0): explored 32 schedules
mapping (0,0,0,1,0,0,1): explored 40 schedules
mapping (0,0,0,1,0,1,0): explored 32 schedules
mapping (0,0,0,1,1,0,0): explored 41 schedules
mapping (0,0,1,0,0,1,0): explored 30 schedules
mapping (0,0,1,0,0,1,1): explored 36 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 25 schedules
mapping (0,1,0,1,0,0,0): explored 38 schedules
mapping (0,1,0,1,0,0,1): explored 32 schedules
mapping (0,1,0,1,1,0,0): explored 28 schedules
mapping (1,0,0,0,0,1,0): explored 42 schedules
mapping (1,0,0,1,0,0,0): explored 33 schedules
mapping (1,0,0,1,0,1,0): explored 34 schedules
Tensorize use time 587.427853345871 s.
#############################################
operations:inputs:[1, 64, 112, 112],[64],[64],body:S[1, 64, 112, 112] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 112, 112],body:S[1, 64, 112, 112] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 112, 112],body:S[1, 64, 114, 114] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 113)) && (v3 >= 1)) && (v3 < 113)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 114, 114],body:R[1, 64, 56, 56] [3, 3] { comm_reducer(result=[(v6 + v7)], lhs=[v6], rhs=[v7], identity_element=[0h]) } { (T0[n, c, ((i*2) + r), ((j*2) + s)]/9h) }$tensors:[1, 64, 112, 112] [64] [64] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph69.log by 200 trials...
.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.006437422290457732
.N.B.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006432457173975794
.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006426578062628088
.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.Y.Y.Y.Y.E.E.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.006422068351237862
.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.006422068351237862
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006422068351237862
.N.E.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.E.Y.Y.Y.Y.N.N.B

Currently best performance: 0.006359453559420637
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006359453559420637
.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.006359453559420637
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006359453559420637
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.E.Y.N.N.N.N.N.N.N

Currently best performance: 0.006359453559420637
.N.Y.Y.Y.Y.Y.E.Y.E.Y.E.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N

Currently best performance: 0.006359453559420637
.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.B.N.N.N.N

Currently best performance: 0.006357079891674949
Schedule cost 840.932623 seconds
#############################################
operations:inputs:[1, 3, 224, 224],body:S[1, 3, 230, 230] [ ] { } { tir.if_then_else(((((v2 >= 3) && (v2 < 227)) && (v3 >= 3)) && (v3 < 227)), T0[b, c, (h - 3), (w - 3)], 0h) }$inputs:[1, 3, 230, 230],[64, 3, 7, 7],body:R[1, 64, 112, 112] [3, 7, 7] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 3, 224, 224] [64, 3, 7, 7] [1, 64, 112, 112] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph70/at:resnet50:subgraph70:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 18
Initial trials per matching: 100
Original weights [0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.2624616048359604, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764, 0.04338461148023764]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 27, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1193.4476390161294/19365.248548673157
.Y
*E
iteration=2: 1e-10/19365.248548673157
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 1: 19365.248548673157/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 2, 1, 1], [1, -1, 0]], [1, 1, 2, 1], [[64, 1, 2, 1], [0, 0, 1]], [[7, 2, 4, 2], [0, -1, 0]]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [1, 0]]], "last_factors": [[[25088, 32, 4], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 2179.6722252501113/13432.961103422498
.Y
*Y
iteration=2: 75.10558877858995/13432.961103422498
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 2: 13432.961103422498/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[28, 4, 2, 7], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 3]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1592.6386666174901/10763.696466458012
.Y
*Y
iteration=2: 1647.250188186839/10763.696466458012
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 3: 10763.696466458012/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[49, 16, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 2303.845384328567/2303.845384328567
.Y
*Y
iteration=2: 1883.8334512976787/2303.845384328567
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 4: 2303.845384328567/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 98, 1, 8], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[5, 2, 1]], "last_factors": [[512, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 6564.766936648992/6564.766936648992
.Y
*Y
iteration=2: 1923.0022964105626/6564.766936648992
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 5: 6564.766936648992/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[8, 7, 14, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[14, 112, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 12507.154945451237/12507.154945451237
.Y
*Y
iteration=2: 3021.4122776046393/12507.154945451237
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 6: 12507.154945451237/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 7], [1, 2, 1, 1], [1, 1, 1, 1], [56, 2, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[448, 28, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2787.133290734847/3951.4811784242356
.Y
*E
iteration=2: 1e-10/3951.4811784242356
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 7: 3951.4811784242356/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 2, 1, 1], [1, 2, 1, 1], [1, 4, 4, 7]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[56, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1149.6037246984743/4536.272384788887
.Y
*Y
iteration=2: 909.641587823193/4536.272384788887
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 8: 4536.272384788887/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[112, 2, 2, 1], [-1, 1, 0]], [[4, 1, 2, 1], [1, 0, -1]], [[8, 7, 2, 1], [1, -1, 1]]], "reduce_factors": [[[2, 1, 1], [1, 0]], [[1, 1, 7], [0, -1]]], "last_factors": [[[2048, 392, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 7044.312076215275/7044.312076215275
.Y
*E
iteration=2: 1e-10/7044.312076215275
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 9: 7044.312076215275/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 2, 1], [1, 1, 2, 1], [2, 14, 4, 1]], "reduce_factors": [[5, 2, 1]], "last_factors": [[6272, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 1285.953744256184/19147.23620859019
.Y
*Y
iteration=2: 270.5193491331512/19147.23620859019
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 10: 19147.23620859019/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 2, 8], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [3, 1, 1]], "last_factors": [[98, 16, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 2839.454750862011/18521.137177088745
.Y
*Y
iteration=2: 1904.9021096690924/18521.137177088745
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 11: 18521.137177088745/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[56, 1, 4, 7], [1, 1, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[896, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 2311.7174757604175/19679.56406782171
.Y
*E
iteration=2: 1e-10/19679.56406782171
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 12: 19679.56406782171/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[392, 1, 1, 4], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 5]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 6268.300418612565/15003.436800840282
.Y
*Y
iteration=2: 1013.3593785215237/15003.436800840282
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 13: 15003.436800840282/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [2, 1, 1, 1], [14, 4, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[3136, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 274.8994945455982/5160.911084283445
.Y
*Y
iteration=2: 472.3816662281366/5160.911084283445
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 14: 5160.911084283445/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[8, 14, 2, 2], [-1, 1, 0]], [[1, 2, 2, 2], [0, 1, 0]], [14, 2, 2, 2]], "reduce_factors": [[[1, 2, 1], [0, 0]], [[7, 1, 1], [0, 0]]], "last_factors": [[[3584, 64, 14], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 7982.6543305540945/7982.6543305540945
.Y
*E
iteration=2: 1e-10/7982.6543305540945
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 15: 7982.6543305540945/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 7, 2, 1], [2, 1, 1, 1], [28, 2, 2, 1]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[14, 128, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 420.8345508220207/1071.8110118515242
.Y
*E
iteration=2: 1e-10/1071.8110118515242
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 16: 1071.8110118515242/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [8, 1], "spatial_factors": [[[112, 2, 2, 1], [1, 1, 1]], [[2, 1, 2, 2], [-1, 0, 0]], [7, 4, 1, 4]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [0, 0]]], "last_factors": [[[14, 7168, 32], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 1561.634446362258/4549.528941773368
.Y
*E
iteration=2: 1e-10/4549.528941773368
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 17: 4549.528941773368/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 8, 2, 7], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[256, 7, 14]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 284.31338714332844/13491.628048640687
.Y
*Y
iteration=2: 4892.561370562127/13491.628048640687
Best record value:19679.56406782171 (larger is better)
Round 1, Match 1, Mapping 18: 13491.628048640687/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[14, 1, 1, 1], [1, 1, 1, 2], [4, 4, 7, 1]], "reduce_factors": [[1, 10, 1]], "last_factors": [[98, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.3862917850255239, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 9 schedules
mapping (0,0,0,0,1,0,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 29 schedules
mapping (0,0,0,1,0,0,1): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 19 schedules
mapping (0,0,1,0,0,0,1): explored 20 schedules
mapping (0,0,1,0,0,1,0): explored 25 schedules
mapping (0,0,1,0,0,1,1): explored 21 schedules
mapping (0,0,1,0,1,0,1): explored 32 schedules
mapping (0,0,1,0,1,1,0): explored 25 schedules
mapping (0,0,1,0,1,1,1): explored 24 schedules
mapping (0,0,1,1,0,0,0): explored 25 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,0,1,0,0): explored 17 schedules
mapping (0,1,0,1,0,0,0): explored 34 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 24 schedules
Original weights [0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.3862917850255239, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696, 0.036100483233792696]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 39, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 12709.155441159595/19365.248548673157
.Y
*Y
iteration=2: 126.83055362444765/19365.248548673157
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 1: 19365.248548673157/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 2, 1, 1], [1, -1, 0]], [1, 1, 2, 1], [[64, 1, 2, 1], [0, 0, 1]], [[7, 2, 4, 2], [0, -1, 0]]], "reduce_factors": [[[2, 1, 1], [1, -1]], [[7, 1, 1], [1, 0]]], "last_factors": [[[25088, 32, 4], [1, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/13432.961103422498
.E

iteration=2: 1e-10/13432.961103422498
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 2: 13432.961103422498/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[28, 4, 2, 7], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 3]], "last_factors": [[3136, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 2478.3170078652506/10763.696466458012
.Y
*E
iteration=2: 1e-10/10763.696466458012
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 3: 10763.696466458012/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[16, 14, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[49, 16, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 1416.129789292045/2303.845384328567
.Y
*E
iteration=2: 1e-10/2303.845384328567
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 4: 2303.845384328567/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 98, 1, 8], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[5, 2, 1]], "last_factors": [[512, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 13208.058531526909/13208.058531526909
.Y
*E
iteration=2: 1e-10/13208.058531526909
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 5: 13208.058531526909/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[112, 14, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[1568, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 2232.700674415097/12507.154945451237
.Y
*Y
iteration=2: 8590.348799188483/12507.154945451237
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 6: 12507.154945451237/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 7], [1, 2, 1, 1], [1, 1, 1, 1], [56, 2, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[448, 28, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 4612.0483054783535/4612.0483054783535
.Y
*Y
iteration=2: 1383.9892464035554/4612.0483054783535
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 7: 4612.0483054783535/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 2], [1, 2, 1, 1], [14, 2, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 3, 1]], "last_factors": [[7, 112, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 3495.662996108782/4536.272384788887
.Y
*E
iteration=2: 1e-10/4536.272384788887
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 8: 4536.272384788887/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[112, 2, 2, 1], [-1, 1, 0]], [[4, 1, 2, 1], [1, 0, -1]], [[8, 7, 2, 1], [1, -1, 1]]], "reduce_factors": [[[2, 1, 1], [1, 0]], [[1, 1, 7], [0, -1]]], "last_factors": [[[2048, 392, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 4013.511174540098/7044.312076215275
.Y
*Y
iteration=2: 2122.5940992667574/7044.312076215275
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 9: 7044.312076215275/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 2, 1], [1, 1, 2, 1], [2, 14, 4, 1]], "reduce_factors": [[5, 2, 1]], "last_factors": [[6272, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 5251.741771938688/19147.23620859019
.E

iteration=2: 1e-10/19147.23620859019
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 10: 19147.23620859019/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 2, 8], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [3, 1, 1]], "last_factors": [[98, 16, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 1155.3864297257214/18521.137177088745
.Y
*Y
iteration=2: 10470.345957230478/18521.137177088745
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 11: 18521.137177088745/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[56, 1, 4, 7], [1, 1, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[896, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 1118.5342994987602/19679.56406782171
.Y
*Y
iteration=2: 158.89232865445928/19679.56406782171
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 12: 19679.56406782171/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[392, 1, 1, 4], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 5]], "last_factors": [[128, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 6136.9638232144325/15003.436800840282
.Y
*E
iteration=2: 1e-10/15003.436800840282
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 13: 15003.436800840282/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [2, 1, 1, 1], [14, 4, 1, 2]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[3136, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/5160.911084283445
.Y
*E
iteration=2: 1e-10/5160.911084283445
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 14: 5160.911084283445/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[8, 14, 2, 2], [-1, 1, 0]], [[1, 2, 2, 2], [0, 1, 0]], [14, 2, 2, 2]], "reduce_factors": [[[1, 2, 1], [0, 0]], [[7, 1, 1], [0, 0]]], "last_factors": [[[3584, 64, 14], [0, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 266.3222502103826/7982.6543305540945
.Y
*E
iteration=2: 1e-10/7982.6543305540945
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 15: 7982.6543305540945/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 7, 2, 1], [2, 1, 1, 1], [28, 2, 2, 1]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[14, 128, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1071.8110118515242
.Y
*Y
iteration=2: 10880.84115881665/10880.84115881665
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 16: 10880.84115881665/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 7, 1, 1], [2, 1, 1, 1], [7, 2, 2, 4]], "reduce_factors": [[2, 1, 1], [1, 1, 7]], "last_factors": [[224, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 15305.74372036396/15305.74372036396
.Y
*Y
iteration=2: 682.3279607907061/15305.74372036396
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 17: 15305.74372036396/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 8, 1], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[256, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 1803.9477857042357/13491.628048640687
.Y
*Y
iteration=2: 140.9753914498586/13491.628048640687
Best record value:19679.56406782171 (larger is better)
Round 2, Match 1, Mapping 18: 13491.628048640687/19679.56406782171(0.05081413371524383 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[14, 1, 1, 1], [1, 1, 1, 2], [4, 4, 7, 1]], "reduce_factors": [[1, 10, 1]], "last_factors": [[98, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.47196804098484985, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437, 0.031060703471479437]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 13 schedules
mapping (0,0,0,0,1,0,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 30 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,1): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 21 schedules
mapping (0,0,1,0,0,0,1): explored 22 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 25 schedules
mapping (0,0,1,0,1,0,1): explored 35 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 28 schedules
mapping (0,0,1,1,0,0,0): explored 27 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,0,1,0,0): explored 21 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 29 schedules
mapping (0,1,0,1,1,0,0): explored 27 schedules
Tensorize use time 989.2087392807007 s.
Query subgraph task id: 0, perf=0.000091 ms after 400 tuning
Query subgraph task id: 1, perf=0.003587 ms after 400 tuning
Query subgraph task id: 2, perf=0.000743 ms after 400 tuning
Query subgraph task id: 3, perf=0.001101 ms after 400 tuning
Query subgraph task id: 4, perf=0.000773 ms after 400 tuning
Query subgraph task id: 5, perf=0.002535 ms after 400 tuning
Query subgraph task id: 6, perf=0.002610 ms after 400 tuning
Query subgraph task id: 7, perf=0.001196 ms after 400 tuning
Query subgraph task id: 8, perf=0.001372 ms after 400 tuning
Query subgraph task id: 9, perf=0.000694 ms after 400 tuning
Query subgraph task id: 10, perf=0.003148 ms after 400 tuning
Query subgraph task id: 11, perf=0.000879 ms after 400 tuning
Query subgraph task id: 12, perf=0.001260 ms after 400 tuning
Query subgraph task id: 13, perf=0.000592 ms after 400 tuning
Query subgraph task id: 14, perf=0.003594 ms after 400 tuning
Query subgraph task id: 15, perf=0.001308 ms after 400 tuning
Query subgraph task id: 16, perf=0.005256 ms after 400 tuning
Query subgraph task id: 17, perf=0.001655 ms after 400 tuning
Query subgraph task id: 18, perf=0.003825 ms after 400 tuning
Query subgraph task id: 19, perf=0.001191 ms after 400 tuning
Query subgraph task id: 20, perf=0.002666 ms after 400 tuning
Query subgraph task id: 21, perf=0.000980 ms after 400 tuning
Query subgraph task id: 22, perf=0.004052 ms after 400 tuning
Query subgraph task id: 23, perf=0.002400 ms after 400 tuning
Query subgraph task id: 24, perf=0.002347 ms after 400 tuning
Query subgraph task id: 25, perf=0.002043 ms after 400 tuning
Query subgraph task id: 26, perf=0.007549 ms after 400 tuning
Query subgraph task id: 27, perf=0.002311 ms after 400 tuning
Query subgraph task id: 28, perf=0.002997 ms after 400 tuning
Query subgraph task id: 29, perf=0.002208 ms after 400 tuning
Query subgraph task id: 30, perf=0.009797 ms after 400 tuning
Query subgraph task id: 31, perf=0.001924 ms after 400 tuning
Query subgraph task id: 32, perf=0.000554 ms after 400 tuning
Query subgraph task id: 33, perf=0.006357 ms after 400 tuning
Query subgraph task id: 34, perf=0.006411 ms after 400 tuning
[NOTICE] totally 71 subgraphs, mapped 54 subgraphs, ratio= 76.05633802816901 %
.GYWhole graph cost is 19.817410 ms
#############################################
operations:inputs:[1, 2048],[1000, 2048],body:R[1, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[1, 2048] [1000, 2048] [1, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/36169.044981858424
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=2: 7364.856435369452/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=3: 9869.766837080972/36169.044981858424
.Y.E.Y.Y.E
*Y*E*E
iteration=4: 622.8955363417717/36169.044981858424
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=5: 35713.08619349066/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=6: 1e-10/36169.044981858424
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=7: 28067.4573477914/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=8: 605.6323020329617/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=9: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=10: 4646.738385145718/36169.044981858424
.E.Y.Y.Y.Y
*E*E*E*E
iteration=11: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=12: 18741.900038511223/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=13: 369.5521497461083/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=14: 5350.975551678435/36169.044981858424
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=15: 5519.292938218494/36169.044981858424
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=16: 13604.289863435692/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=17: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=18: 821.7617301863324/36169.044981858424
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=19: 6355.899539829533/36169.044981858424
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=20: 737.3567123076217/36169.044981858424
Best record value:36169.044981858424 (larger is better)
Round 1, Match 1, Mapping 1: 36169.044981858424/36169.044981858424(0.02764795145964118 ms), {"vmap": [[1], -1]}, {"inline": [1, 1], "vectorize": 8, "spatial_factors": [[[2, 1, 4, 2], [-1, 0, 0]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 8], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 761 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 2485.2920841253776/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 358.0822296021537/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=3: 347.096317853703/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=4: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=5: 2572.3482489538233/36169.044981858424
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=6: 7719.185624088171/36169.044981858424
.Y.Y.E.E.Y
*E*E*Y
iteration=7: 635.8187287969464/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=8: 484.0201837735326/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=9: 23586.345233403365/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=10: 18337.416302396716/36169.044981858424
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=11: 35478.05668825038/36169.044981858424
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=12: 28148.405171101884/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=13: 797.9468998256042/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=14: 1e-10/36169.044981858424
.Y.Y.E.Y.Y
*E*E*E*E
iteration=15: 1e-10/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=16: 35815.20608510264/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=17: 35880.58823466134/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=18: 7788.254476388648/36169.044981858424
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=19: 1372.111003907239/36169.044981858424
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=20: 23401.826836342898/36169.044981858424
Best record value:36169.044981858424 (larger is better)
Round 2, Match 1, Mapping 1: 36169.044981858424/36169.044981858424(0.02764795145964118 ms), {"vmap": [[1], -1]}, {"inline": [1, 1], "vectorize": 8, "spatial_factors": [[[2, 1, 4, 2], [-1, 0, 0]], [[32, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 1, 8], [1, -1]]], "last_factors": [[[25, 32, 5], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 797 schedules
Tensorize use time 590.6146106719971 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 2048, 7, 7],body:R[1, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.003586928799245485
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.E.Y.Y.Y.E.N

Currently best performance: 0.003586928799245485
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.003586928799245485
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003586928799245485
.N.N.B.N.N.Y.Y.Y.Y.E.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0035840921313057502
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0035840921313057502
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0035840921313057502
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0035840921313057502
.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0034301963549435185
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.T.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0034301963549435185
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.0034301963549435185
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0034301963549435185
.N.N.N.N.N.N.N.NSchedule cost 1315.358255 seconds
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 7, 7],[2048, 512, 1, 1],body:R[1, 2048, 7, 7] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [2048, 512, 1, 1] [1, 2048, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph2/at:resnet50:subgraph2:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.08321265267886407, 0.2261954416748301, 0.08321265267886407, 0.08321265267886407, 0.18519316430524038, 0.17254813062560911, 0.08321265267886407, 0.08321265267886407]
Original trials for each mapping [9, 23, 9, 9, 19, 18, 9, 9]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 1007.5052819217295/26426.687739785866
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=2: 6810.338579001574/26426.687739785866
.E.Y.Y
*E*Y
iteration=3: 4442.649228711309/26426.687739785866
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 1: 26426.687739785866/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [32, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[224, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 17214.653908900138/30139.170185743464
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 9528.010013646892/30139.170185743464
.Y.Y.Y
*E*Y*Y
iteration=3: 4856.060629908369/30139.170185743464
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 2: 30139.170185743464/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 2274.037089537511/12524.584988293986
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=2: 22372.745349136385/22372.745349136385
.Y.E.Y
*E*Y
iteration=3: 5306.741570873291/22372.745349136385
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 3: 22372.745349136385/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [32, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 3104.688114037414/24211.11742069991
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 10024.393603009354/24211.11742069991
.Y.Y.E
*E*E
iteration=3: 1e-10/24211.11742069991
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 4: 24211.11742069991/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 21516.799227584186/29049.952283933242
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 5756.015357063818/29049.952283933242
.Y.Y.Y
*E*Y*Y
iteration=3: 10412.551608361768/29049.952283933242
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 5: 29049.952283933242/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[[7, 7, 8, 2], [0, -1, 1]], [[32, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 14], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 4217.757762050311/26647.658053540385
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 4251.358780885402/26647.658053540385
.Y.Y.Y
*Y*Y*Y
iteration=3: 7809.547468951698/26647.658053540385
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 6: 26647.658053540385/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 3186.299989209237/24465.544377091195
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=2: 1889.7012970885107/24465.544377091195
.E.E.E

iteration=3: 1e-10/24465.544377091195
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 7: 24465.544377091195/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 17501.742885508076/21231.599231001903
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=2: 20758.805646759065/21231.599231001903
.Y.Y.Y
*E*Y*E
iteration=3: 28446.662955948963/28446.662955948963
Best record value:30139.170185743464 (larger is better)
Round 1, Match 1, Mapping 8: 28446.662955948963/30139.170185743464(0.0331794138271605 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [32, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.07014767117402712, 0.4243686810524264, 0.07014767117402712, 0.07014767117402712, 0.11905516949957659, 0.10583779357786141, 0.07014767117402712, 0.07014767117402712]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 37 schedules
mapping (0,0,0,0,1,1,1): explored 55 schedules
mapping (0,0,0,1,0,0,1): explored 34 schedules
mapping (0,0,0,1,0,1,0): explored 42 schedules
mapping (0,0,1,0,1,1,0): explored 62 schedules
mapping (0,0,1,0,1,1,1): explored 46 schedules
mapping (0,1,0,1,0,0,1): explored 51 schedules
mapping (1,0,0,1,0,1,0): explored 50 schedules
Original weights [0.07014767117402712, 0.4243686810524264, 0.07014767117402712, 0.07014767117402712, 0.11905516949957659, 0.10583779357786141, 0.07014767117402712, 0.07014767117402712]
Original trials for each mapping [8, 43, 8, 8, 12, 11, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 17791.328149316552/26426.687739785866
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=2: 13942.507373226366/26426.687739785866
.Y.Y.Y
*E*Y*Y
iteration=3: 8956.706235470398/26426.687739785866
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 1: 26426.687739785866/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [32, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[224, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 1722.7815317516013/30139.170185743464
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=2: 23043.1648566735/30139.170185743464
.E.Y.Y
*Y*Y
iteration=3: 14688.853865865285/30139.170185743464
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 2: 30139.170185743464/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[112, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/22372.745349136385
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=2: 1501.003597787702/22372.745349136385
.Y.Y.E
*E*Y
iteration=3: 2791.283429292616/22372.745349136385
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 3: 22372.745349136385/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [32, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 10039.603826701428/24211.11742069991
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=2: 16749.785663129853/24211.11742069991
.E.Y.Y
*E*Y
iteration=3: 3291.2226132187575/24211.11742069991
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 4: 24211.11742069991/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 26362.73652668287/29049.952283933242
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=2: 14825.177447424969/29049.952283933242
.Y.Y.E
*E*Y
iteration=3: 4082.999015872235/29049.952283933242
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 5: 29049.952283933242/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[[7, 7, 8, 2], [0, -1, 1]], [[32, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 14], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 6153.728561626017/26647.658053540385
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=2: 3804.872190899309/26647.658053540385
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/26647.658053540385
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 6: 26647.658053540385/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11997.29385955005/24465.544377091195
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=2: 10913.440529119836/24465.544377091195
.Y.Y.Y
*E*E*Y
iteration=3: 3721.406293689073/24465.544377091195
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 7: 24465.544377091195/30139.170185743464(0.0331794138271605 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*E
iteration=1: 8660.42829011879/28446.662955948963
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=2: 5473.850361874565/28446.662955948963
.Y.Y.Y
*E*Y*E
iteration=3: 17394.132135767206/28446.662955948963
Best record value:30139.170185743464 (larger is better)
Round 2, Match 1, Mapping 8: 28446.662955948963/30139.170185743464(0.0331794138271605 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [32, 1, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.05576016374182462, 0.5705914599040587, 0.05576016374182462, 0.05576016374182462, 0.07846579544944568, 0.07214192593737284, 0.05576016374182462, 0.05576016374182462]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 45 schedules
mapping (0,0,0,0,1,1,1): explored 62 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 49 schedules
mapping (0,0,1,0,1,1,0): explored 69 schedules
mapping (0,0,1,0,1,1,1): explored 51 schedules
mapping (0,1,0,1,0,0,1): explored 60 schedules
mapping (1,0,0,1,0,1,0): explored 54 schedules
Tensorize use time 684.4801898002625 s.
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 9, 9] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 8)) && (v3 >= 1)) && (v3 < 8)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 9, 9],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph3/at:resnet50:subgraph3:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.0736444536430549, 0.0736444536430549, 0.0736444536430549, 0.3348361815879345, 0.22329709655373609, 0.0736444536430549, 0.0736444536430549, 0.0736444536430549]
Original trials for each mapping [8, 8, 8, 34, 23, 8, 8, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 850.6015684913219/1885.2063695929414
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=2: 1048.8349438409653/1885.2063695929414
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1885.2063695929414
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 1: 1885.2063695929414/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 4, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/3139.3976939948157
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=2: 850.2889007236952/3139.3976939948157
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3139.3976939948157
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 2: 3139.3976939948157/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/2349.0677414703023
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=2: 228.3838140088261/2349.0677414703023
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2349.0677414703023
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 3: 2349.0677414703023/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 2, 1], [3, 1, 1]], "last_factors": [[7, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 4839.288382952467/7514.617935122427
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=2: 1042.8942255100571/7514.617935122427
.E.Y.Y
*Y*E
iteration=3: 1228.1333429802733/7514.617935122427
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 4: 7514.617935122427/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/6234.053295994352
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/6234.053295994352
.E.E.E

iteration=3: 1e-10/6234.053295994352
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 5: 6234.053295994352/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[49, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/2023.540576496042
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=2: 791.9439794667804/2023.540576496042
.Y.Y.Y
*Y*E*E
iteration=3: 56.318678705045926/2023.540576496042
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 6: 2023.540576496042/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 4, 1]], "reduce_factors": [[96, 3, 1]], "last_factors": [[7, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1795.5722013318884
.Y.E.E.Y.Y
*E*Y*Y
iteration=2: 1052.8875253580318/1795.5722013318884
.Y.E.E
*E
iteration=3: 1e-10/1795.5722013318884
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 7: 1795.5722013318884/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [[1, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 838.208706692263/2654.9773186667135
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/2654.9773186667135
.E.E.E

iteration=3: 1e-10/2654.9773186667135
Best record value:7514.617935122427 (larger is better)
Round 1, Match 1, Mapping 8: 2654.9773186667135/7514.617935122427(0.1330739644561461 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[7, 1, 1, 1], [[4, 1, 2, 2], [1, 0, 1]]], "reduce_factors": [[[32, 1, 1], [0, 0]], [[3, 1, 1], [1, -1]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[224, 448, 1], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
New weights [0.060965907600450196, 0.060965907600450196, 0.060965907600450196, 0.5152406068424185, 0.11896394755488025, 0.060965907600450196, 0.060965907600450196, 0.060965907600450196]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 30 schedules
mapping (0,0,0,0,1,1,1): explored 32 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 36 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 33 schedules
Original weights [0.060965907600450196, 0.060965907600450196, 0.060965907600450196, 0.5152406068424185, 0.11896394755488025, 0.060965907600450196, 0.060965907600450196, 0.060965907600450196]
Original trials for each mapping [7, 7, 7, 52, 12, 7, 7, 7]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 970.8199237249956/1885.2063695929414
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=2: 267.6832648903808/1885.2063695929414
.E.Y.Y
*E*E
iteration=3: 1e-10/1885.2063695929414
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 1: 1885.2063695929414/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 4, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/3139.3976939948157
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=2: 2513.7329611200744/3139.3976939948157
.Y.E.Y
*E*Y
iteration=3: 467.55791233823004/3139.3976939948157
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 2: 3139.3976939948157/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 2233.6318215323295/2349.0677414703023
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=2: 2148.8492546976786/2349.0677414703023
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2349.0677414703023
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 3: 2349.0677414703023/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[48, 2, 1], [3, 1, 1]], "last_factors": [[7, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 1980.9487032315053/7514.617935122427
.Y.Y.Y.Y.Y
*E*E*E*T*Y
iteration=2: 63.41504871371554/7514.617935122427
.Y.Y.Y
*T*T*E
iteration=3: 1e-10/7514.617935122427
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 4: 7514.617935122427/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1043.4282107079673/6234.053295994352
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/6234.053295994352
.Y.Y.Y
*Y*E*E
iteration=3: 217.0189724452877/6234.053295994352
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 5: 6234.053295994352/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[48, 1, 2], [3, 1, 1]], "last_factors": [[49, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 422.23733721500605/2023.540576496042
.E.E.Y.Y.Y
*Y*E*E
iteration=2: 2847.7518491087535/2847.7518491087535
.Y.E.Y
*Y*Y
iteration=3: 1341.4680193575034/2847.7518491087535
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 6: 2847.7518491087535/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [8, 2, 1, 1]], "reduce_factors": [[18, 16, 1]], "last_factors": [[1, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 1822.6853640296845/1822.6853640296845
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=2: 613.3389466822649/1822.6853640296845
.Y.Y.E
*E*E
iteration=3: 1e-10/1822.6853640296845
Best record value:7514.617935122427 (larger is better)
Round 2, Match 1, Mapping 7: 1822.6853640296845/7514.617935122427(0.1330739644561461 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[14, 14, 2, 2], [0, 0, 1]], [[4, 2, 1, 2], [1, -1, 0]]], "reduce_factors": [[[96, 1, 1], [1, 0]], [1, 1, 3]], "last_factors": [[[512, 14, 14], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 885.2964566764721/2654.9773186667135
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=2: 8673.3992986858/8673.3992986858
.Y.E.Y
*E*Y
iteration=3: 115.17108124542492/8673.3992986858
Best record value:8673.3992986858 (larger is better)
Round 2, Match 1, Mapping 8: 8673.3992986858/8673.3992986858(0.11529504932991161 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[49, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.07295139149619335, 0.07295139149619335, 0.07295139149619335, 0.3264560419905549, 0.11048455866357404, 0.07295139149619335, 0.07295139149619335, 0.19830244186490414]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 36 schedules
mapping (0,0,0,0,1,1,1): explored 35 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 35 schedules
mapping (0,0,1,0,1,1,0): explored 35 schedules
mapping (0,0,1,0,1,1,1): explored 40 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 39 schedules
Tensorize use time 1162.3592102527618 s.
#############################################
operations:inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 2048, 7, 7],[512, 2048, 1, 1],body:R[1, 512, 7, 7] [2048, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 2048, 7, 7] [512, 2048, 1, 1] [1, 512, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph4/at:resnet50:subgraph4:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.057204365198540066, 0.057204365198540066, 0.057204365198540066, 0.5788380771993903, 0.0779357316093693, 0.057204365198540066, 0.057204365198540066, 0.057204365198540066]
Original trials for each mapping [6, 6, 6, 58, 8, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 9304.634774013277/13654.140504581572
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 13920.219231176168/13920.219231176168
.Y.E.Y
*E*Y
iteration=3: 12471.55750267637/13920.219231176168
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 1: 13920.219231176168/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[4, 2, 2, 1], [-1, 1, 0]], [[2, 16, 4, 1], [-1, 1, 1]]], "reduce_factors": [[[16, 2, 4], [1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[448, 8, 28], [-1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 5715.978677363501/9195.470203021361
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=2: 1107.5493315317037/9195.470203021361
.Y.E.E
*E
iteration=3: 1e-10/9195.470203021361
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 2: 9195.470203021361/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[7, 1, 1, 1], [1, -1, 0]], [[16, 1, 1, 1], [1, 0, -1]], [[2, 16, 2, 2], [1, 0, 0]]], "reduce_factors": [[[8, 8, 2], [-1, 0]]], "last_factors": [[[256, 196, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 3362.1335115810457/6511.472538602427
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=2: 5533.29153948445/6511.472538602427
.Y.Y.Y
*Y*E*Y
iteration=3: 7929.082199742489/7929.082199742489
Best record value:15996.95987375775 (larger is better)
Round 1, Match 1, Mapping 3: 7929.082199742489/15996.95987375775(0.06251187775 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1]], "last_factors": [[14, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/15996.95987375775
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=2: 20677.435143628005/20677.435143628005
.Y.Y.Y
*E*E*Y
iteration=3: 1728.3854460194552/20677.435143628005
Best record value:20677.435143628005 (larger is better)
Round 1, Match 1, Mapping 4: 20677.435143628005/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 9583.885306336082/13497.704808853781
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=2: 13552.233478467217/13552.233478467217
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/13552.233478467217
Best record value:20677.435143628005 (larger is better)
Round 1, Match 1, Mapping 5: 13552.233478467217/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 4, 4], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 4352.388747245364/8527.479157776252
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/8527.479157776252
.Y.E.E
*Y
iteration=3: 6604.2542056246675/8527.479157776252
Best record value:20677.435143628005 (larger is better)
Round 1, Match 1, Mapping 6: 8527.479157776252/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[64, 2, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 312.06212904843153/10168.971928300716
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=2: 5089.080507160594/10168.971928300716
.E.Y.Y
*Y*E
iteration=3: 16729.152212096244/16729.152212096244
Best record value:20677.435143628005 (larger is better)
Round 1, Match 1, Mapping 7: 16729.152212096244/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 8185.853406512843/10459.321252806618
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=2: 2988.7902343151195/10459.321252806618
.Y.Y.Y
*E*E*Y
iteration=3: 649.9758359031358/10459.321252806618
Best record value:20677.435143628005 (larger is better)
Round 1, Match 1, Mapping 8: 10459.321252806618/20677.435143628005(0.04836189754937578 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.049690401477981025, 0.049690401477981025, 0.049690401477981025, 0.6405770785811193, 0.061280512550994336, 0.049690401477981025, 0.049690401477981025, 0.049690401477981025]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 47 schedules
mapping (0,0,0,0,1,1,1): explored 46 schedules
mapping (0,0,0,1,0,0,1): explored 43 schedules
mapping (0,0,0,1,0,1,0): explored 47 schedules
mapping (0,0,1,0,1,1,0): explored 45 schedules
mapping (0,0,1,0,1,1,1): explored 41 schedules
mapping (0,1,0,1,0,0,1): explored 36 schedules
mapping (1,0,0,1,0,1,0): explored 45 schedules
Original weights [0.049690401477981025, 0.049690401477981025, 0.049690401477981025, 0.6405770785811193, 0.061280512550994336, 0.049690401477981025, 0.049690401477981025, 0.049690401477981025]
Original trials for each mapping [5, 5, 5, 65, 7, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 4566.4164518164425/13920.219231176168
.E.E.Y.Y.Y
*Y*Y*Y
iteration=2: 16021.88535173368/16021.88535173368
.Y.E.Y
*Y*Y
iteration=3: 5177.661871056554/16021.88535173368
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 1: 16021.88535173368/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 3317.735390696179/9195.470203021361
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 12872.592445004408/12872.592445004408
.Y.Y.E
*E*E
iteration=3: 1e-10/12872.592445004408
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 2: 12872.592445004408/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 32, 1]], "last_factors": [[98, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 3362.899214140213/7929.082199742489
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 2775.599542049272/7929.082199742489
.E.E.E

iteration=3: 1e-10/7929.082199742489
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 3: 7929.082199742489/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1]], "last_factors": [[14, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 11736.58102388105/20677.435143628005
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=2: 4919.381602289122/20677.435143628005
.Y.E.Y
*E*Y
iteration=3: 1093.3897441952927/20677.435143628005
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 4: 20677.435143628005/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 2069.1770052583097/13552.233478467217
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 5273.891327391251/13552.233478467217
.Y.E.Y
*Y*E
iteration=3: 14942.344594123711/14942.344594123711
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 5: 14942.344594123711/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1]], "reduce_factors": [[8, 1, 16], [1, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 15488.918612418289/15488.918612418289
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 7793.845866815065/15488.918612418289
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/15488.918612418289
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 6: 15488.918612418289/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 4]], "last_factors": [[7, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1183.7979960540822/16729.152212096244
.Y.E.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/16729.152212096244
.E.E.Y
*E
iteration=3: 1e-10/16729.152212096244
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 7: 16729.152212096244/20677.435143628005(0.04836189754937578 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[32, 2, 2], [1, 1, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/10459.321252806618
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/10459.321252806618
.Y.Y.Y
*Y*Y*E
iteration=3: 1844.3616461011213/10459.321252806618
Best record value:20677.435143628005 (larger is better)
Round 2, Match 1, Mapping 8: 10459.321252806618/20677.435143628005(0.04836189754937578 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.047600094904057394, 0.047600094904057394, 0.047600094904057394, 0.6590332058808112, 0.05536622469484444, 0.047600094904057394, 0.047600094904057394, 0.047600094904057394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 54 schedules
mapping (0,0,0,0,1,1,1): explored 51 schedules
mapping (0,0,0,1,0,0,1): explored 49 schedules
mapping (0,0,0,1,0,1,0): explored 54 schedules
mapping (0,0,1,0,1,1,0): explored 48 schedules
mapping (0,0,1,0,1,1,1): explored 46 schedules
mapping (0,1,0,1,0,0,1): explored 37 schedules
mapping (1,0,0,1,0,1,0): explored 47 schedules
Tensorize use time 762.0443468093872 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048, 7, 7] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph5.log by 200 trials...
.Y.Y.Y.T.T.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.E.Y.E.Y.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.Y.Y.E.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.Y.Y.Y.Y.Y.Y.E.Y.T.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.T.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.0025354378690461182
.N.N.N.N.N.N.N.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0025354378690461182
.N.B.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.E.Y.Y.Y.N.N.N

Currently best performance: 0.0024996621899665383
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0024996621899665383
.Y.Y.Y.Y.Y.Y.E.Y.T.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.0024996621899665383
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N

Currently best performance: 0.0024996621899665383
.N.N.N.N.N.N.NSchedule cost 1701.978101 seconds
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph9.log by 200 trials...
.Y.T.Y.Y.Y.Y.E.Y.Y.E.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N.N.N.N

Currently best performance: 0.002609645474769548
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.E.Y.N

Currently best performance: 0.0025403664143519365
.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.T.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0025403664143519365
.N.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.0025403664143519365
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0025403664143519365
.Y.Y.Y.E.Y.E.Y.E.Y.E.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.0025403664143519365
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N.Y.E.E.Y.Y.Y.Y.E.Y.Y.N

Currently best performance: 0.0025403664143519365
.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.0025403664143519365
.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N

Currently best performance: 0.0025403664143519365
.N.N.B.N.N.E.E.E.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.002520519375276493
.Y.T.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.002520519375276493
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.002520519375276493
.N.N.N.N.N.N.NSchedule cost 1347.041785 seconds
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[2048, 1024, 1, 1],body:R[1, 2048, 7, 7] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [2048, 1024, 1, 1] [1, 2048, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph10/at:resnet50:subgraph10:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.051165470697955975, 0.641841705114308, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975, 0.051165470697955975]
Original trials for each mapping [6, 65, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 2186.6225364793017/5351.689694935078
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/5351.689694935078
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/5351.689694935078
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 1: 5351.689694935078/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/14875.299843832068
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=2: 1675.1473433016702/14875.299843832068
.Y.Y.Y
*E*E*Y
iteration=3: 2349.7284888731106/14875.299843832068
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 2: 14875.299843832068/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/7407.666068173515
.E.Y.Y.E.Y
*Y*E*Y
iteration=2: 2386.200924969865/7407.666068173515
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/7407.666068173515
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 3: 7407.666068173515/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 8], [1, 1, 1]], "last_factors": [[28, 56, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 1268.915594905563/11632.041459545846
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/11632.041459545846
.Y.Y.Y
*E*Y*Y
iteration=3: 9802.41670885594/11632.041459545846
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 4: 11632.041459545846/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 4761.666837497027/8059.233339344995
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=2: 2480.6600304521567/8059.233339344995
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/8059.233339344995
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 5: 8059.233339344995/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 4, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 2636.953464091567/4556.045854364919
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=2: 2437.215280047422/4556.045854364919
.Y.Y.E
*E*Y
iteration=3: 2609.1955432668824/4556.045854364919
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 6: 4556.045854364919/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [[16, 2, 1, 2], [0, 0, -1]]], "reduce_factors": [[[16, 2, 2], [1, 0]]], "last_factors": [[[16, 12544, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 6509.048241686155/12916.949467504443
.Y.Y.E.E.E
*E*E
iteration=2: 1e-10/12916.949467504443
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/12916.949467504443
Best record value:14875.299843832068 (larger is better)
Round 1, Match 1, Mapping 7: 12916.949467504443/14875.299843832068(0.0672255356529598 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 241.0336332064902/4790.59193350507
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=2: 14926.144777332942/14926.144777332942
.Y.E.Y
*E*E
iteration=3: 1e-10/14926.144777332942
Best record value:14926.144777332942 (larger is better)
Round 1, Match 1, Mapping 8: 14926.144777332942/14926.144777332942(0.06699653627362737 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [32, 1, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 16, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.07312504290103963, 0.36247526727057805, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.19877447532318415]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 37 schedules
mapping (0,0,0,0,1,1,1): explored 43 schedules
mapping (0,0,0,1,0,0,1): explored 32 schedules
mapping (0,0,0,1,0,1,0): explored 34 schedules
mapping (0,0,1,0,1,1,0): explored 40 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,1,0,1,0,0,1): explored 32 schedules
mapping (1,0,0,1,0,1,0): explored 38 schedules
Original weights [0.07312504290103963, 0.36247526727057805, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.07312504290103963, 0.19877447532318415]
Original trials for each mapping [8, 37, 8, 8, 8, 8, 8, 20]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/5351.689694935078
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=2: 3301.2373558069294/5351.689694935078
.Y.E.Y
*Y*E
iteration=3: 1638.2802840795594/5351.689694935078
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 1: 5351.689694935078/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5878.546023972488/14875.299843832068
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/14875.299843832068
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/14875.299843832068
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 2: 14875.299843832068/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 16]], "last_factors": [[784, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/7407.666068173515
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=2: 4178.8482016960725/7407.666068173515
.Y.Y.Y
*E*Y*Y
iteration=3: 3658.4182120049595/7407.666068173515
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 3: 7407.666068173515/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 8], [1, 1, 1]], "last_factors": [[28, 56, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 2251.9583117477328/11632.041459545846
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=2: 6852.755968043525/11632.041459545846
.E.Y.Y
*E*Y
iteration=3: 228.2195166849235/11632.041459545846
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 4: 11632.041459545846/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3820.54630563546/8059.233339344995
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=2: 1325.9567784993455/8059.233339344995
.Y.Y.Y
*E*Y*Y
iteration=3: 1806.706941350756/8059.233339344995
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 5: 8059.233339344995/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 4, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 5808.950768406536/5808.950768406536
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 3371.356878360456/5808.950768406536
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/5808.950768406536
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 6: 5808.950768406536/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [[16, 2, 1, 2], [0, 0, -1]]], "reduce_factors": [[[16, 2, 2], [1, 0]]], "last_factors": [[[16, 12544, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 6282.682563351015/12916.949467504443
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 1515.215718283354/12916.949467504443
.Y.Y.E
*E*E
iteration=3: 1e-10/12916.949467504443
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 7: 12916.949467504443/14926.144777332942(0.06699653627362737 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 7699.415608105597/14926.144777332942
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=2: 6811.8601483822285/14926.144777332942
.E.Y.E
*E
iteration=3: 1e-10/14926.144777332942
Best record value:14926.144777332942 (larger is better)
Round 2, Match 1, Mapping 8: 14926.144777332942/14926.144777332942(0.06699653627362737 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [32, 1, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 16, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.06996304565357991, 0.15696996433773358, 0.06996304565357991, 0.06996304565357991, 0.06996304565357991, 0.06996304565357991, 0.06996304565357991, 0.42325176174078694]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 40 schedules
mapping (0,0,0,0,1,1,1): explored 47 schedules
mapping (0,0,0,1,0,0,1): explored 35 schedules
mapping (0,0,0,1,0,1,0): explored 38 schedules
mapping (0,0,1,0,1,1,0): explored 49 schedules
mapping (0,0,1,0,1,1,1): explored 37 schedules
mapping (0,1,0,1,0,0,1): explored 37 schedules
mapping (1,0,0,1,0,1,0): explored 41 schedules
Tensorize use time 871.1863992214203 s.
#############################################
operations:inputs:[1, 512, 14, 14],[512],[512],body:S[1, 512, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 14, 14],body:S[1, 512, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 14, 14],body:S[1, 512, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 16, 16],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 14, 14] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph12/at:resnet50:subgraph12:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.07080534317982438, 0.07080534317982438, 0.07080534317982438, 0.07080534317982438, 0.1468205760863389, 0.07080534317982438, 0.4283473648347131, 0.0708053431798261]
Original trials for each mapping [8, 8, 8, 8, 15, 8, 43, 8]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 153.9108841466994/1089.4393374759975
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=2: 258.66872521791134/1089.4393374759975
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 1: 1089.4393374759975/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 1438.9863629619813/2860.0239465348122
.Y.E.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/2860.0239465348122
.Y.E.Y
*E*E
iteration=3: 1e-10/2860.0239465348122
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 2: 2860.0239465348122/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 8, 2], [1, 1, 1, 1]], "reduce_factors": [[144, 2, 1]], "last_factors": [[2, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1256.9411699307452
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 2740.8869081370385/2740.8869081370385
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2740.8869081370385
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 3: 2740.8869081370385/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [3, 1, 1]], "last_factors": [[16, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/3925.6131871493685
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/3925.6131871493685
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3925.6131871493685
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 4: 3925.6131871493685/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[49, 2, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 3552.774271774762/5834.146424501155
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=2: 1858.9713382100017/5834.146424501155
.Y.Y.Y
*Y*E*E
iteration=3: 256.24287823367763/5834.146424501155
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 5: 5834.146424501155/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1821.2367997916267
.E.Y.E.Y.Y
*E*E*E
iteration=2: 1e-10/1821.2367997916267
.Y.Y.Y
*E*E*T
iteration=3: 1e-10/1821.2367997916267
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 6: 1821.2367997916267/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[4, 7, 4, 7], [-1, 1, -1]], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/7949.350977020189
.E.Y.Y.Y.E
*E*E*Y
iteration=2: 53.90754122459271/7949.350977020189
.E.E.Y
*E
iteration=3: 1e-10/7949.350977020189
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 7: 7949.350977020189/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[12, 2, 4], [3, 1, 1]], "last_factors": [[98, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 727.3228420689943/5802.828372136154
.E.Y.Y.E.Y
*E*E*E
iteration=2: 1e-10/5802.828372136154
.Y.Y.E
*E*E
iteration=3: 1e-10/5802.828372136154
Best record value:7949.350977020189 (larger is better)
Round 1, Match 1, Mapping 8: 5802.828372136154/7949.350977020189(0.12579643330515639 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.05625469521589101, 0.05625469521589101, 0.05625469521589101, 0.05625469521589101, 0.08487627201869867, 0.05625469521589101, 0.5775955566859543, 0.056254695215891985]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 17 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 19 schedules
Original weights [0.05625469521589101, 0.05625469521589101, 0.05625469521589101, 0.05625469521589101, 0.08487627201869867, 0.05625469521589101, 0.5775955566859543, 0.056254695215891985]
Original trials for each mapping [6, 6, 6, 6, 9, 6, 58, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1089.4393374759975
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=2: 243.5219970814278/1089.4393374759975
.Y.E.Y
*E*E
iteration=3: 1e-10/1089.4393374759975
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 1: 1089.4393374759975/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 2], [3, 1, 1]], "last_factors": [[56, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/2860.0239465348122
.E.Y.E.Y.Y
*Y*Y*E
iteration=2: 4469.3744216622/4469.3744216622
.Y.E.Y
*E*E
iteration=3: 1e-10/4469.3744216622
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 2: 4469.3744216622/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[48, 2, 3]], "last_factors": [[28, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 338.7060490034899/2740.8869081370385
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 1019.5198611994475/2740.8869081370385
.Y.E.Y
*E*E
iteration=3: 1e-10/2740.8869081370385
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 3: 2740.8869081370385/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [3, 1, 1]], "last_factors": [[16, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 2374.5367534636334/3925.6131871493685
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 5714.286613058888/5714.286613058888
.E.Y.Y
*E*Y
iteration=3: 1738.1521408342226/5714.286613058888
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 4: 5714.286613058888/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [4, 2, 1, 2], [[4, 4, 4, 2], [-1, 1, -1]]], "reduce_factors": [[[16, 1, 2], [0, 0]], [[1, 3, 1], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[8, 14, 7]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3387.9663168388784/5834.146424501155
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 1962.8319559098761/5834.146424501155
.E.Y.E
*E
iteration=3: 1e-10/5834.146424501155
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 5: 5834.146424501155/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[16, 6, 1], [3, 1, 1]], "last_factors": [[7, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 1864.5116143692355/1864.5116143692355
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/1864.5116143692355
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1864.5116143692355
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 6: 1864.5116143692355/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1]], "reduce_factors": [[[288, 1, 1], [0, 0]]], "last_factors": [[[16, 196, 32], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 119.50901925575269/7949.350977020189
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/7949.350977020189
.Y.E.Y
*E*E
iteration=3: 1e-10/7949.350977020189
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 7: 7949.350977020189/7949.350977020189(0.12579643330515639 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 1, 4, 1]], "reduce_factors": [[12, 2, 4], [3, 1, 1]], "last_factors": [[98, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/5802.828372136154
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/5802.828372136154
.Y.Y.Y
*Y*E*E
iteration=3: 313.3509318737096/5802.828372136154
Best record value:7949.350977020189 (larger is better)
Round 2, Match 1, Mapping 8: 5802.828372136154/7949.350977020189(0.12579643330515639 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 1, 1, 2]], "reduce_factors": [[8, 2, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[4, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04885846738811375, 0.04885846738811375, 0.04885846738811375, 0.04885846738811375, 0.06388978971819316, 0.04885846738811375, 0.6429594059531237, 0.04885846738811436]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 18 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,1): explored 27 schedules
mapping (0,0,0,1,0,1,0): explored 30 schedules
mapping (0,0,1,0,1,1,0): explored 33 schedules
mapping (0,0,1,0,1,1,1): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 20 schedules
Tensorize use time 885.8949582576752 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[512, 1024, 1, 1],body:R[1, 512, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [512, 1024, 1, 1] [1, 512, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph13/at:resnet50:subgraph13:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03758003144763057, 0.0962134919829326, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057]
Original trials for each mapping [4, 10, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 23, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 3264.0965697806973/16693.99003413472
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 1: 16693.99003413472/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/16401.682335283098
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 2: 16401.682335283098/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 2520.937812936271/13226.63899024339
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 3: 13226.63899024339/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 20196.56552062256/20196.56552062256
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 4: 20196.56552062256/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 11750.454764529273/15061.898286553858
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 5: 15061.898286553858/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2451.379492114679/2451.379492114679
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 6: 2451.379492114679/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [1, 2, 1, 8], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 5774.973430833871/12429.991534877847
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 7: 12429.991534877847/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 5055.458878561111/12730.280584749318
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 8: 12730.280584749318/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 6043.0713738260265/6043.0713738260265
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 9: 6043.0713738260265/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 8], [14, 1, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[16, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 4638.869837438827/11006.709794974735
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 10: 11006.709794974735/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [8, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 4]], "last_factors": [[14, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 12504.140636095628/12504.140636095628
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 11: 12504.140636095628/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 2, 2, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 289.7862444508905/6821.053348577542
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 12: 6821.053348577542/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 8586.163311059048/8586.163311059048
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 13: 8586.163311059048/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 1, 2], [[2, 2, 1, 4], [1, -1, 0]], [[7, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[32, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 585.8040781053775/2984.600672384814
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 14: 2984.600672384814/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[4, 2, 1, 2], [0, 1, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1777.595982884677/27239.05951412685
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 15: 27239.05951412685/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 2, 1], [[16, 1, 1, 1], [0, 0, 0]], [[14, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 16], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1739.0888183263485/1739.3858228659458
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 16: 1739.3858228659458/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[56, 28, 2, 1], [1, -1, 0]], [2, 2, 4, 1]], "reduce_factors": [[[8, 2, 4], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[196, 256, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2505.7755526721958/2505.7755526721958
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 17: 2505.7755526721958/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [2, 2, 4, 1], [[7, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 4, 1], [1, -1]]], "last_factors": [[[56, 448, 16], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/12544.560513289447
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 18: 12544.560513289447/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/11904.041765600941
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 19: 11904.041765600941/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2659.072348743532/15524.478087850383
Best record value:27239.05951412685 (larger is better)
Round 1, Match 1, Mapping 20: 15524.478087850383/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.03249000842224461, 0.06261487980265704, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.35256496859694, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 24 schedules
mapping (0,0,0,0,0,1,1): explored 18 schedules
mapping (0,0,0,0,1,1,0): explored 23 schedules
mapping (0,0,0,0,1,1,1): explored 27 schedules
mapping (0,0,0,1,0,0,0): explored 26 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 25 schedules
mapping (0,0,0,1,1,0,0): explored 33 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 27 schedules
mapping (0,0,1,0,1,1,1): explored 17 schedules
mapping (0,0,1,1,0,0,0): explored 25 schedules
mapping (0,1,0,0,0,1,0): explored 30 schedules
mapping (0,1,0,1,0,0,0): explored 23 schedules
mapping (0,1,0,1,0,0,1): explored 40 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 23 schedules
mapping (1,0,0,1,0,0,0): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 20 schedules
Original weights [0.03249000842224461, 0.06261487980265704, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.35256496859694, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461, 0.03249000842224461]
Original trials for each mapping [4, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 36, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 3224.8926414753005/16693.99003413472
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 1: 16693.99003413472/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 17008.54110692234/17008.54110692234
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 2: 17008.54110692234/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 2, 16], [1, 1, 1]], "last_factors": [[224, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 22367.86928081931/22367.86928081931
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 3: 22367.86928081931/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 8, 2], [1, 1, 1]], "last_factors": [[49, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 5395.127285783521/20196.56552062256
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 4: 20196.56552062256/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 5818.5442777693215/15061.898286553858
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 5: 15061.898286553858/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 2038.6058433323763/2451.379492114679
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 6: 2451.379492114679/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [1, 2, 1, 8], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 4916.352253145447/12429.991534877847
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 7: 12429.991534877847/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4535.559049967486/12730.280584749318
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 8: 12730.280584749318/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 5323.65304501398/6043.0713738260265
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 9: 6043.0713738260265/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 8], [14, 1, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[16, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 473.4050670009972/11006.709794974735
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 10: 11006.709794974735/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [8, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 4]], "last_factors": [[14, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 14133.786904690794/14133.786904690794
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 11: 14133.786904690794/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 2, 2, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[56, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 101.98625908943355/6821.053348577542
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 12: 6821.053348577542/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[4, 4, 4]], "last_factors": [[28, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 3506.737723556202/8586.163311059048
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 13: 8586.163311059048/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 1, 2], [[2, 2, 1, 4], [1, -1, 0]], [[7, 1, 1, 2], [0, 0, -1]]], "reduce_factors": [[[32, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [-1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1184.3530390030562/2984.600672384814
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 14: 2984.600672384814/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[16, 14, 1, 1], [1, -1, 0]], [[4, 2, 1, 2], [0, 1, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[32, 2, 1], [0, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[98, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/27239.05951412685
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 15: 27239.05951412685/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 1, 2, 1], [[16, 1, 1, 1], [0, 0, 0]], [[14, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[2, 2, 16], [-1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 2, 14], [1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 5085.216930459624/5085.216930459624
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 16: 5085.216930459624/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 2, 4]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[8, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2589.7028678517545/2589.7028678517545
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 17: 2589.7028678517545/27239.05951412685(0.03671198704497765 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [[2, 2, 2, 2], [0, 1, -1]], [[7, 2, 1, 1], [0, 0, 0]]], "reduce_factors": [[[16, 4, 1], [1, -1]]], "last_factors": [[[56, 448, 16], [-1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.E
*Y*E
iteration=1: 562.6387614377579/12544.560513289447
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 18: 12544.560513289447/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 914.6138490740516/11904.041765600941
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 19: 11904.041765600941/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 3071.8855906930603/15524.478087850383
Best record value:27239.05951412685 (larger is better)
Round 2, Match 1, Mapping 20: 15524.478087850383/27239.05951412685(0.03671198704497765 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [8, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.028293586843124333, 0.045630879402128614, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.4450845574216333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 21 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 29 schedules
mapping (0,0,0,1,0,0,1): explored 23 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,0,1,1,0,0): explored 36 schedules
mapping (0,0,1,0,0,1,0): explored 32 schedules
mapping (0,0,1,0,0,1,1): explored 25 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 18 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 35 schedules
mapping (0,1,0,1,0,0,0): explored 23 schedules
mapping (0,1,0,1,0,0,1): explored 44 schedules
mapping (0,1,0,1,1,0,0): explored 30 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 27 schedules
mapping (1,0,0,1,0,1,0): explored 21 schedules
Tensorize use time 812.885066986084 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1, 1024, 14, 14] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph14.log by 200 trials...
.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.0031483827626506023
.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0029250300319326773
.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N

Currently best performance: 0.0029250300319326773
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0029250300319326773
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0029250300319326773
.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0029250300319326773
.N.N.N.N.N.N.N.N.E.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N

Currently best performance: 0.002894197916857339
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.002894197916857339
.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.002894197916857339
.T.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.E.Y.Y.N.N.N.N.N

Currently best performance: 0.002894197916857339
.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N

Currently best performance: 0.002894197916857339
.N.N.N.N.N.N.NSchedule cost 1238.589948 seconds
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 14, 14],[1024, 256, 1, 1],body:R[1, 1024, 14, 14] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [1024, 256, 1, 1] [1, 1024, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph15/at:resnet50:subgraph15:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.4490914672569309, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737, 0.028995185933845737]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 5520.338165528287/6226.040207912518
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 1: 6226.040207912518/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 4], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 31847.8702159109/31847.8702159109
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 2: 31847.8702159109/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 16937.529349072305/25134.908618828045
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 3: 25134.908618828045/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/14393.026699115324
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 4: 14393.026699115324/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[448, 1, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 32439.074604742014/32439.074604742014
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 5: 32439.074604742014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 6233.006509465597/13635.191393141622
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 6: 13635.191393141622/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[5, 1, 5, 1], [0, -1, 1]], [[2, 4, 1, 4], [1, 1, -1]], [[32, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[8, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[57344, 2, 7], [-1, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 12358.156574054223/30339.865847604102
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 7: 30339.865847604102/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [8, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 6783.762633208267/30058.69417756331
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 8: 30058.69417756331/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/9403.537556677502
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 9: 9403.537556677502/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 18049.568717127335/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 17679.02759799319/19237.171494441558
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 11: 19237.171494441558/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 1, 5], [32, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 10026.282832781168/18053.40927734779
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 12: 18053.40927734779/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 34589.785982358284/34589.785982358284
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 13: 34589.785982358284/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 2], [7, 1, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[784, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 37328.800875104935/37328.800875104935
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 14: 37328.800875104935/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 2, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 5901.610513399045/12056.445149124753
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 15: 12056.445149124753/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[896, 7, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3640.4224060762767/39998.48586548887
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 16: 39998.48586548887/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 9265.765651707281/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 15512.259495647966/15512.259495647966
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 18: 15512.259495647966/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 16, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/40036.246843112414
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 19: 40036.246843112414/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 4], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 1301.5332978142053/14524.11355550379
Best record value:46087.472006544514 (larger is better)
Round 1, Match 1, Mapping 20: 14524.11355550379/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 37 schedules
mapping (0,0,0,0,0,1,1): explored 27 schedules
mapping (0,0,0,0,1,1,0): explored 37 schedules
mapping (0,0,0,0,1,1,1): explored 28 schedules
mapping (0,0,0,1,0,0,0): explored 24 schedules
mapping (0,0,0,1,0,0,1): explored 32 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,0,1,1,0,0): explored 37 schedules
mapping (0,0,1,0,0,1,0): explored 32 schedules
mapping (0,0,1,0,0,1,1): explored 41 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 29 schedules
mapping (0,1,0,0,0,1,0): explored 35 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 24 schedules
mapping (0,1,0,1,1,0,0): explored 32 schedules
mapping (1,0,0,0,0,1,0): explored 30 schedules
mapping (1,0,0,1,0,0,0): explored 34 schedules
mapping (1,0,0,1,0,1,0): explored 24 schedules
Original weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 50, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 17914.53906013284/17914.53906013284
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 1: 17914.53906013284/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [4, 1], "spatial_factors": [[[1, 1, 1, 2], [0, 0, -1]], [[16, 2, 1, 1], [0, 1, -1]], [[32, 1, 1, 4], [1, 0, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 4, 2], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[448, 128, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 25186.598961488744/31847.8702159109
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 2: 31847.8702159109/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11752.247860100599/25134.908618828045
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 3: 25134.908618828045/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 13430.911360410852/14393.026699115324
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 4: 14393.026699115324/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[448, 1, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 4866.214984904972/32439.074604742014
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 5: 32439.074604742014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 1, 1, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 14851.519235993208/14851.519235993208
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 6: 14851.519235993208/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [8, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[49, 128, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 2824.872016075105/30339.865847604102
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 7: 30339.865847604102/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [8, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/30058.69417756331
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 8: 30058.69417756331/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[2, 1, 1, 1], [1, -1, 0]], [[8, 4, 1, 1], [1, -1, 0]], [[64, 1, 1, 2], [0, -1, 0]], [[2, 1, 1, 7], [-1, -1, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[7168, 4, 28], [1, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 4014.056645341303/9403.537556677502
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 9: 9403.537556677502/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 5265.398320424505/46087.472006544514
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 10: 46087.472006544514/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[784, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 17495.233460293428/19237.171494441558
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 11: 19237.171494441558/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 1, 5], [32, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 13916.770821487702/18053.40927734779
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 12: 18053.40927734779/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 5, 5], [16, 1, 1, 2]], "reduce_factors": [[4, 4, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 12127.473275070399/34589.785982358284
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 13: 34589.785982358284/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 2, 2], [7, 1, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[784, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 44074.45749550527/44074.45749550527
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 14: 44074.45749550527/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [8, 1, 2, 2], [7, 1, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[1568, 1, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/12056.445149124753
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 15: 12056.445149124753/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 32, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[896, 7, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 1680.689811534659/39998.48586548887
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 16: 39998.48586548887/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[16, 56, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 14586.50695278721/30667.450876959014
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 17: 30667.450876959014/46087.472006544514(0.021697870515831243 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[4, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 2071.250265744225/15512.259495647966
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 18: 15512.259495647966/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 16, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 36530.6094946398/40036.246843112414
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 19: 40036.246843112414/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 4], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 25451.19492666789/25451.19492666789
Best record value:46087.472006544514 (larger is better)
Round 2, Match 1, Mapping 20: 25451.19492666789/46087.472006544514(0.021697870515831243 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [4, 4, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.5157742615338217, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413, 0.025485565182430413]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 40 schedules
mapping (0,0,0,0,0,1,1): explored 31 schedules
mapping (0,0,0,0,1,1,0): explored 41 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 26 schedules
mapping (0,0,0,1,0,0,1): explored 36 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 37 schedules
mapping (0,0,1,0,0,1,0): explored 35 schedules
mapping (0,0,1,0,0,1,1): explored 43 schedules
mapping (0,0,1,0,1,1,0): explored 32 schedules
mapping (0,0,1,0,1,1,1): explored 31 schedules
mapping (0,0,1,1,0,0,0): explored 32 schedules
mapping (0,1,0,0,0,1,0): explored 36 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 34 schedules
mapping (1,0,0,0,0,1,0): explored 31 schedules
mapping (1,0,0,1,0,0,0): explored 37 schedules
mapping (1,0,0,1,0,1,0): explored 25 schedules
Tensorize use time 654.2395997047424 s.
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 16, 16],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph16/at:resnet50:subgraph16:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.0962134919829326, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 23, 4, 4, 4, 10, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/2814.965840110349
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 1: 2814.965840110349/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/3375.834536846011
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 2: 3375.834536846011/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 2761.137406168445/4012.178346497324
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 3: 4012.178346497324/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [0, 0, 0]], [2, 1, 4, 1], [[1, 8, 2, 8], [0, -1, 0]]], "reduce_factors": [[[24, 2, 1], [-1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[4096, 49, 1], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1862.6340601335974/10941.02996715534
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 4: 10941.02996715534/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[49, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/4347.072929484619
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 5: 4347.072929484619/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 9403.572655370115/13576.90576455772
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 6: 13576.90576455772/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 2, 4, 1], [0, 1, -1]], [1, 1, 1, 1]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 8363.994322934834/8363.994322934834
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 7: 8363.994322934834/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[2, 28, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 668.4960749035253/3308.3037349848473
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 8: 3308.3037349848473/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [4, 2, 1, 1], [[16, 4, 1, 2], [0, 0, 0]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 3959.1057218980395/3959.1057218980395
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 9: 3959.1057218980395/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[1, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1565.7919643586474/4692.089428654026
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 10: 4692.089428654026/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[24, 6, 1]], "last_factors": [[7, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 1136.7187656308195/18233.390451352392
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 11: 18233.390451352392/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 2, 2], [1, 1, 3]], "last_factors": [[16, 7, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 252.8669316232506/344.99805867004903
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 12: 344.99805867004903/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[48, 1, 3]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 55.44472003547484/3573.068418661297
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 13: 3573.068418661297/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[4, 2, 1, 1], [-1, 1, 0]], [[1, 7, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 6], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 1323.261236484283/2695.214749182826
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 14: 2695.214749182826/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[3, 8, 2], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 3735.5460713835896/17946.16177464942
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 15: 17946.16177464942/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[[28, 4, 2, 1], [1, -1, 0]], [[8, 1, 1, 1], [0, 0, 0]], [7, 1, 1, 2]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 636.6824854471041/9884.645285559383
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 16: 9884.645285559383/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 3003.4937791444872/4301.099135001353
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 17: 4301.099135001353/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 5449.619388479029/5942.112726474381
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 18: 5942.112726474381/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 1, 1], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 1322.8403981070194/11010.567165834947
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 19: 11010.567165834947/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 2, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 2573.411097649456/3197.76573807756
Best record value:18233.390451352392 (larger is better)
Round 1, Match 1, Mapping 20: 3197.76573807756/18233.390451352392(0.05484443514046664 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.35256496859693987, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.06261487980265702, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 14 schedules
mapping (0,0,0,0,1,1,0): explored 18 schedules
mapping (0,0,0,0,1,1,1): explored 20 schedules
mapping (0,0,0,1,0,0,0): explored 11 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 25 schedules
mapping (0,0,1,0,0,1,0): explored 12 schedules
mapping (0,0,1,0,0,1,1): explored 22 schedules
mapping (0,0,1,0,1,1,0): explored 26 schedules
mapping (0,0,1,0,1,1,1): explored 18 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 12 schedules
mapping (0,1,0,1,0,0,0): explored 27 schedules
mapping (0,1,0,1,0,0,1): explored 27 schedules
mapping (0,1,0,1,1,0,0): explored 28 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 25 schedules
mapping (1,0,0,1,0,1,0): explored 17 schedules
Original weights [0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.35256496859693987, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.06261487980265702, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446, 0.0324900084222446]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 36, 4, 4, 4, 7, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1643.9429015727053/2814.965840110349
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 1: 2814.965840110349/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 1639.0743819150448/3375.834536846011
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 2: 3375.834536846011/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": [8, 1], "spatial_factors": [[[1, 2, 1, 1], [0, 0, 0]], [[2, 4, 1, 1], [1, -1, 0]], [[16, 2, 2, 2], [-1, 0, 0]], [[7, 2, 1, 1], [1, -1, 0]]], "reduce_factors": [[[6, 1, 8], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 1263.2996317373631/4012.178346497324
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 3: 4012.178346497324/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[5, 5, 1, 1], [0, 0, 0]], [2, 1, 4, 1], [[1, 8, 2, 8], [0, -1, 0]]], "reduce_factors": [[[24, 2, 1], [-1, 1]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[4096, 49, 1], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2513.4147664521206/10941.02996715534
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 4: 10941.02996715534/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[49, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 3594.6145284815216/4347.072929484619
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 5: 4347.072929484619/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[7, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 4799.261710975254/13576.90576455772
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 6: 13576.90576455772/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[[25, 1, 1, 1], [1, 0, 0]], [[1, 2, 4, 1], [0, 1, -1]], [1, 1, 1, 1]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[7168, 2, 14], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/8363.994322934834
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 7: 8363.994322934834/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[2, 28, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1098.7923788288024/3308.3037349848473
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 8: 3308.3037349848473/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[1, 1, 2, 1], [-1, 0, 1]], [4, 2, 1, 1], [[16, 4, 1, 2], [0, 0, 0]], [[1, 7, 1, 2], [0, 0, -1]]], "reduce_factors": [[[4, 3, 4], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[14336, 1, 14], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 3310.8710254829966/3959.1057218980395
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 9: 3959.1057218980395/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[1, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 4902.0126175873675/4902.0126175873675
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 10: 4902.0126175873675/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 4, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 6]], "last_factors": [[14, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2865.908296666323/18233.390451352392
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 11: 18233.390451352392/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[12, 2, 2], [1, 1, 3]], "last_factors": [[16, 7, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/344.99805867004903
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 12: 344.99805867004903/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 25, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[48, 1, 3]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 201.3565799531737/3573.068418661297
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 13: 3573.068418661297/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[2, 1, 1, 1], [[4, 2, 1, 1], [-1, 1, 0]], [[1, 7, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 6], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[1792, 14, 8], [-1, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 1334.7053835853756/2695.214749182826
Best record value:18233.390451352392 (larger is better)
Round 2, Match 1, Mapping 14: 2695.214749182826/18233.390451352392(0.05484443514046664 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[3, 8, 2], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 18509.620877688645/18509.620877688645
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 15: 18509.620877688645/18509.620877688645(0.054025957992764315 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [[8, 1, 1, 1], [0, 0, 0]], [7, 1, 2, 1]], "reduce_factors": [[[12, 4, 1], [-1, 1]], [[1, 1, 3], [0, -1]]], "last_factors": [[[1024, 7, 28], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 516.0654868824869/9884.645285559383
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 16: 9884.645285559383/18509.620877688645(0.054025957992764315 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[12, 1, 4], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 2045.5632434870295/4301.099135001353
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 17: 4301.099135001353/18509.620877688645(0.054025957992764315 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[48, 1, 3]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/5942.112726474381
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 18: 5942.112726474381/18509.620877688645(0.054025957992764315 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 1, 1], [[1, 1, 4, 2], [0, 0, 0]], [[2, 1, 1, 7], [-1, 0, 0]]], "reduce_factors": [[[8, 1, 2], [-1, 0]], [[3, 1, 1], [1, -1]], [[3, 1, 1], [1, 0]]], "last_factors": [[[2048, 14, 7], [1, 0]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 5191.013598762395/11010.567165834947
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 19: 11010.567165834947/18509.620877688645(0.054025957992764315 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 2, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 6263.627811492041/6263.627811492041
Best record value:18509.620877688645 (larger is better)
Round 2, Match 1, Mapping 20: 6263.627811492041/18509.620877688645(0.054025957992764315 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 2, 2, 2]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
New weights [0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.2054268662577558, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.15561896308633408, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326, 0.035497453925328326]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 17 schedules
mapping (0,0,0,0,1,1,0): explored 21 schedules
mapping (0,0,0,0,1,1,1): explored 23 schedules
mapping (0,0,0,1,0,0,0): explored 14 schedules
mapping (0,0,0,1,0,0,1): explored 33 schedules
mapping (0,0,0,1,0,1,0): explored 17 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 15 schedules
mapping (0,0,1,0,0,1,1): explored 24 schedules
mapping (0,0,1,0,1,1,0): explored 30 schedules
mapping (0,0,1,0,1,1,1): explored 18 schedules
mapping (0,0,1,1,0,0,0): explored 23 schedules
mapping (0,1,0,0,0,1,0): explored 13 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 28 schedules
mapping (0,1,0,1,1,0,0): explored 29 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 26 schedules
mapping (1,0,0,1,0,1,0): explored 18 schedules
Tensorize use time 924.1665382385254 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[256, 1024, 1, 1],body:R[1, 256, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [256, 1024, 1, 1] [1, 256, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph17/at:resnet50:subgraph17:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03297529899888271, 0.05011859544049359, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.3563260225796174, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271]
Original trials for each mapping [4, 6, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 36, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 19605.01375786638/19605.01375786638
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 1: 19605.01375786638/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 8483.06297218639/19610.30288708449
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 2: 19610.30288708449/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 7480.839430979201/9266.982870527318
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 3: 9266.982870527318/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 14901.263451591223/14901.263451591223
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 4: 14901.263451591223/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[8, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 13265.293266141929/13265.293266141929
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 5: 13265.293266141929/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [1, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 2408.5165176042788/6684.270934611943
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 6: 6684.270934611943/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 1076.4579763419285/8945.125981588524
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 7: 8945.125981588524/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 5878.801049148194/7473.64112283227
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 8: 7473.64112283227/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[2, 1, 1, 1], [1, 0, -1]], [[2, 2, 2, 1], [0, 1, 0]], [[4, 16, 2, 1], [0, 0, 0]], [[7, 1, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[8, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[28, 3584, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 10798.395082129075/11537.18858953466
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 9: 11537.18858953466/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 1, 4], [2, 1, 7, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 2439.9108895744907/15333.986651025125
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 10: 15333.986651025125/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 10585.671945000351/29414.445807708387
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 11: 29414.445807708387/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 2496.9219090211855/8349.947481551804
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 12: 8349.947481551804/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[25, 1, 1, 1], [[1, 1, 1, 8], [0, 0, -1]]], "reduce_factors": [[[64, 1, 1], [0, 0]]], "last_factors": [[[224, 32, 28], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 1382.7085004830426/12055.4232401008
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 13: 12055.4232401008/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 4, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[49, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 5149.433788858312/17629.3407806432
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 14: 17629.3407806432/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[98, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 7458.544257393349/29582.76885314248
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 15: 29582.76885314248/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 7575.597477485918/19644.156953774353
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 16: 19644.156953774353/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 8810.683636106012/13738.260830308433
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 17: 13738.260830308433/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[112, 1, 1, 2], [0, -1, 0]], [[1, 4, 1, 2], [-1, 1, 0]], [7, 1, 2, 1]], "reduce_factors": [[[8, 4, 2], [-1, 0]]], "last_factors": [[[3584, 14, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/21066.888600269576
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 18: 21066.888600269576/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 11314.236070925592/11676.283724112813
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 19: 11676.283724112813/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 6511.0071716753355/10186.477209770044
Best record value:29582.76885314248 (larger is better)
Round 1, Match 1, Mapping 20: 10186.477209770044/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 26 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,0): explored 38 schedules
mapping (0,0,0,1,0,0,1): explored 32 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,1): explored 27 schedules
mapping (0,0,1,1,0,0,0): explored 25 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 28 schedules
mapping (0,1,0,1,0,0,1): explored 37 schedules
mapping (0,1,0,1,1,0,0): explored 29 schedules
mapping (1,0,0,0,0,1,0): explored 22 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Original weights [0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Original trials for each mapping [3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 3, 3, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 4723.139547066575/19605.01375786638
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 1: 19605.01375786638/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1], [1, 1, 7, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/19610.30288708449
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 2: 19610.30288708449/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[49, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/9266.982870527318
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 3: 9266.982870527318/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[28, 14, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 1230.1531550803918/14901.263451591223
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 4: 14901.263451591223/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[25, 1, 1, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[8, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/13265.293266141929
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 5: 13265.293266141929/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [1, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/6684.270934611943
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 6: 6684.270934611943/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 1554.9061208198405/8945.125981588524
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 7: 8945.125981588524/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 8402.765467818603/8402.765467818603
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 8: 8402.765467818603/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 4, 2, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 2, 8], [1, 1, 1]], "last_factors": [[392, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 22746.64560066336/22746.64560066336
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 9: 22746.64560066336/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [14, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[196, 8, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/15333.986651025125
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 10: 15333.986651025125/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 2697.995891593595/29414.445807708387
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 11: 29414.445807708387/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 12817.368668532794/12817.368668532794
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 12: 12817.368668532794/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 4, 1]], "reduce_factors": [[8, 8, 1]], "last_factors": [[28, 4, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 9812.025025493427/12055.4232401008
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 13: 12055.4232401008/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 4, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1]], "last_factors": [[49, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 10600.669794645219/17629.3407806432
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 14: 17629.3407806432/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[98, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 1382.8523818711042/29582.76885314248
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 15: 29582.76885314248/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 16, 1], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 3474.648302731317/19644.156953774353
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 16: 19644.156953774353/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/13738.260830308433
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 17: 13738.260830308433/29582.76885314248(0.033803461905959266 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, 1], "spatial_factors": [[[112, 1, 1, 2], [0, -1, 0]], [[1, 4, 1, 2], [-1, 1, 0]], [7, 1, 2, 1]], "reduce_factors": [[[8, 4, 2], [-1, 0]]], "last_factors": [[[3584, 14, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 4669.978317715711/21066.888600269576
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 18: 21066.888600269576/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [7, 1, 1, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/11676.283724112813
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 19: 11676.283724112813/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[1, 1, 2, 1], [[2, 1, 1, 4], [-1, 0, 0]], [[7, 2, 1, 1], [0, 1, -1]]], "reduce_factors": [[[64, 1, 1], [1, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[1568, 32, 4], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/10186.477209770044
Best record value:29582.76885314248 (larger is better)
Round 2, Match 1, Mapping 20: 10186.477209770044/29582.76885314248(0.033803461905959266 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.0261983511840325, 0.03313455063019228, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.4952951280572229, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325, 0.0261983511840325]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 31 schedules
mapping (0,0,0,0,0,1,1): explored 26 schedules
mapping (0,0,0,0,1,1,0): explored 27 schedules
mapping (0,0,0,0,1,1,1): explored 34 schedules
mapping (0,0,0,1,0,0,0): explored 38 schedules
mapping (0,0,0,1,0,0,1): explored 32 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 26 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 24 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 32 schedules
mapping (0,1,0,1,0,0,0): explored 30 schedules
mapping (0,1,0,1,0,0,1): explored 38 schedules
mapping (0,1,0,1,1,0,0): explored 29 schedules
mapping (1,0,0,0,0,1,0): explored 23 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Tensorize use time 841.8400571346283 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph34.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.T.Y.N.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.T.E.Y.Y.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.E.E.N.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.T.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.T.Y.Y.E.Y.Y.E.Y.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.E.Y.Y.Y.Y.Y.E.Y.E.Y.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003593671550283241
.Y.Y.T.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003593671550283241
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.T.Y.E.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.003593671550283241
.N.N.N.N.N.N.NSchedule cost 1644.688119 seconds
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[1024, 512, 1, 1],body:R[1, 1024, 14, 14] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [1024, 512, 1, 1] [1, 1024, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph35/at:resnet50:subgraph35:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.3563260225796174, 0.03297529899888271, 0.05011859544049359, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271, 0.03297529899888271]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 36, 4, 6, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/10116.886530624432
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 1: 10116.886530624432/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 4, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 64, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 1314.0759028872076/20526.335436547204
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 2: 20526.335436547204/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [32, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 8461.022454506208/22413.56872588828
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 3: 22413.56872588828/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 7226.208702687462/7772.726546742941
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 4: 7772.726546742941/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 4698.143099462504/5876.209355471275
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 5: 5876.209355471275/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [16, 1, 1, 2], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/6262.7674857685715
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 6: 6262.7674857685715/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 12237.579689718557/30869.59917949008
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 7: 30869.59917949008/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 855.5333339434004/9421.131332117226
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 8: 9421.131332117226/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 6343.2674220178915/20437.046207681367
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 9: 20437.046207681367/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 1903.428746610878/12423.143439314239
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 10: 12423.143439314239/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 17146.301108767268/17146.301108767268
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 11: 17146.301108767268/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[5, 1, 5, 1], [[8, 4, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 128, 1], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 2200.22509428181/40411.1505641937
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 12: 40411.1505641937/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [16, 1, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[49, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 1677.6753027219113/21340.672472348368
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 13: 21340.672472348368/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [16, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 989.0304816501937/31113.300300120893
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 14: 31113.300300120893/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 11805.798939014847/11805.798939014847
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 15: 11805.798939014847/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 2, 8, 1], [7, 2, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 5492.771828759867/5492.771828759867
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 16: 5492.771828759867/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 2, 4, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 23350.237185766895/23350.237185766895
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 17: 23350.237185766895/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [32, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2859.429995505836/5541.553620549572
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 18: 5541.553620549572/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [32, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 5499.198811745685/5499.198811745685
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 19: 5499.198811745685/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [4, 4, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 9935.441938783111/9935.441938783111
Best record value:40411.1505641937 (larger is better)
Round 1, Match 1, Mapping 20: 9935.441938783111/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [8, 2, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 49, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 27 schedules
mapping (0,0,0,0,1,1,0): explored 24 schedules
mapping (0,0,0,0,1,1,1): explored 37 schedules
mapping (0,0,0,1,0,0,0): explored 21 schedules
mapping (0,0,0,1,0,0,1): explored 29 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 20 schedules
mapping (0,0,1,0,0,1,0): explored 29 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 29 schedules
mapping (0,0,1,1,0,0,0): explored 32 schedules
mapping (0,1,0,0,0,1,0): explored 30 schedules
mapping (0,1,0,1,0,0,0): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 26 schedules
mapping (1,0,0,1,0,0,0): explored 35 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Original weights [0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 4, 3, 3, 3, 3, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 10426.077942679192/10426.077942679192
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 1: 10426.077942679192/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 4, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 28, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 12444.675708532368/20526.335436547204
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 2: 20526.335436547204/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [32, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 882.0951613679742/22413.56872588828
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 3: 22413.56872588828/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/7772.726546742941
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 4: 7772.726546742941/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 3900.588960322332/5876.209355471275
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 5: 5876.209355471275/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [16, 1, 1, 2], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 1894.2855276317932/6262.7674857685715
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 6: 6262.7674857685715/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/30869.59917949008
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 7: 30869.59917949008/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 5, 1], [16, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 4742.536045296263/9421.131332117226
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 8: 9421.131332117226/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2919.4561053275775/20437.046207681367
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 9: 20437.046207681367/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 2], [1, 1, 7, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 7981.0326838238925/12423.143439314239
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 10: 12423.143439314239/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[8, 1, 4]], "last_factors": [[7, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 8069.268914955618/17146.301108767268
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 11: 17146.301108767268/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[5, 1, 5, 1], [[8, 4, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [-1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 128, 1], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2355.698107864685/40411.1505641937
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 12: 40411.1505641937/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [16, 1, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[49, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 2815.369346005017/21340.672472348368
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 13: 21340.672472348368/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [16, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 8341.210180680857/31113.300300120893
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 14: 31113.300300120893/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 717.8621748573391/11805.798939014847
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 15: 11805.798939014847/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 2, 8, 1], [7, 2, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 8471.335006263927/8471.335006263927
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 16: 8471.335006263927/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [8, 1, 1, 4]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 313.3477245691738/23350.237185766895
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 17: 23350.237185766895/40411.1505641937(0.024745645348837213 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [32, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 4406.701511951677/5541.553620549572
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 18: 5541.553620549572/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [32, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 6762.338806196672/6762.338806196672
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 19: 6762.338806196672/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 2676.252003263674/9935.441938783111
Best record value:40411.1505641937 (larger is better)
Round 2, Match 1, Mapping 20: 9935.441938783111/40411.1505641937(0.024745645348837213 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 5, 5], [8, 2, 1, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 49, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.49529512805722303, 0.026198351184032503, 0.033134550630192286, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503, 0.026198351184032503]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 24 schedules
mapping (0,0,0,0,0,1,1): explored 29 schedules
mapping (0,0,0,0,1,1,0): explored 28 schedules
mapping (0,0,0,0,1,1,1): explored 37 schedules
mapping (0,0,0,1,0,0,0): explored 25 schedules
mapping (0,0,0,1,0,0,1): explored 31 schedules
mapping (0,0,0,1,0,1,0): explored 22 schedules
mapping (0,0,0,1,1,0,0): explored 24 schedules
mapping (0,0,1,0,0,1,0): explored 34 schedules
mapping (0,0,1,0,0,1,1): explored 37 schedules
mapping (0,0,1,0,1,1,0): explored 31 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 35 schedules
mapping (0,1,0,0,0,1,0): explored 33 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 27 schedules
mapping (0,1,0,1,1,0,0): explored 29 schedules
mapping (1,0,0,0,0,1,0): explored 28 schedules
mapping (1,0,0,1,0,0,0): explored 36 schedules
mapping (1,0,0,1,0,1,0): explored 29 schedules
Tensorize use time 731.9419014453888 s.
#############################################
operations:inputs:[1, 256, 28, 28],[256],[256],body:S[1, 256, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 28, 28],body:S[1, 256, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 28, 28],body:S[1, 256, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 30, 30],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 28, 28] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph37/at:resnet50:subgraph37:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05766803909260984, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.22953826901990948, 0.06777254044140643, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847, 0.03794242067329847]
Original trials for each mapping [6, 4, 4, 4, 4, 4, 4, 4, 23, 7, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 1984.6483849092815/4094.385839804651
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 1: 4094.385839804651/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 3384.9982286579134/6130.7708896893055
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 2: 6130.7708896893055/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[196, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 1956.2541724740593/2518.8363429486117
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 3: 2518.8363429486117/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 3, 1], [1, 1, 3]], "last_factors": [[14, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 1079.3190813366045/3765.7377234804817
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 4: 3765.7377234804817/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [1, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[784, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1570.1205104009343/2883.448670517337
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 5: 2883.448670517337/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [1, 8, 1, 1], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 522.157326652388/3399.78973660395
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 6: 3399.78973660395/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 824.1733187398115/903.4398564477241
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 7: 903.4398564477241/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [4, 1, 1, 2], [[32, 2, 1, 2], [1, 0, 0]]], "reduce_factors": [[[1, 1, 16], [-1, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14, 3584, 4], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1768.1001338408146
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 8: 1768.1001338408146/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[12, 4, 1], [1, 3, 1]], "last_factors": [[1, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 323.1225900174258/10879.563992904737
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 9: 10879.563992904737/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[112, 1, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 1383.0600474966404/7284.428508009884
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 10: 7284.428508009884/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[9, 2, 8]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 70.05299986500718/889.7652105357744
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 11: 889.7652105357744/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[784, 1, 4, 1], [0, -1, 1]], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 6, 4], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[49, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 417.6853523170386/4047.377240191769
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 12: 4047.377240191769/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[1, 5, 5, 1], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2563.7712193114735
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 13: 2563.7712193114735/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[4, 12, 1], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 1818.604537454693/2911.124912577461
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 14: 2911.124912577461/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[32, 1, 7, 1], [-1, 0, 1]], [[2, 4, 1, 1], [1, 1, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[256, 784, 1], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 2709.5274963380234/2709.5274963380234
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 15: 2709.5274963380234/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [1, 4, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[14, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 3364.592921250618/3364.592921250618
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 16: 3364.592921250618/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [1, 3, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 1620.6401046817605/8043.447076275373
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 17: 8043.447076275373/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 2, 7, 2], [1, 1, 1]], [[4, 2, 1, 1], [0, 1, -1]], [[7, 1, 1, 2], [0, -1, 0]]], "reduce_factors": [[[24, 3, 2], [1, -1]]], "last_factors": [[[3584, 7, 8], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 2185.675688276044/5351.784052098863
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 18: 5351.784052098863/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*E
iteration=1: 469.4499138952554/2029.431122044455
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 19: 2029.431122044455/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 224, 1, 1], [0, 0, 0]], [[8, 1, 1, 1], [0, 0, 0]], [[1, 1, 7, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[14, 1792, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 775.5755941768081/775.5755941768081
Best record value:10879.563992904737 (larger is better)
Round 1, Match 1, Mapping 20: 775.5755941768081/10879.563992904737(0.09191544814223844 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[4, 49, 2, 8], [1, 0, -1]], [4, 1, 2, 1]], "reduce_factors": [[[8, 2, 1], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[1, 28672, 7], [0, 1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, -1]}
New weights [0.04432765424020601, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.35250602587613317, 0.04968749911054694, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 17 schedules
mapping (0,0,0,0,0,1,1): explored 19 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 18 schedules
mapping (0,0,0,1,0,0,1): explored 6 schedules
mapping (0,0,0,1,0,1,0): explored 35 schedules
mapping (0,0,0,1,1,0,0): explored 17 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 16 schedules
mapping (0,0,1,0,1,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,1): explored 25 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 16 schedules
mapping (0,1,0,1,0,0,0): explored 18 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (0,1,0,1,1,0,0): explored 10 schedules
mapping (1,0,0,0,0,1,0): explored 24 schedules
mapping (1,0,0,1,0,0,0): explored 24 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Original weights [0.04432765424020601, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.35250602587613317, 0.04968749911054694, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095, 0.032557577692536095]
Original trials for each mapping [5, 4, 4, 4, 4, 4, 4, 4, 36, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/4094.385839804651
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 1: 4094.385839804651/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/6130.7708896893055
Best record value:10879.563992904737 (larger is better)
Round 2, Match 1, Mapping 2: 6130.7708896893055/10879.563992904737(0.09191544814223844 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[196, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 12885.739884174956/12885.739884174956
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 3: 12885.739884174956/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 3], [3, 1, 1]], "last_factors": [[14, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 3614.965408755503/3765.7377234804817
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 4: 3765.7377234804817/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [1, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 3]], "last_factors": [[784, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 2918.155415364519/2918.155415364519
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 5: 2918.155415364519/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 1, 8], [3, 1, 1], [3, 1, 1]], "last_factors": [[98, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 304.0067875717064/3399.78973660395
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 6: 3399.78973660395/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/903.4398564477241
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 7: 903.4398564477241/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[5, 5, 1, 1], [1, 0, -1]], [4, 1, 1, 2], [[32, 2, 1, 2], [1, 0, 0]]], "reduce_factors": [[[1, 1, 16], [-1, 0]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[14, 3584, 4], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1768.1001338408146
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 8: 1768.1001338408146/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[12, 4, 1], [1, 3, 1]], "last_factors": [[1, 784, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 10891.846095383093/10891.846095383093
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 9: 10891.846095383093/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[[112, 1, 2, 1], [0, 0, 1]], [[2, 2, 1, 2], [1, -1, -1]], [[14, 1, 1, 1], [1, 0, -1]]], "reduce_factors": [[[6, 4, 2], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[3136, 32, 2], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 487.10753045017753/7284.428508009884
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 10: 7284.428508009884/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [7, 2, 1, 1]], "reduce_factors": [[9, 2, 8]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/889.7652105357744
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 11: 889.7652105357744/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": [2, 1], "spatial_factors": [[[784, 1, 4, 1], [0, -1, 1]], [[8, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[2, 6, 4], [0, 1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[49, 2048, 2], [-1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 9903.702087392308/9903.702087392308
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 12: 9903.702087392308/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[5, 1, 1, 5], [[8, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[48, 3, 1], [0, 0]]], "last_factors": [[[512, 14, 28], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/2563.7712193114735
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 13: 2563.7712193114735/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[4, 12, 1], [3, 1, 1]], "last_factors": [[28, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2682.8024713926893/2911.124912577461
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 14: 2911.124912577461/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[32, 1, 7, 1], [-1, 0, 1]], [[2, 4, 1, 1], [1, 1, -1]], [[14, 1, 1, 1], [1, 0, 0]]], "reduce_factors": [[[16, 1, 3], [1, 0]], [[1, 1, 3], [-1, 0]]], "last_factors": [[[256, 784, 1], [-1, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 1310.5349565832876/2709.5274963380234
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 15: 2709.5274963380234/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [1, 4, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[12, 2, 2], [3, 1, 1]], "last_factors": [[14, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/3364.592921250618
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 16: 3364.592921250618/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 1, 1, 1]], "reduce_factors": [[8, 3, 2], [1, 3, 1]], "last_factors": [[7, 112, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/8043.447076275373
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 17: 8043.447076275373/12885.739884174956(0.07760516733913783 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[8, 2, 7, 2], [1, 1, 1]], [[4, 2, 1, 1], [0, 1, -1]], [[7, 1, 1, 2], [0, -1, 0]]], "reduce_factors": [[[24, 3, 2], [1, -1]]], "last_factors": [[[3584, 7, 8], [0, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.E
*E*Y
iteration=1: 1852.1528324420108/5351.784052098863
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 18: 5351.784052098863/12885.739884174956(0.07760516733913783 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[16, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 923.2913572640554/2029.431122044455
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 19: 2029.431122044455/12885.739884174956(0.07760516733913783 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [1, -1], "spatial_factors": [[[1, 224, 1, 1], [0, 0, 0]], [[8, 1, 1, 1], [0, 0, 0]], [[1, 1, 7, 2], [0, 0, -1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[3, 1, 1], [1, 0]], [[1, 1, 3], [0, -1]]], "last_factors": [[[14, 1792, 8], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 778.4717975835997/778.4717975835997
Best record value:12885.739884174956 (larger is better)
Round 2, Match 1, Mapping 20: 778.4717975835997/12885.739884174956(0.07760516733913783 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 5, 5, 1], [1, 8, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 3, 1], [1, 3, 1]], "last_factors": [[112, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [0.04646664877997652, 0.03687878482794433, 0.1002469306534522, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.21272618642902932, 0.05049967689043319, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433, 0.03687878482794433]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 17 schedules
mapping (0,0,0,0,0,1,1): explored 19 schedules
mapping (0,0,0,0,1,1,0): explored 26 schedules
mapping (0,0,0,0,1,1,1): explored 33 schedules
mapping (0,0,0,1,0,0,0): explored 19 schedules
mapping (0,0,0,1,0,0,1): explored 7 schedules
mapping (0,0,0,1,0,1,0): explored 35 schedules
mapping (0,0,0,1,1,0,0): explored 17 schedules
mapping (0,0,1,0,0,1,0): explored 23 schedules
mapping (0,0,1,0,0,1,1): explored 17 schedules
mapping (0,0,1,0,1,1,0): explored 15 schedules
mapping (0,0,1,0,1,1,1): explored 29 schedules
mapping (0,0,1,1,0,0,0): explored 21 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 21 schedules
mapping (0,1,0,1,0,0,1): explored 23 schedules
mapping (0,1,0,1,1,0,0): explored 10 schedules
mapping (1,0,0,0,0,1,0): explored 25 schedules
mapping (1,0,0,1,0,0,0): explored 29 schedules
mapping (1,0,0,1,0,1,0): explored 28 schedules
Tensorize use time 894.2870810031891 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[256, 512, 1, 1],body:R[1, 256, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [256, 512, 1, 1] [1, 256, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph38/at:resnet50:subgraph38:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.0329752989988827, 0.35632602257961726, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.050118595440493574, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827, 0.0329752989988827]
Original trials for each mapping [4, 36, 4, 4, 4, 4, 4, 4, 4, 6, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 4360.32310708673/5244.477237518436
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 1: 5244.477237518436/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 31409.452346968672/32603.213258919433
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 2: 32603.213258919433/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 2], [[8, 1, 1, 1], [0, 0, 0]], [[4, 2, 1, 16], [0, -1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 2, 8], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 7222.485796367318/9291.137781277019
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 3: 9291.137781277019/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 9701.843241440054/25632.308630740503
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 4: 25632.308630740503/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 1, 7, 1], [[4, 1, 1, 2], [-1, 0, 0]], [[2, 16, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 1], [-1, 1]]], "last_factors": [[[14336, 56, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 4608.2787761742275/25268.11746638482
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 5: 25268.11746638482/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": [2, -1], "spatial_factors": [[[1, 1, 2, 2], [0, -1, 0]], [[4, 1, 2, 1], [0, -1, 1]], [[64, 2, 1, 1], [0, 1, -1]], [[7, 2, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[4, 8, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 14, 16], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4513.092926093898/14516.57253422937
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 6: 14516.57253422937/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 277.1315405120315/15696.504530945278
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 7: 15696.504530945278/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 224, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 10935.710797193733/21292.14599581217
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 8: 21292.14599581217/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 2, 4, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 874.0378950543776/25007.863028200652
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 9: 25007.863028200652/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 2, 8], [1, 1, 1]], "last_factors": [[98, 4, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 5250.033156834846/31247.460988797327
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 10: 31247.460988797327/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 2], [14, 1, 1, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[448, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 1537.119252242594/7343.868829508598
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 11: 7343.868829508598/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 1]], "reduce_factors": [[1, 32, 1], [1, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 2008.348829752079/24956.799175891672
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 12: 24956.799175891672/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 1], [8, 1, 1, 1]], "reduce_factors": [[1, 32, 1]], "last_factors": [[64, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 7159.931503767124/7159.931503767124
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 13: 7159.931503767124/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 2], [2, 1, 14, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 21738.62688838686/21738.62688838686
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 14: 21738.62688838686/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 1], [7, 1, 1, 4]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 8633.25933257183/8633.25933257183
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 15: 8633.25933257183/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 2], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[16, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 1013.7321456100939/2654.2577295010838
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 16: 2654.2577295010838/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [4, 1], "spatial_factors": [[7, 2, 1, 7], [[2, 1, 4, 1], [0, -1, 1]]], "reduce_factors": [[[8, 2, 2], [1, 1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[8, 14336, 7], [1, -1]]], "output_unroll_step": [64, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 27062.133483755868/27062.133483755868
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 17: 27062.133483755868/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 4], [8, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 4, 2]], "last_factors": [[224, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 4515.236627041513/9647.668180341461
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 18: 9647.668180341461/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 15033.718626465883/24377.902125799596
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 19: 24377.902125799596/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 2], [[14, 1, 2, 1], [0, 0, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 4, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 5122.763015636329/21296.33469059542
Best record value:32603.213258919433 (larger is better)
Round 1, Match 1, Mapping 20: 21296.33469059542/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 36 schedules
mapping (0,0,0,0,1,1,0): explored 36 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,0): explored 32 schedules
mapping (0,0,0,1,0,0,1): explored 25 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 27 schedules
mapping (0,0,1,0,0,1,1): explored 26 schedules
mapping (0,0,1,0,1,1,0): explored 30 schedules
mapping (0,0,1,0,1,1,1): explored 41 schedules
mapping (0,0,1,1,0,0,0): explored 25 schedules
mapping (0,1,0,0,0,1,0): explored 34 schedules
mapping (0,1,0,1,0,0,0): explored 38 schedules
mapping (0,1,0,1,0,0,1): explored 26 schedules
mapping (0,1,0,1,1,0,0): explored 34 schedules
mapping (1,0,0,0,0,1,0): explored 30 schedules
mapping (1,0,0,1,0,0,0): explored 35 schedules
mapping (1,0,0,1,0,1,0): explored 28 schedules
Original weights [0.028595364350615028, 0.4462668094078044, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.03901663228112518, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028, 0.028595364350615028]
Original trials for each mapping [3, 45, 3, 3, 3, 3, 3, 3, 3, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 908.7573125429046/5244.477237518436
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 1: 5244.477237518436/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 2], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 15525.882414024934/32603.213258919433
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 2: 32603.213258919433/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[1, 1, 2, 2], [[8, 1, 1, 1], [0, 0, 0]], [[4, 2, 1, 16], [0, -1, 0]], [[28, 1, 1, 1], [1, -1, 0]]], "reduce_factors": [[[16, 2, 1], [1, -1]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 2, 8], [1, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/9291.137781277019
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 3: 9291.137781277019/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 16677.903097708964/25632.308630740503
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 4: 25632.308630740503/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 1, 7, 1], [[4, 1, 1, 2], [-1, 0, 0]], [[2, 16, 2, 2], [1, -1, 1]]], "reduce_factors": [[[16, 2, 1], [-1, 1]]], "last_factors": [[[14336, 56, 1], [1, -1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 25329.98665585044/25329.98665585044
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 5: 25329.98665585044/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": 2, "spatial_factors": [[[1, 1, 2, 2], [0, -1, 0]], [[4, 1, 2, 1], [0, -1, 1]], [[64, 2, 1, 1], [0, 1, -1]], [[7, 2, 1, 2], [-1, 0, 0]]], "reduce_factors": [[[4, 8, 1], [1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 14, 16], [0, 1]]], "output_unroll_step": [64, -1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 15438.95411506071/15438.95411506071
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 6: 15438.95411506071/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 2, 1, 7], [1, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[28, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 16088.20108927034/16088.20108927034
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 7: 16088.20108927034/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 2, 7], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 49, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 4765.663351017012/21292.14599581217
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 8: 21292.14599581217/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 2, 4, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 2076.6407265059024/25007.863028200652
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 9: 25007.863028200652/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 2, 8], [1, 1, 1]], "last_factors": [[98, 4, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 5974.196262878441/31247.460988797327
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 10: 31247.460988797327/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 2], [14, 1, 1, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[448, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 550.4100555766074/7343.868829508598
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 11: 7343.868829508598/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [2, 4, 1, 1]], "reduce_factors": [[1, 32, 1], [1, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 29409.038450196036/29409.038450196036
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 12: 29409.038450196036/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [4, 2, 1, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[224, 28, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 2341.195143933419/7159.931503767124
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 13: 7159.931503767124/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 2], [2, 1, 14, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 9926.712533032858/21738.62688838686
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 14: 21738.62688838686/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 1], [7, 1, 1, 4]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[3136, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 3661.7383470320456/8633.25933257183
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 15: 8633.25933257183/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 2], [7, 2, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[16, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 7743.894370707732/7743.894370707732
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 16: 7743.894370707732/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [2, 2, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[196, 16, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 7607.633036712361/27062.133483755868
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 17: 27062.133483755868/32603.213258919433(0.030671823419933148 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 4], [8, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 4, 2]], "last_factors": [[224, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 2069.2402262931996/9647.668180341461
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 18: 9647.668180341461/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 9740.524259905096/24377.902125799596
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 19: 24377.902125799596/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [1, 1], "vectorize": [4, 1], "spatial_factors": [[2, 1, 2, 1], [4, 1, 1, 2], [[14, 1, 2, 1], [0, 0, 1]]], "reduce_factors": [[[32, 1, 1], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[12544, 4, 16], [0, 0]]], "output_unroll_step": [64, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/21296.33469059542
Best record value:32603.213258919433 (larger is better)
Round 2, Match 1, Mapping 20: 21296.33469059542/32603.213258919433(0.030671823419933148 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 4, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.026198351184032496, 0.4952951280572228, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.03313455063019227, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496, 0.026198351184032496]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 38 schedules
mapping (0,0,0,0,1,1,0): explored 36 schedules
mapping (0,0,0,0,1,1,1): explored 30 schedules
mapping (0,0,0,1,0,0,0): explored 35 schedules
mapping (0,0,0,1,0,0,1): explored 27 schedules
mapping (0,0,0,1,0,1,0): explored 31 schedules
mapping (0,0,0,1,1,0,0): explored 31 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 34 schedules
mapping (0,0,1,0,1,1,1): explored 43 schedules
mapping (0,0,1,1,0,0,0): explored 29 schedules
mapping (0,1,0,0,0,1,0): explored 38 schedules
mapping (0,1,0,1,0,0,0): explored 40 schedules
mapping (0,1,0,1,0,0,1): explored 30 schedules
mapping (0,1,0,1,1,0,0): explored 38 schedules
mapping (1,0,0,0,0,1,0): explored 34 schedules
mapping (1,0,0,1,0,0,0): explored 39 schedules
mapping (1,0,0,1,0,1,0): explored 28 schedules
Tensorize use time 597.4295144081116 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [1, 512, 28, 28] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph39.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003804954025755584
.N.N.N.N.Y.Y.E.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.003804954025755584
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.T.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.003804954025755584
.N.Y.T.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.003804954025755584
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.003804954025755584
.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.T.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.003804954025755584
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N

Currently best performance: 0.003804954025755584
.N.N.N.N.N.N.N.Y.T.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.003804954025755584
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0034283362299194096
.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0034283362299194096
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.0034283362299194096
.N.N.N.N.E.Y.Y.T.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.E.Y.Y.E.N

Currently best performance: 0.0034283362299194096
.N.N.N.N.N.NSchedule cost 1271.437515 seconds
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 128, 28, 28],[512, 128, 1, 1],body:R[1, 512, 28, 28] [128, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [512, 128, 1, 1] [1, 512, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph40/at:resnet50:subgraph40:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 23915.3828677506/38779.52067648477
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 1: 38779.52067648477/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 15696.126187017067/44207.936145967775
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 2: 44207.936145967775/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 14611.050000041761/43337.15426033236
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 3: 43337.15426033236/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 16, 16], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 23501.0010794541/27350.72072749853
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 4: 27350.72072749853/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.E.E.Y.Y
*E*Y
iteration=1: 8885.83633110833/42043.08406845557
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 5: 42043.08406845557/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [4, 1, 4, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 5359.949425723529/24910.065246255665
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 6: 24910.065246255665/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 35792.52344795214/35792.52344795214
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 7: 35792.52344795214/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 17110.72064215674/35834.059865070136
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 8: 35834.059865070136/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 12569.583410768293/12892.917513187022
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 9: 12892.917513187022/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [0, -1], "vectorize": 8, "spatial_factors": [[[16, 7, 2, 2], [0, 0, 0]], [[2, 8, 1, 1], [0, 1, -1]], [[14, 2, 1, 1], [1, 1, 0]]], "reduce_factors": [[[1, 2, 4], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[2048, 49, 16], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [16, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 2147.4272510881538/23909.580226272134
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 10: 23909.580226272134/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 1, 2], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 1]], "last_factors": [[196, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 14464.181799283617/14464.181799283617
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 11: 14464.181799283617/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 7, 2, 7], [4, 2, 2, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[196, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 30524.457561601517/39882.62992523138
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 12: 39882.62992523138/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 29377.28558859564/37711.35820645354
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 13: 37711.35820645354/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 32417.419225797345/36075.71786748248
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 14: 36075.71786748248/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*Y*Y
iteration=1: 39303.90644666728/39303.90644666728
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 15: 39303.90644666728/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [4, 4, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 24156.83891943019/33693.38231836143
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 16: 33693.38231836143/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 7], [2, 1, 8, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 15647.986320706379/15727.847729045647
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 17: 15727.847729045647/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [4, 1, 2, 2], [1, 2, 2, 7]], "reduce_factors": [[2, 4, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 4729.543292334646/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 11643.762671934137/37261.41222980756
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 19: 37261.41222980756/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [4, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 5571.220976170903/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 1, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 33 schedules
mapping (0,0,0,0,0,1,1): explored 41 schedules
mapping (0,0,0,0,1,1,0): explored 43 schedules
mapping (0,0,0,0,1,1,1): explored 34 schedules
mapping (0,0,0,1,0,0,0): explored 42 schedules
mapping (0,0,0,1,0,0,1): explored 39 schedules
mapping (0,0,0,1,0,1,0): explored 40 schedules
mapping (0,0,0,1,1,0,0): explored 43 schedules
mapping (0,0,1,0,0,1,0): explored 53 schedules
mapping (0,0,1,0,0,1,1): explored 40 schedules
mapping (0,0,1,0,1,1,0): explored 34 schedules
mapping (0,0,1,0,1,1,1): explored 45 schedules
mapping (0,0,1,1,0,0,0): explored 35 schedules
mapping (0,1,0,0,0,1,0): explored 38 schedules
mapping (0,1,0,1,0,0,0): explored 37 schedules
mapping (0,1,0,1,0,0,1): explored 43 schedules
mapping (0,1,0,1,1,0,0): explored 40 schedules
mapping (1,0,0,0,0,1,0): explored 33 schedules
mapping (1,0,0,1,0,0,0): explored 28 schedules
mapping (1,0,0,1,0,1,0): explored 25 schedules
Original weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 50, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 20420.77895488228/38779.52067648477
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 1: 38779.52067648477/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/44207.936145967775
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 2: 44207.936145967775/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 15850.09512870138/43337.15426033236
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 3: 43337.15426033236/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[7, 7, 2, 1], [1, 0, 1]], [[8, 1, 1, 2], [0, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[1, 1, 8], [-1, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[6272, 16, 16], [0, 0]]], "output_unroll_step": [1500, 1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 6032.18168558046/27350.72072749853
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 4: 27350.72072749853/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1]], "last_factors": [[1568, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 2423.1250967600636/42043.08406845557
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 5: 42043.08406845557/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [4, 1, 4, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 8912.55287631964/24910.065246255665
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 6: 24910.065246255665/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 15615.102182476354/35792.52344795214
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 7: 35792.52344795214/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 2, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 3515.100064694909/35834.059865070136
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 8: 35834.059865070136/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 29109.292978567024/29109.292978567024
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 9: 29109.292978567024/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 4], [14, 1, 2, 1]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[98, 4, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6169.910945055636/23909.580226272134
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 10: 23909.580226272134/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 2], [2, 4, 1, 2], [14, 2, 1, 1]], "reduce_factors": [[2, 4, 1]], "last_factors": [[196, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 8620.1200172041/14464.181799283617
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 11: 14464.181799283617/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 7, 2, 7], [4, 2, 2, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 1]], "last_factors": [[196, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 24516.948517788864/39882.62992523138
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 12: 39882.62992523138/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 4, 2, 2]], "reduce_factors": [[1, 1, 8]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*Y*E*E
iteration=1: 4026.8612291383756/37711.35820645354
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 13: 37711.35820645354/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [16, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 8877.164429594226/36075.71786748248
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 14: 36075.71786748248/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 4, 4, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 9509.015416862661/39303.90644666728
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 15: 39303.90644666728/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [4, 4, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 26024.245745520275/33693.38231836143
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 16: 33693.38231836143/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 2, 1, 7], [2, 1, 8, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 2391.2289960348085/15727.847729045647
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 17: 15727.847729045647/47636.208566517395(0.020992434748530374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [4, 1, 2, 2], [1, 2, 2, 7]], "reduce_factors": [[2, 4, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 11091.25738363681/47636.208566517395
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 18: 47636.208566517395/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [4, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[1, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 1369.771465791528/37261.41222980756
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 19: 37261.41222980756/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [4, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 2485.4732437135667/28354.036223795014
Best record value:47636.208566517395 (larger is better)
Round 2, Match 1, Mapping 20: 28354.036223795014/47636.208566517395(0.020992434748530374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 4, 2]], "reduce_factors": [[2, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.5157742615338219, 0.025485565182430423, 0.025485565182430423]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 38 schedules
mapping (0,0,0,0,0,1,1): explored 41 schedules
mapping (0,0,0,0,1,1,0): explored 44 schedules
mapping (0,0,0,0,1,1,1): explored 37 schedules
mapping (0,0,0,1,0,0,0): explored 43 schedules
mapping (0,0,0,1,0,0,1): explored 42 schedules
mapping (0,0,0,1,0,1,0): explored 42 schedules
mapping (0,0,0,1,1,0,0): explored 47 schedules
mapping (0,0,1,0,0,1,0): explored 58 schedules
mapping (0,0,1,0,0,1,1): explored 45 schedules
mapping (0,0,1,0,1,1,0): explored 36 schedules
mapping (0,0,1,0,1,1,1): explored 49 schedules
mapping (0,0,1,1,0,0,0): explored 36 schedules
mapping (0,1,0,0,0,1,0): explored 42 schedules
mapping (0,1,0,1,0,0,0): explored 41 schedules
mapping (0,1,0,1,0,0,1): explored 47 schedules
mapping (0,1,0,1,1,0,0): explored 41 schedules
mapping (1,0,0,0,0,1,0): explored 35 schedules
mapping (1,0,0,1,0,0,0): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Tensorize use time 527.953574180603 s.
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 30, 30],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph41/at:resnet50:subgraph41:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.1576640462228908, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.03966142845658374, 0.10781094026426008, 0.06028072975092513, 0.03966142845658374, 0.03966142845658374]
Original trials for each mapping [4, 4, 4, 4, 16, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 11, 7, 4, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1076.9057194836384/3254.4458905557176
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 1: 3254.4458905557176/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 1374.3154352290856/5114.969535208765
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 2: 5114.969535208765/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 26.162845732437294/1551.5705935288172
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 3: 1551.5705935288172/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/12864.601026325301
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 4: 12864.601026325301/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[6, 6, 2]], "last_factors": [[1568, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 6721.587658015374/18709.425497966746
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 5: 18709.425497966746/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/11275.675299207296
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 6: 11275.675299207296/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[8, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3577.5775667960675/15676.638784790579
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 7: 15676.638784790579/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1198.5096723985273/4193.489231819809
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 8: 4193.489231819809/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[2, 1, 1, 2], [[4, 1, 1, 1], [0, 0, 0]], [[16, 4, 2, 1], [0, 0, 1]], [[1, 14, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[4, 1, 6], [-1, 0]], [[1, 3, 1], [-1, 1]]], "last_factors": [[[28672, 7, 2], [-1, 1]]], "output_unroll_step": [64, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 2796.5492383272854/6695.159681432256
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 9: 6695.159681432256/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 7168.022593235488/8041.72122012158
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 10: 8041.72122012158/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[24, 1, 3]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 4583.310530662631/4583.310530662631
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 11: 4583.310530662631/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 7, 7], [2, 1, 2, 1]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 14509.249503411733/14509.249503411733
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 12: 14509.249503411733/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [1, 1, 2, 2]], "reduce_factors": [[36, 2, 1]], "last_factors": [[112, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 2373.6827762864114/4583.502882733829
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 13: 4583.502882733829/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*E*E
iteration=1: 1e-10/7091.036074450569
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 14: 7091.036074450569/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 209.9250202618055/15740.468346399526
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 15: 15740.468346399526/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [4, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[98, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 5431.948474666994/5431.948474666994
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 16: 5431.948474666994/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [1, 1, 1, 4]], "reduce_factors": [[12, 2, 1], [1, 1, 3]], "last_factors": [[49, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/20696.21415000286
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 17: 20696.21415000286/20696.21415000286(0.04831801568886752 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[18, 1, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 1324.0833496289115/10290.212221797356
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 18: 10290.212221797356/20696.21415000286(0.04831801568886752 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 1086.554939152514/1797.15030374209
Best record value:20696.21415000286 (larger is better)
Round 1, Match 1, Mapping 19: 1797.15030374209/20696.21415000286(0.04831801568886752 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [8, -1], "spatial_factors": [[1, 1, 4, 1], [[2, 2, 1, 1], [0, 0, 0]], [[7, 4, 1, 1], [0, 1, -1]]], "reduce_factors": [[[2, 1, 4], [1, -1]], [[3, 1, 1], [1, 0]], [[3, 1, 1], [1, -1]]], "last_factors": [[[32, 392, 32], [1, 1]]], "output_unroll_step": [512, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 22596.3801588608/22596.3801588608
Best record value:22596.3801588608 (larger is better)
Round 1, Match 1, Mapping 20: 22596.3801588608/22596.3801588608(0.04425487591240876 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.10365245360048875, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.08942239275866212, 0.05482325877000943, 0.04018007110713299, 0.10922075715671192]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 24 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 19 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 18 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 15 schedules
mapping (0,0,1,0,1,1,0): explored 19 schedules
mapping (0,0,1,0,1,1,1): explored 34 schedules
mapping (0,0,1,1,0,0,0): explored 16 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 14 schedules
mapping (0,1,0,1,0,0,1): explored 24 schedules
mapping (0,1,0,1,1,0,0): explored 18 schedules
mapping (1,0,0,0,0,1,0): explored 13 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 26 schedules
Original weights [0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.10365245360048875, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.04018007110713299, 0.08942239275866212, 0.05482325877000943, 0.04018007110713299, 0.10922075715671192]
Original trials for each mapping [5, 5, 5, 5, 11, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 9, 6, 5, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/3254.4458905557176
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 1: 3254.4458905557176/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 436.7495454593334/5114.969535208765
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 2: 5114.969535208765/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1551.5705935288172
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 3: 1551.5705935288172/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": [0, -1], "vectorize": [2, 1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, 0]], [[4, 1, 1, 1], [1, 0, -1]], [1, 1, 1, 1]], "reduce_factors": [[[8, 3, 1], [1, -1]], [[3, 1, 1], [0, 0]]], "last_factors": [[[16, 896, 28], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 6643.613314825108/12864.601026325301
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 4: 12864.601026325301/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[6, 6, 2]], "last_factors": [[1568, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/18709.425497966746
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 5: 18709.425497966746/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 8162.109984028967/11275.675299207296
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 6: 11275.675299207296/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[8, 56, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 171.54347850431213/15676.638784790579
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 7: 15676.638784790579/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 6197.220465842894/6197.220465842894
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 8: 6197.220465842894/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [2, 1, 1, 2], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[6, 1, 4], [1, 1, 3]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2400.2089213072327/6695.159681432256
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 9: 6695.159681432256/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[4, 3, 2], [3, 1, 1]], "last_factors": [[112, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 4683.824578309342/8041.72122012158
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 10: 8041.72122012158/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[24, 1, 3]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 1231.9567780283994/4583.310530662631
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 11: 4583.310530662631/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 7, 7], [2, 1, 2, 1]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 820.3805130813026/14509.249503411733
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 12: 14509.249503411733/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [1, 1, 2, 2]], "reduce_factors": [[36, 2, 1]], "last_factors": [[112, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2005.0742091377583/4583.502882733829
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 13: 4583.502882733829/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 931.2999101933108/7091.036074450569
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 14: 7091.036074450569/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [1, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 1, 3]], "last_factors": [[49, 32, 2]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/15740.468346399526
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 15: 15740.468346399526/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [4, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [1, 1, 3]], "last_factors": [[98, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 1078.8899433763363/5431.948474666994
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 16: 5431.948474666994/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [1, 1, 1, 4]], "reduce_factors": [[12, 2, 1], [1, 1, 3]], "last_factors": [[49, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 2681.0882677612794/20696.21415000286
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 17: 20696.21415000286/22596.3801588608(0.04425487591240876 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[18, 1, 4]], "last_factors": [[112, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 3717.370227511807/10290.212221797356
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 18: 10290.212221797356/22596.3801588608(0.04425487591240876 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 4, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[98, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 19114.137740710357/19114.137740710357
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 19: 19114.137740710357/22596.3801588608(0.04425487591240876 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 1], [1, 3, 1], [1, 1, 3]], "last_factors": [[112, 2, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 11728.533415632435/22596.3801588608
Best record value:22596.3801588608 (larger is better)
Round 2, Match 1, Mapping 20: 22596.3801588608/22596.3801588608(0.04425487591240876 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [1, 3, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.07179746693222895, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.03697024444708934, 0.06639314249821117, 0.04662853383806971, 0.03697024444708934, 0.22365694557806082]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 19 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 25 schedules
mapping (0,0,0,0,1,1,1): explored 20 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 21 schedules
mapping (0,0,0,1,0,1,0): explored 30 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 24 schedules
mapping (0,0,1,0,0,1,1): explored 19 schedules
mapping (0,0,1,0,1,1,0): explored 21 schedules
mapping (0,0,1,0,1,1,1): explored 37 schedules
mapping (0,0,1,1,0,0,0): explored 17 schedules
mapping (0,1,0,0,0,1,0): explored 33 schedules
mapping (0,1,0,1,0,0,0): explored 14 schedules
mapping (0,1,0,1,0,0,1): explored 25 schedules
mapping (0,1,0,1,1,0,0): explored 19 schedules
mapping (1,0,0,0,0,1,0): explored 17 schedules
mapping (1,0,0,1,0,0,0): explored 23 schedules
mapping (1,0,0,1,0,1,0): explored 27 schedules
Tensorize use time 852.5392079353333 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[128, 512, 1, 1],body:R[1, 128, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [128, 512, 1, 1] [1, 128, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph42/at:resnet50:subgraph42:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4004.777319760308/4004.777319760308
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 1: 4004.777319760308/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[4, 1, 1, 1], [[1, 2, 2, 1], [0, 1, -1]], [[16, 4, 2, 1], [1, -1, 1]], [[2, 7, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[8, 4, 1], [-1, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[50176, 8, 1], [1, -1]]], "output_unroll_step": [512, 1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 5558.666161426926/14426.643534925734
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 2: 14426.643534925734/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [1, 1, 4, 1], [1, 1, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*Y
iteration=1: 12443.319621993873/14401.294250511062
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 3: 14401.294250511062/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 13576.969789763929/25437.06487850397
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 4: 25437.06487850397/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 11483.364825937973/11483.364825937973
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 5: 11483.364825937973/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [1, 1, 2, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 4280.418224605369/23720.70037360382
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 6: 23720.70037360382/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 21319.380023349862/21319.380023349862
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 7: 21319.380023349862/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 14769.914717898397/15920.155851199206
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 8: 15920.155851199206/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 34351.04755994305/34351.04755994305
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 9: 34351.04755994305/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 1, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[196, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 5574.575864346029/37066.19633169733
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 10: 37066.19633169733/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [7, 2, 2, 1]], "reduce_factors": [[2, 1, 16]], "last_factors": [[392, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 3480.980324265477/14128.727200863004
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 11: 14128.727200863004/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 3250.6175188704597/18052.205921128745
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 12: 18052.205921128745/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 10990.577805878787/30610.955266009743
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 13: 30610.955266009743/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11442.752989750046/37834.748423347526
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 14: 37834.748423347526/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 6017.180397497214/18294.62417580691
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 15: 18294.62417580691/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 1272.1224080241684/19968.894483783984
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 16: 19968.894483783984/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 14], [2, 1, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.E.Y
*E*Y
iteration=1: 18301.6179148207/26081.150480228338
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 17: 26081.150480228338/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 4]], "last_factors": [[49, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 26445.26550693411/44226.35255363897
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 18: 44226.35255363897/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 6675.671966212535/22042.82291325643
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 19: 22042.82291325643/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 15692.35536302537/17273.101672926856
Best record value:44226.35255363897 (larger is better)
Round 1, Match 1, Mapping 20: 17273.101672926856/44226.35255363897(0.022610953475920757 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [2, 1, 2, 1]], "reduce_factors": [[2, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 33 schedules
mapping (0,0,0,0,1,1,0): explored 30 schedules
mapping (0,0,0,0,1,1,1): explored 24 schedules
mapping (0,0,0,1,0,0,0): explored 22 schedules
mapping (0,0,0,1,0,0,1): explored 38 schedules
mapping (0,0,0,1,0,1,0): explored 28 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 29 schedules
mapping (0,0,1,0,1,1,1): explored 34 schedules
mapping (0,0,1,1,0,0,0): explored 36 schedules
mapping (0,1,0,0,0,1,0): explored 27 schedules
mapping (0,1,0,1,0,0,0): explored 32 schedules
mapping (0,1,0,1,0,0,1): explored 38 schedules
mapping (0,1,0,1,1,0,0): explored 29 schedules
mapping (1,0,0,0,0,1,0): explored 36 schedules
mapping (1,0,0,1,0,0,0): explored 30 schedules
mapping (1,0,0,1,0,1,0): explored 35 schedules
Original weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 50, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 15712.535103744423/15712.535103744423
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 1: 15712.535103744423/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 1, 1, 2], [1, 1, 1, 1], [2, 1, 7, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 5824.602386657321/14426.643534925734
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 2: 14426.643534925734/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [1, 1, 4, 1], [1, 1, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1891.455899172485/14401.294250511062
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 3: 14401.294250511062/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 237.36205045757967/25437.06487850397
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 4: 25437.06487850397/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14154.29869689935/14154.29869689935
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 5: 14154.29869689935/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": [2, 1], "spatial_factors": [[[4, 1, 1, 1], [1, 0, 0]], [[1, 2, 2, 1], [0, 1, 0]], [[8, 8, 1, 2], [-1, 1, 0]], [[14, 1, 1, 2], [1, -1, 0]]], "reduce_factors": [[[16, 1, 2], [1, -1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[512, 196, 4], [1, -1]]], "output_unroll_step": [16, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 3401.9672798316074/23720.70037360382
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 6: 23720.70037360382/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 9721.318756018925/21319.380023349862
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 7: 21319.380023349862/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 2, 1], [1, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 98, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 7176.558337485248/15920.155851199206
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 8: 15920.155851199206/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*E*E
iteration=1: 1e-10/34351.04755994305
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 9: 34351.04755994305/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 1, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[196, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6795.093421106315/37066.19633169733
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 10: 37066.19633169733/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [7, 2, 2, 1]], "reduce_factors": [[2, 1, 16]], "last_factors": [[392, 2, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 10370.403656556004/14128.727200863004
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 11: 14128.727200863004/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[4, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 865.8756775702145/18052.205921128745
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 12: 18052.205921128745/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/30610.955266009743
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 13: 30610.955266009743/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 14244.958002806456/37834.748423347526
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 14: 37834.748423347526/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [7, 2, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 7466.329330702393/18294.62417580691
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 15: 18294.62417580691/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 3995.746309777406/19968.894483783984
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 16: 19968.894483783984/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 14], [2, 1, 2, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 11229.334255520305/26081.150480228338
Best record value:44226.35255363897 (larger is better)
Round 2, Match 1, Mapping 17: 26081.150480228338/44226.35255363897(0.022610953475920757 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 4]], "last_factors": [[49, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 46155.819215145304/46155.819215145304
Best record value:46155.819215145304 (larger is better)
Round 2, Match 1, Mapping 18: 46155.819215145304/46155.819215145304(0.0216657404635961 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*E
iteration=1: 12096.861369170001/22042.82291325643
Best record value:46155.819215145304 (larger is better)
Round 2, Match 1, Mapping 19: 22042.82291325643/46155.819215145304(0.0216657404635961 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [1, 2, 2, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 31756.668209530275/31756.668209530275
Best record value:46155.819215145304 (larger is better)
Round 2, Match 1, Mapping 20: 31756.668209530275/46155.819215145304(0.0216657404635961 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [2, 2, 1, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.5157742615338219, 0.025485565182430423, 0.025485565182430423]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 35 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 25 schedules
mapping (0,0,0,1,0,0,0): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 40 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 33 schedules
mapping (0,0,1,0,0,1,0): explored 28 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 33 schedules
mapping (0,0,1,0,1,1,1): explored 38 schedules
mapping (0,0,1,1,0,0,0): explored 36 schedules
mapping (0,1,0,0,0,1,0): explored 29 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 39 schedules
mapping (0,1,0,1,1,0,0): explored 31 schedules
mapping (1,0,0,0,0,1,0): explored 38 schedules
mapping (1,0,0,1,0,0,0): explored 32 schedules
mapping (1,0,0,1,0,1,0): explored 39 schedules
Tensorize use time 633.381073474884 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [512] [512] [1, 512, 28, 28] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph51.log by 200 trials...
.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N

Currently best performance: 0.00405159175180237
.N.N.N.N.N.Y.E.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.00405159175180237
.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.B.N.N.N.N.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.004041457602309105
.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N

Currently best performance: 0.004041457602309105
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.004041457602309105
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.E.N.N.N.N

Currently best performance: 0.004031409009914239
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004031409009914239
.Y.T.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.004031409009914239
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004031409009914239
.N.N.N.N.N.N.N.NSchedule cost 1058.726456 seconds
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[512, 256, 1, 1],body:R[1, 512, 28, 28] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [512, 256, 1, 1] [1, 512, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph52/at:resnet50:subgraph52:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.2273459419597171, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.03758003144763057, 0.0962134919829326, 0.03758003144763057]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 23, 4, 4, 4, 4, 4, 4, 4, 4, 4, 10, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 2526.6579776395192/14808.756410973985
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 1: 14808.756410973985/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 2, 1, 4], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 16565.918224488454/30296.739799722767
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 2: 30296.739799722767/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [8, 1, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[196, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 17525.221109615137/17525.221109615137
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 3: 17525.221109615137/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 2, 7], [2, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 14, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 1576.5113287294846/27250.32972353314
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 4: 27250.32972353314/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 529.9088295139991/10977.675441929608
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 5: 10977.675441929608/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [16, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/11904.320927118997
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 6: 11904.320927118997/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 8754.457989769682/12446.251756298905
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 7: 12446.251756298905/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, -1]], [2, 4, 2, 1], [[128, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 4, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1482.628215980249/31392.028408144077
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 8: 31392.028408144077/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 23701.529654524224/37497.35297133777
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 9: 37497.35297133777/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [14, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*Y*E*E
iteration=1: 9732.197688775972/20732.404143420124
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 10: 20732.404143420124/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 29119.873243436734/29119.873243436734
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 11: 29119.873243436734/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 2, 4, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[896, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2475.800247484432/32238.100533406825
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 12: 32238.100533406825/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[448, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 15781.961987082856/25994.858065912853
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 13: 25994.858065912853/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 9068.588169251987/18589.33446709031
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 14: 18589.33446709031/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 9456.994626948426/21086.8508898989
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 15: 21086.8508898989/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 17152.301040941846/17152.301040941846
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 16: 17152.301040941846/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 14], [2, 4, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[98, 4, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 5667.297305688297/20478.509400152692
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 17: 20478.509400152692/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 1, 1, 4], [7, 1, 4, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 5776.97531588647/12409.74095891379
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 18: 12409.74095891379/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 2040.010844647894/28756.265656913532
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 19: 28756.265656913532/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 31368.829237953898/31368.829237953898
Best record value:37497.35297133777 (larger is better)
Round 1, Match 1, Mapping 20: 31368.829237953898/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.3525649685969398, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.06261487980265701, 0.032490008422244594]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 30 schedules
mapping (0,0,0,0,0,1,1): explored 34 schedules
mapping (0,0,0,0,1,1,0): explored 31 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 43 schedules
mapping (0,0,0,1,0,0,1): explored 33 schedules
mapping (0,0,0,1,0,1,0): explored 23 schedules
mapping (0,0,0,1,1,0,0): explored 37 schedules
mapping (0,0,1,0,0,1,0): explored 34 schedules
mapping (0,0,1,0,0,1,1): explored 31 schedules
mapping (0,0,1,0,1,1,0): explored 39 schedules
mapping (0,0,1,0,1,1,1): explored 28 schedules
mapping (0,0,1,1,0,0,0): explored 27 schedules
mapping (0,1,0,0,0,1,0): explored 28 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 31 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 39 schedules
mapping (1,0,0,1,0,0,0): explored 31 schedules
mapping (1,0,0,1,0,1,0): explored 31 schedules
Original weights [0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.3525649685969398, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.032490008422244594, 0.06261487980265701, 0.032490008422244594]
Original trials for each mapping [4, 4, 4, 4, 4, 4, 4, 4, 36, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 27225.524776508057/27225.524776508057
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 1: 27225.524776508057/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 2], [4, 2, 2, 1], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 6980.281105280736/30296.739799722767
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 2: 30296.739799722767/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [8, 1, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[196, 32, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 1892.3207091869704/17525.221109615137
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 3: 17525.221109615137/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 2, 7], [2, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 14, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 1935.5726836186375/27250.32972353314
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 4: 27250.32972353314/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[14, 112, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 5070.522214872506/10977.675441929608
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 5: 10977.675441929608/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [16, 1, 1, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 2, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 2363.215581910193/11904.320927118997
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 6: 11904.320927118997/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 4705.040132434912/12446.251756298905
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 7: 12446.251756298905/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[49, 1, 1, 2], [0, 0, -1]], [2, 4, 2, 1], [[128, 1, 1, 1], [0, 0, 0]]], "reduce_factors": [[[1, 4, 4], [0, 1]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 4], [1, -1]]], "output_unroll_step": [64, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 853.8120122406938/31392.028408144077
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 8: 31392.028408144077/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 15822.548634301915/37497.35297133777
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 9: 37497.35297133777/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 1, 4, 2], [14, 1, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[448, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 3889.453804002304/20732.404143420124
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 10: 20732.404143420124/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[1, 2, 8]], "last_factors": [[784, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 16352.88830822422/29119.873243436734
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 11: 29119.873243436734/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 2, 4, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[896, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2769.788504489374/32238.100533406825
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 12: 32238.100533406825/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[448, 14, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 10503.518168755067/25994.858065912853
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 13: 25994.858065912853/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[64, 7, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 9974.246876236328/18589.33446709031
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 14: 18589.33446709031/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*Y*E*Y
iteration=1: 8647.306987713877/21086.8508898989
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 15: 21086.8508898989/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 2], [7, 4, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 24409.553637214165/24409.553637214165
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 16: 24409.553637214165/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 1, 1, 7], [4, 4, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[112, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 1678.0177039897105/20478.509400152692
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 17: 20478.509400152692/37497.35297133777(0.026668549131038128 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 1, 1, 4], [7, 1, 4, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/12409.74095891379
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 18: 12409.74095891379/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [2, -1], "spatial_factors": [[[2, 224, 1, 1], [1, 1, -1]], [8, 1, 1, 2], [[14, 1, 2, 1], [-1, 0, 1]]], "reduce_factors": [[[1, 16, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [16, -1], "last_unroll_step": [512, -1]}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 2195.6670373511556/28756.265656913532
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 19: 28756.265656913532/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [8, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 609.9659642202313/31368.829237953898
Best record value:37497.35297133777 (larger is better)
Round 2, Match 1, Mapping 20: 31368.829237953898/37497.35297133777(0.026668549131038128 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 2, 1], [8, 1, 2, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.4450845574216331, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.028293586843124333, 0.04563087940212862, 0.028293586843124333]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 31 schedules
mapping (0,0,0,0,0,1,1): explored 38 schedules
mapping (0,0,0,0,1,1,0): explored 33 schedules
mapping (0,0,0,0,1,1,1): explored 35 schedules
mapping (0,0,0,1,0,0,0): explored 46 schedules
mapping (0,0,0,1,0,0,1): explored 35 schedules
mapping (0,0,0,1,0,1,0): explored 27 schedules
mapping (0,0,0,1,1,0,0): explored 38 schedules
mapping (0,0,1,0,0,1,0): explored 35 schedules
mapping (0,0,1,0,0,1,1): explored 33 schedules
mapping (0,0,1,0,1,1,0): explored 42 schedules
mapping (0,0,1,0,1,1,1): explored 32 schedules
mapping (0,0,1,1,0,0,0): explored 30 schedules
mapping (0,1,0,0,0,1,0): explored 32 schedules
mapping (0,1,0,1,0,0,0): explored 37 schedules
mapping (0,1,0,1,0,0,1): explored 35 schedules
mapping (0,1,0,1,1,0,0): explored 28 schedules
mapping (1,0,0,0,0,1,0): explored 39 schedules
mapping (1,0,0,1,0,0,0): explored 32 schedules
mapping (1,0,0,1,0,1,0): explored 33 schedules
Tensorize use time 623.9478693008423 s.
#############################################
operations:inputs:[1, 128, 56, 56],[128],[128],body:S[1, 128, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 56, 56],body:S[1, 128, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 56, 56],body:S[1, 128, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 58, 58],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 56, 56] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph54/at:resnet50:subgraph54:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.02899518593384574, 0.4490914672569309, 0.02899518593384574, 0.02899518593384574]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 45, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 7935.330146312466/7935.330146312466
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 1: 7935.330146312466/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 1, 4], [3, 1, 1], [3, 1, 1]], "last_factors": [[392, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 177.59106800040578/3227.1956924719566
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 2: 3227.1956924719566/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[28, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1383.5279485651172
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 3: 1383.5279485651172/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 3921.027560079249/3921.027560079249
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 4: 3921.027560079249/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[36, 2, 1]], "last_factors": [[14, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 2261.9856771066925/3361.5806347518524
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 5: 3361.5806347518524/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 662.8046225839053/5021.392471767626
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 6: 5021.392471767626/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 419.16942391036247/16091.638917716718
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 7: 16091.638917716718/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2397.683146172233/3670.7454211904846
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 8: 3670.7454211904846/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [2, 7, 1, 2]], "reduce_factors": [[2, 6, 2], [3, 1, 1]], "last_factors": [[4, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/4294.620319983427
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 9: 4294.620319983427/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": [1, 1], "vectorize": [1, -1], "spatial_factors": [[2, 1, 2, 1], [[2, 1, 2, 1], [-1, 0, 1]], [[7, 2, 2, 1], [0, -1, 1]]], "reduce_factors": [[[4, 2, 3], [-1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[4, 12544, 8], [0, -1]]], "output_unroll_step": [1500, 1], "last_unroll_step": [512, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 69.0323062118775/2607.358965154263
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 10: 2607.358965154263/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [1, 1, 2, 2], [2, 7, 1, 2]], "reduce_factors": [[12, 2, 3]], "last_factors": [[32, 98, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 520.1739514516272/9261.296800165035
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 11: 9261.296800165035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [4, 1, 1, 1]], "reduce_factors": [[2, 4, 3], [3, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 2085.8499305120336/2411.3107152370035
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 12: 2411.3107152370035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 1, 2]], "reduce_factors": [[9, 8, 1]], "last_factors": [[8, 392, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 4034.7523542364097/4521.522362346432
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 13: 4521.522362346432/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [1, 2, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[64, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2636.4584391461667
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 14: 2636.4584391461667/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 2, 1], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 1184.429891285233/4215.9753120017185
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 15: 4215.9753120017185/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [1, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[3, 8, 1], [3, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1875.91044028376
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 16: 1875.91044028376/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 16762.32481931678/16762.32481931678
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 17: 16762.32481931678/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 1], [28, 1, 1, 1]], "reduce_factors": [[18, 4, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 20655.166103829102/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/12912.867797767763
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 19: 12912.867797767763/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 2053.394692099084/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 1, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 28 schedules
mapping (0,0,0,0,0,1,1): explored 15 schedules
mapping (0,0,0,0,1,1,0): explored 46 schedules
mapping (0,0,0,0,1,1,1): explored 32 schedules
mapping (0,0,0,1,0,0,0): explored 27 schedules
mapping (0,0,0,1,0,0,1): explored 19 schedules
mapping (0,0,0,1,0,1,0): explored 29 schedules
mapping (0,0,0,1,1,0,0): explored 28 schedules
mapping (0,0,1,0,0,1,0): explored 19 schedules
mapping (0,0,1,0,0,1,1): explored 13 schedules
mapping (0,0,1,0,1,1,0): explored 27 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 22 schedules
mapping (0,1,0,0,0,1,0): explored 20 schedules
mapping (0,1,0,1,0,0,0): explored 24 schedules
mapping (0,1,0,1,0,0,1): explored 17 schedules
mapping (0,1,0,1,1,0,0): explored 26 schedules
mapping (1,0,0,0,0,1,0): explored 29 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 23 schedules
Original weights [0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.026511792210549126, 0.49627594799956665, 0.026511792210549126, 0.026511792210549126]
Original trials for each mapping [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 50, 3, 3]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 2124.166051689095/7935.330146312466
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 1: 7935.330146312466/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[2, 1, 4], [3, 1, 1], [3, 1, 1]], "last_factors": [[392, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 4889.840356492042/4889.840356492042
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 2: 4889.840356492042/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [2, 1, 2, 1], [1, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[4, 196, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*Y
iteration=1: 19717.16522732397/19717.16522732397
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 3: 19717.16522732397/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[6, 1, 4], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 7430.540059079307/7430.540059079307
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 4: 7430.540059079307/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[98, 1, 1, 1], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[18, 4, 1]], "last_factors": [[16, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 1168.2102064773426/3361.5806347518524
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 5: 3361.5806347518524/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[1, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 1046.7213594436391/5021.392471767626
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 6: 5021.392471767626/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 2, 1], [1, 3, 1]], "last_factors": [[448, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 7702.295486818682/16091.638917716718
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 7: 16091.638917716718/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[49, 1, 2, 1], [1, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 3], [3, 1, 1]], "last_factors": [[14, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 7524.602001589455/7524.602001589455
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 8: 7524.602001589455/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 4], [1, 2, 1, 2], [1, 1, 1, 1], [4, 1, 7, 1]], "reduce_factors": [[6, 1, 4], [3, 1, 1]], "last_factors": [[224, 2, 7]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 13777.920501416103/13777.920501416103
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 9: 13777.920501416103/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [4, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[3, 4, 2], [3, 1, 1]], "last_factors": [[14, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3415.3568473213677/3415.3568473213677
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 10: 3415.3568473213677/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": [0, -1], "vectorize": [1, -1], "spatial_factors": [[[64, 1, 1, 7], [1, 0, 0]], [[1, 4, 1, 1], [0, 0, 0]], [7, 1, 4, 1]], "reduce_factors": [[[18, 2, 2], [0, 0]]], "last_factors": [[[3584, 56, 2], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, 1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 176.38311009804804/9261.296800165035
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 11: 9261.296800165035/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [4, 1, 1, 1]], "reduce_factors": [[2, 4, 3], [3, 1, 1]], "last_factors": [[4, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2583.4255236663025/2583.4255236663025
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 12: 2583.4255236663025/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [2, 1, 2, 1]], "reduce_factors": [[9, 1, 8]], "last_factors": [[49, 2, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 2711.568562326048/4521.522362346432
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 13: 4521.522362346432/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [1, 2, 2, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[64, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 1372.3843461283534/2636.4584391461667
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 14: 2636.4584391461667/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [2, 1, 2, 7]], "reduce_factors": [[12, 2, 1], [3, 1, 1]], "last_factors": [[7, 56, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 4942.378938310418/4942.378938310418
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 15: 4942.378938310418/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 2], [4, 1, 1, 7]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[224, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 1137.4425917081633/1875.91044028376
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 16: 1875.91044028376/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[14, 7, 1, 1], [[2, 1, 1, 2], [0, 0, 0]]], "reduce_factors": [[[6, 1, 4], [1, 0]], [[3, 1, 1], [0, 0]]], "last_factors": [[[3584, 112, 1], [-1, 1]]], "output_unroll_step": [16, -1], "last_unroll_step": [1500, 1]}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*E*Y*E
iteration=1: 94.3047504796336/16762.32481931678
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 17: 16762.32481931678/21742.738697325945(0.04599236618351975 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 1], [28, 1, 1, 1]], "reduce_factors": [[18, 4, 1]], "last_factors": [[1568, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1925.344970686143/21742.738697325945
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 18: 21742.738697325945/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[784, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/12912.867797767763
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 19: 12912.867797767763/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [1, 1, 3], [1, 3, 1]], "last_factors": [[196, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 4347.694639634172/14151.93817815408
Best record value:21742.738697325945 (larger is better)
Round 2, Match 1, Mapping 20: 14151.93817815408/21742.738697325945(0.04599236618351975 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[8, 14, 28]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.025485565182430423, 0.5157742615338219, 0.025485565182430423, 0.025485565182430423]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 29 schedules
mapping (0,0,0,0,0,1,1): explored 16 schedules
mapping (0,0,0,0,1,1,0): explored 47 schedules
mapping (0,0,0,0,1,1,1): explored 34 schedules
mapping (0,0,0,1,0,0,0): explored 30 schedules
mapping (0,0,0,1,0,0,1): explored 20 schedules
mapping (0,0,0,1,0,1,0): explored 31 schedules
mapping (0,0,0,1,1,0,0): explored 29 schedules
mapping (0,0,1,0,0,1,0): explored 22 schedules
mapping (0,0,1,0,0,1,1): explored 18 schedules
mapping (0,0,1,0,1,1,0): explored 28 schedules
mapping (0,0,1,0,1,1,1): explored 33 schedules
mapping (0,0,1,1,0,0,0): explored 26 schedules
mapping (0,1,0,0,0,1,0): explored 22 schedules
mapping (0,1,0,1,0,0,0): explored 25 schedules
mapping (0,1,0,1,0,0,1): explored 20 schedules
mapping (0,1,0,1,1,0,0): explored 27 schedules
mapping (1,0,0,0,0,1,0): explored 34 schedules
mapping (1,0,0,1,0,0,0): explored 20 schedules
mapping (1,0,0,1,0,1,0): explored 25 schedules
Tensorize use time 866.1844227313995 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[128, 256, 1, 1],body:R[1, 128, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [128, 256, 1, 1] [1, 128, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph55/at:resnet50:subgraph55:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.0412372831838123, 0.11209455753357675, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.09177526150540846, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.0412372831838123, 0.06267584451696966, 0.07365780550304805, 0.0412372831838123]
Original trials for each mapping [5, 12, 5, 5, 5, 5, 5, 5, 5, 5, 5, 10, 5, 5, 5, 5, 5, 7, 8, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 8552.522829420437/19903.947737077124
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 1: 19903.947737077124/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.E.Y
*E*E
iteration=1: 1e-10/29577.030565626723
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 2: 29577.030565626723/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[196, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 11941.626209840177/21135.128988535304
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 3: 21135.128988535304/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 4, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[224, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 27557.697576694045/27557.697576694045
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 4: 27557.697576694045/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[784, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1279.3237469087367/12798.247402744511
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 5: 12798.247402744511/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 2], [1, 1, 1, 1], [1, 8, 7, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 11324.067586316993/11324.067586316993
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 6: 11324.067586316993/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 4, 1, 2], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 4], [1, 1, 1]], "last_factors": [[1568, 1, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14702.731699713982/16151.415695502232
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 7: 16151.415695502232/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 4, 2, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*E
iteration=1: 9660.040389509753/13459.39381449475
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 8: 13459.39381449475/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 1874.2429721832968/15336.34068216761
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 9: 15336.34068216761/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1312.8970546500968/21365.35590078082
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 10: 21365.35590078082/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 2, 7, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 24948.271020729026/24948.271020729026
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 11: 24948.271020729026/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 1, 2, 7], [2, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[56, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.E
*Y*E
iteration=1: 10193.343141633086/29126.09114784877
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 12: 29126.09114784877/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [2, 1, 2, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/5073.633407938291
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 13: 5073.633407938291/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 2], [7, 2, 2, 2]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[1792, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*Y
iteration=1: 24671.90447314622/24671.90447314622
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 14: 24671.90447314622/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[56, 8, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 23670.80458072038/23670.80458072038
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 15: 23670.80458072038/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 1716.6676293712308/11521.582180068463
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 16: 11521.582180068463/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 7, 7], [1, 2, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[64, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 7939.089374415283/15714.479580726029
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 17: 15714.479580726029/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 4]], "last_factors": [[896, 2, 7]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 8218.686957236672/23397.430823519346
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 18: 23397.430823519346/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 28092.449765846173/28092.449765846173
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 19: 28092.449765846173/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 2, 1], [14, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*Y
iteration=1: 3917.1291550360834/25530.069945293042
Best record value:29577.030565626723 (larger is better)
Round 1, Match 1, Mapping 20: 25530.069945293042/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 7, 2, 1], [1, 1, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.0374153160025092, 0.22634947158478894, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.06696283158458485, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.050941541373561626, 0.057101099416917184, 0.0374153160025092]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 40 schedules
mapping (0,0,0,0,0,1,1): explored 22 schedules
mapping (0,0,0,0,1,1,0): explored 40 schedules
mapping (0,0,0,0,1,1,1): explored 31 schedules
mapping (0,0,0,1,0,0,0): explored 28 schedules
mapping (0,0,0,1,0,0,1): explored 50 schedules
mapping (0,0,0,1,0,1,0): explored 33 schedules
mapping (0,0,0,1,1,0,0): explored 30 schedules
mapping (0,0,1,0,0,1,0): explored 32 schedules
mapping (0,0,1,0,0,1,1): explored 26 schedules
mapping (0,0,1,0,1,1,0): explored 46 schedules
mapping (0,0,1,0,1,1,1): explored 30 schedules
mapping (0,0,1,1,0,0,0): explored 38 schedules
mapping (0,1,0,0,0,1,0): explored 24 schedules
mapping (0,1,0,1,0,0,0): explored 35 schedules
mapping (0,1,0,1,0,0,1): explored 37 schedules
mapping (0,1,0,1,1,0,0): explored 22 schedules
mapping (1,0,0,0,0,1,0): explored 33 schedules
mapping (1,0,0,1,0,0,0): explored 29 schedules
mapping (1,0,0,1,0,1,0): explored 41 schedules
Original weights [0.0374153160025092, 0.22634947158478894, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.06696283158458485, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.0374153160025092, 0.050941541373561626, 0.057101099416917184, 0.0374153160025092]
Original trials for each mapping [4, 23, 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 4, 4, 4, 4, 4, 6, 6, 4]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 7653.548262349639/19903.947737077124
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 1: 19903.947737077124/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 14, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 28730.909896391866/29577.030565626723
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 2: 29577.030565626723/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[196, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 21143.850438047786/21143.850438047786
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 3: 21143.850438047786/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 4, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1]], "last_factors": [[224, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 8166.015985389291/27557.697576694045
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 4: 27557.697576694045/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[784, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 17823.622761020484/17823.622761020484
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 5: 17823.622761020484/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": [0, -1], "vectorize": [2, -1], "spatial_factors": [[7, 1, 1, 1], [[1, 1, 1, 4], [0, -1, -1]], [[1, 32, 4, 1], [0, 1, 1]], [[7, 1, 4, 2], [0, -1, 1]]], "reduce_factors": [[[16, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[4096, 49, 8], [0, 0]]], "output_unroll_step": [512, -1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 13199.883619314603/13199.883619314603
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 6: 13199.883619314603/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 2, 14, 1], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[32, 49, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 18173.467026283226/18173.467026283226
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 7: 18173.467026283226/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 1, 7, 1], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 19134.563500863464/19134.563500863464
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 8: 19134.563500863464/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": [4, 1], "spatial_factors": [[[7, 1, 1, 1], [0, 0, 0]], [[1, 4, 1, 1], [0, 0, 0]], [[2, 32, 2, 1], [1, 0, 1]], [[14, 2, 2, 1], [1, 1, 1]]], "reduce_factors": [[[1, 2, 8], [0, 0]], [[1, 1, 1], [0, 0]]], "last_factors": [[[14336, 56, 2], [0, 0]]], "output_unroll_step": [512, 1], "last_unroll_step": [64, -1]}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 18808.260637535244/18808.260637535244
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 9: 18808.260637535244/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 1], [2, 1, 4, 7]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[12544, 1, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 3196.374908110964/21365.35590078082
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 10: 21365.35590078082/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 2], [4, 2, 7, 1]], "reduce_factors": [[4, 4, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 10992.401607500633/24948.271020729026
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 11: 24948.271020729026/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 1, 2, 7], [2, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[56, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 12861.396096138476/29126.09114784877
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 12: 29126.09114784877/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [2, 1, 2, 1]], "reduce_factors": [[2, 8, 1]], "last_factors": [[112, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 4754.905760865619/5073.633407938291
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 13: 5073.633407938291/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 2], [7, 2, 2, 2]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[1792, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 4175.202720246456/24671.90447314622
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 14: 24671.90447314622/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[56, 8, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 13201.096697699486/23670.80458072038
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 15: 23670.80458072038/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1568, 2, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 7625.3950835172445/11521.582180068463
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 16: 11521.582180068463/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 1, 7, 7], [1, 2, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[64, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13226.233692482456/15714.479580726029
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 17: 15714.479580726029/29577.030565626723(0.033810020170252024 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 1], [7, 4, 1, 2]], "reduce_factors": [[1, 4, 4]], "last_factors": [[896, 2, 7]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 7569.76343027994/23397.430823519346
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 18: 23397.430823519346/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 2], [56, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 8, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 12067.32484030616/28092.449765846173
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 19: 28092.449765846173/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 2, 1], [14, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 5017.4059887582225/25530.069945293042
Best record value:29577.030565626723 (larger is better)
Round 2, Match 1, Mapping 20: 25530.069945293042/29577.030565626723(0.033810020170252024 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 7, 2, 1], [1, 1, 4, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.0322627923697773, 0.34975356543798297, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.04935950264418222, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.0322627923697773, 0.040594908357001414, 0.0440873456443971, 0.0322627923697773]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 43 schedules
mapping (0,0,0,0,0,1,1): explored 25 schedules
mapping (0,0,0,0,1,1,0): explored 42 schedules
mapping (0,0,0,0,1,1,1): explored 35 schedules
mapping (0,0,0,1,0,0,0): explored 31 schedules
mapping (0,0,0,1,0,0,1): explored 52 schedules
mapping (0,0,0,1,0,1,0): explored 36 schedules
mapping (0,0,0,1,1,0,0): explored 32 schedules
mapping (0,0,1,0,0,1,0): explored 34 schedules
mapping (0,0,1,0,0,1,1): explored 28 schedules
mapping (0,0,1,0,1,1,0): explored 50 schedules
mapping (0,0,1,0,1,1,1): explored 35 schedules
mapping (0,0,1,1,0,0,0): explored 39 schedules
mapping (0,1,0,0,0,1,0): explored 27 schedules
mapping (0,1,0,1,0,0,0): explored 39 schedules
mapping (0,1,0,1,0,0,1): explored 40 schedules
mapping (0,1,0,1,1,0,0): explored 27 schedules
mapping (1,0,0,0,0,1,0): explored 36 schedules
mapping (1,0,0,1,0,0,0): explored 32 schedules
mapping (1,0,0,1,0,1,0): explored 43 schedules
Tensorize use time 645.8160610198975 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [1, 256, 56, 56] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph56.log by 200 trials...
.Y.Y.Y.Y.Y.Y.E.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.E.Y.Y.E.Y.Y.Y.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.E.Y.E.N.N.N.N.N.N

Currently best performance: 0.007548796446567131
.N.Y.E.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.T.N.N.N.N

Currently best performance: 0.007548796446567131
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N

Currently best performance: 0.007504289093331477
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.E.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.007504289093331477
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.T.Y.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.007504289093331477
.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.007504289093331477
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.007504289093331477
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.007504289093331477
.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.007504289093331477
.N.N.N.N