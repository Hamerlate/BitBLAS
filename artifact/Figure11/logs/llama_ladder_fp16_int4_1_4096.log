Measure the memory for llama batch 1 seq 4096 under ladder_fp16_int4
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 142.029 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_layout_transform_ladder_layout_transform_2:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 137.83 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_ladder_perfect_quant_linear_3_layout_transform_reshape_reshape_reshape_transpose_4:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2051.89 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 102.912 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_ladder_perfect_quant_linear_6:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 352.256 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_7:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 15.1088 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 61.5604 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_nn_batch_matmul_9_reshape_divide_10:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 3374.8 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_max_11_subtract_exp_12:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2049.54 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_sum_13_divide_cast_cast_reshape_14:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 83.0719 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_ladder_perfect_quant_linear_15:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 352.358 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 99.072 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_nn_batch_matmul_17_reshape_transpose_reshape_reshape_layout_transform_ladder_layout_transform_18:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 1498.11 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_ladder_perfect_quant_linear_19_layout_transform_reshape_reshape_add_20:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2169.75 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 142.643 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_multiply_cast_multiply_23:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 131.891 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_reshape_layout_transform_ladder_layout_transform_24:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 101.888 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_ladder_perfect_quant_linear_25_layout_transform_reshape_reshape_26:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 6944.56 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_ladder_perfect_quant_linear_27_sigmoid_multiply_layout_transform_reshape_reshape_multiply_reshape_layout_transform_ladder_layout_transform_28:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7490.05 us/iter
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #19 tvmgen_welder_ladder_perfect_quant_linear_29_layout_transform_reshape_reshape_add_30:
[08:28:18] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7232.41 us/iter
Testing model: llama2-70b
Running from prebuilt model: /root/Ladder/artifact/Figure11/../checkpoints/Figure11/ladder/checkpoints/llama2-70b/llama2_fq_0_int_4_-1_bs1_seq4096_ci_False_async
Execution time summary:
 mean (ms)   median (ms)    max (ms)     min (ms)     std (ms)  
  34.3901      34.3897      34.3945      34.3852       0.0032   
               
Node Name                                                                                                                                                    Ops                                                                                                                                                          Time(us)   Time(%)  Shape                Inputs  Outputs  Measurements(us)  
---------                                                                                                                                                    ---                                                                                                                                                          --------   -------  -----                ------  -------  ----------------  
tvmgen_welder_ladder_perfect_quant_linear_27_sigmoid_multiply_layout_transform_reshape_reshape_multiply_reshape_layout_transform_ladder_layout_transform_28  tvmgen_welder_ladder_perfect_quant_linear_27_sigmoid_multiply_layout_transform_reshape_reshape_multiply_reshape_layout_transform_ladder_layout_transform_28  7490.048   21.689   (256, 1792, 16, 16)  3       1        [7490.048]        
tvmgen_welder_ladder_perfect_quant_linear_29_layout_transform_reshape_reshape_add_30                                                                         tvmgen_welder_ladder_perfect_quant_linear_29_layout_transform_reshape_reshape_add_30                                                                         7232.41    20.943   (1, 4096, 8192)      3       1        [7232.41]         
tvmgen_welder_ladder_perfect_quant_linear_25_layout_transform_reshape_reshape_26                                                                             tvmgen_welder_ladder_perfect_quant_linear_25_layout_transform_reshape_reshape_26                                                                             6944.563   20.11    (1, 4096, 28672)     2       1        [6944.563]        
tvmgen_welder_nn_batch_matmul_9_reshape_divide_10                                                                                                            tvmgen_welder_nn_batch_matmul_9_reshape_divide_10                                                                                                            3374.797   9.772    (1, 64, 4096, 4096)  2       1        [3374.797]        
tvmgen_welder_ladder_perfect_quant_linear_19_layout_transform_reshape_reshape_add_20                                                                         tvmgen_welder_ladder_perfect_quant_linear_19_layout_transform_reshape_reshape_add_20                                                                         2169.754   6.283    (1, 4096, 8192)      3       1        [2169.754]        
tvmgen_welder_ladder_perfect_quant_linear_3_layout_transform_reshape_reshape_reshape_transpose_4                                                             tvmgen_welder_ladder_perfect_quant_linear_3_layout_transform_reshape_reshape_reshape_transpose_4                                                             2051.891   5.942    (1, 64, 4096, 128)   2       1        [2051.891]        
tvmgen_welder_max_11_subtract_exp_12                                                                                                                         tvmgen_welder_max_11_subtract_exp_12                                                                                                                         2049.536   5.935    (1, 64, 4096, 4096)  2       1        [2049.536]        
tvmgen_welder_nn_batch_matmul_17_reshape_transpose_reshape_reshape_layout_transform_ladder_layout_transform_18                                               tvmgen_welder_nn_batch_matmul_17_reshape_transpose_reshape_reshape_layout_transform_ladder_layout_transform_18                                               1498.112   4.338    (256, 512, 16, 16)   2       1        [1498.112]        
tvmgen_welder_ladder_perfect_quant_linear_15                                                                                                                 tvmgen_welder_ladder_perfect_quant_linear_15                                                                                                                 352.358    1.02     (256, 64, 16, 16)    2       1        [352.358]         
tvmgen_welder_ladder_perfect_quant_linear_6                                                                                                                  tvmgen_welder_ladder_perfect_quant_linear_6                                                                                                                  352.256    1.02     (256, 64, 16, 16)    2       1        [352.256]         
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                       tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                       142.643    0.413    (1, 4096, 8192)      1       2        [142.643]         
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                       tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                       142.643    0.413    (1, 4096, 1)         1       2        [142.643]         
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                         tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                         142.029    0.411    (1, 4096, 8192)      1       2        [142.029]         
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                         tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                         142.029    0.411    (1, 4096, 1)         1       2        [142.029]         
tvmgen_welder_multiply_cast_multiply_reshape_layout_transform_ladder_layout_transform_2                                                                      tvmgen_welder_multiply_cast_multiply_reshape_layout_transform_ladder_layout_transform_2                                                                      137.83     0.399    (256, 512, 16, 16)   3       1        [137.83]          
tvmgen_welder_multiply_cast_multiply_23                                                                                                                      tvmgen_welder_multiply_cast_multiply_23                                                                                                                      131.891    0.382    (1, 4096, 8192)      3       1        [131.891]         
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                               tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                               102.912    0.298    (64, 4096, 128)      3       1        [102.912]         
tvmgen_welder_reshape_layout_transform_ladder_layout_transform_24                                                                                            tvmgen_welder_reshape_layout_transform_ladder_layout_transform_24                                                                                            101.888    0.295    (256, 512, 16, 16)   1       1        [101.888]         
tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16                                       tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16                                       99.072     0.287    (64, 128, 4096)      1       1        [99.072]          
tvmgen_welder_sum_13_divide_cast_cast_reshape_14                                                                                                             tvmgen_welder_sum_13_divide_cast_cast_reshape_14                                                                                                             83.072     0.241    (64, 4096, 4096)     2       1        [83.072]          
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8          tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8          61.56      0.178    (64, 4096, 128)      3       1        [61.56]           
tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_7                                                                                           tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_7                                                                                           15.109     0.044    (1, 8, 4096, 128)    1       1        [15.109]          
Total_time                                                                                                                                                   -                                                                                                                                                            34533.731  -        -                    -       -        -                 [08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 142.95 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_layout_transform_ladder_layout_transform_2:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 137.626 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_ladder_perfect_quant_linear_3_layout_transform_reshape_reshape_reshape_transpose_4:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2053.02 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 102.912 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_ladder_perfect_quant_linear_6:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 351.744 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_7:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 15.1064 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 61.2592 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_nn_batch_matmul_9_reshape_divide_10:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 3374.59 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_max_11_subtract_exp_12:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2044.72 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_sum_13_divide_cast_cast_reshape_14:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 82.6879 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_ladder_perfect_quant_linear_15:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 352.051 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_layout_transform_reshape_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 98.6239 us/iter
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_nn_batch_matmul_17_reshape_transpose_reshape_reshape_layout_transform_ladder_layout_transform_18:
[08:28:33] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 1498.93 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_ladder_perfect_quant_linear_19_layout_transform_reshape_reshape_add_20:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 2169.86 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 141.926 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_multiply_cast_multiply_23:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 132.096 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_reshape_layout_transform_ladder_layout_transform_24:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 102.298 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_ladder_perfect_quant_linear_25_layout_transform_reshape_reshape_26:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 6947.02 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_ladder_perfect_quant_linear_27_sigmoid_multiply_layout_transform_reshape_reshape_multiply_reshape_layout_transform_ladder_layout_transform_28:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7493.53 us/iter
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #19 tvmgen_welder_ladder_perfect_quant_linear_29_layout_transform_reshape_reshape_add_30:
[08:28:34] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7232.72 us/iter
{'llama_ladder_fp16_int4_1_4096': 5192}
