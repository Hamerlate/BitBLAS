Measure the memory for llama batch 1 seq 1 under ladder
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.30852 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_2:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.42279 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_nn_dense_3:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 84.9279 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_reshape_reshape_transpose_4:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.45918 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.42521 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_nn_dense_6:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 12.8923 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_reshape_reshape_transpose_7:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.35549 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.48418 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_nn_dense_15:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 12.9091 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.82736 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_nn_dense_19:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 85.9519 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_reshape_add_20:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.40356 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.12721 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_multiply_cast_multiply_23_reshape_24:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.41065 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_nn_dense_25_reshape_26:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 268.595 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_nn_dense_27:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 269.312 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.80287 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_nn_dense_29:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 274.227 us/iter
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_reshape_add_30:
[19:23:43] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.39124 us/iter
Testing model: llama2-70b
Running from prebuilt model: /root/Ladder/artifact/Figure11/../checkpoints/Figure11/ladder/checkpoints/llama2-70b/llama2_bs1_seq1_async
Execution time summary:
 mean (ms)   median (ms)    max (ms)     min (ms)     std (ms)  
   1.0285       1.0285       1.0286       1.0283       0.0001   
               
Node Name                                                                                                                                                                                                                                          Ops                                                                                                                                                                                                                                                Time(us)  Time(%)  Shape            Inputs  Outputs  Measurements(us)  
---------                                                                                                                                                                                                                                          ---                                                                                                                                                                                                                                                --------  -------  -----            ------  -------  ----------------  
tvmgen_welder_nn_dense_29                                                                                                                                                                                                                          tvmgen_welder_nn_dense_29                                                                                                                                                                                                                          274.227   24.834   (1, 8192)        2       1        [274.227]         
tvmgen_welder_nn_dense_27                                                                                                                                                                                                                          tvmgen_welder_nn_dense_27                                                                                                                                                                                                                          269.312   24.389   (1, 28672)       2       1        [269.312]         
tvmgen_welder_nn_dense_25_reshape_26                                                                                                                                                                                                               tvmgen_welder_nn_dense_25_reshape_26                                                                                                                                                                                                               268.595   24.324   (1, 1, 28672)    2       1        [268.595]         
tvmgen_welder_nn_dense_19                                                                                                                                                                                                                          tvmgen_welder_nn_dense_19                                                                                                                                                                                                                          85.952    7.784    (1, 8192)        2       1        [85.952]          
tvmgen_welder_nn_dense_3                                                                                                                                                                                                                           tvmgen_welder_nn_dense_3                                                                                                                                                                                                                           84.928    7.691    (1, 8192)        2       1        [84.928]          
tvmgen_welder_nn_dense_15                                                                                                                                                                                                                          tvmgen_welder_nn_dense_15                                                                                                                                                                                                                          12.909    1.169    (1, 1024)        2       1        [12.909]          
tvmgen_welder_nn_dense_6                                                                                                                                                                                                                           tvmgen_welder_nn_dense_6                                                                                                                                                                                                                           12.892    1.168    (1, 1024)        2       1        [12.892]          
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14  tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14  9.484     0.859    (64, 1, 1)       4       1        [9.484]           
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               9.309     0.843    (1, 1, 8192)     1       2        [9.309]           
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               9.309     0.843    (1, 1, 1)        1       2        [9.309]           
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             9.127     0.827    (1, 1, 8192)     1       2        [9.127]           
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             9.127     0.827    (1, 1, 1)        1       2        [9.127]           
tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18                                                                                              tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18                                                                                              7.827     0.709    (1, 8192)        2       1        [7.827]           
tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28                                                                                                                                                                                         tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28                                                                                                                                                                                         7.803     0.707    (1, 28672)       2       1        [7.803]           
tvmgen_welder_reshape_reshape_transpose_4                                                                                                                                                                                                          tvmgen_welder_reshape_reshape_transpose_4                                                                                                                                                                                                          7.459     0.676    (1, 64, 1, 128)  1       1        [7.459]           
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                                                                                                                     tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                                                                                                                     7.425     0.672    (64, 1, 128)     3       1        [7.425]           
tvmgen_welder_multiply_cast_multiply_reshape_2                                                                                                                                                                                                     tvmgen_welder_multiply_cast_multiply_reshape_2                                                                                                                                                                                                     7.423     0.672    (1, 8192)        3       1        [7.423]           
tvmgen_welder_multiply_cast_multiply_23_reshape_24                                                                                                                                                                                                 tvmgen_welder_multiply_cast_multiply_23_reshape_24                                                                                                                                                                                                 7.411     0.671    (1, 8192)        3       1        [7.411]           
tvmgen_welder_reshape_add_20                                                                                                                                                                                                                       tvmgen_welder_reshape_add_20                                                                                                                                                                                                                       7.404     0.67     (1, 1, 8192)     2       1        [7.404]           
tvmgen_welder_reshape_add_30                                                                                                                                                                                                                       tvmgen_welder_reshape_add_30                                                                                                                                                                                                                       7.391     0.669    (1, 1, 8192)     2       1        [7.391]           
tvmgen_welder_reshape_reshape_transpose_7                                                                                                                                                                                                          tvmgen_welder_reshape_reshape_transpose_7                                                                                                                                                                                                          7.355     0.666    (1, 8, 1, 128)   1       1        [7.355]           
Total_time                                                                                                                                                                                                                                         -                                                                                                                                                                                                                                                  1104.234  -        -                -       -        -                 [19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.2096 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_2:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.43384 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_nn_dense_3:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 85.44 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_reshape_reshape_transpose_4:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.51261 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.43007 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_nn_dense_6:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 12.9156 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_reshape_reshape_transpose_7:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.32815 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.49358 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_nn_dense_15:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 12.9175 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.76827 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_nn_dense_19:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 85.8239 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_reshape_add_20:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.38914 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.13905 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_multiply_cast_multiply_23_reshape_24:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.39446 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_nn_dense_25_reshape_26:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 269.312 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_nn_dense_27:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 269.312 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.81312 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_nn_dense_29:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 275.149 us/iter
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_reshape_add_30:
[19:23:46] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.39876 us/iter
{'llama_ladder_1_1': 2060}
