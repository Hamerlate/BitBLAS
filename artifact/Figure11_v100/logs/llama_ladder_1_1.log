Measure the memory for llama batch 1 seq 1 under ladder
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 8.76023 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_2:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.1917 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_nn_dense_3:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 158.515 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_reshape_reshape_transpose_4:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.01155 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.01629 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_nn_dense_6:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 27.3159 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_reshape_reshape_transpose_7:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.19644 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.19771 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_nn_dense_15:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 27.1775 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.24972 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_nn_dense_19:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 158.003 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_reshape_add_20:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.39803 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 8.75896 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_multiply_cast_multiply_23_reshape_24:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.19644 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_nn_dense_25_reshape_26:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 533.709 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_nn_dense_27:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 533.914 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.20119 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_nn_dense_29:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 536.371 us/iter
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_reshape_add_30:
[07:42:56] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.00269 us/iter
Testing model: llama2-70b
Running from prebuilt model: /root/Ladder/artifact/Figure11_v100/../checkpoints/Figure11_v100/ladder/checkpoints/llama2-70b/llama2_bs1_seq1_async
Execution time summary:
 mean (ms)   median (ms)    max (ms)     min (ms)     std (ms)  
   1.9756       1.9756       1.9757       1.9756       0.0000   
               
Node Name                                                                                                                                                                                                                                          Ops                                                                                                                                                                                                                                                Time(us)  Time(%)  Shape            Inputs  Outputs  Measurements(us)  
---------                                                                                                                                                                                                                                          ---                                                                                                                                                                                                                                                --------  -------  -----            ------  -------  ----------------  
tvmgen_welder_nn_dense_29                                                                                                                                                                                                                          tvmgen_welder_nn_dense_29                                                                                                                                                                                                                          536.371   25.959   (1, 8192)        2       1        [536.371]         
tvmgen_welder_nn_dense_27                                                                                                                                                                                                                          tvmgen_welder_nn_dense_27                                                                                                                                                                                                                          533.914   25.841   (1, 28672)       2       1        [533.914]         
tvmgen_welder_nn_dense_25_reshape_26                                                                                                                                                                                                               tvmgen_welder_nn_dense_25_reshape_26                                                                                                                                                                                                               533.709   25.831   (1, 1, 28672)    2       1        [533.709]         
tvmgen_welder_nn_dense_3                                                                                                                                                                                                                           tvmgen_welder_nn_dense_3                                                                                                                                                                                                                           158.515   7.672    (1, 8192)        2       1        [158.515]         
tvmgen_welder_nn_dense_19                                                                                                                                                                                                                          tvmgen_welder_nn_dense_19                                                                                                                                                                                                                          158.003   7.647    (1, 8192)        2       1        [158.003]         
tvmgen_welder_nn_dense_6                                                                                                                                                                                                                           tvmgen_welder_nn_dense_6                                                                                                                                                                                                                           27.316    1.322    (1, 1024)        2       1        [27.316]          
tvmgen_welder_nn_dense_15                                                                                                                                                                                                                          tvmgen_welder_nn_dense_15                                                                                                                                                                                                                          27.178    1.315    (1, 1024)        2       1        [27.178]          
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14  tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14  9.198     0.445    (64, 1, 1)       4       1        [9.198]           
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               8.76      0.424    (1, 1, 8192)     1       2        [8.76]            
tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1                                                                                                                                                                                               8.76      0.424    (1, 1, 1)        1       2        [8.76]            
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             8.759     0.424    (1, 1, 8192)     1       2        [8.759]           
tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22                                                                                                                                                                                             8.759     0.424    (1, 1, 1)        1       2        [8.759]           
tvmgen_welder_reshape_add_20                                                                                                                                                                                                                       tvmgen_welder_reshape_add_20                                                                                                                                                                                                                       7.398     0.358    (1, 1, 8192)     2       1        [7.398]           
tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18                                                                                              tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18                                                                                              7.25      0.351    (1, 8192)        2       1        [7.25]            
tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28                                                                                                                                                                                         tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28                                                                                                                                                                                         7.201     0.349    (1, 28672)       2       1        [7.201]           
tvmgen_welder_reshape_reshape_transpose_7                                                                                                                                                                                                          tvmgen_welder_reshape_reshape_transpose_7                                                                                                                                                                                                          7.196     0.348    (1, 8, 1, 128)   1       1        [7.196]           
tvmgen_welder_multiply_cast_multiply_23_reshape_24                                                                                                                                                                                                 tvmgen_welder_multiply_cast_multiply_23_reshape_24                                                                                                                                                                                                 7.196     0.348    (1, 8192)        3       1        [7.196]           
tvmgen_welder_multiply_cast_multiply_reshape_2                                                                                                                                                                                                     tvmgen_welder_multiply_cast_multiply_reshape_2                                                                                                                                                                                                     7.192     0.348    (1, 8192)        3       1        [7.192]           
tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                                                                                                                     tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5                                                                                                                                                     7.016     0.34     (64, 1, 128)     3       1        [7.016]           
tvmgen_welder_reshape_reshape_transpose_4                                                                                                                                                                                                          tvmgen_welder_reshape_reshape_transpose_4                                                                                                                                                                                                          7.012     0.339    (1, 64, 1, 128)  1       1        [7.012]           
tvmgen_welder_reshape_add_30                                                                                                                                                                                                                       tvmgen_welder_reshape_add_30                                                                                                                                                                                                                       7.003     0.339    (1, 1, 8192)     2       1        [7.003]           
Total_time                                                                                                                                                                                                                                         -                                                                                                                                                                                                                                                  2066.186  -        -                -       -        -                 [07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #0 tvmgen_welder_cast_multiply_0_mean_add_sqrt_divide_1:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 8.7452 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #1 tvmgen_welder_multiply_cast_multiply_reshape_2:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.22215 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #2 tvmgen_welder_nn_dense_3:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 158.72 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #3 tvmgen_welder_reshape_reshape_transpose_4:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.01905 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #4 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_reshape_5:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.00974 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #5 tvmgen_welder_nn_dense_6:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 27.2882 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #6 tvmgen_welder_reshape_reshape_transpose_7:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.17748 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #7 tvmgen_welder_multiply_strided_slice_negative_strided_slice_concatenate_multiply_add_expand_dims_broadcast_to_reshape_transpose_reshape_transpose_8_nn_batch_matmul_9_reshape_divide_10_max_11_subtract_exp_12_sum_13_divide_cast_cast_reshape_14:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 9.16273 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #8 tvmgen_welder_nn_dense_15:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 27.1222 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #9 tvmgen_welder_reshape_reshape_transpose_expand_dims_broadcast_to_reshape_reshape_transpose_16_nn_batch_matmul_17_reshape_transpose_reshape_reshape_18:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.27376 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #10 tvmgen_welder_nn_dense_19:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 158.106 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #11 tvmgen_welder_reshape_add_20:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.00044 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #12 tvmgen_welder_cast_multiply_21_mean_add_sqrt_divide_22:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 8.75055 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #13 tvmgen_welder_multiply_cast_multiply_23_reshape_24:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.20646 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #14 tvmgen_welder_nn_dense_25_reshape_26:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 533.709 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #15 tvmgen_welder_nn_dense_27:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 533.914 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #16 tvmgen_welder_sigmoid_multiply_reshape_multiply_reshape_28:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.19684 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #17 tvmgen_welder_nn_dense_29:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 536.269 us/iter
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:95: Op #18 tvmgen_welder_reshape_add_30:
[07:43:01] /root/Ladder/3rdparty/tvm/src/runtime/graph_executor/debug/graph_executor_debug.cc:98: Iteration: 0: 7.29385 us/iter
{'llama_ladder_1_1': 1943}
