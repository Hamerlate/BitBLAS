fc_model/latest.pth.tar does not exist. Failed to load checkpoint.
Batch 1
Dtype float16
Trials 200
Logging to devnull...
Totally 1 different mappings for this matching
Logging to devnull...
Totally 1 different mappings for this matching
Query subgraph task id: 0, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph1.log...
Query subgraph task id: 1, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 2, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 3, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 4, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph5.log...
Query subgraph task id: 5, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph9.log...
Query subgraph task id: 6, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 7, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 8, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 9, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph14.log...
Query subgraph task id: 10, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 11, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 12, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 13, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph34.log...
Query subgraph task id: 14, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 15, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 16, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 17, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph39.log...
Query subgraph task id: 18, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 19, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 20, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 21, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph51.log...
Query subgraph task id: 22, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 23, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 24, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 25, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph56.log...
Query subgraph task id: 26, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 27, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 28, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 29, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph64.log...
Query subgraph task id: 30, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 31, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 32, perf=10000000000.000000 ms after 0 tuning
Fallback to TG
Loading from resnet50/tg:resnet50:subgraph69.log...
Query subgraph task id: 33, perf=10000000000.000000 ms after 0 tuning
Logging to devnull...
Totally 35 different mappings for this matching
Logging to devnull...
Totally 35 different mappings for this matching
Query subgraph task id: 34, perf=10000000000.000000 ms after 0 tuning
#############################################
operations:inputs:[1, 2048],[1000, 2048],body:R[1, 1000] [2048] { comm_reducer(result=[(v3 + v4)], lhs=[v3], rhs=[v4], identity_element=[0h]) } { (T0[i, rv]*T1[j, rv]) }$tensors:[1, 2048] [1000, 2048] [1, 1000] graph:
Autoscheduling resnet50/at-resnet50:subgraph0/at:resnet50:subgraph0:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 1
Initial trials per matching: 100
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 7902.74139580403/7902.74139580403
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=2: 9413.933609624166/9413.933609624166
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=3: 13188.342453851696/13188.342453851696
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=4: 3067.417509684581/13188.342453851696
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=5: 1666.6828938430433/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=6: 5576.062455817218/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=7: 3102.988320305977/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=8: 1839.3953429265011/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=9: 5914.840037169429/13188.342453851696
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=10: 3747.9422891846316/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=11: 2243.6820343568193/13188.342453851696
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=12: 7306.063685746897/13188.342453851696
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=13: 9419.538976541324/13188.342453851696
.Y.Y.Y.Y.E
*E*E*E*E
iteration=14: 1e-10/13188.342453851696
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=15: 6369.179923371937/13188.342453851696
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=16: 7186.381266573468/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=17: 11939.059396986353/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=18: 1230.8923470565155/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=19: 551.9324644773745/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=20: 9418.675547551591/13188.342453851696
Best record value:13188.342453851696 (larger is better)
Round 1, Match 1, Mapping 1: 13188.342453851696/13188.342453851696(0.075824540005628 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 1], [16, 1, 1, 2]], "reduce_factors": [[32, 2, 2]], "last_factors": [[1, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 40 schedules
Original weights [1.0]
Original trials for each mapping [100]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [i]
j: int32 : [j]
rk: int32 : [rv]
Current explored mapping: {"vmap": [[1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 1883.5407660154617/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 881.6976693959548/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=3: 13092.76705838513/13188.342453851696
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=4: 9103.77971723534/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=5: 10768.023591868747/13188.342453851696
.E.Y.Y.Y.Y
*E*E*E*E
iteration=6: 1e-10/13188.342453851696
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=7: 10728.180641189741/13188.342453851696
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=8: 1e-10/13188.342453851696
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=9: 3196.8469714741327/13188.342453851696
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=10: 14362.234719165215/14362.234719165215
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=11: 2458.376674845934/14362.234719165215
.Y.E.Y.E.Y
*E*E*E
iteration=12: 1e-10/14362.234719165215
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=13: 13199.780867295725/14362.234719165215
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=14: 1e-10/14362.234719165215
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=15: 4223.7210576347925/14362.234719165215
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=16: 11894.056653367179/14362.234719165215
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=17: 11470.791191001763/14362.234719165215
.E.Y.Y.Y.Y
*E*E*E*E
iteration=18: 1e-10/14362.234719165215
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=19: 1e-10/14362.234719165215
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=20: 2316.9577860486793/14362.234719165215
Best record value:14362.234719165215 (larger is better)
Round 2, Match 1, Mapping 1: 14362.234719165215/14362.234719165215(0.06962704756980351 ms), {"vmap": [[1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 1], [8, 2, 2, 1]], "reduce_factors": [[32, 4, 1]], "last_factors": [[2, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [1.0]
Show mapping exploration summary:
mapping (1): explored 69 schedules
Tensorize use time 427.87751054763794 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 2048, 7, 7],body:R[1, 2048] [7, 7] { comm_reducer(result=[(v4 + v5)], lhs=[v4], rhs=[v5], identity_element=[0h]) } { (T0[n, c, h, w]/49h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph1.log by 200 trials...
.Y.Y.Y.E.Y.T.E.E.E.Y.B.B.B.B.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.B.N.N.N

Currently best performance: 0.009666191879012954
.N.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.B.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.007578317727379855
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N

Currently best performance: 0.004755297920750942
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.E.Y.Y.Y.N.N.N

Currently best performance: 0.004435572454404399
.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004435572454404399
.Y.Y.Y.Y.Y.Y.T.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.T.N.N.N.N.N

Currently best performance: 0.004435572454404399
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004435572454404399
.N.N.N.N.N.N.N.N.Y.Y.E.E.T.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.004435572454404399
.N.N.E.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N

Currently best performance: 0.004435572454404399
.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004435572454404399
.T.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.004435572454404399
.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.E.Y.Y.N

Currently best performance: 0.004435572454404399
.N.N.N.N.N.N.NSchedule cost 1244.162031 seconds
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 7, 7],[2048, 512, 1, 1],body:R[1, 2048, 7, 7] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [2048, 512, 1, 1] [1, 2048, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph2/at:resnet50:subgraph2:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=2: 14070.668593299939/14070.668593299939
.Y.Y.Y
*Y*E*E
iteration=3: 5725.981831895493/14070.668593299939
Best record value:14070.668593299939 (larger is better)
Round 1, Match 1, Mapping 1: 14070.668593299939/14070.668593299939(0.07106982822949666 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 1067.2405708201345/1067.2405708201345
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=2: 2470.6481058281565/2470.6481058281565
.Y.Y.Y
*E*E*Y
iteration=3: 5644.278822327362/5644.278822327362
Best record value:14070.668593299939 (larger is better)
Round 1, Match 1, Mapping 2: 5644.278822327362/14070.668593299939(0.07106982822949666 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 8, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*E
iteration=1: 6222.090219751648/6222.090219751648
.E.E.Y.Y.Y
*E*Y*Y
iteration=2: 14473.751350250437/14473.751350250437
.Y.Y.Y
*E*E*Y
iteration=3: 10260.890084845483/14473.751350250437
Best record value:14473.751350250437 (larger is better)
Round 1, Match 1, Mapping 3: 14473.751350250437/14473.751350250437(0.06909058859731601 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 32], [1, 1, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 13736.842112487217/13736.842112487217
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=2: 10016.989360696827/13736.842112487217
.Y.Y.E
*Y*Y
iteration=3: 13638.842835329671/13736.842112487217
Best record value:14473.751350250437 (larger is better)
Round 1, Match 1, Mapping 4: 13736.842112487217/14473.751350250437(0.06909058859731601 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 4, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 6103.279953239524/6103.279953239524
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/6103.279953239524
.Y.E.E
*E
iteration=3: 1e-10/6103.279953239524
Best record value:14473.751350250437 (larger is better)
Round 1, Match 1, Mapping 5: 6103.279953239524/14473.751350250437(0.06909058859731601 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 4, 1, 1]], "reduce_factors": [[1, 16, 2], [1, 1, 1]], "last_factors": [[1, 112, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 15143.706704697212/15143.706704697212
.Y.Y.E.Y.E
*E*E*Y
iteration=2: 11015.149716158456/15143.706704697212
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/15143.706704697212
Best record value:15143.706704697212 (larger is better)
Round 1, Match 1, Mapping 6: 15143.706704697212/15143.706704697212(0.06603403113253799 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1]], "reduce_factors": [[2, 4, 4]], "last_factors": [[14, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 6899.701023224176/6899.701023224176
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=2: 8294.334628179371/8294.334628179371
.Y.E.Y
*Y*E
iteration=3: 6412.819646076756/8294.334628179371
Best record value:15143.706704697212 (larger is better)
Round 1, Match 1, Mapping 7: 8294.334628179371/15143.706704697212(0.06603403113253799 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 2, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[2, 392, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*Y*Y
iteration=1: 11460.442670902681/11460.442670902681
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=2: 15901.545938204601/15901.545938204601
.Y.Y.Y
*Y*Y*Y
iteration=3: 13800.332715703074/15901.545938204601
Best record value:15901.545938204601 (larger is better)
Round 1, Match 1, Mapping 8: 15901.545938204601/15901.545938204601(0.06288696733551098 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 2, 8, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 7, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 6 schedules
mapping (1,0,0,1,0,1,0): explored 8 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245]
Original trials for each mapping [11, 11, 11, 11, 11, 11, 11, 28]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 6970.966496076498/14070.668593299939
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=2: 9728.407357669319/14070.668593299939
.Y.Y.Y
*E*Y*E
iteration=3: 13845.714895017658/14070.668593299939
Best record value:15901.545938204601 (larger is better)
Round 2, Match 1, Mapping 1: 14070.668593299939/15901.545938204601(0.06288696733551098 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 283.7688008677922/5644.278822327362
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=2: 9938.60486210921/9938.60486210921
.Y.Y.Y
*E*E*Y
iteration=3: 3913.4895322523917/9938.60486210921
Best record value:15901.545938204601 (larger is better)
Round 2, Match 1, Mapping 2: 9938.60486210921/15901.545938204601(0.06288696733551098 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [8, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 4]], "last_factors": [[8, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 5038.57458621068/14473.751350250437
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=2: 5369.4622716941385/14473.751350250437
.Y.E.Y
*Y*Y
iteration=3: 26061.09526400997/26061.09526400997
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 3: 26061.09526400997/26061.09526400997(0.03837137272511285 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [64, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 8], [1, 1, 1]], "last_factors": [[56, 14, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 16433.73544089374/16433.73544089374
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=2: 10869.81972373681/16433.73544089374
.Y.E.Y
*Y*Y
iteration=3: 14241.051436719521/16433.73544089374
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 4: 16433.73544089374/26061.09526400997(0.03837137272511285 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 56, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 16117.014137401646/16117.014137401646
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=2: 1968.1418182651214/16117.014137401646
.E.Y.Y
*Y*E
iteration=3: 3500.498590444056/16117.014137401646
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 5: 16117.014137401646/26061.09526400997(0.03837137272511285 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [8, 2, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[49, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 3219.469470064967/15143.706704697212
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=2: 16399.069433061493/16399.069433061493
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/16399.069433061493
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 6: 16399.069433061493/26061.09526400997(0.03837137272511285 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [16, 4, 1, 1]], "reduce_factors": [[2, 8, 2]], "last_factors": [[784, 1, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 7727.860084574963/8294.334628179371
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 2771.061607697169/8294.334628179371
.Y.Y.Y
*E*E*Y
iteration=3: 942.9561644991105/8294.334628179371
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 7: 8294.334628179371/26061.09526400997(0.03837137272511285 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 2, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[2, 392, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 11419.719325482325/15901.545938204601
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=2: 17775.796702555945/17775.796702555945
.Y.E.Y
*E*Y
iteration=3: 14192.533538789603/17775.796702555945
Best record value:26061.09526400997 (larger is better)
Round 2, Match 1, Mapping 8: 17775.796702555945/26061.09526400997(0.03837137272511285 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 2, 2, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 4, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.09137574887758489, 0.09137574887758489, 0.248385037735776, 0.09137574887758489, 0.09137574887758489, 0.09137574887758489, 0.09137574887758489, 0.20336046899871482]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 10 schedules
mapping (0,0,0,0,1,1,1): explored 11 schedules
mapping (0,0,0,1,0,0,1): explored 11 schedules
mapping (0,0,0,1,0,1,0): explored 12 schedules
mapping (0,0,1,0,1,1,0): explored 5 schedules
mapping (0,0,1,0,1,1,1): explored 9 schedules
mapping (0,1,0,1,0,0,1): explored 13 schedules
mapping (1,0,0,1,0,1,0): explored 12 schedules
Tensorize use time 542.5440068244934 s.
#############################################
operations:inputs:[1, 512, 7, 7],[512],[512],body:S[1, 512, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 7, 7],body:S[1, 512, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 7, 7],body:S[1, 512, 9, 9] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 8)) && (v3 >= 1)) && (v3 < 8)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 9, 9],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 7, 7] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph3/at:resnet50:subgraph3:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=2: 6788.762353523779/6788.762353523779
.Y.Y.Y
*Y*Y*E
iteration=3: 5794.902331118711/6788.762353523779
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 1: 6788.762353523779/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=2: 3270.5327287422/3270.5327287422
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3270.5327287422
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 2: 3270.5327287422/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 6]], "last_factors": [[4, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 2774.352336626857/2774.352336626857
.Y.Y.E
*Y*E
iteration=3: 787.5401411358682/2774.352336626857
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 3: 2774.352336626857/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 4, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [1, 1, 3]], "last_factors": [[49, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 2123.1938332790305/2123.1938332790305
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=2: 1060.9575201160542/2123.1938332790305
.Y.Y.Y
*E*Y*E
iteration=3: 1257.6562322454781/2123.1938332790305
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 4: 2123.1938332790305/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[4, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=2: 4063.327343574296/4063.327343574296
.E.Y.Y
*E*Y
iteration=3: 2005.2278108327819/4063.327343574296
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 5: 4063.327343574296/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[96, 1, 1], [3, 1, 1]], "last_factors": [[4, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 2358.6053097555982/2358.6053097555982
.Y.Y.Y
*E*E*Y
iteration=3: 3069.846906734761/3069.846906734761
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 6: 3069.846906734761/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[96, 3, 1]], "last_factors": [[196, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 421.0944037046545/421.0944037046545
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=2: 141.88238049974237/421.0944037046545
.E.Y.Y
*Y*E
iteration=3: 40.270637190303695/421.0944037046545
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 7: 421.0944037046545/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 8, 1, 2]], "reduce_factors": [[96, 1, 1], [1, 1, 3]], "last_factors": [[7, 28, 4]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 114.16600235991059/114.16600235991059
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/114.16600235991059
.E.E.E

iteration=3: 1e-10/114.16600235991059
Best record value:6788.762353523779 (larger is better)
Round 1, Match 1, Mapping 8: 114.16600235991059/6788.762353523779(0.14730225450901804 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 8, 1, 2]], "reduce_factors": [[2, 1, 16], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 14, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.27970806737656245, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [28, 11, 11, 11, 11, 11, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/6788.762353523779
.Y.E.Y.Y.E
*E*E*E
iteration=2: 1e-10/6788.762353523779
.Y.E.Y
*E*Y
iteration=3: 204.2031255947097/6788.762353523779
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 1: 6788.762353523779/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 2], [3, 1, 1]], "last_factors": [[7, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/3270.5327287422
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 846.99869339065/3270.5327287422
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3270.5327287422
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 2: 3270.5327287422/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 6]], "last_factors": [[4, 28, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 791.4928683574431/2774.352336626857
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/2774.352336626857
.E.Y.Y
*E*E
iteration=3: 1e-10/2774.352336626857
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 3: 2774.352336626857/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 4, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [1, 1, 3]], "last_factors": [[49, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 67.94088194136981/2123.1938332790305
.Y.E.Y.Y.E
*E*E*E
iteration=2: 1e-10/2123.1938332790305
.Y.Y.Y
*E*E*Y
iteration=3: 2096.413262537025/2123.1938332790305
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 4: 2123.1938332790305/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[4, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2226.268748766539/4063.327343574296
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=2: 104.88332041058949/4063.327343574296
.E.E.Y
*E
iteration=3: 1e-10/4063.327343574296
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 5: 4063.327343574296/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1]], "reduce_factors": [[96, 1, 1], [3, 1, 1]], "last_factors": [[4, 196, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/3069.846906734761
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=2: 1783.7798958310934/3069.846906734761
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3069.846906734761
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 6: 3069.846906734761/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[96, 3, 1]], "last_factors": [[196, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 51.65931616847065/421.0944037046545
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=2: 955.7618470859906/955.7618470859906
.E.Y.Y
*E*E
iteration=3: 1e-10/955.7618470859906
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 7: 955.7618470859906/6788.762353523779(0.14730225450901804 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1]], "reduce_factors": [[12, 4, 2], [1, 1, 3]], "last_factors": [[2, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 1126.1589515245323/1126.1589515245323
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 1203.608235148325/1203.608235148325
.E.Y.Y
*E*E
iteration=3: 1e-10/1203.608235148325
Best record value:6788.762353523779 (larger is better)
Round 2, Match 1, Mapping 8: 1203.608235148325/6788.762353523779(0.14730225450901804 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 2]], "reduce_factors": [[4, 8, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[196, 4, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.4635870417887259, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056, 0.07663042260161056]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,0): explored 7 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 7 schedules
mapping (1,0,0,1,0,1,0): explored 6 schedules
Tensorize use time 728.399420261383 s.
#############################################
operations:inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 7)) && (v3 >= 0)) && (v3 < 7)), T0[b, c, h, w], 0h) }$inputs:[1, 2048, 7, 7],[512, 2048, 1, 1],body:R[1, 512, 7, 7] [2048, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 2048, 7, 7] [512, 2048, 1, 1] [1, 512, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph4/at:resnet50:subgraph4:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 3933.172342543958/3933.172342543958
.Y.Y.Y.Y.E
*E*E*E*E
iteration=2: 1e-10/3933.172342543958
.Y.Y.Y
*Y*Y*Y
iteration=3: 9563.853199438696/9563.853199438696
Best record value:9563.853199438696 (larger is better)
Round 1, Match 1, Mapping 1: 9563.853199438696/9563.853199438696(0.10456036695112492 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [8, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 4], [1, 1, 1]], "last_factors": [[14, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 5478.009982514526/5478.009982514526
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=2: 4688.483355136058/5478.009982514526
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/5478.009982514526
Best record value:9563.853199438696 (larger is better)
Round 1, Match 1, Mapping 2: 5478.009982514526/9563.853199438696(0.10456036695112492 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 4, 1]], "last_factors": [[2, 56, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 4590.212048594464/4590.212048594464
.Y.Y.Y
*Y*E*E
iteration=3: 1469.9159903451123/4590.212048594464
Best record value:9563.853199438696 (larger is better)
Round 1, Match 1, Mapping 3: 4590.212048594464/9563.853199438696(0.10456036695112492 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[98, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 5790.885341892596/5790.885341892596
.E.Y.E.Y.Y
*E*Y*Y
iteration=2: 6966.286224895552/6966.286224895552
.Y.Y.Y
*Y*Y*Y
iteration=3: 7986.533215103767/7986.533215103767
Best record value:9563.853199438696 (larger is better)
Round 1, Match 1, Mapping 4: 7986.533215103767/9563.853199438696(0.10456036695112492 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 4, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=2: 3373.9671484793134/3373.9671484793134
.Y.Y.Y
*Y*E*E
iteration=3: 1671.4306538906424/3373.9671484793134
Best record value:9563.853199438696 (larger is better)
Round 1, Match 1, Mapping 5: 3373.9671484793134/9563.853199438696(0.10456036695112492 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[8, 8, 2], [1, 1, 1]], "last_factors": [[2, 392, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 11006.27062794108/11006.27062794108
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 9207.598432814302/11006.27062794108
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/11006.27062794108
Best record value:11006.27062794108 (larger is better)
Round 1, Match 1, Mapping 6: 11006.27062794108/11006.27062794108(0.0908572970631259 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 2]], "reduce_factors": [[16, 2, 4]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.Y
*Y*E
iteration=1: 1321.7689944328429/1321.7689944328429
.Y.E.E.Y.Y
*Y*E*Y
iteration=2: 2553.5614411438523/2553.5614411438523
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/2553.5614411438523
Best record value:11006.27062794108 (larger is better)
Round 1, Match 1, Mapping 7: 2553.5614411438523/11006.27062794108(0.0908572970631259 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 4, 2, 2]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[49, 16, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 756.4617592194036/756.4617592194036
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=2: 914.491471329741/914.491471329741
.Y.Y.Y
*E*Y*Y
iteration=3: 2166.8044916234007/2166.8044916234007
Best record value:11006.27062794108 (larger is better)
Round 1, Match 1, Mapping 8: 2166.8044916234007/11006.27062794108(0.0908572970631259 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 1, 16]], "reduce_factors": [[64, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 1, 16]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 8 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 11, 11, 11, 11, 28, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 12963.623586127824/12963.623586127824
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=2: 3715.2932295800456/12963.623586127824
.E.Y.Y
*Y*E
iteration=3: 1078.7027111288933/12963.623586127824
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 1: 12963.623586127824/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 8], [1, 1, 1]], "last_factors": [[28, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 2969.194641583806/5478.009982514526
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=2: 10186.802669779001/10186.802669779001
.E.Y.Y
*Y*Y
iteration=3: 4479.802548222884/10186.802669779001
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 2: 10186.802669779001/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 4, 1]], "last_factors": [[2, 56, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 551.7699486796208/4590.212048594464
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 2796.7513847507753/4590.212048594464
.Y.Y.Y
*E*Y*E
iteration=3: 433.6793451373144/4590.212048594464
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 3: 4590.212048594464/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 16, 1], [1, 1, 1]], "last_factors": [[98, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 8309.733810888127/8309.733810888127
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=2: 5981.915922743909/8309.733810888127
.E.Y.Y
*E*E
iteration=3: 1e-10/8309.733810888127
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 4: 8309.733810888127/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[64, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 3715.3985830048828/3715.3985830048828
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=2: 325.0634890033289/3715.3985830048828
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3715.3985830048828
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 5: 3715.3985830048828/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [2, 1, 2, 4]], "reduce_factors": [[64, 1, 2], [1, 1, 1]], "last_factors": [[4, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 9653.590919634136/11006.27062794108
.Y.Y.E.E.Y
*E*E*Y
iteration=2: 6535.349075727398/11006.27062794108
.Y.Y.Y
*Y*E*E
iteration=3: 5379.623947862733/11006.27062794108
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 6: 11006.27062794108/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 2]], "reduce_factors": [[16, 2, 4]], "last_factors": [[28, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*E*Y
iteration=1: 10493.577060703128/10493.577060703128
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=2: 10917.567943803617/10917.567943803617
.E.E.Y
*Y
iteration=3: 2938.4521879407152/10917.567943803617
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 7: 10917.567943803617/12963.623586127824(0.07713892596126323 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 4, 1]], "reduce_factors": [[32, 4, 1], [1, 1, 1]], "last_factors": [[7, 8, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*Y*E
iteration=1: 654.4239037939718/2166.8044916234007
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=2: 2232.0155685263967/2232.0155685263967
.Y.Y.Y
*Y*E*E
iteration=3: 340.69433771768445/2232.0155685263967
Best record value:12963.623586127824 (larger is better)
Round 2, Match 1, Mapping 8: 2232.0155685263967/12963.623586127824(0.07713892596126323 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 8, 1, 1]], "reduce_factors": [[16, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 4, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.24838503773577597, 0.09137574887758487, 0.09137574887758487, 0.09137574887758487, 0.09137574887758487, 0.2033604689987148, 0.09137574887758487, 0.09137574887758487]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 12 schedules
mapping (0,0,0,0,1,1,1): explored 10 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 10 schedules
mapping (0,0,1,0,1,1,0): explored 7 schedules
mapping (0,0,1,0,1,1,1): explored 11 schedules
mapping (0,1,0,1,0,0,1): explored 8 schedules
mapping (1,0,0,1,0,1,0): explored 14 schedules
Tensorize use time 545.9606025218964 s.
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [1, 2048, 7, 7] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph5.log by 200 trials...
.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.B.B.B.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.T.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.009181104299917918
.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.E.Y.Y.E.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.009181104299917918
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.B.N.N.N.N.N

Currently best performance: 0.0032092447182700376
.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0032092447182700376
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0032092447182700376
.Y.Y.Y.Y.E.Y.E.Y.Y.Y.B.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.E.N.N.N.N.N

Currently best performance: 0.0031812549329734534
.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0031812549329734534
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0031812549329734534
.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0029468652613122916
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.T.Y.E.N.N.B.B.N.N.N.N

Currently best performance: 0.002907066905107422
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.E.N.N.N.N.N

Currently best performance: 0.002907066905107422
.N.N.N.Y.E.Y.Y.E.Y.Y.Y.E.Y.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.002907066905107422
.N.N.N.N.N.N.N.NSchedule cost 1043.890404 seconds
#############################################
operations:inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[2048],[2048],body:S[1, 2048, 7, 7] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 2048, 7, 7],[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 2048, 7, 7],body:S[1, 2048, 7, 7] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] [2048] [2048] [1, 2048, 7, 7] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph9.log by 200 trials...
.E.Y.Y.Y.Y.Y.Y.E.Y.Y.B.N.B.B.N.N.N.B.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.043552562094172874
.B.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.Y.N.N

Currently best performance: 0.008121431426863463
.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.008121431426863463
.N.N.Y.Y.Y.Y.Y.Y.Y.E.E.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.008121431426863463
.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.008121431426863463
.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.003980893444620146
.N.N.N.N.Y.E.Y.Y.Y.Y.Y.T.Y.Y.N.N.N.N.N.N.N.N.Y.E.E.Y.Y.Y.Y.Y.Y.Y.N

Currently best performance: 0.003980893444620146
.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0033029078926426867
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.0033029078926426867
.N.N.N.N.N.N.E.Y.T.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.0033029078926426867
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B

Currently best performance: 0.0032337650982607676
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.T.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.E.N.N

Currently best performance: 0.0032337650982607676
.N.N.N.N.N.NSchedule cost 1206.932807 seconds
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[2048, 1024, 1, 1],body:R[1, 2048, 7, 7] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [2048, 1024, 1, 1] [1, 2048, 7, 7] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph10/at:resnet50:subgraph10:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.E.Y.Y
*E*E*E*E
iteration=2: 1e-10/1e-10
.Y.Y.Y
*E*Y*E
iteration=3: 5517.635994455456/5517.635994455456
Best record value:5517.635994455456 (larger is better)
Round 1, Match 1, Mapping 1: 5517.635994455456/5517.635994455456(0.18123703720304796 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [8, 1, 1, 8], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*E
iteration=1: 2565.5000172027044/2565.5000172027044
.Y.E.Y.E.E
*E*E
iteration=2: 1e-10/2565.5000172027044
.E.E.Y
*E
iteration=3: 1e-10/2565.5000172027044
Best record value:5517.635994455456 (larger is better)
Round 1, Match 1, Mapping 2: 2565.5000172027044/5517.635994455456(0.18123703720304796 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 7, 1, 1], [16, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1]], "last_factors": [[4, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1473.960312144635/1473.960312144635
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=2: 151.73611009848332/1473.960312144635
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1473.960312144635
Best record value:5517.635994455456 (larger is better)
Round 1, Match 1, Mapping 3: 1473.960312144635/5517.635994455456(0.18123703720304796 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 8, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[1, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=2: 13698.804744961682/13698.804744961682
.E.Y.Y
*Y*Y
iteration=3: 8479.587733605325/13698.804744961682
Best record value:13698.804744961682 (larger is better)
Round 1, Match 1, Mapping 4: 13698.804744961682/13698.804744961682(0.07299906952595937 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 131.0042915276648/131.0042915276648
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 478.31077433135954/478.31077433135954
.E.Y.Y
*E*Y
iteration=3: 1173.5726317904073/1173.5726317904073
Best record value:13698.804744961682 (larger is better)
Round 1, Match 1, Mapping 5: 1173.5726317904073/13698.804744961682(0.07299906952595937 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 16, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2423.6767625875946/2423.6767625875946
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=2: 10491.235988611252/10491.235988611252
.E.Y.Y
*Y*E
iteration=3: 2641.311357302924/10491.235988611252
Best record value:13698.804744961682 (larger is better)
Round 1, Match 1, Mapping 6: 10491.235988611252/13698.804744961682(0.07299906952595937 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 2, 1, 2]], "reduce_factors": [[8, 4, 2]], "last_factors": [[56, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 4475.834933818236/4475.834933818236
.Y.E.Y
*E*Y
iteration=3: 4146.961414110081/4475.834933818236
Best record value:13698.804744961682 (larger is better)
Round 1, Match 1, Mapping 7: 4475.834933818236/13698.804744961682(0.07299906952595937 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 2, 2, 2]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 17215.79979791231/17215.79979791231
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=2: 18711.36398410146/18711.36398410146
.Y.Y.Y
*Y*Y*Y
iteration=3: 18644.370469671343/18711.36398410146
Best record value:18711.36398410146 (larger is better)
Round 1, Match 1, Mapping 8: 18711.36398410146/18711.36398410146(0.05344345825615241 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [32, 2, 1, 1]], "reduce_factors": [[2, 4, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 8 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245]
Original trials for each mapping [11, 11, 11, 11, 11, 11, 11, 28]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 9939.036355362394/9939.036355362394
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=2: 10170.708303903937/10170.708303903937
.Y.E.E
*E
iteration=3: 1e-10/10170.708303903937
Best record value:18711.36398410146 (larger is better)
Round 2, Match 1, Mapping 1: 10170.708303903937/18711.36398410146(0.05344345825615241 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [16, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 19975.631195177466/19975.631195177466
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=2: 2226.9733207596637/19975.631195177466
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/19975.631195177466
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 2: 19975.631195177466/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [32, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 16]], "last_factors": [[224, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 1910.4867842546591/1910.4867842546591
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=2: 3513.6798855892403/3513.6798855892403
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/3513.6798855892403
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 3: 3513.6798855892403/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [8, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[1, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/13698.804744961682
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=2: 6899.314903594036/13698.804744961682
.Y.Y.Y
*E*Y*E
iteration=3: 180.52503324794975/13698.804744961682
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 4: 13698.804744961682/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [16, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 4]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1173.5726317904073
.E.Y.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/1173.5726317904073
.Y.Y.Y
*Y*E*Y
iteration=3: 549.0742384799715/1173.5726317904073
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 5: 1173.5726317904073/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 16, 2, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[448, 1, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/10491.235988611252
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=2: 12822.397471362332/12822.397471362332
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/12822.397471362332
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 6: 12822.397471362332/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 4]], "reduce_factors": [[32, 1, 2]], "last_factors": [[112, 1, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/4475.834933818236
.Y.Y.Y.E.E
*E*Y*E
iteration=2: 1492.6677716621118/4475.834933818236
.E.Y.Y
*Y*Y
iteration=3: 5084.05228925148/5084.05228925148
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 7: 5084.05228925148/19975.631195177466(0.05006099633244234 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [8, 2, 2, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[28, 7, 16]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 2835.33373626665/18711.36398410146
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/18711.36398410146
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/18711.36398410146
Best record value:19975.631195177466 (larger is better)
Round 2, Match 1, Mapping 8: 18711.36398410146/19975.631195177466(0.05006099633244234 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [32, 2, 1, 1]], "reduce_factors": [[2, 4, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.09137574887758489, 0.248385037735776, 0.09137574887758489, 0.09137574887758489, 0.09137574887758489, 0.09137574887758489, 0.09137574887758489, 0.20336046899871482]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 8 schedules
mapping (0,0,0,0,1,1,1): explored 6 schedules
mapping (0,0,0,1,0,0,1): explored 6 schedules
mapping (0,0,0,1,0,1,0): explored 8 schedules
mapping (0,0,1,0,1,1,0): explored 8 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,1,0,1,0,0,1): explored 7 schedules
mapping (1,0,0,1,0,1,0): explored 11 schedules
Tensorize use time 515.7413411140442 s.
#############################################
operations:inputs:[1, 512, 14, 14],[512],[512],body:S[1, 512, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 14, 14],body:S[1, 512, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 512, 14, 14],body:S[1, 512, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 512, 16, 16],[512, 512, 3, 3],body:R[1, 512, 7, 7] [512, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 14, 14] [512] [512] [512, 512, 3, 3] [1, 512, 7, 7] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph12/at:resnet50:subgraph12:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 8
Initial trials per matching: 100
Original weights [0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125]
Original trials for each mapping [13, 13, 13, 13, 13, 13, 13, 13]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/1e-10
.Y.E.Y
*E*E
iteration=3: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=2: 903.8828640916897/903.8828640916897
.Y.Y.Y
*E*E*Y
iteration=3: 205.89473539000556/903.8828640916897
Best record value:903.8828640916897 (larger is better)
Round 1, Match 1, Mapping 2: 903.8828640916897/903.8828640916897(1.1063380441501103 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 9]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 461.8188169054917/461.8188169054917
.E.E.Y.Y.Y
*E*E*E
iteration=2: 1e-10/461.8188169054917
.Y.E.E
*E
iteration=3: 1e-10/461.8188169054917
Best record value:903.8828640916897 (larger is better)
Round 1, Match 1, Mapping 3: 461.8188169054917/903.8828640916897(1.1063380441501103 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 8, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 6], [3, 1, 1]], "last_factors": [[49, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/1e-10
.Y.Y.E
*E*E
iteration=3: 1e-10/1e-10
Best record value:903.8828640916897 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/903.8828640916897(1.1063380441501103 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*E
iteration=1: 1787.3195102682168/1787.3195102682168
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/1787.3195102682168
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1787.3195102682168
Best record value:1787.3195102682168 (larger is better)
Round 1, Match 1, Mapping 5: 1787.3195102682168/1787.3195102682168(0.5594970536912751 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 4, 1, 2]], "reduce_factors": [[8, 3, 4], [3, 1, 1]], "last_factors": [[1, 56, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
.Y.E.E.Y.E
*Y*E
iteration=2: 2823.7982000854295/2823.7982000854295
.E.Y.Y
*E*E
iteration=3: 1e-10/2823.7982000854295
Best record value:2823.7982000854295 (larger is better)
Round 1, Match 1, Mapping 6: 2823.7982000854295/2823.7982000854295(0.3541329546742209 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 7, 1], [4, 2, 2, 1]], "reduce_factors": [[24, 3, 4]], "last_factors": [[7, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/1e-10
.Y.Y.E
*E*Y
iteration=3: 2686.3506471647624/2686.3506471647624
Best record value:2823.7982000854295 (larger is better)
Round 1, Match 1, Mapping 7: 2686.3506471647624/2823.7982000854295(0.3541329546742209 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[16, 2, 3], [1, 3, 1]], "last_factors": [[1, 28, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*E
iteration=1: 760.3093290367755/760.3093290367755
.E.Y.Y.Y.E
*E*E*E
iteration=2: 1e-10/760.3093290367755
.E.Y.Y
*Y*Y
iteration=3: 1049.7596260408293/1049.7596260408293
Best record value:2823.7982000854295 (larger is better)
Round 1, Match 1, Mapping 8: 1049.7596260408293/2823.7982000854295(0.3541329546742209 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 16, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[98, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Original weights [0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.10289884751763394, 0.27970806737656245, 0.10289884751763394, 0.10289884751763394]
Original trials for each mapping [11, 11, 11, 11, 11, 28, 11, 11]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 3164.22998465179/3164.22998465179
.E.Y.Y.E.Y
*E*E*E
iteration=2: 1e-10/3164.22998465179
.Y.E.Y
*E*Y
iteration=3: 2633.0653069083733/3164.22998465179
Best record value:3164.22998465179 (larger is better)
Round 2, Match 1, Mapping 1: 3164.22998465179/3164.22998465179(0.31603265402658326 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 3], [1, 1, 3]], "last_factors": [[4, 196, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 543.1907167327513/903.8828640916897
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=2: 1e-10/903.8828640916897
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/903.8828640916897
Best record value:3164.22998465179 (larger is better)
Round 2, Match 1, Mapping 2: 903.8828640916897/3164.22998465179(0.31603265402658326 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 9]], "last_factors": [[14, 56, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/461.8188169054917
.E.E.Y.Y.Y
*E*E*Y
iteration=2: 1931.255226871799/1931.255226871799
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1931.255226871799
Best record value:3164.22998465179 (larger is better)
Round 2, Match 1, Mapping 3: 1931.255226871799/3164.22998465179(0.31603265402658326 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 8, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 6], [3, 1, 1]], "last_factors": [[49, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.E.E.Y.Y
*E*E
iteration=1: 1e-10/1e-10
.Y.Y.Y.E.Y
*E*E*E*E
iteration=2: 1e-10/1e-10
.Y.Y.Y
*Y*E*E
iteration=3: 9463.409741088411/9463.409741088411
Best record value:9463.409741088411 (larger is better)
Round 2, Match 1, Mapping 4: 9463.409741088411/9463.409741088411(0.10567015772953178 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 3, 1], [1, 3, 1]], "last_factors": [[56, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1787.3195102682168
.Y.E.Y.E.Y
*E*E*E
iteration=2: 1e-10/1787.3195102682168
.Y.Y.Y
*E*Y*Y
iteration=3: 1484.050975077717/1787.3195102682168
Best record value:9463.409741088411 (larger is better)
Round 2, Match 1, Mapping 5: 1787.3195102682168/9463.409741088411(0.10567015772953178 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 4, 1, 2]], "reduce_factors": [[8, 3, 4], [3, 1, 1]], "last_factors": [[1, 56, 14]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/2823.7982000854295
.Y.E.Y.Y.Y
*E*E*E*E
iteration=2: 1e-10/2823.7982000854295
.Y.Y.E
*E*E
iteration=3: 1e-10/2823.7982000854295
Best record value:9463.409741088411 (larger is better)
Round 2, Match 1, Mapping 6: 2823.7982000854295/9463.409741088411(0.10567015772953178 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 7, 1], [4, 2, 2, 1]], "reduce_factors": [[24, 3, 4]], "last_factors": [[7, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 942.4981424050516/2686.3506471647624
.Y.E.E.Y.E
*E*Y
iteration=2: 1380.66667362528/2686.3506471647624
.E.Y.Y
*Y*Y
iteration=3: 5793.7679335223065/5793.7679335223065
Best record value:9463.409741088411 (larger is better)
Round 2, Match 1, Mapping 7: 5793.7679335223065/9463.409741088411(0.10567015772953178 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [16, 1, 1, 1]], "reduce_factors": [[16, 2, 3], [1, 3, 1]], "last_factors": [[1, 28, 28]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 776.8313209777573/1049.7596260408293
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=2: 1527.7857280516407/1527.7857280516407
.Y.Y.Y
*E*E*E
iteration=3: 1e-10/1527.7857280516407
Best record value:9463.409741088411 (larger is better)
Round 2, Match 1, Mapping 8: 1527.7857280516407/9463.409741088411(0.10567015772953178 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 8, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[98, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.09137574887758487, 0.09137574887758487, 0.09137574887758487, 0.24838503773577597, 0.09137574887758487, 0.2033604689987148, 0.09137574887758487, 0.09137574887758487]
Show mapping exploration summary:
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 6 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (1,0,0,1,0,1,0): explored 10 schedules
Tensorize use time 566.5784065723419 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[512, 1024, 1, 1],body:R[1, 512, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [512, 1024, 1, 1] [1, 512, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph13/at:resnet50:subgraph13:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 756.3192915349488/756.3192915349488
Best record value:756.3192915349488 (larger is better)
Round 1, Match 1, Mapping 2: 756.3192915349488/756.3192915349488(1.3221929034369884 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 8, 1, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 5406.3971481830185/5406.3971481830185
Best record value:5406.3971481830185 (larger is better)
Round 1, Match 1, Mapping 3: 5406.3971481830185/5406.3971481830185(0.18496606382978725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 2773.0997524117915/2773.0997524117915
Best record value:5406.3971481830185 (larger is better)
Round 1, Match 1, Mapping 4: 2773.0997524117915/5406.3971481830185(0.18496606382978725 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 5, 1, 1], [2, 1, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[64, 1, 1]], "last_factors": [[112, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 21243.399399087713/21243.399399087713
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 5: 21243.399399087713/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[4, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 1816.6035623088248/1816.6035623088248
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 6: 1816.6035623088248/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [2, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[14, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 7612.2861100238515/7612.2861100238515
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 7: 7612.2861100238515/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 5, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 1130.9624776422606/1130.9624776422606
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 8: 1130.9624776422606/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [1, 4, 1, 4], [1, 1, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[7, 448, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 3741.577149400037/3741.577149400037
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 9: 3741.577149400037/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 4, 4, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 2643.260442160888/2643.260442160888
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 11: 2643.260442160888/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [2, 4, 2, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[392, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 4926.183599990735/4926.183599990735
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 14: 4926.183599990735/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 556.9234319216434/556.9234319216434
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 15: 556.9234319216434/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 1, 8, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 5800.370267495488/5800.370267495488
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 17: 5800.370267495488/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 8, 2]], "last_factors": [[1, 224, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 1713.8333894570487/1713.8333894570487
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 18: 1713.8333894570487/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 4, 1, 2], [7, 1, 1, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 1568, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 5462.9194439421435/5462.9194439421435
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 19: 5462.9194439421435/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [1, 1, 8, 2], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 3617.7847985313533/3617.7847985313533
Best record value:21243.399399087713 (larger is better)
Round 1, Match 1, Mapping 20: 3617.7847985313533/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 1, 8, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 224, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 5093.995030424037/5093.995030424037
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 2: 5093.995030424037/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 8, 1, 2], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[14, 112, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 5366.3820572059885/5406.3971481830185
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 3: 5406.3971481830185/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [4, 1, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 6025.073402932661/6025.073402932661
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 4: 6025.073402932661/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 16, 1]], "last_factors": [[28, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 12704.607615941673/21243.399399087713
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 5: 21243.399399087713/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[4, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 13683.190215296801/13683.190215296801
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 6: 13683.190215296801/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [16, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[112, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/7612.2861100238515
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 7: 7612.2861100238515/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 5, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 2]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 6479.62608768928/6479.62608768928
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 8: 6479.62608768928/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 4, 1, 1], [1, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[4, 8, 2], [1, 1, 1]], "last_factors": [[2, 112, 14]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/3741.577149400037
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 9: 3741.577149400037/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 4, 4, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 10: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 2715.3331684804843/2715.3331684804843
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 11: 2715.3331684804843/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [1, 8, 2, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[32, 49, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 12874.058198185909/12874.058198185909
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 13: 12874.058198185909/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [2, 1, 4, 2], [7, 1, 1, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[8, 49, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/4926.183599990735
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 14: 4926.183599990735/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 1, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/556.9234319216434
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 15: 556.9234319216434/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 1, 8, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 4, 1], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 8526.749580388745/8526.749580388745
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 16: 8526.749580388745/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [1, 4, 2, 2]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[7, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/5800.370267495488
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 17: 5800.370267495488/21243.399399087713(0.04707344531887606 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [16, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 8, 2]], "last_factors": [[1, 224, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 3030.683890104627/3030.683890104627
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 18: 3030.683890104627/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [1, 16, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[2, 8, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 15447.399776774677/15447.399776774677
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 19: 15447.399776774677/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [4, 1, 4, 1], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 4831.772007281361/4831.772007281361
Best record value:21243.399399087713 (larger is better)
Round 2, Match 1, Mapping 20: 4831.772007281361/21243.399399087713(0.04707344531887606 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 2, 2, 2]], "reduce_factors": [[16, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1, 98, 32]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 4 schedules
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 6 schedules
mapping (0,0,0,1,0,0,0): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 5 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Tensorize use time 624.462060213089 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1, 1024, 14, 14] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph14.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.013332604871509822
.N.N.N.E.Y.Y.Y.E.E.Y.Y.Y.E.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.013332604871509822
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.T.N.N.N.B.N.N.N.N

Currently best performance: 0.00469135019534986
.Y.E.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.00469135019534986
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.00469135019534986
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.E.Y.Y.E.Y.E.N.N.N.N

Currently best performance: 0.00469135019534986
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N

Currently best performance: 0.00469135019534986
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.00469135019534986
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N

Currently best performance: 0.0038281900362836623
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.0038281900362836623
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N

Currently best performance: 0.0038281900362836623
.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.0038281900362836623
.N.N.N.N.N.N.N.NSchedule cost 955.632301 seconds
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 14, 14],[1024, 256, 1, 1],body:R[1, 1024, 14, 14] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [1024, 256, 1, 1] [1, 1024, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph15/at:resnet50:subgraph15:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 14255.333453351079/14255.333453351079
Best record value:14255.333453351079 (larger is better)
Round 1, Match 1, Mapping 1: 14255.333453351079/14255.333453351079(0.07014918334056398 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [32, 1, 1, 1], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 22583.110428718144/22583.110428718144
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 2: 22583.110428718144/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [16, 2, 1, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 2977.781430842976/2977.781430842976
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 3: 2977.781430842976/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [8, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1, 448, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 7341.160215318329/7341.160215318329
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 4: 7341.160215318329/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [2, 2, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[224, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 16954.551516890893/16954.551516890893
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 5: 16954.551516890893/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 16, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[1, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 6: 1e-10/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 6998.955301976299/6998.955301976299
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 7: 6998.955301976299/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [8, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 18485.539609297863/18485.539609297863
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 8: 18485.539609297863/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 8, 2, 1], [1, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*E
iteration=1: 18606.299583375727/18606.299583375727
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 9: 18606.299583375727/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 1, 2, 1], [1, 7, 1, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 9040.49177148785/9040.49177148785
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 10: 9040.49177148785/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 8, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[8, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 11431.224336218065/11431.224336218065
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 11: 11431.224336218065/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 4, 2, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[7, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 7799.958977755381/7799.958977755381
Best record value:22583.110428718144 (larger is better)
Round 1, Match 1, Mapping 12: 7799.958977755381/22583.110428718144(0.04428087987066367 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 5, 5], [8, 2, 1, 2]], "reduce_factors": [[4, 1, 4]], "last_factors": [[4, 112, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 22647.118024760868/22647.118024760868
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 13: 22647.118024760868/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[28, 28, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 3071.953691775112/3071.953691775112
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 14: 3071.953691775112/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 8, 1, 4], [7, 1, 1, 2]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[2, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 4997.867180896779/4997.867180896779
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 15: 4997.867180896779/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [16, 1, 1, 2], [1, 7, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[14, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*E
iteration=1: 19316.990560457834/19316.990560457834
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 16: 19316.990560457834/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 5933.2385394683115/5933.2385394683115
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 17: 5933.2385394683115/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 8], [1, 2, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 1306.9081279216305/1306.9081279216305
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 18: 1306.9081279216305/22647.118024760868(0.04415572872922134 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [1, 7, 1, 2]], "reduce_factors": [[1, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.E
*Y*E*Y
iteration=1: 6123.181877252375/6123.181877252375
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 19: 6123.181877252375/22647.118024760868(0.04415572872922134 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [2, 1, 4, 4], [1, 1, 1, 14]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 20507.285322666277/20507.285322666277
Best record value:22647.118024760868 (larger is better)
Round 1, Match 1, Mapping 20: 20507.285322666277/22647.118024760868(0.04415572872922134 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 0 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 4 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*Y*E
iteration=1: 1264.0672909673206/14255.333453351079
Best record value:22647.118024760868 (larger is better)
Round 2, Match 1, Mapping 1: 14255.333453351079/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [32, 1, 1, 1], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 19176.827330202/22583.110428718144
Best record value:22647.118024760868 (larger is better)
Round 2, Match 1, Mapping 2: 22583.110428718144/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [16, 2, 1, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 2316.8576501670086/2977.781430842976
Best record value:22647.118024760868 (larger is better)
Round 2, Match 1, Mapping 3: 2977.781430842976/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [8, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[1, 448, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 1748.8236118257387/7341.160215318329
Best record value:22647.118024760868 (larger is better)
Round 2, Match 1, Mapping 4: 7341.160215318329/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [2, 2, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[224, 2, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 7206.216309284392/16954.551516890893
Best record value:22647.118024760868 (larger is better)
Round 2, Match 1, Mapping 5: 16954.551516890893/22647.118024760868(0.04415572872922134 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 16, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[1, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 40789.584821588716/40789.584821588716
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 6: 40789.584821588716/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [4, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 5788.49028769673/6998.955301976299
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 7: 6998.955301976299/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [8, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 9616.517722624436/18485.539609297863
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 8: 18485.539609297863/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 8, 2, 1], [1, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[32, 49, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 10533.835628206789/18606.299583375727
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 9: 18606.299583375727/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [16, 1, 2, 1], [1, 7, 1, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[128, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14900.16723440064/14900.16723440064
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 10: 14900.16723440064/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 8, 1], [7, 2, 1, 1]], "reduce_factors": [[4, 2, 2]], "last_factors": [[8, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 3235.1765089964238/11431.224336218065
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 11: 11431.224336218065/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 4, 2, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[7, 56, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 20450.181565329705/20450.181565329705
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 12: 20450.181565329705/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 8, 1, 1]], "reduce_factors": [[1, 8, 2]], "last_factors": [[784, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 4758.561699962873/22647.118024760868
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 13: 22647.118024760868/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 1, 2], [14, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[28, 28, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 3662.419050893139/3662.419050893139
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 14: 3662.419050893139/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[2, 448, 7]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 6917.235870171687/6917.235870171687
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 15: 6917.235870171687/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [16, 1, 1, 2], [1, 7, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[14, 64, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 22445.743294997636/22445.743294997636
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 16: 22445.743294997636/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [16, 1, 1, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 3559.8771931427145/5933.2385394683115
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 17: 5933.2385394683115/40789.584821588716(0.024516062234365515 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 8], [1, 2, 7, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[28, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 23177.993214179027/23177.993214179027
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 18: 23177.993214179027/40789.584821588716(0.024516062234365515 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 2, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 11071.365417815492/11071.365417815492
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 19: 11071.365417815492/40789.584821588716(0.024516062234365515 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 8], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 112, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1961.2398626540328/20507.285322666277
Best record value:40789.584821588716 (larger is better)
Round 2, Match 1, Mapping 20: 20507.285322666277/40789.584821588716(0.024516062234365515 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 5, 1], [16, 1, 1, 2]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 6 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 7 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 5 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 6 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Tensorize use time 442.54131746292114 s.
#############################################
operations:inputs:[1, 256, 14, 14],[256],[256],body:S[1, 256, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 14, 14],body:S[1, 256, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 14, 14],body:S[1, 256, 16, 16] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 15)) && (v3 >= 1)) && (v3 < 15)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 16, 16],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 14, 14] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph16/at:resnet50:subgraph16:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 393.84652844873494/393.84652844873494
Best record value:393.84652844873494 (larger is better)
Round 1, Match 1, Mapping 2: 393.84652844873494/393.84652844873494(2.539060085 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 4], [1, 1, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[6, 4, 2], [3, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 415.7970891667782/415.7970891667782
Best record value:415.7970891667782 (larger is better)
Round 1, Match 1, Mapping 3: 415.7970891667782/415.7970891667782(2.4050192414860683 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 1], [1, 1, 3]], "last_factors": [[98, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 381.9173690225745/381.9173690225745
Best record value:415.7970891667782 (larger is better)
Round 1, Match 1, Mapping 4: 381.9173690225745/415.7970891667782(2.4050192414860683 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 12, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 517.2733340679789/517.2733340679789
Best record value:517.2733340679789 (larger is better)
Round 1, Match 1, Mapping 5: 517.2733340679789/517.2733340679789(1.9332139009287925 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[1, 1, 16], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 518.5978384771447/518.5978384771447
Best record value:518.5978384771447 (larger is better)
Round 1, Match 1, Mapping 6: 518.5978384771447/518.5978384771447(1.9282764520123838 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 12, 1], [3, 1, 1]], "last_factors": [[196, 2, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 3436.9448785439567/3436.9448785439567
Best record value:3436.9448785439567 (larger is better)
Round 1, Match 1, Mapping 7: 3436.9448785439567/3436.9448785439567(0.2909560773705643 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[98, 4, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3436.9448785439567 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/3436.9448785439567(0.2909560773705643 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:3436.9448785439567 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/3436.9448785439567(0.2909560773705643 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 4646.030817006458/4646.030817006458
Best record value:4646.030817006458 (larger is better)
Round 1, Match 1, Mapping 10: 4646.030817006458/4646.030817006458(0.21523748752151461 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[1, 56, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4646.030817006458 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/4646.030817006458(0.21523748752151461 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 5975.1414142275335/5975.1414142275335
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 12: 5975.1414142275335/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2]], "reduce_factors": [[24, 3, 2]], "last_factors": [[49, 32, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.E.Y.E
*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*E*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 2024.1556015607916/2024.1556015607916
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 17: 2024.1556015607916/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 4, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[24, 1, 6]], "last_factors": [[1, 112, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 2272.3323091605234/2272.3323091605234
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 18: 2272.3323091605234/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 2], [1, 2, 1, 4], [14, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 4469.999540601237/4469.999540601237
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 19: 4469.999540601237/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [2, 4, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[14, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 1: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.E.E.Y
*E
iteration=1: 1e-10/393.84652844873494
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 2: 393.84652844873494/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 1, 1, 4], [1, 1, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[6, 4, 2], [3, 1, 1]], "last_factors": [[7, 16, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 1391.4495759425467/1391.4495759425467
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 3: 1391.4495759425467/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[24, 2, 1], [1, 1, 3]], "last_factors": [[98, 16, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/381.9173690225745
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 4: 381.9173690225745/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[12, 12, 1]], "last_factors": [[4, 28, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 330.1674915252113/517.2733340679789
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 5: 517.2733340679789/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1], [1, 2, 7, 1]], "reduce_factors": [[1, 1, 16], [3, 1, 1], [3, 1, 1]], "last_factors": [[56, 1, 28]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 4467.971936920609/4467.971936920609
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 6: 4467.971936920609/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 12, 1], [3, 1, 1]], "last_factors": [[196, 2, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 1294.1421554045442/3436.9448785439567
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 7: 3436.9448785439567/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[98, 4, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.Y.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 8: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 4468.124686097077/4646.030817006458
Best record value:5975.1414142275335 (larger is better)
Round 2, Match 1, Mapping 10: 4646.030817006458/5975.1414142275335(0.16736005571665286 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[1, 56, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 6745.877648272191/6745.877648272191
Best record value:6745.877648272191 (larger is better)
Round 2, Match 1, Mapping 11: 6745.877648272191/6745.877648272191(0.14823868029330892 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [3, 1, 1]], "last_factors": [[8, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 247.78712285161407/5975.1414142275335
Best record value:6745.877648272191 (larger is better)
Round 2, Match 1, Mapping 12: 5975.1414142275335/6745.877648272191(0.14823868029330892 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2]], "reduce_factors": [[24, 3, 2]], "last_factors": [[49, 32, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.Y.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:6745.877648272191 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/6745.877648272191(0.14823868029330892 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*E
iteration=1: 731.7392739792884/731.7392739792884
Best record value:6745.877648272191 (larger is better)
Round 2, Match 1, Mapping 14: 731.7392739792884/6745.877648272191(0.14823868029330892 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 4, 1, 2], [2, 7, 1, 1]], "reduce_factors": [[16, 3, 1], [1, 1, 3]], "last_factors": [[196, 4, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 1858.386593360922/1858.386593360922
Best record value:6745.877648272191 (larger is better)
Round 2, Match 1, Mapping 15: 1858.386593360922/6745.877648272191(0.14823868029330892 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 2], [7, 1, 2, 1]], "reduce_factors": [[24, 2, 1], [3, 1, 1]], "last_factors": [[2, 56, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 10313.37113256204/10313.37113256204
Best record value:10313.37113256204 (larger is better)
Round 2, Match 1, Mapping 16: 10313.37113256204/10313.37113256204(0.09696150629571891 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [2, 2, 2, 1]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[4, 14, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 843.0264191374891/2024.1556015607916
Best record value:10313.37113256204 (larger is better)
Round 2, Match 1, Mapping 17: 2024.1556015607916/10313.37113256204(0.09696150629571891 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 4, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[24, 1, 6]], "last_factors": [[1, 112, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/2272.3323091605234
Best record value:10313.37113256204 (larger is better)
Round 2, Match 1, Mapping 18: 2272.3323091605234/10313.37113256204(0.09696150629571891 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 2], [1, 2, 1, 4], [14, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[49, 4, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 8062.17752116845/8062.17752116845
Best record value:10313.37113256204 (larger is better)
Round 2, Match 1, Mapping 19: 8062.17752116845/10313.37113256204(0.09696150629571891 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[14, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 5282.372906352256/5282.372906352256
Best record value:10313.37113256204 (larger is better)
Round 2, Match 1, Mapping 20: 5282.372906352256/10313.37113256204(0.09696150629571891 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 2, 1, 2]], "reduce_factors": [[4, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[49, 32, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 4 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Tensorize use time 655.7394602298737 s.
#############################################
operations:inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 14)) && (v3 >= 0)) && (v3 < 14)), T0[b, c, h, w], 0h) }$inputs:[1, 1024, 14, 14],[256, 1024, 1, 1],body:R[1, 256, 14, 14] [1024, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 1024, 14, 14] [256, 1024, 1, 1] [1, 256, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph17/at:resnet50:subgraph17:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 4441.115132027687/4441.115132027687
Best record value:4441.115132027687 (larger is better)
Round 1, Match 1, Mapping 2: 4441.115132027687/4441.115132027687(0.22516867279309385 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 2, 1, 2], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[16, 14, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 2565.131041338698/2565.131041338698
Best record value:4441.115132027687 (larger is better)
Round 1, Match 1, Mapping 3: 2565.131041338698/4441.115132027687(0.22516867279309385 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[2, 784, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 4990.5721783764075/4990.5721783764075
Best record value:4990.5721783764075 (larger is better)
Round 1, Match 1, Mapping 4: 4990.5721783764075/4990.5721783764075(0.20037782527881043 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2]], "last_factors": [[112, 2, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 9590.683898877953/9590.683898877953
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 5: 9590.683898877953/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 2, 4, 1], [1, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 1958.3734857594102/1958.3734857594102
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 6: 1958.3734857594102/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[112, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 4998.818310810686/4998.818310810686
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 7: 4998.818310810686/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 1587.1093681842935/1587.1093681842935
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 8: 1587.1093681842935/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 2, 1, 2], [1, 1, 1, 1], [1, 2, 1, 7]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[2, 196, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 7098.581682974411/7098.581682974411
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 9: 7098.581682974411/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 2], [1, 1, 4, 2], [7, 1, 2, 1]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[4, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*E*Y*Y
iteration=1: 8505.533546412324/8505.533546412324
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 10: 8505.533546412324/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [4, 1, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[32, 2, 1]], "last_factors": [[2, 49, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 4328.017687325591/4328.017687325591
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 11: 4328.017687325591/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [8, 1, 1, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[2, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 5020.29578003762/5020.29578003762
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 12: 5020.29578003762/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[8, 4, 2]], "last_factors": [[112, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 7869.929693664967/7869.929693664967
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 13: 7869.929693664967/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[28, 28, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 7731.454570990238/7731.454570990238
Best record value:9590.683898877953 (larger is better)
Round 1, Match 1, Mapping 14: 7731.454570990238/9590.683898877953(0.1042678510254095 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [1, 1, 7, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[14, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 10133.152660203921/10133.152660203921
Best record value:10133.152660203921 (larger is better)
Round 1, Match 1, Mapping 15: 10133.152660203921/10133.152660203921(0.09868597005622097 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[2, 32, 1], [1, 1, 1]], "last_factors": [[28, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 5069.855154238244/5069.855154238244
Best record value:10133.152660203921 (larger is better)
Round 1, Match 1, Mapping 16: 5069.855154238244/10133.152660203921(0.09868597005622097 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 1, 1, 2]], "reduce_factors": [[8, 2, 4], [1, 1, 1]], "last_factors": [[224, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 14239.114135068254/14239.114135068254
Best record value:14239.114135068254 (larger is better)
Round 1, Match 1, Mapping 17: 14239.114135068254/14239.114135068254(0.07022908802572124 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1]], "last_factors": [[16, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 8758.69826819507/8758.69826819507
Best record value:14239.114135068254 (larger is better)
Round 1, Match 1, Mapping 18: 8758.69826819507/14239.114135068254(0.07022908802572124 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 11242.203836018123/11242.203836018123
Best record value:14239.114135068254 (larger is better)
Round 1, Match 1, Mapping 19: 11242.203836018123/14239.114135068254(0.07022908802572124 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 2, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 7222.4686157268225/7222.4686157268225
Best record value:14239.114135068254 (larger is better)
Round 1, Match 1, Mapping 20: 7222.4686157268225/14239.114135068254(0.07022908802572124 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 5, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[8, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 20297.731157878403/20297.731157878403
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 1: 20297.731157878403/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[4, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 2, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 4621.948717981166/4621.948717981166
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 2: 4621.948717981166/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [1, 2, 4, 1], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[16, 2, 2], [1, 1, 1]], "last_factors": [[1, 98, 16]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 4121.861826947837/4121.861826947837
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 3: 4121.861826947837/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[5, 1, 1, 5], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1]], "last_factors": [[1, 49, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 6116.291159276098/6116.291159276098
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 4: 6116.291159276098/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 5, 1, 1], [1, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 8]], "last_factors": [[16, 98, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 4542.759944411814/9590.683898877953
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 5: 9590.683898877953/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 1], [1, 2, 4, 1], [1, 1, 1, 1], [14, 1, 1, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 4, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 10111.646284852717/10111.646284852717
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 6: 10111.646284852717/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[112, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 2447.6685345908986/4998.818310810686
Best record value:20297.731157878403 (larger is better)
Round 2, Match 1, Mapping 7: 4998.818310810686/20297.731157878403(0.049266590054911526 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [4, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 24527.005538371555/24527.005538371555
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 8: 24527.005538371555/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 8308.075768760462/8308.075768760462
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 9: 8308.075768760462/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 2, 1], [2, 2, 1, 2], [7, 2, 1, 1]], "reduce_factors": [[8, 8, 1], [1, 1, 1]], "last_factors": [[2, 49, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13595.385944308888/13595.385944308888
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 10: 13595.385944308888/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [14, 1, 1, 1]], "reduce_factors": [[16, 2, 2]], "last_factors": [[14, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.E.E.E.Y
*Y
iteration=1: 1236.5270712102617/4328.017687325591
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 11: 4328.017687325591/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 5, 1, 1], [8, 1, 1, 1]], "reduce_factors": [[4, 4, 4], [1, 1, 1]], "last_factors": [[2, 112, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/5020.29578003762
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 12: 5020.29578003762/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [2, 1, 2, 2]], "reduce_factors": [[8, 4, 2]], "last_factors": [[112, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 2324.4326730068988/7869.929693664967
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 13: 7869.929693664967/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[28, 28, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*E*Y*E
iteration=1: 1016.876404450655/7731.454570990238
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 14: 7731.454570990238/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 1, 2, 1], [1, 1, 7, 2]], "reduce_factors": [[32, 2, 1], [1, 1, 1]], "last_factors": [[14, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 13549.49513971184/13549.49513971184
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 15: 13549.49513971184/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 2, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 4, 2], [1, 1, 1]], "last_factors": [[196, 8, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 5993.621865951827/5993.621865951827
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 16: 5993.621865951827/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [2, 2, 1, 2]], "reduce_factors": [[16, 1, 4], [1, 1, 1]], "last_factors": [[224, 7, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 4540.696287957654/14239.114135068254
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 17: 14239.114135068254/24527.005538371555(0.04077138558294605 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[16, 4, 1]], "last_factors": [[16, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 2401.2829384940387/8758.69826819507
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 18: 8758.69826819507/24527.005538371555(0.04077138558294605 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 2], [4, 2, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[32, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 7550.7011123385955/11242.203836018123
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 19: 11242.203836018123/24527.005538371555(0.04077138558294605 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [4, 1, 2, 1], [2, 1, 1, 7]], "reduce_factors": [[8, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 12433.731672251628/12433.731672251628
Best record value:24527.005538371555 (larger is better)
Round 2, Match 1, Mapping 20: 12433.731672251628/24527.005538371555(0.04077138558294605 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 5, 1], [4, 1, 2, 1]], "reduce_factors": [[64, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 7 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,0): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 4 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 7 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 4 schedules
Tensorize use time 438.8731138706207 s.
#############################################
operations:inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1024],[1024],body:S[1, 1024, 14, 14] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 1024, 14, 14],[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 1024, 14, 14],body:S[1, 1024, 14, 14] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] [1024] [1024] [1, 1024, 14, 14] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph34.log by 200 trials...
.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.B.B.B.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.B.N.N.N

Currently best performance: 0.020069626384491553
.N.N.N.B.E.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.005360879452620568
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.B.N.N.N.N.N

Currently best performance: 0.005295194321232132
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.005295194321232132
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.B.N

Currently best performance: 0.004663729338815051
.Y.Y.Y.E.Y.Y.Y.E.T.E.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.004663729338815051
.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004663729338815051
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.004663729338815051
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.004663729338815051
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.B.N.N.N.N.N.N.N.N

Currently best performance: 0.003615913281221944
.Y.E.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.003615913281221944
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.E.N.N

Currently best performance: 0.003615913281221944
.N.N.N.N.N.NSchedule cost 899.246333 seconds
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[1024, 512, 1, 1],body:R[1, 1024, 14, 14] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [1024, 512, 1, 1] [1, 1024, 14, 14] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph35/at:resnet50:subgraph35:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 4628.354357480537/4628.354357480537
Best record value:4628.354357480537 (larger is better)
Round 1, Match 1, Mapping 1: 4628.354357480537/4628.354357480537(0.21605951549145297 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 4, 1, 1], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4628.354357480537 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/4628.354357480537(0.21605951549145297 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 16851.968057522652/16851.968057522652
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 3: 16851.968057522652/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 2019.5540016942655/2019.5540016942655
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 5: 2019.5540016942655/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 4, 1], [1, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 3930.8582222572786/3930.8582222572786
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 6: 3930.8582222572786/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [2, 16, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 14949.93900567266/14949.93900567266
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 7: 14949.93900567266/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 16, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 1161.5902443949287/1161.5902443949287
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 8: 1161.5902443949287/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 4, 1, 2], [1, 1, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[2, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 3163.8890613939516/3163.8890613939516
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 9: 3163.8890613939516/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 4], [1, 2, 7, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 200.6147210201586/200.6147210201586
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 10: 200.6147210201586/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 16, 1, 2], [1, 14, 1, 1]], "reduce_factors": [[2, 8, 2]], "last_factors": [[16, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 1877.5055873817275/1877.5055873817275
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 11: 1877.5055873817275/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 25, 1, 1], [32, 1, 1, 1]], "reduce_factors": [[1, 16, 2], [1, 1, 1]], "last_factors": [[7, 896, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 11495.97902433746/11495.97902433746
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 12: 11495.97902433746/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 25], [8, 1, 2, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[64, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 2692.2779061116153/2692.2779061116153
Best record value:16851.968057522652 (larger is better)
Round 1, Match 1, Mapping 13: 2692.2779061116153/16851.968057522652(0.059340250146842875 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [8, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[2, 448, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 32334.377698900957/32334.377698900957
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 14: 32334.377698900957/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 1513.6157323195732/1513.6157323195732
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 15: 1513.6157323195732/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 1], [2, 16, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[2, 2, 8], [1, 1, 1]], "last_factors": [[2, 1568, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 7762.451339542806/7762.451339542806
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 16: 7762.451339542806/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [8, 4, 1, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 13377.44934239924/13377.44934239924
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 17: 13377.44934239924/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [32, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 6723.930455634667/6723.930455634667
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 18: 6723.930455634667/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 2, 4, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 20301.301208872694/20301.301208872694
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 19: 20301.301208872694/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 1, 2, 1], [2, 1, 1, 7]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 2794.332559925139/2794.332559925139
Best record value:32334.377698900957 (larger is better)
Round 1, Match 1, Mapping 20: 2794.332559925139/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 5, 1, 5], [4, 1, 1, 8]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 32, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/4628.354357480537
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 1: 4628.354357480537/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [8, 4, 1, 1], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 392, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.E.E
*E*E
iteration=1: 1e-10/1e-10
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 2: 1e-10/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/16851.968057522652
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 3: 16851.968057522652/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[25, 1, 1, 1], [2, 1, 8, 2], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 20985.36502330504/20985.36502330504
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 4: 20985.36502330504/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 2, 4, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 254.7620786946482/2019.5540016942655
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 5: 2019.5540016942655/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [4, 2, 4, 1], [1, 1, 1, 1], [2, 7, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 4091.0599602690804/4091.0599602690804
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 6: 4091.0599602690804/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[5, 1, 1, 5], [2, 16, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 8, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 16943.951883602298/16943.951883602298
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 7: 16943.951883602298/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [8, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 13769.010483626322/13769.010483626322
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 8: 13769.010483626322/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 1, 8, 1], [1, 1, 1, 1], [7, 2, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 2528.286580184609/3163.8890613939516
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 9: 3163.8890613939516/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 4], [1, 2, 7, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 171.62559589640455/200.6147210201586
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 10: 200.6147210201586/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [1, 16, 1, 2], [1, 14, 1, 1]], "reduce_factors": [[2, 8, 2]], "last_factors": [[16, 49, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 6735.680076853467/6735.680076853467
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 11: 6735.680076853467/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[25, 1, 1, 1], [2, 8, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1]], "last_factors": [[49, 4, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 5477.49042635288/11495.97902433746
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 12: 11495.97902433746/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 25], [8, 1, 2, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[64, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 10425.832394024052/10425.832394024052
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 13: 10425.832394024052/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [8, 1, 4, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[196, 16, 2]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 2235.990671446919/32334.377698900957
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 14: 32334.377698900957/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 2, 1], [32, 1, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[196, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 7147.715261397657/7147.715261397657
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 15: 7147.715261397657/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 16, 1], [7, 1, 1, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 17852.655097328654/17852.655097328654
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 16: 17852.655097328654/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[5, 1, 1, 5], [4, 2, 4, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[128, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 1457.2836722109248/13377.44934239924
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 17: 13377.44934239924/32334.377698900957(0.030926836115791088 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [32, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[8, 4, 1]], "last_factors": [[8, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 12943.726089701671/12943.726089701671
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 18: 12943.726089701671/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [16, 2, 1, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 1057.96563785023/20301.301208872694
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 19: 20301.301208872694/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 1], [16, 1, 2, 1], [2, 1, 1, 7]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 6840.61572315326/6840.61572315326
Best record value:32334.377698900957 (larger is better)
Round 2, Match 1, Mapping 20: 6840.61572315326/32334.377698900957(0.030926836115791088 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [4, 1, 4, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 98, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.24150629157585726, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526, 0.039920721496007526]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 5 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 4 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 5 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 7 schedules
Tensorize use time 487.1243362426758 s.
#############################################
operations:inputs:[1, 256, 28, 28],[256],[256],body:S[1, 256, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 28, 28],body:S[1, 256, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 256, 28, 28],body:S[1, 256, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 256, 30, 30],[256, 256, 3, 3],body:R[1, 256, 14, 14] [256, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 28, 28] [256] [256] [256, 256, 3, 3] [1, 256, 14, 14] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph37/at:resnet50:subgraph37:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 2684.432138817375/2684.432138817375
Best record value:2684.432138817375 (larger is better)
Round 1, Match 1, Mapping 1: 2684.432138817375/2684.432138817375(0.3725182639336711 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1], [1, 1, 1, 14]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.E
*E*E*Y
iteration=1: 2243.4829399998525/2243.4829399998525
Best record value:2684.432138817375 (larger is better)
Round 1, Match 1, Mapping 2: 2243.4829399998525/2684.432138817375(0.3725182639336711 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 2, 1, 4], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[1, 112, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 4862.642659123564/4862.642659123564
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 3: 4862.642659123564/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 1], [3, 1, 1]], "last_factors": [[8, 14, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 4305.5272253683615/4305.5272253683615
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 4: 4305.5272253683615/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[392, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 4001.939995840658/4001.939995840658
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 5: 4001.939995840658/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 158.00458686999676/158.00458686999676
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 6: 158.00458686999676/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[3, 8, 2], [3, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 1865.7174259015426/1865.7174259015426
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 8: 1865.7174259015426/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[16, 3, 1], [3, 1, 1]], "last_factors": [[4, 392, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 597.0509211347822/597.0509211347822
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 9: 597.0509211347822/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 2], [1, 7, 2, 1]], "reduce_factors": [[6, 2, 4], [3, 1, 1]], "last_factors": [[32, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 2346.9541557540206/2346.9541557540206
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 10: 2346.9541557540206/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 4, 1], [7, 2, 1, 1]], "reduce_factors": [[48, 1, 3]], "last_factors": [[56, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 2651.0700841465837/2651.0700841465837
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 12: 2651.0700841465837/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2]], "reduce_factors": [[12, 12, 1]], "last_factors": [[1, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 176.8352359104152/176.8352359104152
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 14: 176.8352359104152/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 1], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 4, 3], [3, 1, 1]], "last_factors": [[8, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 15: 1e-10/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.E.Y.Y
*Y*E
iteration=1: 2105.106634846304/2105.106634846304
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 16: 2105.106634846304/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[7, 28, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 4676.699220264771/4676.699220264771
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 17: 4676.699220264771/4862.642659123564(0.2056494935163997 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 2], [2, 2, 1, 2], [2, 1, 7, 1]], "reduce_factors": [[24, 3, 2]], "last_factors": [[98, 1, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 660.3362006741743/660.3362006741743
Best record value:4862.642659123564 (larger is better)
Round 1, Match 1, Mapping 18: 660.3362006741743/4862.642659123564(0.2056494935163997 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[16, 14, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 5207.797200559129/5207.797200559129
Best record value:5207.797200559129 (larger is better)
Round 1, Match 1, Mapping 19: 5207.797200559129/5207.797200559129(0.19201976603325416 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [1, 2, 2, 2], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:5207.797200559129 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/5207.797200559129(0.19201976603325416 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 6153.8463384569295/6153.8463384569295
Best record value:6153.8463384569295 (larger is better)
Round 2, Match 1, Mapping 1: 6153.8463384569295/6153.8463384569295(0.16249999512512184 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 1], [4, 1, 1, 2], [1, 1, 1, 1], [1, 1, 1, 14]], "reduce_factors": [[8, 2, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 112, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/2243.4829399998525
Best record value:6153.8463384569295 (larger is better)
Round 2, Match 1, Mapping 2: 2243.4829399998525/6153.8463384569295(0.16249999512512184 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 2, 1, 4], [1, 1, 1, 1], [7, 1, 1, 2]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[1, 112, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 1539.2802110234027/4862.642659123564
Best record value:6153.8463384569295 (larger is better)
Round 2, Match 1, Mapping 3: 4862.642659123564/6153.8463384569295(0.16249999512512184 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 1, 5], [2, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[48, 1, 1], [3, 1, 1]], "last_factors": [[8, 14, 14]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/4305.5272253683615
Best record value:6153.8463384569295 (larger is better)
Round 2, Match 1, Mapping 4: 4305.5272253683615/6153.8463384569295(0.16249999512512184 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [2, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[72, 1, 2]], "last_factors": [[392, 4, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 6234.855517392137/6234.855517392137
Best record value:6234.855517392137 (larger is better)
Round 2, Match 1, Mapping 5: 6234.855517392137/6234.855517392137(0.16038864047619047 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1], [1, 1, 2, 7]], "reduce_factors": [[8, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[14, 28, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/158.00458686999676
Best record value:6234.855517392137 (larger is better)
Round 2, Match 1, Mapping 6: 158.00458686999676/6234.855517392137(0.16038864047619047 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 5, 5, 1], [1, 8, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[3, 8, 2], [3, 1, 1]], "last_factors": [[7, 56, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 1567.8732060938232/1567.8732060938232
Best record value:6234.855517392137 (larger is better)
Round 2, Match 1, Mapping 7: 1567.8732060938232/6234.855517392137(0.16038864047619047 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[5, 1, 5, 1], [1, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[56, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1865.7174259015426
Best record value:6234.855517392137 (larger is better)
Round 2, Match 1, Mapping 8: 1865.7174259015426/6234.855517392137(0.16038864047619047 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1], [2, 1, 1, 7]], "reduce_factors": [[16, 3, 1], [3, 1, 1]], "last_factors": [[4, 392, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 4277.186346065589/4277.186346065589
Best record value:6234.855517392137 (larger is better)
Round 2, Match 1, Mapping 9: 4277.186346065589/6234.855517392137(0.16038864047619047 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 2], [8, 1, 1, 1], [2, 1, 7, 1]], "reduce_factors": [[12, 4, 1], [3, 1, 1]], "last_factors": [[784, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 6817.498373917217/6817.498373917217
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 10: 6817.498373917217/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [2, 1, 4, 1], [7, 2, 1, 1]], "reduce_factors": [[48, 1, 3]], "last_factors": [[56, 14, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 1323.1822574866862/1323.1822574866862
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 11: 1323.1822574866862/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 25], [1, 2, 2, 2]], "reduce_factors": [[48, 1, 1], [1, 1, 3]], "last_factors": [[4, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/2651.0700841465837
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 12: 2651.0700841465837/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[5, 1, 5, 1], [4, 1, 1, 2]], "reduce_factors": [[12, 12, 1]], "last_factors": [[1, 196, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 344.7399277589553/344.7399277589553
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 14: 344.7399277589553/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [2, 2, 2, 1], [1, 7, 2, 1]], "reduce_factors": [[4, 4, 3], [3, 1, 1]], "last_factors": [[8, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1688.3955885847827/1688.3955885847827
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 15: 1688.3955885847827/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 1], [1, 4, 1, 2], [1, 1, 2, 7]], "reduce_factors": [[6, 8, 1], [3, 1, 1]], "last_factors": [[112, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1424.8667379394467/2105.106634846304
Best record value:6817.498373917217 (larger is better)
Round 2, Match 1, Mapping 16: 2105.106634846304/6817.498373917217(0.14668136978599927 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[25, 1, 1, 1], [1, 2, 2, 2]], "reduce_factors": [[24, 1, 2], [1, 3, 1]], "last_factors": [[7, 28, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*E*E
iteration=1: 10272.438119203533/10272.438119203533
Best record value:10272.438119203533 (larger is better)
Round 2, Match 1, Mapping 17: 10272.438119203533/10272.438119203533(0.09734787286093034 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 1], [4, 2, 1, 1], [7, 1, 2, 1]], "reduce_factors": [[8, 2, 9]], "last_factors": [[4, 14, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 769.9709325600294/769.9709325600294
Best record value:10272.438119203533 (larger is better)
Round 2, Match 1, Mapping 18: 769.9709325600294/10272.438119203533(0.09734787286093034 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 1], [2, 2, 2, 1], [2, 7, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[16, 14, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 16761.499743951506/16761.499743951506
Best record value:16761.499743951506 (larger is better)
Round 2, Match 1, Mapping 19: 16761.499743951506/16761.499743951506(0.05966053248670999 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 1], [4, 1, 2, 1], [7, 1, 2, 1]], "reduce_factors": [[2, 4, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[392, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 1866.833975498903/1866.833975498903
Best record value:16761.499743951506 (larger is better)
Round 2, Match 1, Mapping 20: 1866.833975498903/16761.499743951506(0.05966053248670999 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 5, 1, 5], [4, 1, 1, 2]], "reduce_factors": [[16, 1, 1], [1, 3, 1], [1, 3, 1]], "last_factors": [[56, 4, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.03992072149600751, 0.2415062915758572, 0.03992072149600751]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 6 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Tensorize use time 716.8539545536041 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[256, 512, 1, 1],body:R[1, 256, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [256, 512, 1, 1] [1, 256, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph38/at:resnet50:subgraph38:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*Y*E
iteration=1: 6470.384942381353/6470.384942381353
Best record value:6470.384942381353 (larger is better)
Round 1, Match 1, Mapping 1: 6470.384942381353/6470.384942381353(0.15455031020642201 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 1, 2, 4], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 23739.882849547856/23739.882849547856
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 2: 23739.882849547856/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [1, 2, 2, 2], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[98, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 6634.738905657676/6634.738905657676
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 3: 6634.738905657676/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 16, 1], [1, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.E.Y.Y
*Y*Y
iteration=1: 6771.834983925112/6771.834983925112
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 4: 6771.834983925112/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 2677.7045873369602/2677.7045873369602
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 5: 2677.7045873369602/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [1, 8, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.Y
*E*Y*Y
iteration=1: 12612.399116223118/12612.399116223118
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 6: 12612.399116223118/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[112, 8, 7]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 4377.124825481169/4377.124825481169
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 7: 4377.124825481169/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 49], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 16351.173382000981/16351.173382000981
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 8: 16351.173382000981/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1], [2, 1, 7, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 5164.760114991305/5164.760114991305
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 9: 5164.760114991305/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [4, 2, 1, 1], [2, 1, 7, 2]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[2, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*Y
iteration=1: 858.8516620789974/858.8516620789974
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 10: 858.8516620789974/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 4, 1], [1, 8, 1, 1], [2, 2, 1, 7]], "reduce_factors": [[8, 2, 2]], "last_factors": [[4, 224, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*E
iteration=1: 6808.212950316578/6808.212950316578
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 11: 6808.212950316578/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 4]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 15543.397626424821/15543.397626424821
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 12: 15543.397626424821/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[16, 196, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 11398.282485418678/11398.282485418678
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 13: 11398.282485418678/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [8, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1]], "last_factors": [[7, 112, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 9349.754269758281/9349.754269758281
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 14: 9349.754269758281/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [4, 1, 2, 1], [7, 4, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 13378.904573847703/13378.904573847703
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 15: 13378.904573847703/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[32, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*Y*Y*E
iteration=1: 13765.527769772001/13765.527769772001
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 16: 13765.527769772001/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 2]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 5124.4254216350455/5124.4254216350455
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 17: 5124.4254216350455/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 2, 1], [2, 2, 1, 2], [7, 1, 4, 1]], "reduce_factors": [[32, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 11364.71021576794/11364.71021576794
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 18: 11364.71021576794/23739.882849547856(0.04212320702412589 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [8, 1, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 16393.51798886447/16393.51798886447
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 19: 16393.51798886447/23739.882849547856(0.04212320702412589 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 4], [7, 2, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*Y*Y
iteration=1: 5608.4705826178715/5608.4705826178715
Best record value:23739.882849547856 (larger is better)
Round 1, Match 1, Mapping 20: 5608.4705826178715/23739.882849547856(0.04212320702412589 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 1, 1, 7], [2, 1, 4, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 112, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Original weights [0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 1608.8973872247923/6470.384942381353
Best record value:23739.882849547856 (larger is better)
Round 2, Match 1, Mapping 1: 6470.384942381353/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [1, 1, 2, 4], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 4473.607333097551/23739.882849547856
Best record value:23739.882849547856 (larger is better)
Round 2, Match 1, Mapping 2: 23739.882849547856/23739.882849547856(0.04212320702412589 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [1, 2, 2, 2], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[98, 8, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 25994.507384605895/25994.507384605895
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 3: 25994.507384605895/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 4], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/6771.834983925112
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 4: 6771.834983925112/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 4, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1]], "last_factors": [[4, 112, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/2677.7045873369602
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 5: 2677.7045873369602/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [1, 8, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 784, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 23319.01989330015/23319.01989330015
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 6: 23319.01989330015/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 1], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[64, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 675.8999154441207/4377.124825481169
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 7: 4377.124825481169/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 49], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*E
iteration=1: 1727.4004780256935/16351.173382000981
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 8: 16351.173382000981/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [4, 1, 2, 1], [1, 1, 1, 1], [2, 1, 7, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 18446.126222098097/18446.126222098097
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 9: 18446.126222098097/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 2], [2, 1, 1, 14]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[64, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1622.594340032852/1622.594340032852
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 10: 1622.594340032852/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 1, 4], [2, 2, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[8, 2, 2]], "last_factors": [[56, 112, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.E.Y.Y
*E*Y*E
iteration=1: 7186.695623912554/7186.695623912554
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 11: 7186.695623912554/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 14, 1], [1, 1, 2, 4]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*E*Y
iteration=1: 6722.752047179868/15543.397626424821
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 12: 15543.397626424821/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [2, 2, 1, 2]], "reduce_factors": [[2, 16, 1]], "last_factors": [[16, 196, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 14858.938058646803/14858.938058646803
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 13: 14858.938058646803/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [1, 4, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[196, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14922.614545767941/14922.614545767941
Best record value:25994.507384605895 (larger is better)
Round 2, Match 1, Mapping 14: 14922.614545767941/25994.507384605895(0.03846966534908086 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 1, 2], [4, 1, 2, 1], [7, 4, 1, 1]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 27758.8969874788/27758.8969874788
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 15: 27758.8969874788/27758.8969874788(0.03602448614766897 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 8, 2], [1, 1, 1]], "last_factors": [[32, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/13765.527769772001
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 16: 13765.527769772001/27758.8969874788(0.03602448614766897 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [1, 2, 2, 2]], "reduce_factors": [[4, 8, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 12656.571611332387/12656.571611332387
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 17: 12656.571611332387/27758.8969874788(0.03602448614766897 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[2, 1, 16]], "last_factors": [[14, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.E.Y
*E*Y
iteration=1: 1949.1730711212695/11364.71021576794
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 18: 11364.71021576794/27758.8969874788(0.03602448614766897 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [8, 1, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[2, 8, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 8, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*Y
iteration=1: 18872.158582904543/18872.158582904543
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 19: 18872.158582904543/27758.8969874788(0.03602448614766897 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 2426.9076520818835/5608.4705826178715
Best record value:27758.8969874788 (larger is better)
Round 2, Match 1, Mapping 20: 5608.4705826178715/27758.8969874788(0.03602448614766897 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 1, 1, 7], [2, 1, 4, 1]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 112, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 6 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 6 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 5 schedules
mapping (1,0,0,1,0,1,0): explored 4 schedules
Tensorize use time 456.3229911327362 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [1, 512, 28, 28] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph39.log by 200 trials...
.E.Y.E.Y.Y.Y.Y.T.E.Y.B.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.009979419054838231
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.B.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004680601864223758
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.T.Y.E.N.N.N.N.N.N.N

Currently best performance: 0.004680601864223758
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.004680601864223758
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.004680601864223758
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.004680601864223758
.N.N.N.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004680601864223758
.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.004680601864223758
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.E.T.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.004680601864223758
.N.N.N.N.N.Y.E.Y.E.Y.Y.Y.Y.Y.T.N.N.N.N.N.N.N

Currently best performance: 0.004680601864223758
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N

Currently best performance: 0.004624314945318821
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.004624314945318821
.N.N.N.N.N.N.N.NSchedule cost 1073.631854 seconds
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 128, 28, 28],[512, 128, 1, 1],body:R[1, 512, 28, 28] [128, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [512, 128, 1, 1] [1, 512, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph40/at:resnet50:subgraph40:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 5129.319380352782/5129.319380352782
Best record value:5129.319380352782 (larger is better)
Round 1, Match 1, Mapping 1: 5129.319380352782/5129.319380352782(0.19495763976608188 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 4, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1], [1, 2, 7, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 22081.165113791438/22081.165113791438
Best record value:22081.165113791438 (larger is better)
Round 1, Match 1, Mapping 2: 22081.165113791438/22081.165113791438(0.04528746535097555 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 4, 2, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[448, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 34728.89194941276/34728.89194941276
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 3: 34728.89194941276/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 7, 2], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[3136, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 30314.14144436037/30314.14144436037
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 4: 30314.14144436037/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 14, 1], [4, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 8]], "last_factors": [[256, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 29255.474697286463/29255.474697286463
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 5: 29255.474697286463/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*E*Y*E
iteration=1: 6568.867907026911/6568.867907026911
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 6: 6568.867907026911/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 49, 1, 2], [2, 1, 8, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 2], [1, 1, 1]], "last_factors": [[1792, 1, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 7: 1e-10/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 8105.583057857666/8105.583057857666
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 9: 8105.583057857666/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 4, 1], [2, 1, 2, 4], [2, 14, 1, 1]], "reduce_factors": [[2, 1, 4], [1, 1, 1]], "last_factors": [[448, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*E
iteration=1: 9434.635569705284/9434.635569705284
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 10: 9434.635569705284/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [1, 4, 4, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 9187.217394809826/9187.217394809826
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 11: 9187.217394809826/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 7, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[196, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 8006.306368234013/8006.306368234013
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 12: 8006.306368234013/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 7, 1, 2], [4, 4, 1, 1]], "reduce_factors": [[2, 1, 4]], "last_factors": [[56, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 20965.684088804737/20965.684088804737
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 13: 20965.684088804737/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[1, 4, 2], [1, 1, 1]], "last_factors": [[392, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 6583.609956408912/6583.609956408912
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 14: 6583.609956408912/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [4, 2, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 1]], "last_factors": [[28, 448, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 30005.677137560808/30005.677137560808
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 15: 30005.677137560808/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 25774.06262448959/25774.06262448959
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 16: 25774.06262448959/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [8, 2, 1, 1]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[14, 64, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 9706.948835171212/9706.948835171212
Best record value:34728.89194941276 (larger is better)
Round 1, Match 1, Mapping 17: 9706.948835171212/34728.89194941276(0.02879446892393321 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 4], [7, 1, 1, 4]], "reduce_factors": [[4, 1, 2]], "last_factors": [[14, 32, 28]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 45282.87896792729/45282.87896792729
Best record value:45282.87896792729 (larger is better)
Round 1, Match 1, Mapping 18: 45282.87896792729/45282.87896792729(0.02208340155908096 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [4, 1, 2, 2], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 36727.98849599447/36727.98849599447
Best record value:45282.87896792729 (larger is better)
Round 1, Match 1, Mapping 19: 36727.98849599447/45282.87896792729(0.02208340155908096 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 4], [7, 2, 1, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.E.E
*Y
iteration=1: 27975.461895486133/27975.461895486133
Best record value:45282.87896792729 (larger is better)
Round 1, Match 1, Mapping 20: 27975.461895486133/45282.87896792729(0.02208340155908096 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [8, 1, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 32, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 0 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 4 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 6803.341982113771/6803.341982113771
Best record value:45282.87896792729 (larger is better)
Round 2, Match 1, Mapping 1: 6803.341982113771/45282.87896792729(0.02208340155908096 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 4, 1, 1], [4, 2, 2, 1], [1, 1, 1, 1], [1, 2, 7, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 7, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 28970.286748118662/28970.286748118662
Best record value:45282.87896792729 (larger is better)
Round 2, Match 1, Mapping 2: 28970.286748118662/45282.87896792729(0.02208340155908096 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[4, 1, 1, 1], [2, 4, 2, 1], [1, 1, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[448, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 9806.713695254755/34728.89194941276
Best record value:45282.87896792729 (larger is better)
Round 2, Match 1, Mapping 3: 34728.89194941276/45282.87896792729(0.02208340155908096 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 7, 2], [4, 1, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[3136, 1, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 46043.52680292242/46043.52680292242
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 4: 46043.52680292242/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [8, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 2]], "last_factors": [[448, 28, 1]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 14226.835060262527/29255.474697286463
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 5: 29255.474697286463/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 4, 2, 1], [1, 1, 1, 1], [14, 1, 2, 1]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.E
*Y*E
iteration=1: 39086.37320724027/39086.37320724027
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 6: 39086.37320724027/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 7, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.E
*Y*Y
iteration=1: 7278.9740458472625/7278.9740458472625
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 7: 7278.9740458472625/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [1, 8, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 128, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*Y
iteration=1: 4839.468861315322/4839.468861315322
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 8: 4839.468861315322/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 1, 1], [2, 4, 1, 2], [1, 1, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 28013.848618327986/28013.848618327986
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 9: 28013.848618327986/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 4, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[2, 4, 1], [1, 1, 1]], "last_factors": [[112, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 10469.528291295197/10469.528291295197
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 10: 10469.528291295197/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [2, 4, 1, 2], [2, 7, 1, 2]], "reduce_factors": [[2, 2, 2]], "last_factors": [[448, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4038.03235071661/9187.217394809826
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 11: 9187.217394809826/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 7, 7, 1], [4, 1, 2, 2]], "reduce_factors": [[8, 1, 1], [1, 1, 1]], "last_factors": [[196, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 3274.807400729583/8006.306368234013
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 12: 8006.306368234013/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 7, 1, 2], [4, 4, 1, 1]], "reduce_factors": [[2, 1, 4]], "last_factors": [[56, 8, 28]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 10780.553160581161/20965.684088804737
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 13: 20965.684088804737/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 2, 2], [14, 2, 1, 1]], "reduce_factors": [[1, 4, 2], [1, 1, 1]], "last_factors": [[392, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 31878.088565006226/31878.088565006226
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 14: 31878.088565006226/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 1, 4, 1], [7, 1, 4, 1]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[16, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 23115.32951496066/30005.677137560808
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 15: 30005.677137560808/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 2, 2, 1], [16, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[1, 2, 4], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 2515.2676647278086/25774.06262448959
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 16: 25774.06262448959/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [8, 2, 1, 1]], "reduce_factors": [[1, 8, 1], [1, 1, 1]], "last_factors": [[14, 64, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 23357.448142915706/23357.448142915706
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 17: 23357.448142915706/46043.52680292242(0.02171857955799618 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [4, 2, 1, 2], [7, 1, 2, 2]], "reduce_factors": [[2, 4, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 30287.135124887805/45282.87896792729
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 18: 45282.87896792729/46043.52680292242(0.02171857955799618 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [4, 1, 2, 2], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 4, 4]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 34940.512901261856/36727.98849599447
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 19: 36727.98849599447/46043.52680292242(0.02171857955799618 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 4], [7, 2, 1, 2]], "reduce_factors": [[1, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[6272, 2, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 40425.24203638276/40425.24203638276
Best record value:46043.52680292242 (larger is better)
Round 2, Match 1, Mapping 20: 40425.24203638276/46043.52680292242(0.02171857955799618 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 7, 7], [8, 1, 1, 2]], "reduce_factors": [[4, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[256, 7, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 7 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 7 schedules
mapping (0,0,0,1,0,0,0): explored 8 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,1): explored 5 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 7 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 8 schedules
mapping (1,0,0,1,0,0,0): explored 8 schedules
mapping (1,0,0,1,0,1,0): explored 5 schedules
Tensorize use time 396.17945861816406 s.
#############################################
operations:inputs:[1, 128, 28, 28],[128],[128],body:S[1, 128, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 28, 28],body:S[1, 128, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 28, 28],body:S[1, 128, 30, 30] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 29)) && (v3 >= 1)) && (v3 < 29)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 30, 30],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 28, 28] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph41/at:resnet50:subgraph41:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 7492.349815430471/7492.349815430471
Best record value:7492.349815430471 (larger is better)
Round 1, Match 1, Mapping 1: 7492.349815430471/7492.349815430471(0.13346947548291235 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 2, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[49, 2, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 4488.343560339433/4488.343560339433
Best record value:7492.349815430471 (larger is better)
Round 1, Match 1, Mapping 2: 4488.343560339433/7492.349815430471(0.13346947548291235 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 1, 1, 2], [1, 1, 1, 1], [4, 1, 7, 1]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[16, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:7492.349815430471 (larger is better)
Round 1, Match 1, Mapping 3: 1e-10/7492.349815430471(0.13346947548291235 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:7492.349815430471 (larger is better)
Round 1, Match 1, Mapping 4: 1e-10/7492.349815430471(0.13346947548291235 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:7492.349815430471 (larger is better)
Round 1, Match 1, Mapping 5: 1e-10/7492.349815430471(0.13346947548291235 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 9617.93357658539/9617.93357658539
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 6: 9617.93357658539/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 12, 1], [1, 1, 3]], "last_factors": [[7, 14, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 1229.739405922491/1229.739405922491
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 7: 1229.739405922491/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 1, 3]], "last_factors": [[1, 1568, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 4873.609984487381/4873.609984487381
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 8: 4873.609984487381/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 2, 1, 7]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[16, 196, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 280.31617073937986/280.31617073937986
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 10: 280.31617073937986/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [1, 2, 1, 2], [2, 7, 2, 1]], "reduce_factors": [[8, 1, 9]], "last_factors": [[196, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 11: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 2061.741639464295/2061.741639464295
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 12: 2061.741639464295/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 7, 2, 1], [4, 1, 1, 1]], "reduce_factors": [[72, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 14: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 5040.55359320703/5040.55359320703
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 15: 5040.55359320703/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [1, 7, 2, 2]], "reduce_factors": [[3, 1, 8], [3, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 2254.6481265112325/2254.6481265112325
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 16: 2254.6481265112325/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 1, 1, 7], [1, 2, 2, 1]], "reduce_factors": [[2, 12, 1], [3, 1, 1]], "last_factors": [[1, 112, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1989.9297077230044/1989.9297077230044
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 18: 1989.9297077230044/9617.93357658539(0.10397243774218551 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 1], [1, 14, 2, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[28, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9617.93357658539 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/9617.93357658539(0.10397243774218551 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 0 schedules
mapping (0,0,0,0,1,1,1): explored 0 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 0 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*Y*E
iteration=1: 811.3572087422317/7492.349815430471
Best record value:9617.93357658539 (larger is better)
Round 2, Match 1, Mapping 1: 7492.349815430471/9617.93357658539(0.10397243774218551 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[2, 2, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[49, 2, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 11325.282756065553/11325.282756065553
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 2: 11325.282756065553/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 1, 1, 2], [1, 1, 1, 1], [4, 1, 7, 1]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[16, 14, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 1381.8484230169668/1381.8484230169668
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 3: 1381.8484230169668/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 14, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 3, 1], [1, 3, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 1189.5478552393192/1189.5478552393192
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 4: 1189.5478552393192/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 14, 1, 7], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[36, 1, 2]], "last_factors": [[196, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.E.E
*E
iteration=1: 1e-10/1e-10
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 5: 1e-10/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 438.782513230658/9617.93357658539
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 6: 9617.93357658539/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 12, 1], [1, 1, 3]], "last_factors": [[7, 14, 32]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1401.2418020733162/1401.2418020733162
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 7: 1401.2418020733162/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 7, 1, 7], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[1, 784, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/4873.609984487381
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 8: 4873.609984487381/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [2, 2, 1, 7]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[16, 196, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:11325.282756065553 (larger is better)
Round 2, Match 1, Mapping 9: 1e-10/11325.282756065553(0.08829801617663133 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.E
*Y*Y*E
iteration=1: 14964.348442741195/14964.348442741195
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 10: 14964.348442741195/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 2, 2], [2, 1, 1, 2], [14, 1, 1, 2]], "reduce_factors": [[6, 2, 6]], "last_factors": [[32, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 11: 1e-10/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 2461.9056942404764/2461.9056942404764
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 12: 2461.9056942404764/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 1, 14, 7], [4, 1, 1, 1]], "reduce_factors": [[72, 1, 1]], "last_factors": [[7, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 13: 1e-10/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*Y
iteration=1: 281.5121914379179/281.5121914379179
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 14: 281.5121914379179/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 4, 1, 1], [1, 4, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 1, 12], [3, 1, 1]], "last_factors": [[8, 392, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/5040.55359320703
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 15: 5040.55359320703/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [1, 7, 2, 2]], "reduce_factors": [[3, 1, 8], [3, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 3835.9094081619387/3835.9094081619387
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 16: 3835.9094081619387/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [2, 2, 1, 1]], "reduce_factors": [[2, 3, 4], [3, 1, 1]], "last_factors": [[98, 16, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*E
iteration=1: 2021.908164931149/2021.908164931149
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 17: 2021.908164931149/14964.348442741195(0.06682549553202052 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 4, 1, 1], [1, 1, 2, 2], [7, 2, 2, 1]], "reduce_factors": [[12, 2, 3]], "last_factors": [[16, 49, 4]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 5040.021124030259/5040.021124030259
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 18: 5040.021124030259/14964.348442741195(0.06682549553202052 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [2, 1, 1, 2], [2, 1, 2, 7]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[7, 28, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/14964.348442741195(0.06682549553202052 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*E
iteration=1: 522.1972671926401/522.1972671926401
Best record value:14964.348442741195 (larger is better)
Round 2, Match 1, Mapping 20: 522.1972671926401/14964.348442741195(0.06682549553202052 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 14, 7, 1], [2, 2, 1, 1]], "reduce_factors": [[4, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[392, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 6 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 0 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 5 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 0 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Tensorize use time 778.4649293422699 s.
#############################################
operations:inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 28)) && (v3 >= 0)) && (v3 < 28)), T0[b, c, h, w], 0h) }$inputs:[1, 512, 28, 28],[128, 512, 1, 1],body:R[1, 128, 28, 28] [512, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 512, 28, 28] [128, 512, 1, 1] [1, 128, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph42/at:resnet50:subgraph42:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 10654.477779093535/10654.477779093535
Best record value:10654.477779093535 (larger is better)
Round 1, Match 1, Mapping 1: 10654.477779093535/10654.477779093535(0.09385725145180024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [1, 1, 1, 4], [1, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 7050.627184948522/7050.627184948522
Best record value:10654.477779093535 (larger is better)
Round 1, Match 1, Mapping 2: 7050.627184948522/10654.477779093535(0.09385725145180024 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1], [4, 7, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 21254.89443891168/21254.89443891168
Best record value:21254.89443891168 (larger is better)
Round 1, Match 1, Mapping 3: 21254.89443891168/21254.89443891168(0.04704798712946246 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 7, 2], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 325.91762053098887/325.91762053098887
Best record value:21254.89443891168 (larger is better)
Round 1, Match 1, Mapping 4: 325.91762053098887/21254.89443891168(0.04704798712946246 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 49, 1, 1], [2, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 8]], "last_factors": [[28, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*E
iteration=1: 25579.91638024643/25579.91638024643
Best record value:25579.91638024643 (larger is better)
Round 1, Match 1, Mapping 5: 25579.91638024643/25579.91638024643(0.039093169232258695 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 1993.1798822193025/1993.1798822193025
Best record value:25579.91638024643 (larger is better)
Round 1, Match 1, Mapping 6: 1993.1798822193025/25579.91638024643(0.039093169232258695 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 49, 1, 2], [1, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[2, 49, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 21213.846027050466/21213.846027050466
Best record value:25579.91638024643 (larger is better)
Round 1, Match 1, Mapping 7: 21213.846027050466/25579.91638024643(0.039093169232258695 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 7, 7], [4, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 20045.27550323637/20045.27550323637
Best record value:25579.91638024643 (larger is better)
Round 1, Match 1, Mapping 8: 20045.27550323637/25579.91638024643(0.039093169232258695 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 2, 1], [1, 1, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[224, 14, 1]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 30953.43351146665/30953.43351146665
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 9: 30953.43351146665/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [2, 1, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[49, 8, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 10: 1e-10/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 19772.64577531869/19772.64577531869
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 11: 19772.64577531869/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*E*Y*Y
iteration=1: 2625.8709509539726/2625.8709509539726
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 12: 2625.8709509539726/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 14], [1, 2, 2, 1]], "reduce_factors": [[4, 2, 4]], "last_factors": [[14, 112, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 28390.64288073314/28390.64288073314
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 13: 28390.64288073314/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [1, 1, 2, 2], [14, 1, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 4575.099556355915/4575.099556355915
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 14: 4575.099556355915/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [1, 2, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 4830.3490138312445/4830.3490138312445
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 15: 4830.3490138312445/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [1, 4, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[1, 2, 16], [1, 1, 1]], "last_factors": [[4, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 22490.643121512916/22490.643121512916
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 16: 22490.643121512916/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [1, 2, 2, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 22265.93985945097/22265.93985945097
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 17: 22265.93985945097/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [1, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 22933.82156792194/22933.82156792194
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 18: 22933.82156792194/30953.43351146665(0.032306593697579676 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 2], [1, 2, 2, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 3970.4714650941432/3970.4714650941432
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 19: 3970.4714650941432/30953.43351146665(0.032306593697579676 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 6509.200797988942/6509.200797988942
Best record value:30953.43351146665 (larger is better)
Round 1, Match 1, Mapping 20: 6509.200797988942/30953.43351146665(0.032306593697579676 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 14, 1, 1], [2, 2, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 0 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 4 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 2 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 7469.259536594106/10654.477779093535
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 1: 10654.477779093535/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[4, 1, 1, 1], [1, 1, 1, 4], [1, 1, 1, 1], [2, 2, 7, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[8, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 7178.508623380482/7178.508623380482
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 2: 7178.508623380482/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [4, 1, 1, 1], [1, 1, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[1, 4, 8], [1, 1, 1]], "last_factors": [[7, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 13206.026119901542/21254.89443891168
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 3: 21254.89443891168/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 1, 7, 2], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 14992.970848930243/14992.970848930243
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 4: 14992.970848930243/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 7], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 8]], "last_factors": [[32, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 16147.208791063944/25579.91638024643
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 5: 25579.91638024643/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 1, 1, 2], [1, 1, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[8, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.E
*E*Y
iteration=1: 25314.017689741693/25314.017689741693
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 6: 25314.017689741693/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [1, 1, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[98, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 2929.295045119821/21213.846027050466
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 7: 21213.846027050466/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 1, 7, 7], [4, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[16, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 25651.314670152293/25651.314670152293
Best record value:30953.43351146665 (larger is better)
Round 2, Match 1, Mapping 8: 25651.314670152293/30953.43351146665(0.032306593697579676 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [4, 1, 1, 1], [1, 1, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 37768.6844082535/37768.6844082535
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 9: 37768.6844082535/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [2, 1, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[16, 2, 1], [1, 1, 1]], "last_factors": [[49, 8, 8]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*E*E
iteration=1: 3968.703418077717/3968.703418077717
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 10: 3968.703418077717/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 1, 2], [1, 2, 1, 2], [7, 1, 1, 4]], "reduce_factors": [[8, 4, 1]], "last_factors": [[1, 392, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 17262.321255791605/19772.64577531869
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 11: 19772.64577531869/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [1, 1, 2, 2]], "reduce_factors": [[32, 1, 1], [1, 1, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 22298.85378010091/22298.85378010091
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 12: 22298.85378010091/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 1, 1, 7], [1, 2, 2, 1]], "reduce_factors": [[8, 2, 2]], "last_factors": [[14, 8, 28]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 29641.10735471474/29641.10735471474
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 13: 29641.10735471474/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [1, 1, 2, 2], [14, 1, 1, 2]], "reduce_factors": [[4, 2, 4], [1, 1, 1]], "last_factors": [[112, 28, 1]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 2895.082364740821/4575.099556355915
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 14: 4575.099556355915/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 2, 1, 1], [1, 2, 2, 1], [14, 2, 1, 1]], "reduce_factors": [[8, 4, 1], [1, 1, 1]], "last_factors": [[2, 784, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 11807.177584243373/11807.177584243373
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 15: 11807.177584243373/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 4], [1, 2, 2, 1], [7, 1, 4, 1]], "reduce_factors": [[8, 2, 2], [1, 1, 1]], "last_factors": [[56, 56, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 11369.401408395683/22490.643121512916
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 16: 22490.643121512916/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 1, 1, 2], [1, 2, 2, 1]], "reduce_factors": [[4, 1, 8], [1, 1, 1]], "last_factors": [[56, 7, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 19700.215251183345/22265.93985945097
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 17: 22265.93985945097/37768.6844082535(0.0264769614210198 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [1, 2, 2, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 2]], "last_factors": [[98, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 24017.486215046403/24017.486215046403
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 18: 24017.486215046403/37768.6844082535(0.0264769614210198 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [2, 2, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 1202.391253408155/3970.4714650941432
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 19: 3970.4714650941432/37768.6844082535(0.0264769614210198 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 2, 1, 1], [1, 4, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[2, 4, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 16, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/6509.200797988942
Best record value:37768.6844082535 (larger is better)
Round 2, Match 1, Mapping 20: 6509.200797988942/37768.6844082535(0.0264769614210198 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 14, 1, 1], [2, 2, 1, 1]], "reduce_factors": [[4, 4, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 7 schedules
mapping (0,0,0,0,1,1,1): explored 4 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 7 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 8 schedules
mapping (0,0,1,0,1,1,1): explored 5 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 6 schedules
mapping (1,0,0,0,0,1,0): explored 5 schedules
mapping (1,0,0,1,0,0,0): explored 7 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Tensorize use time 446.1899263858795 s.
#############################################
operations:inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[512],[512],body:S[1, 512, 28, 28] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 512, 28, 28],[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 512, 28, 28],body:S[1, 512, 28, 28] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 512, 28, 28] [512] [512] [1, 512, 28, 28] [512] [512] [1, 512, 28, 28] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph51.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.N.N.N.N.E.Y.E.Y.Y.Y.Y.E.Y.Y.N.N.N.N

Currently best performance: 0.02167503553710251
.N.B.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.Y.Y.Y.Y.Y.N.B

Currently best performance: 0.007035936463316255
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.T.Y.Y.Y.E.N.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.N.Y.T.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.007035936463316255
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.E.Y.Y.Y.Y.N

Currently best performance: 0.007035936463316255
.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.007035936463316255
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.007035936463316255
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.007035936463316255
.N.N.N.N.N.N.N.NSchedule cost 964.486456 seconds
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[512, 256, 1, 1],body:R[1, 512, 28, 28] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [512, 256, 1, 1] [1, 512, 28, 28] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph52/at:resnet50:subgraph52:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 24488.644123710546/24488.644123710546
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 1: 24488.644123710546/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 22470.30998399912/22470.30998399912
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 2: 22470.30998399912/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 16414.47119927761/16414.47119927761
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 3: 16414.47119927761/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 10688.220518969887/10688.220518969887
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 4: 10688.220518969887/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 1, 2], [2, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[16, 784, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3889.292592127588/3889.292592127588
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 5: 3889.292592127588/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 4, 1, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*Y
iteration=1: 2370.839508110834/2370.839508110834
Best record value:24488.644123710546 (larger is better)
Round 1, Match 1, Mapping 6: 2370.839508110834/24488.644123710546(0.04083525388127854 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 7, 1], [2, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[1, 6272, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 25702.95722287696/25702.95722287696
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 7: 25702.95722287696/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 14, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 1842.7787278825554/1842.7787278825554
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 10: 1842.7787278825554/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 1, 1], [1, 16, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[196, 8, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 305.1136844511133/305.1136844511133
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 11: 305.1136844511133/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 49, 2, 1], [2, 2, 1, 4]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[16, 56, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 2514.117001930043/2514.117001930043
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 12: 2514.117001930043/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 2, 7], [1, 8, 1, 2]], "reduce_factors": [[2, 2, 4]], "last_factors": [[16, 56, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 4816.61017146181/4816.61017146181
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 13: 4816.61017146181/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 8], [7, 2, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[8, 196, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 8745.568952981228/8745.568952981228
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 14: 8745.568952981228/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 8, 2, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 11644.718318369705/11644.718318369705
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 15: 11644.718318369705/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [8, 2, 1, 1], [4, 1, 7, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[16, 56, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 7372.897507502958/7372.897507502958
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 16: 7372.897507502958/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 17737.777902293372/17737.777902293372
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 17: 17737.777902293372/25702.95722287696(0.03890602903505393 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 2, 1, 1], [1, 2, 2, 7]], "reduce_factors": [[2, 1, 8]], "last_factors": [[224, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 12353.140078893342/12353.140078893342
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 18: 12353.140078893342/25702.95722287696(0.03890602903505393 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [2, 2, 4, 1], [14, 1, 1, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/25702.95722287696(0.03890602903505393 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 4937.845262587074/4937.845262587074
Best record value:25702.95722287696 (larger is better)
Round 1, Match 1, Mapping 20: 4937.845262587074/25702.95722287696(0.03890602903505393 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 49, 2, 1], [16, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 896, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 5 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 27049.447536900007/27049.447536900007
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 1: 27049.447536900007/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [8, 1, 1, 2], [1, 1, 1, 1], [7, 1, 2, 2]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 7, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*E
iteration=1: 1425.8522104183903/22470.30998399912
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 2: 22470.30998399912/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [4, 2, 2, 1], [1, 1, 1, 1], [14, 2, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[112, 8, 14]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.E.Y
*E*E*E
iteration=1: 1e-10/16414.47119927761
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 3: 16414.47119927761/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 1, 2], [2, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[392, 16, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.E
*E*Y
iteration=1: 1563.940207437989/10688.220518969887
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 4: 10688.220518969887/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 1, 2], [2, 2, 4, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[16, 784, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*E
iteration=1: 1991.8681024779903/3889.292592127588
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 5: 3889.292592127588/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 4, 1, 1], [2, 2, 2, 2], [1, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 20931.96783299408/20931.96783299408
Best record value:27049.447536900007 (larger is better)
Round 2, Match 1, Mapping 6: 20931.96783299408/27049.447536900007(0.0369693317630917 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 28630.345080137344/28630.345080137344
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 7: 28630.345080137344/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 14, 1], [8, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 14, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 14674.895662054929/14674.895662054929
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 8: 14674.895662054929/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 1, 2], [2, 8, 1, 1], [1, 1, 1, 1], [28, 1, 1, 1]], "reduce_factors": [[1, 4, 4], [1, 1, 1]], "last_factors": [[1792, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 2744.667075384165/2744.667075384165
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 9: 2744.667075384165/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [1, 16, 1, 1], [2, 2, 1, 7]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[224, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 9668.97765250305/9668.97765250305
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 10: 9668.97765250305/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 4, 1, 1], [8, 2, 1, 1], [7, 4, 1, 1]], "reduce_factors": [[2, 4, 2]], "last_factors": [[196, 8, 8]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1970.830245241221/1970.830245241221
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 11: 1970.830245241221/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 2, 7], [2, 2, 2, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[1, 392, 32]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*E
iteration=1: 20381.25636581285/20381.25636581285
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 12: 20381.25636581285/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 2, 7], [4, 4, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[49, 8, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 7408.6348263606615/7408.6348263606615
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 13: 7408.6348263606615/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 2, 1, 8], [14, 1, 1, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[8, 196, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 15647.181901072914/15647.181901072914
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 14: 15647.181901072914/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [2, 2, 4, 1], [7, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[49, 64, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 11806.30100713217/11806.30100713217
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 15: 11806.30100713217/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [4, 4, 1, 1], [2, 1, 14, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[98, 8, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 1050.9397384260942/7372.897507502958
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 16: 7372.897507502958/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 7, 1, 1], [4, 2, 2, 1]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[392, 32, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*E
iteration=1: 1e-10/17737.777902293372
Best record value:28630.345080137344 (larger is better)
Round 2, Match 1, Mapping 17: 17737.777902293372/28630.345080137344(0.03492797579634352 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 1, 1, 1], [8, 2, 1, 1], [1, 2, 2, 7]], "reduce_factors": [[2, 1, 8]], "last_factors": [[224, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 34433.76142079379/34433.76142079379
Best record value:34433.76142079379 (larger is better)
Round 2, Match 1, Mapping 18: 34433.76142079379/34433.76142079379(0.029041265279724046 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [16, 1, 1, 1], [7, 1, 4, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 11800.050537250841/11800.050537250841
Best record value:34433.76142079379 (larger is better)
Round 2, Match 1, Mapping 19: 11800.050537250841/34433.76142079379(0.029041265279724046 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 2, 2], [4, 1, 2, 2], [2, 14, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 7, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 5499.935906020143/5499.935906020143
Best record value:34433.76142079379 (larger is better)
Round 2, Match 1, Mapping 20: 5499.935906020143/34433.76142079379(0.029041265279724046 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 2, 7], [1, 1, 4, 4]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 448, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 8 schedules
mapping (0,0,0,0,0,1,1): explored 4 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 5 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 6 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 8 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 4 schedules
Tensorize use time 401.7107493877411 s.
#############################################
operations:inputs:[1, 128, 56, 56],[128],[128],body:S[1, 128, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 128, 56, 56],body:S[1, 128, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 128, 56, 56],body:S[1, 128, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 128, 58, 58],[128, 128, 3, 3],body:R[1, 128, 28, 28] [128, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 128, 56, 56] [128] [128] [128, 128, 3, 3] [1, 128, 28, 28] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph54/at:resnet50:subgraph54:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 1: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:1e-10 (larger is better)
Round 1, Match 1, Mapping 2: 1e-10/1e-10(10000000000000.0 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*T
iteration=1: 23773.008425685282/23773.008425685282
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 3: 23773.008425685282/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[3, 2, 4], [3, 1, 1]], "last_factors": [[16, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*Y*E
iteration=1: 17967.25599150811/17967.25599150811
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 4: 17967.25599150811/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[24, 3, 1]], "last_factors": [[196, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*E*E*Y
iteration=1: 2614.2344979375384/2614.2344979375384
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 5: 2614.2344979375384/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [1, 2, 7, 2]], "reduce_factors": [[4, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[1, 392, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*E*E*Y
iteration=1: 1860.7539175325073/1860.7539175325073
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 6: 1860.7539175325073/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 14, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[1, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 451.2604184085482/451.2604184085482
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 7: 451.2604184085482/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 14, 1, 7], [1, 2, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[98, 2, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*E
iteration=1: 937.3234099683358/937.3234099683358
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 8: 937.3234099683358/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 2, 1], [1, 2, 1, 2], [1, 1, 1, 1], [1, 7, 4, 1]], "reduce_factors": [[2, 2, 6], [3, 1, 1]], "last_factors": [[8, 56, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 9: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 23254.28463072327/23254.28463072327
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 10: 23254.28463072327/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[3, 8, 3]], "last_factors": [[392, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*Y
iteration=1: 849.3843577236785/849.3843577236785
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 11: 849.3843577236785/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 14], [2, 2, 1, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[49, 4, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 1188.7361492957207/1188.7361492957207
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 13: 1188.7361492957207/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [4, 1, 1, 7]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 8744.55389381334/8744.55389381334
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 14: 8744.55389381334/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [1, 2, 2, 1], [7, 1, 1, 4]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 5890.0558224632605/5890.0558224632605
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 15: 5890.0558224632605/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 2, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[16, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 17: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 2340.9959421584167/2340.9959421584167
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 18: 2340.9959421584167/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[1, 4, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[8, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 19: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 4331.569416010632/4331.569416010632
Best record value:23773.008425685282 (larger is better)
Round 1, Match 1, Mapping 20: 4331.569416010632/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[1, 112, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 0 schedules
mapping (0,0,0,0,0,1,1): explored 0 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 0 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 0 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*E
iteration=1: 1396.9741013352543/1396.9741013352543
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 1: 1396.9741013352543/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 1, 1, 2], [2, 1, 1, 2], [1, 1, 1, 1], [2, 7, 2, 1]], "reduce_factors": [[4, 2, 1], [3, 1, 1], [1, 3, 1]], "last_factors": [[224, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.E.Y
*E*E*Y
iteration=1: 2597.7976107837394/2597.7976107837394
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 2: 2597.7976107837394/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 2, 1, 2], [2, 2, 1, 1], [1, 1, 1, 1], [7, 1, 4, 1]], "reduce_factors": [[24, 1, 1], [1, 1, 3]], "last_factors": [[2, 56, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/23773.008425685282
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 3: 23773.008425685282/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[3, 2, 4], [3, 1, 1]], "last_factors": [[16, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*Y
iteration=1: 1168.8266850205089/17967.25599150811
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 4: 17967.25599150811/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[49, 2, 1, 1], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[24, 3, 1]], "last_factors": [[196, 4, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 1837.166771382507/2614.2344979375384
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 5: 2614.2344979375384/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[4, 1, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1], [1, 2, 7, 2]], "reduce_factors": [[4, 1, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[1, 392, 8]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1860.7539175325073
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 6: 1860.7539175325073/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 14, 1, 1], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 3], [1, 1, 3]], "last_factors": [[1, 98, 32]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 14148.477256736829/14148.477256736829
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 7: 14148.477256736829/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 2, 1], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 8], [1, 1, 3], [3, 1, 1]], "last_factors": [[16, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 9379.952585594874/9379.952585594874
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 8: 9379.952585594874/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 1, 2], [1, 4, 1, 1], [1, 1, 1, 1], [7, 1, 1, 4]], "reduce_factors": [[8, 1, 3], [1, 3, 1]], "last_factors": [[28, 8, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*E*E
iteration=1: 87.78997059660611/87.78997059660611
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 9: 87.78997059660611/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 2, 1, 2], [1, 2, 1, 2], [1, 7, 1, 4]], "reduce_factors": [[2, 12, 1], [3, 1, 1]], "last_factors": [[8, 56, 7]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/23254.28463072327
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 10: 23254.28463072327/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [14, 1, 1, 2]], "reduce_factors": [[3, 8, 3]], "last_factors": [[392, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 3107.0108955094584/3107.0108955094584
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 11: 3107.0108955094584/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 14], [2, 1, 2, 1]], "reduce_factors": [[6, 2, 2], [3, 1, 1]], "last_factors": [[49, 4, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 12: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 2743.315504375241/2743.315504375241
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 13: 2743.315504375241/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 1, 2, 1], [1, 1, 1, 4], [4, 1, 1, 7]], "reduce_factors": [[4, 2, 3], [3, 1, 1]], "last_factors": [[14, 28, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*Y
iteration=1: 4025.794289963372/8744.55389381334
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 14: 8744.55389381334/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 4], [1, 2, 2, 1], [7, 1, 1, 4]], "reduce_factors": [[24, 1, 1], [3, 1, 1]], "last_factors": [[196, 2, 8]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 4053.814483732046/5890.0558224632605
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 15: 5890.0558224632605/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 2, 1], [2, 2, 1, 1], [7, 2, 1, 2]], "reduce_factors": [[6, 4, 1], [3, 1, 1]], "last_factors": [[16, 49, 4]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 16: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.E.Y
*Y*Y*E
iteration=1: 1326.712462702896/1326.712462702896
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 17: 1326.712462702896/23773.008425685282(0.042064512075785966 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 2, 1], [2, 1, 2, 1], [1, 4, 1, 7]], "reduce_factors": [[36, 1, 2]], "last_factors": [[784, 1, 4]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.E.E
*E
iteration=1: 1e-10/2340.9959421584167
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 18: 2340.9959421584167/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[2, 1, 2, 1], [2, 2, 1, 1], [7, 2, 2, 1]], "reduce_factors": [[1, 4, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[8, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 19: 1e-10/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 521.0738115524751/4331.569416010632
Best record value:23773.008425685282 (larger is better)
Round 2, Match 1, Mapping 20: 4331.569416010632/23773.008425685282(0.042064512075785966 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 7, 1], [2, 1, 1, 2]], "reduce_factors": [[4, 1, 2], [3, 1, 1], [3, 1, 1]], "last_factors": [[1, 112, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 5 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 0 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 2 schedules
mapping (1,0,0,1,0,0,0): explored 0 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Tensorize use time 686.6276621818542 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[128, 256, 1, 1],body:R[1, 128, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [128, 256, 1, 1] [1, 128, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph55/at:resnet50:subgraph55:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*E
iteration=1: 14489.946080280823/14489.946080280823
Best record value:14489.946080280823 (larger is better)
Round 1, Match 1, Mapping 1: 14489.946080280823/14489.946080280823(0.06901336930169029 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*E*Y
iteration=1: 25535.70573294075/25535.70573294075
Best record value:25535.70573294075 (larger is better)
Round 1, Match 1, Mapping 2: 25535.70573294075/25535.70573294075(0.039160852277131786 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[896, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*E*Y
iteration=1: 14624.921666517579/14624.921666517579
Best record value:25535.70573294075 (larger is better)
Round 1, Match 1, Mapping 3: 14624.921666517579/25535.70573294075(0.039160852277131786 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 1, 2, 7], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 28486.226373018446/28486.226373018446
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 4: 28486.226373018446/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 2, 1, 2], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*E
iteration=1: 4335.88794716052/4335.88794716052
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 5: 4335.88794716052/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 1], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 896, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 9719.538239768443/9719.538239768443
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 6: 9719.538239768443/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 2, 1, 7], [2, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 8, 2], [1, 1, 1]], "last_factors": [[7, 112, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 15175.648826126338/15175.648826126338
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 7: 15175.648826126338/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 1, 1, 7], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*E
iteration=1: 3164.656181502568/3164.656181502568
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 8: 3164.656181502568/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [1, 4, 1, 1], [1, 1, 1, 1], [4, 14, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[256, 49, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 2353.135538009943/2353.135538009943
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 9: 2353.135538009943/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 4], [1, 4, 1, 14]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[2, 196, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*Y
iteration=1: 28098.808242932264/28098.808242932264
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 10: 28098.808242932264/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[128, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 15294.249465984964/15294.249465984964
Best record value:28486.226373018446 (larger is better)
Round 1, Match 1, Mapping 11: 15294.249465984964/28486.226373018446(0.03510468487139381 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 7, 2, 4], [2, 1, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[224, 56, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 44264.37201390646/44264.37201390646
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 12: 44264.37201390646/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 2]], "reduce_factors": [[1, 8, 2]], "last_factors": [[196, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 7837.368231974766/7837.368231974766
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 13: 7837.368231974766/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [28, 1, 1, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[4, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*E*Y
iteration=1: 5064.179273124158/5064.179273124158
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 14: 5064.179273124158/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [1, 2, 1, 2], [4, 2, 1, 7]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*E*Y*E
iteration=1: 5205.214113669772/5205.214113669772
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 15: 5205.214113669772/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [2, 1, 2, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[8, 784, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.E
*E*E*E*Y
iteration=1: 7778.7412080607455/7778.7412080607455
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 16: 7778.7412080607455/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 4, 2], [1, 4, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[2, 224, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 7981.1214168063/7981.1214168063
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 17: 7981.1214168063/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 2, 1], [7, 2, 1, 4]], "reduce_factors": [[4, 2, 2]], "last_factors": [[448, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*E*Y*E
iteration=1: 5527.080876614127/5527.080876614127
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 18: 5527.080876614127/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 2], [2, 7, 4, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 2136.9030635503877/2136.9030635503877
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 19: 2136.9030635503877/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 1], [1, 14, 4, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 196, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:44264.37201390646 (larger is better)
Round 1, Match 1, Mapping 20: 1e-10/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, None
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 2 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 4 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 4 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 2 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 0 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*E*E
iteration=1: 1538.2369532030866/14489.946080280823
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 1: 14489.946080280823/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 7, 1], [2, 2, 1, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[4, 98, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 32704.71936097034/32704.71936097034
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 2: 32704.71936097034/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 1], [1, 1, 1, 1], [14, 1, 2, 2]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[896, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/14624.921666517579
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 3: 14624.921666517579/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 1, 2, 7], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1]], "last_factors": [[224, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 926.5592392983791/28486.226373018446
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 4: 28486.226373018446/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[98, 2, 1, 2], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[1568, 4, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*Y
iteration=1: 508.74226488099794/4335.88794716052
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 5: 4335.88794716052/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 1], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 896, 2]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.Y.Y.E
*Y*E*E
iteration=1: 11446.133403298118/11446.133403298118
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 6: 11446.133403298118/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 1, 2, 2], [1, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[8, 56, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 16294.141319267128/16294.141319267128
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 7: 16294.141319267128/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 1, 1, 7], [2, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 1]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.Y
*E*Y*Y
iteration=1: 8151.634601859684/8151.634601859684
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 8: 8151.634601859684/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 4, 1], [1, 1, 1, 1], [1, 7, 2, 4]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[14, 112, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 10317.104088969652/10317.104088969652
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 9: 10317.104088969652/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 2], [14, 2, 2, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[28, 112, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 8736.192825366768/28098.808242932264
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 10: 28098.808242932264/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 2, 4]], "last_factors": [[128, 7, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 16628.814710897845/16628.814710897845
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 11: 16628.814710897845/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 7, 1, 1], [2, 2, 1, 1]], "reduce_factors": [[1, 16, 1], [1, 1, 1]], "last_factors": [[896, 14, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 5609.831559197604/44264.37201390646
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 12: 44264.37201390646/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[98, 1, 2, 2], [1, 2, 1, 2]], "reduce_factors": [[1, 8, 2]], "last_factors": [[196, 16, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 3647.181061964346/7837.368231974766
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 13: 7837.368231974766/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 2], [28, 1, 1, 2]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[4, 392, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.E
*Y*E
iteration=1: 4998.553263153119/5064.179273124158
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 14: 5064.179273124158/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [1, 2, 1, 2], [4, 2, 1, 7]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 4]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*E*Y*Y
iteration=1: 5188.201078937307/5205.214113669772
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 15: 5205.214113669772/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [2, 1, 2, 1], [28, 1, 2, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[8, 784, 2]], "output_unroll_step": 16, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 4566.770191586622/7778.7412080607455
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 16: 7778.7412080607455/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 4, 2], [1, 4, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[2, 224, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.E.Y.E.E.Y
*Y*Y
iteration=1: 10140.908053506435/10140.908053506435
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 17: 10140.908053506435/44264.37201390646(0.02259153252385082 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 4, 1, 1], [2, 2, 2, 7]], "reduce_factors": [[8, 2, 1]], "last_factors": [[3136, 1, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 2574.285819113054/5527.080876614127
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 18: 5527.080876614127/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 2], [2, 7, 4, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 112, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 7622.827568831008/7622.827568831008
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 19: 7622.827568831008/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 4], [7, 2, 2, 2]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 14, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.E.E.E
*Y
iteration=1: 2212.1207372629688/2212.1207372629688
Best record value:44264.37201390646 (larger is better)
Round 2, Match 1, Mapping 20: 2212.1207372629688/44264.37201390646(0.02259153252385082 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 28, 1, 1], [1, 2, 2, 1]], "reduce_factors": [[1, 2, 8], [1, 1, 1], [1, 1, 1]], "last_factors": [[112, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.24150629157585732, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753, 0.03992072149600753]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 6 schedules
mapping (0,0,0,1,1,0,0): explored 4 schedules
mapping (0,0,1,0,0,1,0): explored 6 schedules
mapping (0,0,1,0,0,1,1): explored 6 schedules
mapping (0,0,1,0,1,1,0): explored 6 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,0,1,1,0,0,0): explored 6 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 5 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Tensorize use time 503.6738991737366 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [1, 256, 56, 56] graph:[0:1][1:2]
Autoscheduling resnet50/tg:resnet50:subgraph56.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.N.N.N.N.Y.Y.Y.Y.E.E.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.04245347634303585
.N.N.N.N.E.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.B

Currently best performance: 0.011012100930530578
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.011012100930530578
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.N.N.N

Currently best performance: 0.008988660695952359
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.008988660695952359
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.B.N.N

Currently best performance: 0.006629528240566529
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.006629528240566529
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.006629528240566529
.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N

Currently best performance: 0.006629528240566529
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N.N

Currently best performance: 0.006629528240566529
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.005022534917844145
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.005022534917844145
.N.N.N.N.N.N.NSchedule cost 761.964451 seconds
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph57/at:resnet50:subgraph57:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 13107.865849280412/13107.865849280412
Best record value:13107.865849280412 (larger is better)
Round 1, Match 1, Mapping 1: 13107.865849280412/13107.865849280412(0.07629006975646592 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 7, 1], [1, 4, 1, 2], [1, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 32]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 6473.483716650995/6473.483716650995
Best record value:13107.865849280412 (larger is better)
Round 1, Match 1, Mapping 2: 6473.483716650995/13107.865849280412(0.07629006975646592 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1], [2, 7, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[7, 896, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.E.E.Y
*Y*Y
iteration=1: 16996.929992627494/16996.929992627494
Best record value:16996.929992627494 (larger is better)
Round 1, Match 1, Mapping 3: 16996.929992627494/16996.929992627494(0.058834154193360515 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 1, 8, 1], [1, 1, 2, 4], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[28, 56, 16]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 12781.194284146002/12781.194284146002
Best record value:16996.929992627494 (larger is better)
Round 1, Match 1, Mapping 4: 12781.194284146002/16996.929992627494(0.058834154193360515 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 56, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[49, 32, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 17773.94889247833/17773.94889247833
Best record value:17773.94889247833 (larger is better)
Round 1, Match 1, Mapping 5: 17773.94889247833/17773.94889247833(0.056262117442184456 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [1, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 17183.76809969644/17183.76809969644
Best record value:17773.94889247833 (larger is better)
Round 1, Match 1, Mapping 6: 17183.76809969644/17773.94889247833(0.056262117442184456 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 14, 4, 1], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[32, 392, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 38343.10722547134/38343.10722547134
Best record value:38343.10722547134 (larger is better)
Round 1, Match 1, Mapping 7: 38343.10722547134/38343.10722547134(0.026080306797246194 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 8, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.Y.E.Y.E
*Y*Y
iteration=1: 10382.794931289094/10382.794931289094
Best record value:38343.10722547134 (larger is better)
Round 1, Match 1, Mapping 8: 10382.794931289094/38343.10722547134(0.026080306797246194 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1], [2, 1, 4, 7]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[25088, 1, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*E*Y
iteration=1: 32225.92190667832/32225.92190667832
Best record value:38343.10722547134 (larger is better)
Round 1, Match 1, Mapping 9: 32225.92190667832/38343.10722547134(0.026080306797246194 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [14, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[12544, 2, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 13087.47780028227/13087.47780028227
Best record value:38343.10722547134 (larger is better)
Round 1, Match 1, Mapping 10: 13087.47780028227/38343.10722547134(0.026080306797246194 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 2], [1, 8, 1, 7]], "reduce_factors": [[1, 2, 2]], "last_factors": [[256, 98, 1]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*E
iteration=1: 42795.85035183713/42795.85035183713
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 11: 42795.85035183713/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 2, 7, 1], [2, 1, 1, 4]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[448, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 14824.490456889025/14824.490456889025
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 12: 14824.490456889025/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 7, 7], [4, 2, 1, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[14, 112, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 13607.215313424957/13607.215313424957
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 13: 13607.215313424957/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 8, 1, 7]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[448, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*E
iteration=1: 27574.348874980555/27574.348874980555
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 14: 27574.348874980555/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 2, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[896, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1715.2323066155986/1715.2323066155986
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 15: 1715.2323066155986/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 2, 1, 2], [7, 1, 1, 8]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[4, 3136, 2]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*Y*Y*Y
iteration=1: 17546.7509894094/17546.7509894094
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 16: 17546.7509894094/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[8, 49, 1, 1], [2, 1, 4, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[448, 28, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 12668.004866835367/12668.004866835367
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 17: 12668.004866835367/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [4, 2, 1, 1], [7, 2, 2, 2]], "reduce_factors": [[2, 2, 1]], "last_factors": [[196, 4, 32]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 16102.810043083744/16102.810043083744
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 18: 16102.810043083744/42795.85035183713(0.023366751490593345 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 2, 14, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 256, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 9350.870242102525/9350.870242102525
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 19: 9350.870242102525/42795.85035183713(0.023366751490593345 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 2, 2, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 26150.71541460278/26150.71541460278
Best record value:42795.85035183713 (larger is better)
Round 1, Match 1, Mapping 20: 26150.71541460278/42795.85035183713(0.023366751490593345 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 2, 14], [8, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,0,1,0): explored 3 schedules
mapping (0,0,0,1,1,0,0): explored 2 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 4 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 1 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 15824.02231646334/15824.02231646334
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 1: 15824.02231646334/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[16, 196, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 6502.111955955598/6502.111955955598
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 2: 6502.111955955598/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [1, 1, 1, 1], [2, 7, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[7, 896, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*E*Y*Y
iteration=1: 29842.081021577007/29842.081021577007
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 3: 29842.081021577007/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 4, 7], [1, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[112, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 12573.123545810247/12781.194284146002
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 4: 12781.194284146002/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 56, 1, 1], [8, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[49, 32, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 4969.202273309765/17773.94889247833
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 5: 17773.94889247833/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [1, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[64, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 10445.214319790586/17183.76809969644
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 6: 17183.76809969644/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 14, 4, 1], [4, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[32, 392, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*E*E
iteration=1: 7651.830475511085/38343.10722547134
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 7: 38343.10722547134/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 8, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 128, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 22735.16429239545/22735.16429239545
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 8: 22735.16429239545/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 4, 1, 1], [1, 1, 1, 1], [7, 8, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[1792, 7, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*E*Y*Y
iteration=1: 4428.669265707015/32225.92190667832
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 9: 32225.92190667832/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [2, 1, 4, 1], [14, 2, 1, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[12544, 2, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 17486.18315249259/17486.18315249259
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 10: 17486.18315249259/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 2, 1, 1], [1, 8, 7, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[128, 7, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 40152.77412657226/42795.85035183713
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 11: 42795.85035183713/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[28, 2, 7, 1], [2, 1, 1, 4]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[448, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 11111.654286988196/14824.490456889025
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 12: 14824.490456889025/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 7, 7], [4, 2, 1, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[14, 112, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 1594.3646729099137/13607.215313424957
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 13: 13607.215313424957/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 8, 1, 7]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[448, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 5310.625406098047/27574.348874980555
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 14: 27574.348874980555/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 2, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[896, 28, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 5221.286405626657/5221.286405626657
Best record value:42795.85035183713 (larger is better)
Round 2, Match 1, Mapping 15: 5221.286405626657/42795.85035183713(0.023366751490593345 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 4], [1, 14, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[3136, 8, 1]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 44946.960698316405/44946.960698316405
Best record value:44946.960698316405 (larger is better)
Round 2, Match 1, Mapping 16: 44946.960698316405/44946.960698316405(0.022248445377919788 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 2, 2], [2, 1, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[1568, 1, 16]], "output_unroll_step": 16, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 28782.65973098476/28782.65973098476
Best record value:44946.960698316405 (larger is better)
Round 2, Match 1, Mapping 17: 28782.65973098476/44946.960698316405(0.022248445377919788 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [7, 2, 4, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[128, 98, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 8720.316153220163/16102.810043083744
Best record value:44946.960698316405 (larger is better)
Round 2, Match 1, Mapping 18: 16102.810043083744/44946.960698316405(0.022248445377919788 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [1, 2, 14, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[49, 256, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.E
*Y*Y*Y
iteration=1: 7419.543516437772/9350.870242102525
Best record value:44946.960698316405 (larger is better)
Round 2, Match 1, Mapping 19: 9350.870242102525/44946.960698316405(0.022248445377919788 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 2, 2, 1], [14, 2, 2, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 196, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*E
iteration=1: 8724.362415934862/26150.71541460278
Best record value:44946.960698316405 (larger is better)
Round 2, Match 1, Mapping 20: 26150.71541460278/44946.960698316405(0.022248445377919788 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 2, 2, 14], [8, 1, 1, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 28, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 9 schedules
mapping (0,0,0,0,0,1,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 7 schedules
mapping (0,0,0,1,0,0,0): explored 8 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 4 schedules
mapping (0,0,0,1,1,0,0): explored 6 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 8 schedules
mapping (0,0,1,0,1,1,0): explored 5 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 6 schedules
mapping (0,1,0,1,0,0,0): explored 6 schedules
mapping (0,1,0,1,0,0,1): explored 6 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 7 schedules
mapping (1,0,0,1,0,1,0): explored 5 schedules
Tensorize use time 386.48563051223755 s.
#############################################
operations:inputs:[1, 64, 56, 56],[64],[64],body:S[1, 64, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 56, 56],body:S[1, 64, 58, 58] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 57)) && (v3 >= 1)) && (v3 < 57)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 58, 58],[64, 64, 3, 3],body:R[1, 64, 56, 56] [64, 3, 3] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64] [64] [64, 64, 3, 3] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/at-resnet50:subgraph58/at:resnet50:subgraph58:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 313.4055982081248/313.4055982081248
Best record value:313.4055982081248 (larger is better)
Round 1, Match 1, Mapping 1: 313.4055982081248/313.4055982081248(3.19075347 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [7, 2, 1, 4]], "reduce_factors": [[1, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[448, 14, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.E.Y.Y
*E*E*Y
iteration=1: 1649.328271477562/1649.328271477562
Best record value:1649.328271477562 (larger is better)
Round 1, Match 1, Mapping 2: 1649.328271477562/1649.328271477562(0.6063074387878788 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[1, 3136, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*E*E
iteration=1: 9148.324581032033/9148.324581032033
Best record value:9148.324581032033 (larger is better)
Round 1, Match 1, Mapping 3: 9148.324581032033/9148.324581032033(0.10930963272481406 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[56, 1, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 3, 2], [3, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*Y
iteration=1: 1999.5605085975733/1999.5605085975733
Best record value:9148.324581032033 (larger is better)
Round 1, Match 1, Mapping 4: 1999.5605085975733/9148.324581032033(0.10930963272481406 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 7, 1, 2], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 3, 3]], "last_factors": [[1, 224, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*E*Y
iteration=1: 1814.5490829241955/1814.5490829241955
Best record value:9148.324581032033 (larger is better)
Round 1, Match 1, Mapping 5: 1814.5490829241955/9148.324581032033(0.10930963272481406 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[1, 2, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[4, 49, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 1464.1747726166568/1464.1747726166568
Best record value:9148.324581032033 (larger is better)
Round 1, Match 1, Mapping 6: 1464.1747726166568/9148.324581032033(0.10930963272481406 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[8, 7, 1, 7], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 6, 2], [3, 1, 1]], "last_factors": [[1, 1568, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 9431.949485309131/9431.949485309131
Best record value:9431.949485309131 (larger is better)
Round 1, Match 1, Mapping 7: 9431.949485309131/9431.949485309131(0.106022620409234 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 3], [1, 1, 3]], "last_factors": [[8, 196, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:9431.949485309131 (larger is better)
Round 1, Match 1, Mapping 8: 1e-10/9431.949485309131(0.106022620409234 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 11526.765839237672/11526.765839237672
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 9: 11526.765839237672/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 2, 14, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 1762.3142484144585/1762.3142484144585
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 10: 1762.3142484144585/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 2, 28]], "reduce_factors": [[18, 1, 2]], "last_factors": [[49, 128, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*E
iteration=1: 2120.8867486182503/2120.8867486182503
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 11: 2120.8867486182503/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 14, 1, 14], [1, 1, 2, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[98, 32, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/1e-10
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 12: 1e-10/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, None
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.E.E.Y.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 13: 1e-10/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*E
iteration=1: 1994.8098086965/1994.8098086965
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 14: 1994.8098086965/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 14, 2, 2]], "reduce_factors": [[3, 1, 4], [3, 1, 1]], "last_factors": [[14, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*E
iteration=1: 2749.806408129255/2749.806408129255
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 15: 2749.806408129255/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 3, 2], [3, 1, 1]], "last_factors": [[16, 28, 14]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 2423.563458055681/2423.563458055681
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 16: 2423.563458055681/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 7, 7, 4], [1, 1, 1, 2]], "reduce_factors": [[12, 1, 1], [3, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1384.3505377164504/1384.3505377164504
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 17: 1384.3505377164504/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [14, 1, 1, 4]], "reduce_factors": [[3, 3, 4]], "last_factors": [[14, 28, 16]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.E.Y.Y
*E*E*E
iteration=1: 1e-10/1e-10
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 18: 1e-10/11526.765839237672(0.08675460349822942 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, None
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*E*E
iteration=1: 1519.9845100210487/1519.9845100210487
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 19: 1519.9845100210487/11526.765839237672(0.08675460349822942 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 1], [2, 1, 14, 2]], "reduce_factors": [[2, 1, 2], [1, 3, 1], [3, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 939.5315570818915/939.5315570818915
Best record value:11526.765839237672 (larger is better)
Round 1, Match 1, Mapping 20: 939.5315570818915/11526.765839237672(0.08675460349822942 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 49, 2, 4], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[448, 1, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 1 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 3 schedules
mapping (0,0,0,1,0,0,1): explored 2 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 0 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 0 schedules
mapping (0,0,1,1,0,0,0): explored 0 schedules
mapping (0,1,0,0,0,1,0): explored 1 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 1 schedules
mapping (1,0,0,0,0,1,0): explored 0 schedules
mapping (1,0,0,1,0,0,0): explored 1 schedules
mapping (1,0,0,1,0,1,0): explored 1 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 8123.153200068063/8123.153200068063
Best record value:11526.765839237672 (larger is better)
Round 2, Match 1, Mapping 1: 8123.153200068063/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [14, 2, 1, 2]], "reduce_factors": [[1, 1, 4], [1, 3, 1], [3, 1, 1]], "last_factors": [[32, 14, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.E.Y
*E*Y*Y
iteration=1: 5485.850999085447/5485.850999085447
Best record value:11526.765839237672 (larger is better)
Round 2, Match 1, Mapping 2: 5485.850999085447/11526.765839237672(0.08675460349822942 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 2, 3], [1, 3, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 12021.966866291992/12021.966866291992
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 3: 12021.966866291992/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 1, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 3, 2], [3, 1, 1]], "last_factors": [[7, 128, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 3511.240799514329/3511.240799514329
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 4: 3511.240799514329/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[28, 7, 1, 2], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 3, 3]], "last_factors": [[1, 224, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.E.E
*Y*E
iteration=1: 600.5544720495143/1814.5490829241955
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 5: 1814.5490829241955/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[1, 2, 2], [1, 1, 3], [3, 1, 1]], "last_factors": [[4, 49, 32]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3407.679391302953/3407.679391302953
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 6: 3407.679391302953/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 4, 1, 14], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 3], [1, 3, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.E
*E*E*E
iteration=1: 1e-10/9431.949485309131
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 7: 9431.949485309131/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 1, 7, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 3], [1, 1, 3]], "last_factors": [[8, 196, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.E.Y.E
*E*E*Y
iteration=1: 235.02491209424906/235.02491209424906
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 8: 235.02491209424906/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [4, 2, 1, 7]], "reduce_factors": [[3, 4, 1], [3, 1, 1]], "last_factors": [[2, 224, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*E*E*E*E
iteration=1: 1e-10/11526.765839237672
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 9: 11526.765839237672/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 2, 14, 1]], "reduce_factors": [[3, 2, 2], [3, 1, 1]], "last_factors": [[112, 7, 8]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 2800.7246732157028/2800.7246732157028
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 10: 2800.7246732157028/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 2, 2, 14]], "reduce_factors": [[18, 1, 2]], "last_factors": [[49, 128, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/2120.8867486182503
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 11: 2120.8867486182503/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 14, 1, 14], [1, 1, 2, 1]], "reduce_factors": [[12, 1, 1], [1, 1, 3]], "last_factors": [[98, 32, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 3432.3198001657915/3432.3198001657915
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 12: 3432.3198001657915/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[4, 2, 7, 7], [1, 1, 1, 2]], "reduce_factors": [[18, 2, 1]], "last_factors": [[392, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*E*E
iteration=1: 5938.707616129864/5938.707616129864
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 13: 5938.707616129864/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 1], [7, 2, 2, 2]], "reduce_factors": [[3, 1, 4], [1, 1, 3]], "last_factors": [[392, 4, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 6593.535481863234/6593.535481863234
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 14: 6593.535481863234/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 14, 2, 2]], "reduce_factors": [[3, 1, 4], [3, 1, 1]], "last_factors": [[14, 16, 28]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 4764.860987877303/4764.860987877303
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 15: 4764.860987877303/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [7, 1, 8, 1]], "reduce_factors": [[6, 2, 1], [3, 1, 1]], "last_factors": [[7, 896, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.E.Y.Y.E
*E*Y
iteration=1: 997.0933171223145/2423.563458055681
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 16: 2423.563458055681/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[2, 7, 7, 4], [1, 1, 1, 2]], "reduce_factors": [[12, 1, 1], [3, 1, 1]], "last_factors": [[56, 112, 1]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 4086.300746769049/4086.300746769049
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 17: 4086.300746769049/12021.966866291992(0.0831810643900432 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 1], [28, 1, 1, 2]], "reduce_factors": [[9, 4, 1]], "last_factors": [[2, 224, 14]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*Y*E
iteration=1: 346.1127967102353/346.1127967102353
Best record value:12021.966866291992 (larger is better)
Round 2, Match 1, Mapping 18: 346.1127967102353/12021.966866291992(0.0831810643900432 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [1, 28, 1, 2]], "reduce_factors": [[1, 4, 1], [3, 1, 1], [3, 1, 1]], "last_factors": [[392, 4, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.E.E
*Y*E
iteration=1: 14924.872235140827/14924.872235140827
Best record value:14924.872235140827 (larger is better)
Round 2, Match 1, Mapping 19: 14924.872235140827/14924.872235140827(0.0670022486119168 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [7, 2, 4, 1]], "reduce_factors": [[4, 1, 1], [1, 3, 1], [3, 1, 1]], "last_factors": [[224, 28, 1]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 12212.186232071535/12212.186232071535
Best record value:14924.872235140827 (larger is better)
Round 2, Match 1, Mapping 20: 12212.186232071535/14924.872235140827(0.0670022486119168 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[392, 1, 1, 1], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 3, 1], [1, 1, 3]], "last_factors": [[28, 7, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.09699956942956135, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.043584716051601316, 0.11847554164161514, 0.043584716051601316]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 3 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 4 schedules
mapping (0,0,0,1,0,0,0): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 1 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 1 schedules
mapping (0,0,1,1,0,0,0): explored 2 schedules
mapping (0,1,0,0,0,1,0): explored 5 schedules
mapping (0,1,0,1,0,0,0): explored 5 schedules
mapping (0,1,0,1,0,0,1): explored 4 schedules
mapping (0,1,0,1,1,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Tensorize use time 468.801805973053 s.
#############################################
operations:inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 256, 56, 56],[64, 256, 1, 1],body:R[1, 64, 56, 56] [256, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 256, 56, 56] [64, 256, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph59/at:resnet50:subgraph59:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 19697.332858781087/19697.332858781087
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 1: 19697.332858781087/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [2, 2, 2, 7]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 2524.9328118977237/2524.9328118977237
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 2: 2524.9328118977237/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [1, 14, 2, 2]], "reduce_factors": [[1, 16, 1], [1, 1, 1]], "last_factors": [[448, 7, 2]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*Y
iteration=1: 3723.3198428012142/3723.3198428012142
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 3: 3723.3198428012142/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 14, 1, 4], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*Y*E*E*E
iteration=1: 9076.547616139173/9076.547616139173
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 4: 9076.547616139173/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 4, 1, 2], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[49, 32, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*E
iteration=1: 643.077892640515/643.077892640515
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 5: 643.077892640515/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [1, 28, 2, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[28, 16, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 8808.994610662292/8808.994610662292
Best record value:19697.332858781087 (larger is better)
Round 1, Match 1, Mapping 6: 8808.994610662292/19697.332858781087(0.05076829473154784 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[4, 49, 1, 2], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[49, 4, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*E*Y
iteration=1: 33098.88810063761/33098.88810063761
Best record value:33098.88810063761 (larger is better)
Round 1, Match 1, Mapping 7: 33098.88810063761/33098.88810063761(0.03021249526447797 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[49, 1, 2, 4], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*E*Y
iteration=1: 7798.114237162466/7798.114237162466
Best record value:33098.88810063761 (larger is better)
Round 1, Match 1, Mapping 8: 7798.114237162466/33098.88810063761(0.03021249526447797 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [1, 8, 7, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[4, 98, 16]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 38920.46082593965/38920.46082593965
Best record value:38920.46082593965 (larger is better)
Round 1, Match 1, Mapping 9: 38920.46082593965/38920.46082593965(0.025693426510857792 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [7, 1, 4, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*E*Y
iteration=1: 779.405131503862/779.405131503862
Best record value:38920.46082593965 (larger is better)
Round 1, Match 1, Mapping 10: 779.405131503862/38920.46082593965(0.025693426510857792 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [2, 28, 1, 1]], "reduce_factors": [[8, 2, 1]], "last_factors": [[1, 392, 16]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 2022.5497994330099/2022.5497994330099
Best record value:38920.46082593965 (larger is better)
Round 1, Match 1, Mapping 11: 2022.5497994330099/38920.46082593965(0.025693426510857792 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 49, 1, 4], [1, 2, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*E*E*Y
iteration=1: 40442.437316306154/40442.437316306154
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 12: 40442.437316306154/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 1, 2], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*E*Y*Y*Y
iteration=1: 26752.362277974196/26752.362277974196
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 13: 26752.362277974196/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*Y*E*Y
iteration=1: 20444.94204636565/20444.94204636565
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 14: 20444.94204636565/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.E
*E*Y*Y
iteration=1: 21455.173658140928/21455.173658140928
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 15: 21455.173658140928/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 1, 7, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.E.Y
*E*Y*E
iteration=1: 9990.097815045727/9990.097815045727
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 16: 9990.097815045727/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 7, 8], [2, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[8, 784, 1]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 37693.788874907346/37693.788874907346
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 17: 37693.788874907346/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[1, 4, 4]], "last_factors": [[896, 1, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 5380.6919191799/5380.6919191799
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 18: 5380.6919191799/40442.437316306154(0.02472650182230253 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 18732.758982701424/18732.758982701424
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 19: 18732.758982701424/40442.437316306154(0.02472650182230253 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [4, 14, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*E*Y
iteration=1: 25658.534145497244/25658.534145497244
Best record value:40442.437316306154 (larger is better)
Round 1, Match 1, Mapping 20: 25658.534145497244/40442.437316306154(0.02472650182230253 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 14, 2], [2, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 1 schedules
mapping (0,0,0,1,0,0,0): explored 1 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 2 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 5 schedules
mapping (0,0,1,0,0,1,1): explored 1 schedules
mapping (0,0,1,0,1,1,0): explored 1 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 1 schedules
mapping (0,1,0,1,1,0,0): explored 4 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 3 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*E
iteration=1: 5160.596827449289/19697.332858781087
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 1: 19697.332858781087/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [2, 2, 2, 7]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 4, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 9839.623786254559/9839.623786254559
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 2: 9839.623786254559/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [2, 7, 4, 1]], "reduce_factors": [[4, 1, 4], [1, 1, 1]], "last_factors": [[896, 7, 1]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 3815.9303821661074/3815.9303821661074
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 3: 3815.9303821661074/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 8, 1, 7], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[112, 4, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.E.E.Y
*Y*E*E
iteration=1: 19398.4980612539/19398.4980612539
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 4: 19398.4980612539/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 2, 1, 7], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[14, 32, 14]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*E
iteration=1: 26322.716504343247/26322.716504343247
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 5: 26322.716504343247/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [1, 1, 1, 1], [7, 1, 1, 8]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 1, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 35757.995503197315/35757.995503197315
Best record value:40442.437316306154 (larger is better)
Round 2, Match 1, Mapping 6: 35757.995503197315/40442.437316306154(0.02472650182230253 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[49, 2, 1, 4], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 4, 2], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 50416.00252010816/50416.00252010816
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 7: 50416.00252010816/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 1, 2, 4], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[4, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[448, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 10587.10902194085/10587.10902194085
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 8: 10587.10902194085/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [1, 1, 1, 1], [8, 7, 1, 1]], "reduce_factors": [[8, 1, 2], [1, 1, 1]], "last_factors": [[56, 56, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=1: 25756.020746306738/38920.46082593965
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 9: 38920.46082593965/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [7, 1, 4, 2]], "reduce_factors": [[4, 2, 2], [1, 1, 1]], "last_factors": [[112, 2, 28]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.E.Y
*E*E*Y*Y
iteration=1: 5349.638675869455/5349.638675869455
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 10: 5349.638675869455/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 1, 2], [2, 2, 1, 14]], "reduce_factors": [[4, 2, 2]], "last_factors": [[1, 448, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 7453.16868565811/7453.16868565811
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 11: 7453.16868565811/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 2, 14, 7], [2, 1, 1, 1]], "reduce_factors": [[16, 1, 1], [1, 1, 1]], "last_factors": [[8, 56, 14]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*E*E*E
iteration=1: 2139.2397142055715/40442.437316306154
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 12: 40442.437316306154/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[196, 1, 1, 2], [1, 2, 1, 1]], "reduce_factors": [[2, 1, 8]], "last_factors": [[784, 2, 4]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.E.E.Y
*Y*E
iteration=1: 9801.718145066445/26752.362277974196
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 13: 26752.362277974196/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 12676.386612104609/20444.94204636565
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 14: 20444.94204636565/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [28, 2, 1, 1]], "reduce_factors": [[2, 8, 1], [1, 1, 1]], "last_factors": [[224, 7, 4]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 9448.436836470519/21455.173658140928
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 15: 21455.173658140928/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [8, 1, 7, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1]], "last_factors": [[28, 32, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 11023.020083752092/11023.020083752092
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 16: 11023.020083752092/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 7, 1, 7], [2, 1, 1, 1]], "reduce_factors": [[1, 1, 16], [1, 1, 1]], "last_factors": [[8, 56, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 13165.267091713971/37693.788874907346
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 17: 37693.788874907346/50416.00252010816(0.019834972032960273 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [14, 1, 4, 1]], "reduce_factors": [[1, 4, 4]], "last_factors": [[896, 1, 7]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*E*Y
iteration=1: 348.2778469344391/5380.6919191799
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 18: 5380.6919191799/50416.00252010816(0.019834972032960273 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 2, 1, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 16, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[2, 392, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 22433.32424866586/22433.32424866586
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 19: 22433.32424866586/50416.00252010816(0.019834972032960273 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [4, 14, 1, 1]], "reduce_factors": [[2, 2, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*Y*Y*Y
iteration=1: 11979.889694132038/25658.534145497244
Best record value:50416.00252010816 (larger is better)
Round 2, Match 1, Mapping 20: 25658.534145497244/50416.00252010816(0.019834972032960273 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 2, 14, 2], [2, 1, 1, 1]], "reduce_factors": [[8, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 2, 14]], "output_unroll_step": 512, "last_unroll_step": 16}
New weights [0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 7 schedules
mapping (0,0,0,0,1,1,0): explored 8 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,0): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 7 schedules
mapping (0,0,0,1,0,1,0): explored 7 schedules
mapping (0,0,0,1,1,0,0): explored 8 schedules
mapping (0,0,1,0,0,1,0): explored 8 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 4 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 6 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 6 schedules
mapping (1,0,0,1,0,1,0): explored 6 schedules
Tensorize use time 428.9197735786438 s.
#############################################
operations:inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[256],[256],body:S[1, 256, 56, 56] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 256, 56, 56],[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { (T0[i0, i1, i2, i3] + T1[i0, i1, i2, i3]) }$inputs:[1, 256, 56, 56],body:S[1, 256, 56, 56] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$tensors:[1, 256, 56, 56] [256] [256] [1, 256, 56, 56] [256] [256] [1, 256, 56, 56] graph:[0:2][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph64.log by 200 trials...
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.B.B.N.N.N.N.N.N.B.N.Y.Y.Y.Y.Y.Y.Y.E.Y.Y.N.N.N.N.N.N

Currently best performance: 0.04462127050618956
.N.B.N.E.E.Y.Y.Y.Y.E.Y.Y.Y.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.03066297278029486
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N

Currently best performance: 0.03066297278029486
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.03066297278029486
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.N

Currently best performance: 0.03066297278029486
.Y.Y.Y.T.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N

Currently best performance: 0.011157293576454294
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.011157293576454294
.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N.N

Currently best performance: 0.011157293576454294
.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.B.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N

Currently best performance: 0.011142325757667132
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.011142325757667132
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.N.N

Currently best performance: 0.011142325757667132
.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.011142325757667132
.N.N.N.N.N.N.N.NSchedule cost 988.476280 seconds
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[256, 64, 1, 1],body:R[1, 256, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [256, 64, 1, 1] [1, 256, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph65/at:resnet50:subgraph65:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 26228.768620074577/26228.768620074577
Best record value:26228.768620074577 (larger is better)
Round 1, Match 1, Mapping 1: 26228.768620074577/26228.768620074577(0.038126075016523465 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 2, 4, 1], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.E.E.Y.Y.E
*Y*E
iteration=1: 2113.5246440551655/2113.5246440551655
Best record value:26228.768620074577 (larger is better)
Round 1, Match 1, Mapping 2: 2113.5246440551655/26228.768620074577(0.038126075016523465 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [1, 8, 1, 1], [1, 1, 1, 1], [2, 14, 2, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[28, 28, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.E.E.Y.E
*Y*Y
iteration=1: 4362.47425121601/4362.47425121601
Best record value:26228.768620074577 (larger is better)
Round 1, Match 1, Mapping 3: 4362.47425121601/26228.768620074577(0.038126075016523465 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 2, 1, 28], [1, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[784, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 15949.60410873872/15949.60410873872
Best record value:26228.768620074577 (larger is better)
Round 1, Match 1, Mapping 4: 15949.60410873872/26228.768620074577(0.038126075016523465 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[28, 7, 1, 2], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4]], "last_factors": [[112, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 26550.23510003585/26550.23510003585
Best record value:26550.23510003585 (larger is better)
Round 1, Match 1, Mapping 5: 26550.23510003585/26550.23510003585(0.03766444990909514 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [1, 1, 1, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 21938.810785507725/21938.810785507725
Best record value:26550.23510003585 (larger is better)
Round 1, Match 1, Mapping 6: 21938.810785507725/26550.23510003585(0.03766444990909514 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[49, 8, 1, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[196, 8, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.E.Y.E.E
*Y*E
iteration=1: 13986.25548951286/13986.25548951286
Best record value:26550.23510003585 (larger is better)
Round 1, Match 1, Mapping 7: 13986.25548951286/26550.23510003585(0.03766444990909514 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[28, 7, 2, 1], [2, 2, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 8, 8]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.E
*Y*Y*Y
iteration=1: 14764.493355890747/14764.493355890747
Best record value:26550.23510003585 (larger is better)
Round 1, Match 1, Mapping 8: 14764.493355890747/26550.23510003585(0.03766444990909514 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[128, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 37081.276164858384/37081.276164858384
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 9: 37081.276164858384/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [7, 2, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 11883.117713548017/11883.117713548017
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 10: 11883.117713548017/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [1, 8, 7, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[49, 16, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*E*Y*Y
iteration=1: 15046.302143714809/15046.302143714809
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 11: 15046.302143714809/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 28, 1, 2], [4, 1, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[64, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.E.Y
*Y*E*Y*Y
iteration=1: 7676.269991202485/7676.269991202485
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 12: 7676.269991202485/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 7, 8, 1], [2, 4, 1, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[896, 14, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 5420.922522084352/5420.922522084352
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 13: 5420.922522084352/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 4], [1, 14, 2, 2]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[128, 7, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*E*Y*Y
iteration=1: 26184.93166418655/26184.93166418655
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 14: 26184.93166418655/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [4, 2, 7, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[196, 8, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 5274.726723166841/5274.726723166841
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 15: 5274.726723166841/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 4], [2, 7, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[32, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.E.Y.E.Y.Y
*Y*Y*Y
iteration=1: 10456.75862947811/10456.75862947811
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 16: 10456.75862947811/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[14, 14, 1, 2], [1, 2, 4, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[224, 112, 1]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*E*Y
iteration=1: 24167.460705465277/24167.460705465277
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 17: 24167.460705465277/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[4, 1, 1]], "last_factors": [[98, 32, 8]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.E.Y.Y.E.Y
*E*E*Y
iteration=1: 2353.719158937394/2353.719158937394
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 18: 2353.719158937394/37081.276164858384(0.02696778815146852 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 2, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.E.Y.Y.E
*Y*Y
iteration=1: 18147.98486162659/18147.98486162659
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 19: 18147.98486162659/37081.276164858384(0.02696778815146852 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 2, 2], [7, 4, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 7, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.E.E
*Y*Y*E
iteration=1: 18027.554016348615/18027.554016348615
Best record value:37081.276164858384 (larger is better)
Round 1, Match 1, Mapping 20: 18027.554016348615/37081.276164858384(0.02696778815146852 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[2, 49, 2, 2], [8, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1792, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 5 schedules
mapping (0,0,0,0,0,1,1): explored 1 schedules
mapping (0,0,0,0,1,1,0): explored 2 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 4 schedules
mapping (0,0,0,1,0,0,1): explored 3 schedules
mapping (0,0,0,1,0,1,0): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 2 schedules
mapping (0,0,1,0,0,1,1): explored 3 schedules
mapping (0,0,1,0,1,1,0): explored 2 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 2 schedules
mapping (0,1,0,1,0,0,0): explored 2 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 1 schedules
mapping (1,0,0,1,0,0,0): explored 2 schedules
mapping (1,0,0,1,0,1,0): explored 2 schedules
Original weights [0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.E.E
*Y*Y
iteration=1: 22008.746923241433/26228.768620074577
Best record value:37081.276164858384 (larger is better)
Round 2, Match 1, Mapping 1: 26228.768620074577/37081.276164858384(0.02696778815146852 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 2, 4, 1], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[784, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*Y*Y
iteration=1: 49417.796094297875/49417.796094297875
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 2: 49417.796094297875/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [2, 1, 2, 2], [1, 1, 1, 1], [56, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[784, 2, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.Y.E.E.Y
*Y*Y
iteration=1: 12907.36180154686/12907.36180154686
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 3: 12907.36180154686/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[392, 1, 1, 1], [1, 2, 1, 4], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[784, 8, 4]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.E.Y.E.Y
*Y*Y*E
iteration=1: 11978.96228353916/15949.60410873872
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 4: 15949.60410873872/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[28, 7, 1, 2], [1, 4, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4]], "last_factors": [[112, 14, 16]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11536.533828886602/26550.23510003585
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 5: 26550.23510003585/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [4, 1, 2, 1], [1, 1, 1, 1], [8, 1, 7, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[224, 56, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*E*Y*Y
iteration=1: 25000.344971086768/25000.344971086768
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 6: 25000.344971086768/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 7, 4, 2], [4, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[196, 64, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*E
iteration=1: 18790.519113675713/18790.519113675713
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 7: 18790.519113675713/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [1, 2, 2, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 32, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.E.E.E.E.E

iteration=1: 1e-10/14764.493355890747
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 8: 14764.493355890747/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 4, 2], [1, 1, 1, 1], [14, 2, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[128, 28, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 11295.174648934837/37081.276164858384
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 9: 37081.276164858384/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [7, 2, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[448, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*E*Y
iteration=1: 2976.5732629504564/11883.117713548017
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 10: 11883.117713548017/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [4, 1, 1, 2], [1, 8, 7, 1]], "reduce_factors": [[4, 1, 1]], "last_factors": [[49, 16, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.E.Y
*Y*Y*Y
iteration=1: 12328.182603962046/15046.302143714809
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 11: 15046.302143714809/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 28, 1, 2], [4, 1, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[64, 98, 4]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*Y*Y
iteration=1: 18219.535107739932/18219.535107739932
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 12: 18219.535107739932/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 28, 2, 7], [8, 1, 1, 1]], "reduce_factors": [[1, 4, 1]], "last_factors": [[1792, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*Y
iteration=1: 19759.684251545405/19759.684251545405
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 13: 19759.684251545405/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 2], [8, 1, 1, 7]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[784, 16, 2]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 37692.1949592608/37692.1949592608
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 14: 37692.1949592608/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 1, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [4, 1, 7, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[196, 8, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*E*Y*Y
iteration=1: 7576.548785293773/7576.548785293773
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 15: 7576.548785293773/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 2, 2], [2, 7, 2, 2]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[32, 112, 7]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 28191.09455779104/28191.09455779104
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 16: 28191.09455779104/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[7, 7, 2, 4], [2, 1, 1, 4]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[784, 1, 32]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 18451.420749063003/24167.460705465277
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 17: 24167.460705465277/49417.796094297875(0.020235625200521357 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 2, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[4, 1, 1]], "last_factors": [[98, 32, 8]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.E.Y.Y
*E*Y*Y
iteration=1: 6887.2530007878195/6887.2530007878195
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 18: 6887.2530007878195/49417.796094297875(0.020235625200521357 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 2, 2, 1], [2, 28, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[56, 224, 2]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.E.Y.Y
*Y*E*Y
iteration=1: 24726.95564931663/24726.95564931663
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 19: 24726.95564931663/49417.796094297875(0.020235625200521357 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 4], [14, 1, 4, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[32, 196, 4]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 20893.548177347242/20893.548177347242
Best record value:49417.796094297875 (larger is better)
Round 2, Match 1, Mapping 20: 20893.548177347242/49417.796094297875(0.020235625200521357 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[2, 49, 2, 2], [8, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[1792, 2, 7]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 7 schedules
mapping (0,0,0,0,0,1,1): explored 4 schedules
mapping (0,0,0,0,1,1,0): explored 4 schedules
mapping (0,0,0,0,1,1,1): explored 5 schedules
mapping (0,0,0,1,0,0,0): explored 9 schedules
mapping (0,0,0,1,0,0,1): explored 5 schedules
mapping (0,0,0,1,0,1,0): explored 4 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 7 schedules
mapping (0,0,1,0,0,1,1): explored 5 schedules
mapping (0,0,1,0,1,1,0): explored 5 schedules
mapping (0,0,1,0,1,1,1): explored 6 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 7 schedules
mapping (0,1,0,1,0,0,0): explored 5 schedules
mapping (0,1,0,1,0,0,1): explored 6 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 3 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 6 schedules
Tensorize use time 351.31107115745544 s.
#############################################
operations:inputs:[1, 64, 56, 56],body:S[1, 64, 56, 56] [ ] { } { tir.if_then_else(((((v2 >= 0) && (v2 < 56)) && (v3 >= 0)) && (v3 < 56)), T0[b, c, h, w], 0h) }$inputs:[1, 64, 56, 56],[64, 64, 1, 1],body:R[1, 64, 56, 56] [64, 1, 1] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, (h + rh), (w + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 64, 56, 56] [64, 64, 1, 1] [1, 64, 56, 56] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph68/at:resnet50:subgraph68:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 20
Initial trials per matching: 100
Original weights [0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
Original trials for each mapping [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 65670.099885632/65670.099885632
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 1: 65670.099885632/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [1, 1, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 23319.123075595147/23319.123075595147
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 2: 23319.123075595147/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 1], [1, 1, 2, 1], [1, 1, 1, 1], [4, 7, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[32, 98, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*E
iteration=1: 63824.47955910664/63824.47955910664
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 3: 63824.47955910664/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 4], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 17844.407196637538/17844.407196637538
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 4: 17844.407196637538/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[2, 28, 7, 1], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2]], "last_factors": [[112, 7, 8]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 18882.034103460144/18882.034103460144
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 5: 18882.034103460144/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [1, 2, 2, 14]], "reduce_factors": [[4, 1, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[14, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 34324.31585111153/34324.31585111153
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 6: 34324.31585111153/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[98, 2, 1, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[14, 28, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 59189.60130737452/59189.60130737452
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 7: 59189.60130737452/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 1, 7, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 27295.76675596298/27295.76675596298
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 8: 27295.76675596298/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [28, 1, 2, 1]], "reduce_factors": [[1, 4, 1], [1, 1, 1]], "last_factors": [[8, 28, 28]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.E.Y
*Y*Y*E*Y
iteration=1: 13293.277543289512/13293.277543289512
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 9: 13293.277543289512/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [2, 7, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 31036.05145978731/31036.05145978731
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 10: 31036.05145978731/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[1, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 15517.597139594875/15517.597139594875
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 11: 15517.597139594875/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 2, 28], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 51068.44715690386/51068.44715690386
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 12: 51068.44715690386/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 4], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 23612.563835407906/23612.563835407906
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 13: 23612.563835407906/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [2, 2, 14, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[28, 28, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 20970.33356133151/20970.33356133151
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 14: 20970.33356133151/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [28, 2, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[16, 392, 1]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 20905.217327429236/20905.217327429236
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 15: 20905.217327429236/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [4, 7, 2, 1]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[64, 49, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.E.Y
*Y*Y*Y*E
iteration=1: 53825.724417445184/53825.724417445184
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 16: 53825.724417445184/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 1, 14, 1], [2, 1, 1, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 19299.16934003348/19299.16934003348
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 17: 19299.16934003348/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [4, 7, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[392, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 30087.785647036486/30087.785647036486
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 18: 30087.785647036486/65670.099885632(0.015227630257020374 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 1], [4, 2, 7, 1]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[896, 1, 7]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 20563.297612450413/20563.297612450413
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 19: 20563.297612450413/65670.099885632(0.015227630257020374 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 2, 1, 1], [7, 1, 1, 8]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 16, 1]], "output_unroll_step": 1500, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*Y*Y
iteration=1: 24048.821466521844/24048.821466521844
Best record value:65670.099885632 (larger is better)
Round 1, Match 1, Mapping 20: 24048.821466521844/65670.099885632(0.015227630257020374 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[28, 7, 2, 1], [2, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[7, 28, 32]], "output_unroll_step": 64, "last_unroll_step": 64}
New weights [0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 4 schedules
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,1,0): explored 3 schedules
mapping (0,0,0,0,1,1,1): explored 3 schedules
mapping (0,0,0,1,0,0,0): explored 5 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,0,1,0): explored 5 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,1,0): explored 3 schedules
mapping (0,0,1,0,0,1,1): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 4 schedules
mapping (0,0,1,0,1,1,1): explored 4 schedules
mapping (0,0,1,1,0,0,0): explored 4 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 5 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 3 schedules
mapping (1,0,0,0,0,1,0): explored 4 schedules
mapping (1,0,0,1,0,0,0): explored 4 schedules
mapping (1,0,0,1,0,1,0): explored 3 schedules
Original weights [0.12516099799833533, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761, 0.04604415800008761]
Original trials for each mapping [13, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.E.Y
*Y*Y*Y
iteration=1: 57125.44762439199/65670.099885632
Best record value:65670.099885632 (larger is better)
Round 2, Match 1, Mapping 1: 65670.099885632/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [1, 1, 1, 1], [28, 1, 1, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 25308.05638035981/25308.05638035981
Best record value:65670.099885632 (larger is better)
Round 2, Match 1, Mapping 2: 25308.05638035981/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 1, 1, 1], [2, 14, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[14, 64, 7]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.E.E.Y.Y.Y
*Y*Y*E
iteration=1: 22996.971488608746/63824.47955910664
Best record value:65670.099885632 (larger is better)
Round 2, Match 1, Mapping 3: 63824.47955910664/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 1, 2, 4], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[784, 8, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*Y*Y*Y*Y
iteration=1: 56637.760294911706/56637.760294911706
Best record value:65670.099885632 (larger is better)
Round 2, Match 1, Mapping 4: 56637.760294911706/65670.099885632(0.015227630257020374 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[28, 2, 7, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[392, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 75329.22792814345/75329.22792814345
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 5: 75329.22792814345/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[7, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [7, 1, 4, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 53619.61531832107/53619.61531832107
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 6: 53619.61531832107/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[49, 2, 4, 1], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1]], "last_factors": [[196, 32, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 59160.7797992211/59189.60130737452
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 7: 59189.60130737452/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[56, 1, 7, 1], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 4], [1, 1, 1], [1, 1, 1]], "last_factors": [[392, 1, 16]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 45657.30573106472/45657.30573106472
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 8: 45657.30573106472/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [1, 1, 1, 1], [1, 1, 2, 28]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[392, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*Y
iteration=1: 5308.912540154727/13293.277543289512
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 9: 13293.277543289512/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [2, 7, 1, 4]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[56, 4, 28]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 29391.174656354895/31036.05145978731
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 10: 31036.05145978731/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 1, 1], [1, 1, 1, 2], [14, 2, 1, 2]], "reduce_factors": [[1, 1, 4]], "last_factors": [[56, 14, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.E.Y.Y
*Y*Y*Y*Y
iteration=1: 11829.047793714608/15517.597139594875
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 11: 15517.597139594875/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 7, 2, 28], [1, 1, 2, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[448, 7, 2]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.E
*E*Y*Y*Y
iteration=1: 43623.608075791635/51068.44715690386
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 12: 51068.44715690386/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[14, 1, 7, 4], [1, 2, 1, 1]], "reduce_factors": [[2, 2, 1]], "last_factors": [[224, 4, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 38795.62298364255/38795.62298364255
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 13: 38795.62298364255/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[1, 1, 1, 7], [1, 1, 2, 1], [7, 2, 2, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 1]], "last_factors": [[98, 2, 32]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 52839.104450216495/52839.104450216495
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 14: 52839.104450216495/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 1, 1, 7], [1, 1, 1, 2], [28, 1, 1, 2]], "reduce_factors": [[2, 1, 2], [1, 1, 1]], "last_factors": [[224, 1, 28]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 35773.531718861814/35773.531718861814
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 15: 35773.531718861814/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [1, 1, 2, 1], [2, 14, 1, 2]], "reduce_factors": [[4, 1, 1], [1, 1, 1]], "last_factors": [[392, 2, 8]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 60906.85193656378/60906.85193656378
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 16: 60906.85193656378/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[392, 1, 1, 1], [1, 1, 2, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1]], "last_factors": [[392, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 16383.72437776896/19299.16934003348
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 17: 19299.16934003348/75329.22792814345(0.013275059727864198 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 1, 7], [2, 1, 1, 1], [4, 7, 2, 1]], "reduce_factors": [[1, 2, 2]], "last_factors": [[392, 8, 2]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}
.Y.Y.E.Y.E
*Y*Y*Y
iteration=1: 37088.90813504433/37088.90813504433
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 18: 37088.90813504433/75329.22792814345(0.013275059727864198 ms), {"vmap": [[1, 0, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[7, 1, 1, 1], [2, 1, 1, 1], [1, 14, 2, 2]], "reduce_factors": [[1, 4, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[3136, 1, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*Y*E
iteration=1: 27526.74101827402/27526.74101827402
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 19: 27526.74101827402/75329.22792814345(0.013275059727864198 ms), {"vmap": [[1, 0, 0, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 7, 1, 1], [2, 1, 1, 1], [8, 1, 1, 7]], "reduce_factors": [[2, 2, 1], [1, 1, 1], [1, 1, 1]], "last_factors": [[128, 49, 1]], "output_unroll_step": 512, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*Y
iteration=1: 69454.12989868975/69454.12989868975
Best record value:75329.22792814345 (larger is better)
Round 2, Match 1, Mapping 20: 69454.12989868975/75329.22792814345(0.013275059727864198 ms), {"vmap": [[1, 0, 0, 1, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 4, "spatial_factors": [[14, 1, 2, 14], [1, 2, 1, 1]], "reduce_factors": [[1, 2, 2], [1, 1, 1], [1, 1, 1]], "last_factors": [[1568, 2, 2]], "output_unroll_step": 64, "last_unroll_step": 512}
New weights [0.09699956942956137, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.11847554164161515, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132, 0.04358471605160132]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,0): explored 7 schedules
mapping (0,0,0,0,0,1,1): explored 7 schedules
mapping (0,0,0,0,1,1,0): explored 5 schedules
mapping (0,0,0,0,1,1,1): explored 7 schedules
mapping (0,0,0,1,0,0,0): explored 9 schedules
mapping (0,0,0,1,0,0,1): explored 8 schedules
mapping (0,0,0,1,0,1,0): explored 9 schedules
mapping (0,0,0,1,1,0,0): explored 7 schedules
mapping (0,0,1,0,0,1,0): explored 8 schedules
mapping (0,0,1,0,0,1,1): explored 8 schedules
mapping (0,0,1,0,1,1,0): explored 8 schedules
mapping (0,0,1,0,1,1,1): explored 7 schedules
mapping (0,0,1,1,0,0,0): explored 7 schedules
mapping (0,1,0,0,0,1,0): explored 8 schedules
mapping (0,1,0,1,0,0,0): explored 9 schedules
mapping (0,1,0,1,0,0,1): explored 7 schedules
mapping (0,1,0,1,1,0,0): explored 7 schedules
mapping (1,0,0,0,0,1,0): explored 7 schedules
mapping (1,0,0,1,0,0,0): explored 8 schedules
mapping (1,0,0,1,0,1,0): explored 7 schedules
Tensorize use time 436.04142022132874 s.
#############################################
operations:inputs:[1, 64, 112, 112],[64],[64],body:S[1, 64, 112, 112] [ ] { } { ((T0[n, c, i, j]*T1[c]) + T2[c]) }$inputs:[1, 64, 112, 112],body:S[1, 64, 112, 112] [ ] { } { max(T0[i0, i1, i2, i3], 0h) }$inputs:[1, 64, 112, 112],body:S[1, 64, 114, 114] [ ] { } { tir.if_then_else(((((v2 >= 1) && (v2 < 113)) && (v3 >= 1)) && (v3 < 113)), T0[b, c, (h - 1), (w - 1)], 0h) }$inputs:[1, 64, 114, 114],body:R[1, 64, 56, 56] [3, 3] { comm_reducer(result=[(v6 + v7)], lhs=[v6], rhs=[v7], identity_element=[0h]) } { (T0[n, c, ((i*2) + r), ((j*2) + s)]/9h) }$tensors:[1, 64, 112, 112] [64] [64] [1, 64, 56, 56] graph:[0:1][1:2][2:3]
Autoscheduling resnet50/tg:resnet50:subgraph69.log by 200 trials...
.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.B.B.N.N.N.B.N.N.N.E.Y.Y.Y.E.Y.Y.Y.E.Y.N.N.B.N

Currently best performance: 0.13044163703270736
.N.N.N.Y.Y.Y.Y.Y.E.Y.Y.Y.Y.N.N.N.B.N.N.N.N.B.Y.Y.E.Y.Y.Y.Y.E.Y.Y.B.N

Currently best performance: 0.04287764057391351
.N.N.B.N.N.N.Y.Y.Y.Y.Y.Y.E.Y.Y.E.N.N.N.N.N.N.B

Currently best performance: 0.03023371502788912
.N.E.Y.E.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.E.Y.Y.E.Y.Y.Y.N.N.B

Currently best performance: 0.012492199160217422
.N.N.N.N.N.Y.Y.Y.Y.Y.Y.E.E.Y.Y.N.N.N.N.N.N.N.N

Currently best performance: 0.012492199160217422
.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.E.Y.Y.N.B.N.N.N

Currently best performance: 0.008340756032026143
.N.N.N.Y.Y.E.Y.E.E.E.Y.Y.E.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.008340756032026143
.N.N.N.N.N.N.N.N.Y.Y.E.Y.Y.Y.Y.Y.Y.E.N.N.N.N.N.N.N

Currently best performance: 0.008340756032026143
.N.Y.Y.Y.E.Y.Y.Y.Y.Y.Y.N.B.N.N.N.N.N.N.N.E.E.Y.Y.Y.Y.Y.Y.Y.Y.N.N

Currently best performance: 0.008305474632472654
.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.Y.N.N.N.N.N.N.N.N.N.N

Currently best performance: 0.008305474632472654
.Y.Y.Y.E.Y.Y.Y.Y.E.Y.N.N.N.N.N.N.N.N.Y.E.E.Y.Y.Y.E.Y.Y.Y.N.N.N.N

Currently best performance: 0.008305474632472654
.N.N.N.Y.Y.Y.Y.Y.E.E.Y.Y.Y.N.N.N.N.N.N.N.N.Y.Y.Y.Y.Y.Y.Y.Y.Y.E.N.N

Currently best performance: 0.008305474632472654
.N.N.N.N.N.N.NSchedule cost 653.226892 seconds
#############################################
operations:inputs:[1, 3, 224, 224],body:S[1, 3, 230, 230] [ ] { } { tir.if_then_else(((((v2 >= 3) && (v2 < 227)) && (v3 >= 3)) && (v3 < 227)), T0[b, c, (h - 3), (w - 3)], 0h) }$inputs:[1, 3, 230, 230],[64, 3, 7, 7],body:R[1, 64, 112, 112] [3, 7, 7] { comm_reducer(result=[(v7 + v8)], lhs=[v7], rhs=[v8], identity_element=[0h]) } { (T0[b, rc, ((h*2) + rh), ((w*2) + rw)]*T1[c, rc, rh, rw]) }$tensors:[1, 3, 224, 224] [64, 3, 7, 7] [1, 64, 112, 112] graph:[0:1]
Autoscheduling resnet50/at-resnet50:subgraph70/at:resnet50:subgraph70:transform.log...
Total trials: 200
Num rounds: 2
Num matching: 1
Num mapping: 18
Initial trials per matching: 100
Original weights [0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555, 0.05555555555555555]
Original trials for each mapping [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 5988.538190521578/5988.538190521578
.Y
*E
iteration=2: 1e-10/5988.538190521578
Best record value:5988.538190521578 (larger is better)
Round 1, Match 1, Mapping 1: 5988.538190521578/5988.538190521578(0.16698565963606288 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 2, 1], [1, 2, 1, 1], [1, 1, 1, 1], [4, 14, 2, 1]], "reduce_factors": [[2, 1, 1], [1, 1, 7]], "last_factors": [[56, 56, 8]], "output_unroll_step": 1500, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 15057.014486830716/15057.014486830716
.Y
*Y
iteration=2: 1439.2363613359842/15057.014486830716
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 2: 15057.014486830716/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 7, 4, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 3]], "last_factors": [[224, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 4499.203849478711/4499.203849478711
.Y
*E
iteration=2: 1e-10/4499.203849478711
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 3: 4499.203849478711/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 98, 1, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[56, 32, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*E*E
iteration=1: 1288.836338024797/1288.836338024797
.Y
*Y
iteration=2: 4119.324246560786/4119.324246560786
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 4: 4119.324246560786/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 14, 8, 14], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[10, 1, 1]], "last_factors": [[448, 7, 8]], "output_unroll_step": 64, "last_unroll_step": 16}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.E.E.Y.Y
*Y*E*E
iteration=1: 140.5813631494933/140.5813631494933
.Y
*E
iteration=2: 1e-10/140.5813631494933
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 5: 140.5813631494933/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 112, 2, 7], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 1], [1, 7, 1]], "last_factors": [[1, 3584, 7]], "output_unroll_step": 16, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*Y*Y
iteration=1: 3431.481476132534/3431.481476132534
.Y
*Y
iteration=2: 4491.511705720427/4491.511705720427
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 6: 4491.511705720427/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [7, 2, 1, 8]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[56, 448, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.E.Y.Y.Y.Y
*Y*Y*Y*E
iteration=1: 9203.18241818094/9203.18241818094
.Y
*Y
iteration=2: 6087.104737035993/9203.18241818094
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 7: 9203.18241818094/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 7, 1], [2, 1, 1, 1], [28, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 3]], "last_factors": [[784, 16, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
.Y
*Y
iteration=2: 1120.408634318697/1120.408634318697
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 8: 1120.408634318697/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 14, 1, 1], [1, 2, 1, 1], [56, 1, 1, 2]], "reduce_factors": [[1, 2, 1], [1, 1, 7]], "last_factors": [[224, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*E*Y*E
iteration=1: 8143.77021332208/8143.77021332208
.Y
*E
iteration=2: 1e-10/8143.77021332208
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 9: 8143.77021332208/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 7], [1, 1, 1, 2], [14, 8, 1, 1]], "reduce_factors": [[5, 1, 2]], "last_factors": [[64, 49, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*E
iteration=1: 3451.9781266290333/3451.9781266290333
.Y
*Y
iteration=2: 2735.515865388251/3451.9781266290333
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 10: 3451.9781266290333/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 4, 1, 7], [1, 2, 1, 1]], "reduce_factors": [[4, 1, 1], [3, 1, 1]], "last_factors": [[112, 16, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.E.Y.Y.Y.Y
*E*Y*E*Y
iteration=1: 2330.080237487912/2330.080237487912
.Y
*Y
iteration=2: 167.07665984147653/2330.080237487912
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 11: 2330.080237487912/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[112, 7, 1, 2], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[7, 256, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 6239.047851832123/6239.047851832123
.Y
*Y
iteration=2: 340.46839674116313/6239.047851832123
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 12: 6239.047851832123/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 28, 1, 8], [2, 1, 1, 1]], "reduce_factors": [[1, 1, 10]], "last_factors": [[1568, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*E
iteration=1: 1e-10/1e-10
.Y
*Y
iteration=2: 318.46443531938036/318.46443531938036
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 13: 318.46443531938036/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[1, 1, 7, 2], [1, 2, 1, 1], [1, 16, 1, 7]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[1792, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 10968.644511531924/10968.644511531924
.Y
*Y
iteration=2: 2671.5908351772296/10968.644511531924
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 14: 10968.644511531924/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 2, 1], [1, 2, 1, 1], [16, 1, 1, 7]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 12425.818921672666/12425.818921672666
.Y
*E
iteration=2: 1e-10/12425.818921672666
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 15: 12425.818921672666/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 7, 1], [2, 1, 1, 1], [56, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[32, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.E.Y.Y.E.Y
*E*E*E
iteration=1: 1e-10/1e-10
.Y
*E
iteration=2: 1e-10/1e-10
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 16: 1e-10/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, None
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 6514.205444608269/6514.205444608269
.Y
*E
iteration=2: 1e-10/6514.205444608269
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 17: 6514.205444608269/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 7, 8], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[8, 98, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*E
iteration=1: 8588.096430063897/8588.096430063897
.Y
*Y
iteration=2: 4654.30231435956/8588.096430063897
Best record value:15057.014486830716 (larger is better)
Round 1, Match 1, Mapping 18: 8588.096430063897/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[7, 1, 1, 2], [1, 1, 2, 1], [14, 2, 2, 2]], "reduce_factors": [[1, 5, 2]], "last_factors": [[8, 224, 14]], "output_unroll_step": 512, "last_unroll_step": 512}
New weights [0.05071435780762185, 0.13785591727042856, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 2 schedules
mapping (0,0,0,0,1,0,1): explored 5 schedules
mapping (0,0,0,0,1,1,0): explored 1 schedules
mapping (0,0,0,0,1,1,1): explored 2 schedules
mapping (0,0,0,1,0,0,1): explored 1 schedules
mapping (0,0,0,1,1,0,0): explored 3 schedules
mapping (0,0,1,0,0,0,1): explored 4 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 2 schedules
mapping (0,0,1,0,1,0,1): explored 4 schedules
mapping (0,0,1,0,1,1,0): explored 3 schedules
mapping (0,0,1,0,1,1,1): explored 2 schedules
mapping (0,0,1,1,0,0,0): explored 1 schedules
mapping (0,1,0,0,0,1,0): explored 3 schedules
mapping (0,1,0,0,1,0,0): explored 4 schedules
mapping (0,1,0,1,0,0,0): explored 0 schedules
mapping (0,1,0,1,0,0,1): explored 3 schedules
mapping (0,1,0,1,1,0,0): explored 4 schedules
Original weights [0.05071435780762185, 0.13785591727042856, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185, 0.05071435780762185]
Original trials for each mapping [6, 14, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6]
Current explored matching: MatchResult(hw_abs_dag:wmma_fp16_fp16, compute:nnn, shape:8x32x16)
Its axis mapping:
i: int32 : [b, b, b, h, h, w, w]
j: int32 : [c, c, c, c, c, c, c]
rk: int32 : [rc, rh, rw, rc, rw, rc, rh]
Current explored mapping: {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}
.Y.E.Y.Y.Y
*Y*E*E*E
iteration=1: 6128.46187921886/6128.46187921886
.Y
*E
iteration=2: 1e-10/6128.46187921886
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 1: 6128.46187921886/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 1, "spatial_factors": [[7, 1, 2, 1], [2, 1, 1, 1], [1, 1, 1, 1], [56, 2, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[16, 392, 4]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}
.Y.Y.E.Y.Y
*E*Y*E*Y
iteration=1: 6386.784945454921/15057.014486830716
.Y
*Y
iteration=2: 8704.101156718138/15057.014486830716
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 2: 15057.014486830716/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[28, 7, 4, 2], [1, 1, 1, 2], [1, 1, 1, 1]], "reduce_factors": [[2, 1, 2], [1, 1, 3]], "last_factors": [[224, 16, 7]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 4417.724487643247/4499.203849478711
.Y
*Y
iteration=2: 1087.440703147794/4499.203849478711
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 3: 4499.203849478711/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 98, 1, 2], [2, 1, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[56, 32, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*E*Y*Y*Y
iteration=1: 4019.136138527696/4119.324246560786
.Y
*Y
iteration=2: 8027.794120431219/8027.794120431219
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 4: 8027.794120431219/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[8, 49, 2, 2], [1, 1, 2, 1], [1, 1, 1, 1]], "reduce_factors": [[5, 2, 1]], "last_factors": [[392, 32, 2]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*E
iteration=1: 137.27045553778578/140.5813631494933
.Y
*Y
iteration=2: 337.59733053418336/337.59733053418336
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 5: 337.59733053418336/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 28, 1, 56], [1, 2, 1, 1], [1, 1, 1, 1]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[1, 1568, 16]], "output_unroll_step": 64, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*Y*Y*E*Y*Y
iteration=1: 3176.8014950723345/4491.511705720427
.Y
*E
iteration=2: 1e-10/4491.511705720427
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 6: 4491.511705720427/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[14, 1, 1, 1], [1, 2, 1, 1], [1, 1, 1, 1], [7, 2, 1, 8]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[56, 448, 1]], "output_unroll_step": 64, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}
.Y.E.Y.Y.Y
*E*Y*Y*Y
iteration=1: 3669.2811616148215/9203.18241818094
.Y
*E
iteration=2: 1e-10/9203.18241818094
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 7: 9203.18241818094/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 2, 7, 1], [2, 1, 1, 1], [28, 2, 1, 2]], "reduce_factors": [[2, 2, 1], [1, 1, 3]], "last_factors": [[784, 16, 2]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.E
*E*E*E*E
iteration=1: 1e-10/1120.408634318697
.Y
*E
iteration=2: 1e-10/1120.408634318697
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 8: 1120.408634318697/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[1, 14, 1, 1], [1, 2, 1, 1], [56, 1, 1, 2]], "reduce_factors": [[1, 2, 1], [1, 1, 7]], "last_factors": [[224, 7, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}
.Y.Y.Y.Y.Y
*Y*Y*Y*E*Y
iteration=1: 6495.772249141748/8143.77021332208
.Y
*E
iteration=2: 1e-10/8143.77021332208
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 9: 8143.77021332208/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 0, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[1, 2, 1, 7], [1, 1, 1, 2], [14, 8, 1, 1]], "reduce_factors": [[5, 1, 2]], "last_factors": [[64, 49, 8]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}
.Y.E.Y.Y.Y
*Y*Y*Y*Y
iteration=1: 1550.6597554693894/3451.9781266290333
.Y
*E
iteration=2: 1e-10/3451.9781266290333
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 10: 3451.9781266290333/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 0, 1], -1]}, {"inline": 1, "vectorize": 2, "spatial_factors": [[56, 4, 1, 7], [1, 2, 1, 1]], "reduce_factors": [[4, 1, 1], [3, 1, 1]], "last_factors": [[112, 16, 14]], "output_unroll_step": 1500, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*E*Y*Y*E
iteration=1: 1812.6172665162223/2330.080237487912
.E

iteration=2: 1e-10/2330.080237487912
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 11: 2330.080237487912/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 0], -1]}, {"inline": 1, "vectorize": 8, "spatial_factors": [[112, 7, 1, 2], [1, 2, 1, 1]], "reduce_factors": [[1, 1, 2], [1, 1, 7]], "last_factors": [[7, 256, 14]], "output_unroll_step": 1500, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}
.Y.Y.Y.Y.Y
*E*E*E*E*Y
iteration=1: 1760.6595570594238/6239.047851832123
.Y
*E
iteration=2: 1e-10/6239.047851832123
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 12: 6239.047851832123/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 0, 1, 1, 1], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 28, 1, 8], [2, 1, 1, 1]], "reduce_factors": [[1, 1, 10]], "last_factors": [[1568, 8, 2]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}
.Y.Y.E.Y.Y
*E*E*E*Y
iteration=1: 1674.797762387563/1674.797762387563
.Y
*Y
iteration=2: 31.874105229918776/1674.797762387563
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 13: 1674.797762387563/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 0, 1, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 1, 7, 2], [1, 2, 1, 1], [1, 16, 1, 7]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[1792, 2, 7]], "output_unroll_step": 64, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*E
iteration=1: 275.17957995804653/10968.644511531924
.Y
*E
iteration=2: 1e-10/10968.644511531924
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 14: 10968.644511531924/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 0, 0, 1, 0], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[1, 7, 2, 1], [1, 2, 1, 1], [16, 1, 1, 7]], "reduce_factors": [[1, 1, 2], [7, 1, 1]], "last_factors": [[448, 4, 14]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*Y*Y
iteration=1: 11577.711421813137/12425.818921672666
.Y
*Y
iteration=2: 5610.897575322234/12425.818921672666
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 15: 12425.818921672666/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 0, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 4, "spatial_factors": [[1, 2, 7, 1], [2, 1, 1, 1], [56, 2, 1, 1]], "reduce_factors": [[2, 2, 1], [3, 1, 1]], "last_factors": [[32, 49, 16]], "output_unroll_step": 512, "last_unroll_step": 1500}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}
.Y.Y.Y.Y.E
*Y*E*Y*Y
iteration=1: 10375.56233901945/10375.56233901945
.Y
*E
iteration=2: 1e-10/10375.56233901945
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 16: 10375.56233901945/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[7, 2, 1, 1], [2, 1, 1, 1], [4, 1, 1, 28]], "reduce_factors": [[2, 1, 1], [7, 1, 1]], "last_factors": [[56, 112, 4]], "output_unroll_step": 512, "last_unroll_step": 512}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}
.Y.Y.Y.Y.Y
*E*Y*E*E*Y
iteration=1: 6506.298881089171/6514.205444608269
.Y
*E
iteration=2: 1e-10/6514.205444608269
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 17: 6514.205444608269/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 0, 0, 1], -1]}, {"inline": 0, "vectorize": 2, "spatial_factors": [[14, 2, 7, 8], [1, 1, 1, 2]], "reduce_factors": [[1, 2, 1], [7, 1, 1]], "last_factors": [[8, 98, 32]], "output_unroll_step": 16, "last_unroll_step": 64}
Current explored mapping: {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}
.Y.Y.Y.Y.Y
*E*Y*Y*Y*E
iteration=1: 12752.894674764762/12752.894674764762
.Y
*Y
iteration=2: 7064.11303798564/12752.894674764762
Best record value:15057.014486830716 (larger is better)
Round 2, Match 1, Mapping 18: 12752.894674764762/15057.014486830716(0.06641422845641995 ms), {"vmap": [[0, 1, 0, 1, 1, 0, 0], -1]}, {"inline": 0, "vectorize": 8, "spatial_factors": [[14, 1, 1, 1], [2, 1, 1, 1], [16, 1, 7, 1]], "reduce_factors": [[1, 1, 10]], "last_factors": [[32, 98, 8]], "output_unroll_step": 512, "last_unroll_step": 64}
New weights [0.04338461148023763, 0.26246160483596037, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763, 0.04338461148023763]
Show mapping exploration summary:
mapping (0,0,0,0,0,1,1): explored 3 schedules
mapping (0,0,0,0,1,0,1): explored 8 schedules
mapping (0,0,0,0,1,1,0): explored 6 schedules
mapping (0,0,0,0,1,1,1): explored 7 schedules
mapping (0,0,0,1,0,0,1): explored 4 schedules
mapping (0,0,0,1,1,0,0): explored 7 schedules
mapping (0,0,1,0,0,0,1): explored 7 schedules
mapping (0,0,1,0,0,1,0): explored 1 schedules
mapping (0,0,1,0,0,1,1): explored 6 schedules
mapping (0,0,1,0,1,0,1): explored 8 schedules
mapping (0,0,1,0,1,1,0): explored 5 schedules
mapping (0,0,1,0,1,1,1): explored 3 schedules
mapping (0,0,1,1,0,0,0): explored 3 schedules
mapping (0,1,0,0,0,1,0): explored 4 schedules
mapping (0,1,0,0,1,0,0): explored 8 schedules
mapping (0,1,0,1,0,0,0): explored 3 schedules
mapping (0,1,0,1,0,0,1): explored 5 schedules
mapping (0,1,0,1,1,0,0): explored 8 schedules
Tensorize use time 813.480711221695 s.
Query subgraph task id: 0, perf=0.000070 ms after 200 tuning
Query subgraph task id: 1, perf=0.004436 ms after 200 tuning
Query subgraph task id: 2, perf=0.000038 ms after 200 tuning
Query subgraph task id: 3, perf=0.000147 ms after 200 tuning
Query subgraph task id: 4, perf=0.000077 ms after 200 tuning
Query subgraph task id: 5, perf=0.002907 ms after 200 tuning
Query subgraph task id: 6, perf=0.003234 ms after 200 tuning
Query subgraph task id: 7, perf=0.000050 ms after 200 tuning
Query subgraph task id: 8, perf=0.000106 ms after 200 tuning
Query subgraph task id: 9, perf=0.000047 ms after 200 tuning
Query subgraph task id: 10, perf=0.003828 ms after 200 tuning
Query subgraph task id: 11, perf=0.000025 ms after 200 tuning
Query subgraph task id: 12, perf=0.000097 ms after 200 tuning
Query subgraph task id: 13, perf=0.000041 ms after 200 tuning
Query subgraph task id: 14, perf=0.003616 ms after 200 tuning
Query subgraph task id: 15, perf=0.000031 ms after 200 tuning
Query subgraph task id: 16, perf=0.000060 ms after 200 tuning
Query subgraph task id: 17, perf=0.000036 ms after 200 tuning
Query subgraph task id: 18, perf=0.004624 ms after 200 tuning
Query subgraph task id: 19, perf=0.000022 ms after 200 tuning
Query subgraph task id: 20, perf=0.000067 ms after 200 tuning
Query subgraph task id: 21, perf=0.000026 ms after 200 tuning
Query subgraph task id: 22, perf=0.007036 ms after 200 tuning
Query subgraph task id: 23, perf=0.000029 ms after 200 tuning
Query subgraph task id: 24, perf=0.000042 ms after 200 tuning
Query subgraph task id: 25, perf=0.000023 ms after 200 tuning
Query subgraph task id: 26, perf=0.005023 ms after 200 tuning
Query subgraph task id: 27, perf=0.000022 ms after 200 tuning
Query subgraph task id: 28, perf=0.000067 ms after 200 tuning
Query subgraph task id: 29, perf=0.000020 ms after 200 tuning
Query subgraph task id: 30, perf=0.011142 ms after 200 tuning
Query subgraph task id: 31, perf=0.000020 ms after 200 tuning
Query subgraph task id: 32, perf=0.000013 ms after 200 tuning
Query subgraph task id: 33, perf=0.008305 ms after 200 tuning
Query subgraph task id: 34, perf=0.000066 ms after 200 tuning
[NOTICE] totally 71 subgraphs, mapped 54 subgraphs, ratio= 76.05633802816901 %
.GYWhole graph cost is 2.841980 ms
Time taken:  231111.167464733124
